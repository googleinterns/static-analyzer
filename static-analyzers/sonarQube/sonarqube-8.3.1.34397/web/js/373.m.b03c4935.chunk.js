(window.webpackJsonp=window.webpackJsonp||[]).push([[373],{1914:function(e,t,a){"use strict";a.r(t),a.d(t,"PullRequestOverview",(function(){return S}));var n=a(424),s=a.n(n),i=a(874),l=a.n(i),r=a(309),c=a(2),o=a(317),m=a(322),d=a.n(m),v=a(325),p=a(5),u=a(410),h=a(540),f=a(347),b=a(329),g=a(345),E=a(423),w=a(319),y=a(1249),N=a(1250),O=a(1251),j=a(1261),_=(a(1248),a(649)),k=a(318);var x=c.memo((function({className:e,measures:t,type:a}){const n=Object(_.j)(a),s=Object(g.findMeasure)(t,n);return s&&void 0!==s.value?c.createElement("div",{className:r(e,"display-flex-center")},c.createElement("span",{className:"huge"},Object(k.formatMeasure)(s.value,"PERCENT")),c.createElement("span",{className:"label flex-1 spacer-left text-right"},Object(p.translate)("component_measures.facet_category.overall_category.estimated"))):null})),D=a(304),B=a(314),C=a(370),M=a.n(C),R=a(332),q=a(320);var L=c.memo((function({component:e,level:t}){const a="OK"===t,n=void 0===e.qualityGate?Object(q.w)():Object(q.v)(e.qualityGate.key);return c.createElement("div",{className:r("overview-quality-gate-badge-large small",{failed:!a,success:a})},c.createElement("div",{className:"display-flex-center"},c.createElement("span",null,Object(p.translate)("overview.on_new_code_long")),c.createElement(d.a,{className:"little-spacer-left",overlay:c.createElement(D.FormattedMessage,{defaultMessage:Object(p.translate)("overview.quality_gate.conditions_on_new_code"),id:"overview.quality_gate.conditions_on_new_code",values:{link:c.createElement(B.Link,{to:n},Object(p.translate)("overview.quality_gate"))}})},c.createElement(M.a,{fill:R.colors.transparentWhite,size:12}))),void 0!==t&&c.createElement("h3",{className:"huge-spacer-top huge"},Object(p.translate)("metric.level",t)))}));class S extends c.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!1,measures:[]},this.conditionsHaveChanged=e=>{var t,a;const n=null!==(t=e.conditions)&&void 0!==t?t:[],s=null!==(a=this.props.conditions)&&void 0!==a?a:[],i=l()(n.filter(e=>"ERROR"===e.level),s.filter(e=>"ERROR"===e.level),e=>e.metric);return void 0===e.conditions&&void 0!==this.props.conditions||i.length>0},this.fetchBranchStatusData=()=>{const{branchLike:e,component:{key:t}}=this.props;this.props.fetchBranchStatus(e,t)},this.fetchBranchData=()=>{const{branchLike:e,component:{key:t},conditions:a}=this.props;this.setState({loading:!0});const n=void 0!==a?s()([..._.e,...a.filter(e=>"OK"!==e.level).map(e=>e.metric)]):_.e;Object(h.f)(t,n,Object(b.d)(e)).then(({component:e,metrics:t})=>{this.mounted&&e.measures&&this.setState({loading:!1,measures:Object(g.enhanceMeasuresWithMetrics)(e.measures||[],t)})},()=>{this.mounted&&this.setState({loading:!1})})}}componentDidMount(){this.mounted=!0,void 0===this.props.conditions?this.fetchBranchStatusData():this.fetchBranchData()}componentDidUpdate(e){this.conditionsHaveChanged(e)&&this.fetchBranchData()}componentWillUnmount(){this.mounted=!1}render(){const{branchLike:e,component:t,conditions:n,ignoredConditions:s,status:i}=this.props,{loading:l,measures:o}=this.state;if(l)return c.createElement("div",{className:"page page-limited"},c.createElement("i",{className:"spinner"}));if(void 0===n)return null;const m=n.filter(e=>"ERROR"===e.level).map(e=>Object(g.enhanceConditionWithMeasure)(e,o)).filter(u.isDefined);return c.createElement("div",{className:"page page-limited"},c.createElement("div",{className:r("pr-overview",{"has-conditions":m.length>0})},s&&c.createElement(v.Alert,{className:"big-spacer-bottom",display:"inline",variant:"info"},c.createElement("span",{className:"text-middle"},Object(p.translate)("overview.quality_gate.ignored_conditions")),c.createElement(d.a,{className:"spacer-left",overlay:Object(p.translate)("overview.quality_gate.ignored_conditions.tooltip")})),c.createElement("div",{className:"display-flex-row"},c.createElement("div",{className:"big-spacer-right"},c.createElement("h2",{className:"overview-panel-title spacer-bottom small"},Object(p.translate)("overview.quality_gate"),c.createElement(f.a,{className:"spacer-left",doc:Promise.resolve().then(a.bind(null,1252))})),c.createElement(L,{component:t,level:i})),m.length>0&&c.createElement("div",{className:"pr-overview-failed-conditions big-spacer-right"},c.createElement("h2",{className:"overview-panel-title spacer-bottom small"},Object(p.translate)("overview.failed_conditions")),c.createElement(j.b,{branchLike:e,collapsible:!0,component:t,failedConditions:m})),c.createElement("div",{className:"flex-1"},c.createElement("h2",{className:"overview-panel-title spacer-bottom small"},Object(p.translate)("overview.measures")),c.createElement("div",{className:"overview-panel-content"},[_.b.Bug,_.b.Vulnerability,_.b.SecurityHotspot,_.b.CodeSmell].map(a=>c.createElement("div",{className:"overview-measures-row display-flex-row",key:a},c.createElement("div",{className:"overview-panel-big-padded flex-1 small display-flex-center"},c.createElement(y.a,{branchLike:e,component:t,measures:o,type:a,useDiffMetric:!0})),c.createElement("div",{className:"overview-panel-big-padded overview-measures-aside display-flex-center"},c.createElement(N.a,{branchLike:e,component:t,measures:o,type:a,useDiffMetric:!0})))),[_.d.Coverage,_.d.Duplication].map(a=>c.createElement("div",{className:"overview-measures-row display-flex-row",key:a},c.createElement("div",{className:"overview-panel-big-padded flex-1 small display-flex-center"},c.createElement(O.a,{branchLike:e,component:t,measures:o,type:a,useDiffMetric:!0})),c.createElement(x,{className:"overview-panel-big-padded overview-measures-aside text-right overview-measures-emphasis",measures:o,type:a}))))))))}}const P={fetchBranchStatus:E.c};t.default=Object(o.connect)((e,{branchLike:t,component:a})=>{const{conditions:n,ignoredConditions:s,status:i}=Object(w.getBranchStatusByBranchLike)(e,a.key,t);return{conditions:n,ignoredConditions:s,status:i}},P)(S)},874:function(e,t,a){var n=a(517),s=a(417),i=a(341),l=a(445),r=a(467),c=a(694),o=l((function(e,t){var a=c(t);return r(a)&&(a=void 0),r(e)?n(e,s(t,1,r,!0),i(a,2)):[]}));e.exports=o}}]);
//# sourceMappingURL=373.m.b03c4935.chunk.js.map