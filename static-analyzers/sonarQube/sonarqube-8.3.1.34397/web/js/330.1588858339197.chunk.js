(window.webpackJsonp=window.webpackJsonp||[]).push([[330],{1077:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return p})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return h})),n.d(t,"g",(function(){return m}));var o=function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),s=0;for(t=0;t<n;t++)for(var r=arguments[t],a=0,i=r.length;a<i;a++,s++)o[s]=r[a];return o},r=11,a=9,i=50;function c(e,t){var n=e[0],o=e[1],s=t[0];return!(n>t[1]+r||o<s-r)}function l(e){return{component:e.component,textRange:e.textRange||{endLine:0,endOffset:0,startLine:0,startOffset:0}}}function p(e){var t=e.component,n=e.issue,o=e.locations,r=n.secondaryLocations.length>0,i=(r&&n.component===t?s([l(n)],o):o).reduce((function(e,t,o){var s,r=Math.max(1,t.textRange.startLine-5),i=function(e){var t=e.issue,n=e.locationEnd,o=t.textRange&&t.textRange.endLine||0;return o&&o!==n?n+5:n+a}({issue:n,locationEnd:t.textRange.endLine});return e=e.filter((function(e){if(c([e.start,e.end],[r,i])){var t=!1;return s||(s=e,t=!0),s.start=Math.min(r,e.start,s.start),s.end=Math.max(i,e.end,s.end),t}return!0})),void 0===s&&e.push({start:r,end:i,index:o}),e}),[]);return r?i.sort((function(e,t){return e.start-t.start})):i}function u(e,t){return e.map((function(e){for(var n=[],o=e.start;o<=e.end;o++)t[o]&&n.push(t[o]);return n})).filter((function(e){return e.length>0}))}function d(e,t,n){var s,r="",a=[],i=function(e){s=o(o({},n[e.component]||{component:{key:e.component,measures:{},path:"",project:"",projectName:"",q:"FIL",uuid:""},sources:[]}),{locations:[]}),a.push(s),r=e.component};return e.secondaryLocations.length>0&&t.every((function(t){return t.component!==e.component}))&&i(l(e)),t.forEach((function(e,t){e.component!==r&&i(e),e.index=t,s.locations.push(e)})),a}function h(e){var t=e.direction,n=e.snippetIndex,o=e.snippets,s=o.find((function(e){return e.index===n}));if(!s)throw new Error("Snippet "+n+" not found");return s.start=Math.max(0,s.start-("up"===t?i:0)),s.end+="down"===t?i:0,o.map((function(e){return e.index===n?s:(c([e.start,e.end],[s.start,s.end])&&(s.start=Math.min(e.start,s.start),s.end=Math.max(e.end,s.end),e.toDelete=!0),e)}))}function m(e,t){return e>=t[0].line&&e<=t[t.length-1].line}},1228:function(e,t,n){"use strict";var o,s=n(658),r=n.n(s),a=n(13),i=n(1067),c=n.n(i),l=n(37),p=n(782),u=n(1194),d=n(963),h=n(1015),m=n(1163),f=(n(1233),n(1077)),g=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),b=function(e){function t(t){var n=e.call(this,t)||this;return n.doScroll=function(e){n.props.scroll&&n.props.scroll(e);var t=n.snippetNodeRef.current;if(t){var o=t.getBoundingClientRect().width/2;Object(p.scrollHorizontally)(e,{leftOffset:o,rightOffset:o,parent:t})}},n.scrollToLastExpandedRow=function(){if(n.props.scroll){var e=n.snippetNodeRef.current;if(!e)return;var t=e.querySelectorAll("tr"),o=t[t.length-1];n.props.scroll(o,100)}},n.expandBlock=function(e){return function(){return n.props.expandBlock(n.props.index,e).then((function(){"down"===e&&n.scrollToLastExpandedRow()}))}},n.snippetNodeRef=a.createRef(),n}return g(t,e),t.prototype.renderLine=function(e){var t=this,n=e.displayDuplications,o=e.displaySCM,s=e.index,r=e.issuesForLine,i=e.issueLocations,c=e.line,l=e.snippet,p=e.symbols,d=e.verticalBuffer,f=Object(h.b)(c,this.props.locations),g=this.props,b=g.duplications,y=g.duplicationsByLine,v=b?b.length:0,E=v&&y&&y[c.line]||[],O=r.some((function(e){return e.key===t.props.issue.key}));return a.createElement(u.a,{branchLike:this.props.branchLike,displayAllIssues:!1,displayCoverage:!0,displayDuplications:n,displayIssues:!O||r.length>1,displayLocationMarkers:!0,displaySCM:o,duplications:E,duplicationsCount:v,highlighted:!1,highlightedLocationMessage:Object(m.b)(this.props.highlightedLocationMessage,f),highlightedSymbols:Object(m.a)(p,this.props.highlightedSymbols),issueLocations:i,issuePopup:this.props.issuePopup,issues:r,key:c.line,last:!1,line:c,linePopup:this.props.linePopup,loadDuplications:this.props.loadDuplications,onIssueChange:this.props.onIssueChange,onIssuePopupToggle:this.props.onIssuePopupToggle,onIssueSelect:function(){},onIssueUnselect:function(){},onIssuesClose:this.props.handleCloseIssues,onIssuesOpen:this.props.handleOpenIssues,onLinePopupToggle:this.props.handleLinePopupToggle,onLocationSelect:this.props.onLocationSelect,onSymbolClick:this.props.handleSymbolClick,openIssues:this.props.openIssuesByLine[c.line],previousLine:s>0?l[s-1]:void 0,renderDuplicationPopup:this.props.renderDuplicationPopup,scroll:this.doScroll,secondaryIssueLocations:f,selectedIssue:Object(m.c)(this.props.issue.key,r),verticalBuffer:d})},t.prototype.render=function(){var e=this,t=this.props,n=t.component,o=t.displaySCM,s=t.issue,i=t.issuesByLine,p=void 0===i?{}:i,u=t.lastSnippetOfLastGroup,h=t.locationsByLine,m=t.openIssuesByLine,g=t.snippet,b=n.measures&&n.measures.lines&&parseInt(n.measures.lines,10),y=Object(d.e)(g),v=g[g.length-1].line,E=s.textRange?s.textRange.endLine:s.line,O=Math.max.apply(Math,Object.keys(p).map((function(e){return parseInt(e,10)})).filter((function(e){return Object(f.g)(e,g)&&(e===E||m[e])}))),x=u?Math.max(0,f.b-(v-O)):0,k=g.some((function(e){return!!e.duplicated}));return a.createElement("div",{className:"source-viewer-code snippet",ref:this.snippetNodeRef},a.createElement("div",null,g[0].line>1&&a.createElement("div",{className:"expand-block expand-block-above"},a.createElement("button",{"aria-label":Object(l.translate)("source_viewer.expand_above"),onClick:this.expandBlock("up"),type:"button"},a.createElement(c.a,null))),a.createElement("table",{className:r()("source-table",{"expand-up":g[0].line>1,"expand-down":!b||g[g.length-1].line<b})},a.createElement("tbody",null,g.map((function(t,n){return e.renderLine({displayDuplications:k,displaySCM:o,index:n,issuesForLine:p[t.line]||[],issueLocations:h[t.line]||[],line:t,snippet:g,symbols:y[t.line],verticalBuffer:n===g.length-1?x:0})})))),(!b||g[g.length-1].line<b)&&a.createElement("div",{className:"expand-block expand-block-below"},a.createElement("button",{"aria-label":Object(l.translate)("source_viewer.expand_below"),onClick:this.expandBlock("down"),type:"button"},a.createElement(c.a,null)))))},t}(a.PureComponent);t.a=b},1233:function(e,t,n){var o=n(660),s=n(1234);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var r={insert:"head",singleton:!1},a=(o(s,r),s.locals?s.locals:{});e.exports=a},1234:function(e,t,n){(t=n(661)(!1)).push([e.i,'.snippet{margin:8px;border:1px solid #cdcdcd;overflow-x:auto;overflow-y:hidden;transition:max-height .2s}.snippet>div{display:table;width:100%;position:relative;transition:margin-top .2s}.snippet table{width:100%}.expand-block{position:absolute;z-index:2;width:100%}.expand-block>button{background:transparent;box-sizing:border-box;color:#777;height:20px;width:100%;padding:2px;border:0;text-align:left;cursor:pointer}.expand-block>button:active,.expand-block>button:focus,.expand-block>button:hover{color:#236a97;outline:none}.expand-block-above{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAAXNSR0IArs4c6QAAADdJREFUCB1dzMEKADAIAlBd1v9/bcc2YgRjHh8qq2qTxCQzsX4wM6y30RARF3sy0Es1SIK7Y64OpCES1W69JS4AAAAASUVORK5CYII=");top:0}.expand-block-below{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4wQQBjQEQVd5jwAAADhJREFUCNddyTEKADEMA8GVA/7/Z+PGwUp1cGTaYe/tv5lxrLWoKj6SiMzkjZDEG7JtANt0N+ccLrB/KZxXTt7fAAAAAElFTkSuQmCC");bottom:0}.source-table.expand-up{margin-top:20px}.source-table.expand-down{margin-bottom:20px}',""]),e.exports=t},1511:function(e,t,n){var o=n(660),s=n(1765);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var r={insert:"head",singleton:!1},a=(o(s,r),s.locals?s.locals:{});e.exports=a},1757:function(e,t,n){var o=n(660),s=n(1758);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var r={insert:"head",singleton:!1},a=(o(s,r),s.locals?s.locals:{});e.exports=a},1758:function(e,t,n){(t=n(661)(!1)).push([e.i,".hotspot-list-header{padding:16px 8px}.hotspot-risk-header{padding:8px}.hotspot-category{background-color:#fff;border:1px solid #e6e6e6}.hotspot-category .hotspot-category-header{padding:16px 8px;color:#444;border-bottom:none;border-left:4px solid}.hotspot-category .hotspot-category-header.contains-selected-hotspot,.hotspot-category .hotspot-category-header:hover{color:#4b9fd5}.hotspot-category.HIGH .hotspot-category-header{border-left-color:#d4333f}.hotspot-category.MEDIUM .hotspot-category-header{border-left-color:#ed7d20}.hotspot-category.LOW .hotspot-category-header{border-left-color:#eabe06}.hotspot-item{color:#444;display:block;padding:8px 16px;border:1px solid transparent;border-top-color:#e6e6e6;transition:padding 0s,border 0s}.hotspot-item:hover{background-color:#f2faff;border:1px dashed #4b9fd5;color:#444}.hotspot-item.highlight{background-color:#f2faff;color:#444;border:1px solid #4b9fd5;cursor:unset}.hotspot-risk-badge{color:#fff;text-transform:uppercase;display:inline-block;text-align:center;min-width:48px;padding:0 8px;font-weight:700;border-radius:2px}.hotspot-risk-badge.HIGH{background-color:#d4333f}.hotspot-risk-badge.MEDIUM{background-color:#ed7d20}.hotspot-risk-badge.LOW{background-color:#eabe06}",""]),e.exports=t},1759:function(e,t,n){var o=n(660),s=n(1760);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var r={insert:"head",singleton:!1},a=(o(s,r),s.locals?s.locals:{});e.exports=a},1760:function(e,t,n){(t=n(661)(!1)).push([e.i,".hotspot-assignee-search-results{min-width:300px}.hotspot-assignee-search-results li{cursor:pointer}.hotspot-assignee-search-results li.active,.hotspot-assignee-search-results li:hover{background-color:#f3f3f3}",""]),e.exports=t},1761:function(e,t,n){var o=n(660),s=n(1762);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var r={insert:"head",singleton:!1},a=(o(s,r),s.locals?s.locals:{});e.exports=a},1762:function(e,t,n){(t=n(661)(!1)).push([e.i,".hotspot-information{flex-basis:320px}.hotspot-information>div>span{flex-basis:100px}",""]),e.exports=t},1763:function(e,t,n){var o=n(660),s=n(1764);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var r={insert:"head",singleton:!1},a=(o(s,r),s.locals?s.locals:{});e.exports=a},1764:function(e,t,n){(t=n(661)(!1)).push([e.i,"#status-trigger,#status-trigger+.popup{width:400px;box-sizing:border-box}#status-trigger{height:80px;border-radius:4px;outline:none}#status-trigger.readonly{cursor:not-allowed}#status-trigger:not(.readonly){cursor:pointer;background-color:#236a97}#status-trigger:not(.readonly) *{color:#fff}",""]),e.exports=t},1765:function(e,t,n){(t=n(661)(!1)).push([e.i,"#security_hotspots .wrapper{position:fixed;bottom:0;width:100%}#security_hotspots .layout-page{margin:0 auto;min-width:1080px;max-width:1280px;height:100%}#security_hotspots .filter-bar{max-width:1280px;box-sizing:border-box;margin:0 auto;padding:16px 8px;border-bottom:1px solid #e6e6e6}#security_hotspots .sidebar{flex:0 0 300px;border-right:1px solid #e6e6e6;height:100%;overflow-y:auto}#security_hotspots .main{flex:1 1 auto;background-color:#fff;overflow-x:auto}#security_hotspots .main .hotspot-content{overflow-y:auto;height:100%;box-sizing:border-box}.invisible{visibility:hidden}",""]),e.exports=t},2230:function(e,t,n){"use strict";n.r(t),n.d(t,"SecurityHotspotsApp",(function(){return Tt}));var o=n(834),s=n.n(o),r=n(871),a=n.n(r),i=n(13),c=n(761),l=n(888),p=n(51),u=n(670),d=function(){return(d=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},h=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(n[o[s]]=e[o[s]])}return n};function m(e,t){return Object(p.post)("/api/hotspots/assign",d({hotspot:e},t)).catch(u.a)}var f=n(727),g=n(740),b=n(678),y=n(961),v=n(682),E=n(962),O=n(677),x=n(665),k=n.n(x),C=n(37),_=n(699),S=n(680),j=n(794),w=n(663),N=n(685);function L(e){var t,n=e.filtered,o=e.isStaticListOfHotspots;return t=o?"no_hotspots_for_keys":n?"no_hotspots_for_filters":"no_hotspots",i.createElement("div",{className:"display-flex-column display-flex-center huge-spacer-top"},i.createElement("img",{alt:Object(C.translate)("hotspots.page"),className:"huge-spacer-top",height:100,src:Object(N.getBaseUrl)()+"/images/"+(n?"filter-large":"hotspot-large")+".svg"}),i.createElement("h1",{className:"huge-spacer-top"},Object(C.translate)("hotspots."+t+".title")),i.createElement("div",{className:"abs-width-400 text-center big-spacer-top"},Object(C.translate)("hotspots."+t+".description")),!(n||o)&&i.createElement(w.Link,{className:"big-spacer-top",target:"_blank",to:{pathname:"/documentation/user-guide/security-hotspots/"}},Object(C.translate)("hotspots.learn_more")))}var A,P=n(671),M=n.n(P),I=n(837),R=n.n(I),H=n(688),T=n.n(H),U=n(748),D=n(872),F=n(697),B=[{value:E.c.TO_REVIEW,label:Object(C.translate)("hotspot.filters.status.to_review")},{value:E.c.FIXED,label:Object(C.translate)("hotspot.filters.status.fixed")},{value:E.c.SAFE,label:Object(C.translate)("hotspot.filters.status.safe")}],V=[{value:!0,label:Object(C.translate)("hotspot.filters.period.since_leak_period")},{value:!1,label:Object(C.translate)("hotspot.filters.period.overall")}];!function(e){e.ALL="all",e.ME="me"}(A||(A={}));var W=[{value:A.ME,label:Object(C.translate)("hotspot.filters.assignee.assigned_to_me")},{value:A.ALL,label:Object(C.translate)("hotspot.filters.assignee.all")}];var q,K,z=Object(f.a)((function(e){var t=e.currentUser,n=e.component,o=e.filters,s=e.hotspotsReviewedMeasure,r=e.isStaticListOfHotspots,a=e.loadingMeasure,c=e.onBranch,l=n.qualifier===F.a.Project;return i.createElement("div",{className:"filter-bar display-flex-center"},r?i.createElement("a",{id:"show_all_hotspot",onClick:function(){return e.onShowAllHotspots()},role:"link",tabIndex:0},Object(C.translate)("hotspot.filters.show_all")):i.createElement("div",{className:"display-flex-space-between width-100"},i.createElement("div",{className:"display-flex-center"},i.createElement("h3",{className:"huge-spacer-right"},Object(C.translate)("hotspot.filters.title")),Object(v.b)(t)&&i.createElement(R.a,{className:"huge-spacer-right",name:"assignee-filter",onCheck:function(t){return e.onChangeFilters({assignedToMe:t===A.ME})},options:W,value:o.assignedToMe?A.ME:A.ALL}),i.createElement("span",{className:"spacer-right"},Object(C.translate)("status")),i.createElement(T.a,{className:"input-medium big-spacer-right",clearable:!1,onChange:function(t){return e.onChangeFilters({status:t.value})},options:B,searchable:!1,value:o.status}),c&&i.createElement(T.a,{className:"input-medium big-spacer-right",clearable:!1,onChange:function(t){return e.onChangeFilters({sinceLeakPeriod:t.value})},options:V,searchable:!1,value:o.sinceLeakPeriod})),l&&i.createElement("div",{className:"display-flex-center"},i.createElement("span",{className:"little-spacer-right"},Object(C.translate)("metric.security_hotspots_reviewed.name")),i.createElement(M.a,{className:"big-spacer-right",overlay:Object(C.translate)("hotspots.reviewed.tooltip")}),i.createElement(k.a,{loading:a},s&&i.createElement(D.a,{value:s}),i.createElement(U.a,{className:"spacer-left huge",metricKey:c&&!o.sinceLeakPeriod?"security_hotspots_reviewed":"new_security_hotspots_reviewed",metricType:"PERCENT",value:s})))))})),X=n(732),G=n.n(X),J=n(658),Q=n(706),Y=n.n(Q),Z=n(775),$=n.n(Z),ee=n(675),te=n.n(ee),ne=function(){return(ne=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},oe=[E.f.HIGH,E.f.MEDIUM,E.f.LOW];function se(e,t){void 0===e&&(e=[]);var n=G()(e,(function(e){return e.securityCategory}));return Object.keys(n).map((function(e){return{key:e,title:re(e,t),hotspots:n[e]}}))}function re(e,t){return t[e]?t[e].title:e}var ae=((q={})[E.b.TO_REVIEW]=E.d.TO_REVIEW,q[E.b.REVIEWED]=E.d.FIXED,q[E.a.FIXED]=E.d.FIXED,q[E.a.SAFE]=E.d.SAFE,q);function ie(e,t){return ae[null!=t?t:e]}var ce=((K={})[E.d.TO_REVIEW]={status:E.b.TO_REVIEW,resolution:void 0},K[E.d.FIXED]={status:E.b.REVIEWED,resolution:E.a.FIXED},K[E.d.SAFE]={status:E.b.REVIEWED,resolution:E.a.SAFE},K);var le=n(753),pe=n.n(le),ue=n(1756),de=n.n(ue);function he(e){var t=e.hotspot,n=e.selected;return i.createElement("a",{className:J("hotspot-item",{highlight:n}),href:"#",onClick:function(){return!n&&e.onClick(t)}},i.createElement("div",{className:"little-spacer-left"},t.message),i.createElement("div",{className:"badge spacer-top"},Object(C.translate)("hotspots.status_option",ie(t.status,t.resolution))))}function me(e){var t=e.categoryKey,n=e.expanded,o=e.hotspots,s=e.selectedHotspot,r=e.title;if(o.length<1)return null;var a=o[0].vulnerabilityProbability;return i.createElement("div",{className:J("hotspot-category",a)},i.createElement("a",{className:J("hotspot-category-header display-flex-space-between display-flex-center",{"contains-selected-hotspot":s.securityCategory===t}),href:"#",onClick:function(){return e.onToggleExpand(t,!n)}},i.createElement("strong",{className:"flex-1"},r),i.createElement("span",null,i.createElement("span",{className:"counter-badge"},o.length),n?i.createElement(de.a,{className:"big-spacer-left"}):i.createElement(pe.a,{className:"big-spacer-left"}))),n&&i.createElement("ul",null,o.map((function(t){return i.createElement("li",{key:t.key},i.createElement(he,{hotspot:t,onClick:e.onHotspotClick,selected:t.key===s.key}))}))))}n(1757);var fe,ge=(fe=function(e,t){return(fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}fe(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),be=function(){return(be=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},ye=function(e){function t(t){var n,o=e.call(this,t)||this;return o.groupHotspots=function(e,t){var n=G()(e,(function(e){return e.vulnerabilityProbability}));return oe.map((function(e){return{risk:e,categories:se(n[e],t)}})).filter((function(e){return e.categories.length>0}))},o.handleToggleCategory=function(e,t){o.setState((function(n){var o,s=n.expandedCategories;return{expandedCategories:be(be({},s),(o={},o[e]=t,o))}}))},o.state={expandedCategories:(n={},n[t.selectedHotspot.securityCategory]=!0,n),groupedHotspots:o.groupHotspots(t.hotspots,t.securityCategories)},o}return ge(t,e),t.prototype.componentDidUpdate=function(e){if(this.props.selectedHotspot.securityCategory!==e.selectedHotspot.securityCategory&&this.handleToggleCategory(this.props.selectedHotspot.securityCategory,!0),this.props.hotspots!==e.hotspots||this.props.securityCategories!==e.securityCategories){var t=this.groupHotspots(this.props.hotspots,this.props.securityCategories);this.setState({groupedHotspots:t})}},t.prototype.render=function(){var e=this,t=this.props,n=t.hotspots,o=t.hotspotsTotal,s=t.isStaticListOfHotspots,r=t.loadingMore,a=t.selectedHotspot,c=t.statusFilter,l=this.state,p=l.expandedCategories,u=l.groupedHotspots;return i.createElement("div",{className:"huge-spacer-bottom"},i.createElement("h1",{className:"hotspot-list-header bordered-bottom"},i.createElement($.a,{className:"spacer-right"}),Object(C.translateWithParameters)(s?"hotspots.list_title":"hotspots.list_title."+c,n.length)),i.createElement("ul",{className:"big-spacer-bottom"},u.map((function(t){return i.createElement("li",{className:"big-spacer-bottom",key:t.risk},i.createElement("div",{className:"hotspot-risk-header little-spacer-left"},i.createElement("span",null,Object(C.translate)("hotspots.risk_exposure"),":"),i.createElement("div",{className:J("hotspot-risk-badge","spacer-left",t.risk)},Object(C.translate)("risk_exposure",t.risk))),i.createElement("ul",null,t.categories.map((function(t){return i.createElement("li",{className:"spacer-bottom",key:t.key},i.createElement(me,{categoryKey:t.key,expanded:p[t.key],hotspots:t.hotspots,onHotspotClick:e.props.onHotspotClick,onToggleExpand:e.handleToggleCategory,selectedHotspot:a,title:t.title}))}))))}))),i.createElement(Y.a,{count:n.length,loadMore:r?void 0:this.props.onLoadMore,loading:r,total:o}))},t}(i.Component),ve=n(782),Ee=n(659),Oe=n(726),xe=n(853),ke=n.n(xe),Ce=n(669),_e=n(767),Se=n(1212),je=n.n(Se),we=n(889),Ne=n.n(we),Le=n(718),Ae=n.n(Le),Pe=n(1213),Me=n(781),Ie=n(673),Re=n.n(Ie),He=n(704),Te=n.n(He),Ue=n(713),De=n(725);n(1759);function Fe(e){var t=e.highlighted,n=e.loading,o=e.open,s=e.query,r=e.suggestedUsers;return i.createElement(i.Fragment,null,i.createElement("div",{className:"display-flex-center"},i.createElement(Te.a,{autoFocus:!0,onChange:e.onSearch,onKeyDown:e.onKeyDown,placeholder:Object(C.translate)("hotspots.assignee.select_user"),value:s}),n&&i.createElement(k.a,{className:"spacer-left"})),!n&&o&&i.createElement("div",{className:"position-relative"},i.createElement(Ie.DropdownOverlay,{noPadding:!0,placement:Ue.PopupPlacement.BottomLeft},r&&r.length>0?i.createElement("ul",{className:"hotspot-assignee-search-results"},r.map((function(n){return i.createElement("li",{className:J("padded",{active:t&&t.login===n.login}),key:n.login,onClick:function(){return e.onSelect(n)}},i.createElement(De.a,{className:"spacer-right",hash:n.avatar,name:n.name,size:16}),n.name)}))):i.createElement("div",{className:"padded"},Object(C.translate)("no_results")))))}var Be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ve=function(e){function t(t){var n=e.call(this,t)||this;return n.mounted=!1,n.handleSearch=function(e){n.mounted&&(e.length<2?n.handleNoSearch(e):n.handleActualSearch(e))},n.handleNoSearch=function(e){var t=n.props,o=t.allowCurrentUserSelection,s=t.loggedInUser;n.setState({loading:!1,open:o,query:e,suggestedUsers:o?[s]:[]})},n.handleActualSearch=function(e){n.setState({loading:!0,query:e}),Object(Me.f)({q:e}).then((function(t){n.mounted&&n.setState({loading:!1,query:e,open:!0,suggestedUsers:t.users.filter(v.c)})})).catch((function(){n.mounted&&n.setState({loading:!1})}))},n.handleKeyDown=function(e){switch(e.keyCode){case Pe.KeyCodes.Enter:e.preventDefault(),n.selectHighlighted();break;case Pe.KeyCodes.UpArrow:e.preventDefault(),n.highlightPrevious();break;case Pe.KeyCodes.DownArrow:e.preventDefault(),n.highlightNext()}},n.getCurrentIndex=function(){var e=n.state,t=e.highlighted,o=e.suggestedUsers;return t?o.findIndex((function(e){return e.login===t.login})):-1},n.highlightIndex=function(e){var t=n.state.suggestedUsers;t.length>0&&(e<0?e=t.length-1:e>=t.length&&(e=0),n.setState({highlighted:t[e]}))},n.highlightPrevious=function(){n.highlightIndex(n.getCurrentIndex()-1)},n.highlightNext=function(){n.highlightIndex(n.getCurrentIndex()+1)},n.selectHighlighted=function(){var e=n.state.highlighted;void 0!==e&&n.props.onSelect(e)},n.state={loading:!1,open:t.allowCurrentUserSelection,suggestedUsers:t.allowCurrentUserSelection?[t.loggedInUser]:[]},n.handleSearch=Ae()(n.handleSearch,250),n}return Be(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.state,t=e.highlighted,n=e.loading,o=e.open,s=e.query,r=e.suggestedUsers;return i.createElement(Fe,{highlighted:t,loading:n,onKeyDown:this.handleKeyDown,onSearch:this.handleSearch,onSelect:this.props.onSelect,open:o,query:s,suggestedUsers:r})},t}(i.PureComponent);function We(e){var t,n,o=e.assignee,s=e.canEdit,r=e.loggedInUser,a=e.editing,c=e.loading;return i.createElement(k.a,{loading:c},!a&&i.createElement("div",{className:"display-flex-center"},i.createElement("strong",{className:"nowrap"},o&&(o.active?null!==(t=o.name)&&void 0!==t?t:o.login:Object(C.translateWithParameters)("user.x_deleted",null!==(n=o.name)&&void 0!==n?n:o.login)),!o&&Object(C.translate)("unassigned")),r&&s&&i.createElement(Ee.EditButton,{className:"spacer-left",onClick:e.onEnterEditionMode})),r&&a&&i.createElement(je.a,{onKeydown:e.onExitEditionMode},i.createElement(Ne.a,{onClickOutside:e.onExitEditionMode},i.createElement(Ve,{allowCurrentUserSelection:r.login!==(null==o?void 0:o.login),loggedInUser:r,onSelect:e.onAssign}))))}var qe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={editing:!1,loading:!1},t.handleEnterEditionMode=function(){t.setState({editing:!0})},t.handleExitEditionMode=function(){t.setState({editing:!1})},t.handleAssign=function(e){e&&e.login&&(t.setState({loading:!0}),m(t.props.hotspot.key,{assignee:e.login}).then((function(){t.mounted&&(t.setState({editing:!1,loading:!1}),t.props.onAssigneeChange())})).then((function(){return Object(_e.a)(Object(C.translateWithParameters)("hotspots.assign.success",e.name))})).catch((function(){return t.setState({loading:!1})})))},t}return qe(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.props,t=e.currentUser,n=e.hotspot,o=n.assigneeUser,s=n.status,r=this.state,a=r.editing,c=r.loading,l=s===E.b.TO_REVIEW;return i.createElement(We,{assignee:o,canEdit:l,editing:a,loading:c,loggedInUser:Object(v.b)(t)?t:void 0,onAssign:this.handleAssign,onEnterEditionMode:this.handleEnterEditionMode,onExitEditionMode:this.handleExitEditionMode})},t}(i.PureComponent),ze=Object(f.a)(Ke),Xe=n(815),Ge=n(1010),Je=n(695),Qe=n.n(Je),Ye=n(698),Ze=n.n(Ye),$e=n(1014);function et(e){var t=i.useState(e.markdownComment),n=t[0],o=t[1];return i.createElement("div",{className:"issue-comment-bubble-popup"},i.createElement("div",{className:"issue-comment-form-text"},i.createElement("textarea",{autoFocus:!0,onChange:function(e){return o(e.target.value)},rows:2,value:n})),i.createElement("div",{className:"spacer-top display-flex-space-between"},i.createElement("div",{className:"issue-comment-form-tips"},i.createElement(Xe.a,null)),i.createElement("div",{className:""},i.createElement(Ee.Button,{className:"little-spacer-right",onClick:function(){return e.onCommentEditSubmit(n)}},Object(C.translate)("save")),i.createElement(Ee.ResetButtonLink,{onClick:function(){o(""),e.onCancelEdit()}},Object(C.translate)("cancel")))))}function tt(e){var t=function(e){var t=[];return e.creationDate&&t.push({type:E.e.Creation,date:e.creationDate,user:ne(ne({},e.authorUser),{name:e.authorUser.name||e.authorUser.login})}),e.changelog&&e.changelog.length>0&&t.push.apply(t,e.changelog.map((function(e){return{type:E.e.Diff,date:e.creationDate,user:{active:e.isUserActive,avatar:e.avatar,name:e.userName||e.user},diffs:e.diffs}}))),e.comment&&e.comment.length>0&&t.push.apply(t,e.comment.map((function(e){return{type:E.e.Comment,date:e.createdAt,updatable:e.updatable,user:ne(ne({},e.user),{name:e.user.name||e.user.login}),html:e.htmlText,key:e.key,markdown:e.markdown}}))),te()(t,(function(e){return e.date}))}(e.hotspot),n=i.useState(""),o=n[0],s=n[1];return i.createElement(i.Fragment,null,t.map((function(t,n){var r=t.user,a=t.type,c=t.diffs,l=t.date,p=t.html,u=t.key,d=t.updatable,h=t.markdown;return i.createElement("div",{className:J("padded",{"bordered-top":n>0}),key:n},i.createElement("div",{className:"display-flex-center"},r.name&&i.createElement(i.Fragment,null,i.createElement(De.a,{className:"little-spacer-right",hash:r.avatar,name:r.name,size:20}),i.createElement("strong",null,r.active?r.name:Object(C.translateWithParameters)("user.x_deleted",r.name)),a===E.e.Creation&&i.createElement("span",{className:"little-spacer-left"},Object(C.translate)("hotspots.review_history.created")),a===E.e.Comment&&i.createElement("span",{className:"little-spacer-left"},Object(C.translate)("hotspots.review_history.comment_added")),i.createElement("span",{className:"little-spacer-left little-spacer-right"},"-")),i.createElement(Ze.a,{date:l})),a===E.e.Diff&&c&&i.createElement("div",{className:"spacer-top"},c.map((function(e,t){return i.createElement($e.a,{diff:e,key:t})}))),a===E.e.Comment&&u&&p&&h&&i.createElement("div",{className:"spacer-top display-flex-space-between"},i.createElement("div",{className:"markdown",dangerouslySetInnerHTML:{__html:Object(Ge.sanitize)(p)}}),d&&i.createElement("div",null,i.createElement("div",{className:"dropdown"},i.createElement(Qe.a,{onRequestClose:function(){s("")},open:u===o,overlay:i.createElement(Ie.DropdownOverlay,{placement:Ue.PopupPlacement.BottomRight},i.createElement(et,{markdownComment:h,onCancelEdit:function(){return s("")},onCommentEditSubmit:function(t){s(""),e.onEditComment(u,t)}}))},i.createElement(Ee.EditButton,{className:"it__hotspots-comment-edit button-small",onClick:function(){return s(u)}}))),i.createElement(Re.a,{onOpen:function(){return s("")},overlay:i.createElement("div",{className:"padded abs-width-150"},i.createElement("p",null,Object(C.translate)("issue.comment.delete_confirm_message")),i.createElement(Ee.Button,{className:"button-red big-spacer-top pull-right",onClick:function(){return e.onDeleteComment(u)}},Object(C.translate)("delete"))),overlayPlacement:Ue.PopupPlacement.BottomRight},i.createElement(Ee.DeleteButton,{className:"it__hotspots-comment-delete button-small"})))))})))}var nt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ot=function(e){function t(t){var n=e.call(this,t)||this;return n.handleCommentChange=function(e){n.setState({comment:e.target.value})},n.handleCloseComment=function(){n.setState({comment:""}),n.props.onCloseComment()},n.handleSubmitComment=function(){return(e=n.props.hotspot.key,t=n.state.comment,Object(p.post)("/api/hotspots/add_comment",{hotspot:e,comment:t}).catch(u.a)).then((function(){n.setState({comment:""}),n.props.onCloseComment(),n.props.onCommentUpdate()}));var e,t},n.handleDeleteComment=function(e){return(t=e,Object(p.post)("/api/hotspots/delete_comment",{comment:t}).catch(u.a)).then((function(){n.props.onCommentUpdate()}));var t},n.handleEditComment=function(e,t){return function(e,t){return Object(p.post)("/api/hotspots/edit_comment",{comment:e,text:t}).catch(u.a)}(e,t).then((function(){n.props.onCommentUpdate()}))},n.state={comment:""},n}return nt(t,e),t.prototype.componentDidUpdate=function(e){e.hotspot!==this.props.hotspot&&this.setState({comment:""})},t.prototype.render=function(){var e=this.props,t=e.currentUser,n=e.hotspot,o=e.commentTextRef,s=e.commentVisible,r=this.state.comment;return i.createElement(i.Fragment,null,i.createElement("h1",null,Object(C.translate)("hotspot.section.activity")),i.createElement("div",{className:"padded"},i.createElement(tt,{hotspot:n,onDeleteComment:this.handleDeleteComment,onEditComment:this.handleEditComment}),Object(v.b)(t)&&i.createElement(i.Fragment,null,i.createElement("hr",null),i.createElement("div",{className:"big-spacer-top"},i.createElement(Ee.Button,{className:J({invisible:s}),id:"hotspot-comment-box-display",onClick:this.props.onOpenComment},Object(C.translate)("hotspots.comment.open")),i.createElement("div",{className:J({invisible:!s})},i.createElement("div",{className:"little-spacer-bottom"},Object(C.translate)("hotspots.comment.field")),i.createElement("textarea",{className:"form-field fixed-width width-100 spacer-bottom",onChange:this.handleCommentChange,ref:o,rows:2,value:r}),i.createElement("div",{className:"display-flex-space-between display-flex-center "},i.createElement(Xe.a,{className:"huge-spacer-bottom"}),i.createElement("div",null,i.createElement(Ee.Button,{className:"huge-spacer-bottom",id:"hotspot-comment-box-submit",onClick:this.handleSubmitComment},Object(C.translate)("hotspots.comment.submit")),i.createElement(Ee.ResetButtonLink,{className:"spacer-left huge-spacer-bottom",id:"hotspot-comment-box-cancel",onClick:this.handleCloseComment},Object(C.translate)("cancel")))))))))},t}(i.PureComponent),st=n(708),rt=n(963),at=n(1016),it=n(1162),ct=n(1228),lt=function(){};function pt(e){var t=e.branchLike,n=e.displayProjectName,o=e.highlightedSymbols,s=e.hotspot,r=e.linePopup,a=e.loading,c=e.locations,l=e.sourceLines,p=e.sourceViewerFile;return i.createElement("div",{className:"bordered big-spacer-bottom"},i.createElement(it.a,{branchLike:t,expandable:!1,displayProjectName:n,linkToProject:!1,loading:a,onExpand:lt,sourceViewerFile:p}),i.createElement(k.a,{loading:a},l.length>0&&i.createElement(at.a.Provider,{value:{branchLike:t,file:p}},i.createElement(ct.a,{branchLike:t,component:p,displaySCM:!1,expandBlock:function(t,n){return e.onExpandBlock(n)},handleCloseIssues:lt,handleLinePopupToggle:e.onLinePopupToggle,handleOpenIssues:lt,handleSymbolClick:e.onSymbolClick,highlightedLocationMessage:void 0,highlightedSymbols:o,index:0,issue:s,issuesByLine:{},lastSnippetOfLastGroup:!1,linePopup:r,loadDuplications:lt,locations:[],locationsByLine:c,onIssueChange:lt,onIssuePopupToggle:lt,onLocationSelect:lt,openIssuesByLine:{},renderDuplicationPopup:lt,snippet:l}))))}var ut,dt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ht=function(){return(ht=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={highlightedSymbols:[],loading:!0,sourceLines:[]},t.handleExpansion=function(e){var n=t.props,o=n.branchLike,s=n.hotspot,r=t.state.sourceLines,a="up"===e?{from:Math.max(1,r[0].line-50),to:r[0].line-1}:{from:r[r.length-1].line+1,to:r[r.length-1].line+50+1};return Object(st.u)(ht(ht({key:s.component.key},a),Object(b.d)(o))).then((function(n){var o,s="down"===e?t.checkLastLine(n,a.to):void 0;o="up"===e?n.concat(r):r.concat(s?n:n.slice(0,-1)),t.setState({lastLine:s,sourceLines:o})}))},t.handleLinePopupToggle=function(e){var n=e.component,o=e.index,s=e.line,r=e.name,a=e.open;t.setState((function(t){var i=void 0!==t.linePopup&&t.linePopup.line===s&&t.linePopup.name===r&&t.linePopup.component===n&&t.linePopup.index===o;return!1===a||i?!0!==a&&i?{linePopup:void 0}:null:{linePopup:e}}))},t.handleSymbolClick=function(e){t.setState({highlightedSymbols:e})},t}return dt(t,e),t.prototype.componentWillMount=function(){this.mounted=!0,this.fetchSources()},t.prototype.componentDidUpdate=function(e){e.hotspot.key!==this.props.hotspot.key&&this.fetchSources()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.checkLastLine=function(e,t){if(!(e.length<1)){var n=e[e.length-1].line;return n<t?n:void 0}},t.prototype.fetchSources=function(){var e=this,t=this.props,n=t.branchLike,o=t.hotspot,s=o.component,r=o.textRange,a=Math.max(1,r.startLine-5),i=r.endLine+5+1;return this.setState({loading:!0}),Object(st.u)(ht({key:s.key,from:a,to:i},Object(b.d)(n))).then((function(t){if(e.mounted){var n=e.checkLastLine(t,i);t=n?t:t.slice(0,-1),e.setState({lastLine:n,loading:!1,sourceLines:t})}})).catch((function(){return e.mounted&&e.setState({loading:!1})}))},t.prototype.render=function(){var e=this.props,t=e.branchLike,n=e.component,o=e.hotspot,s=this.state,r=s.highlightedSymbols,a=s.lastLine,c=s.linePopup,l=s.loading,p=s.sourceLines,u=Object(rt.d)([o]),d=function(e,t){var n=e.component,o=e.project;return{key:n.key,measures:{lines:t?t.toString():void 0},path:n.path||"",project:o.key,projectName:o.name,q:n.qualifier,uuid:""}}(o,a);return i.createElement(pt,{branchLike:t,displayProjectName:n.qualifier===F.a.Application,highlightedSymbols:r,hotspot:o,lastLine:a,linePopup:c,loading:l,locations:u,onExpandBlock:this.handleExpansion,onLinePopupToggle:this.handleLinePopupToggle,onSymbolClick:this.handleSymbolClick,sourceLines:p,sourceViewerFile:d})},t}(i.Component),ft=(n(1761),n(964)),gt=n.n(ft),bt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(e){e.RiskDescription="risk",e.VulnerabilityDescription="vulnerability",e.FixRecommendation="fix"}(ut||(ut={}));var yt=function(e){function t(t){var n=e.call(this,t)||this;n.handleSelectTabs=function(e){var t=n.state.tabs.find((function(t){return t.key===e}));n.setState({currentTab:t})};var o=n.computeTabs();return n.state={currentTab:o[0],tabs:o},n}return bt(t,e),t.prototype.componentDidUpdate=function(e){if(this.props.hotspot.key!==e.hotspot.key){var t=this.computeTabs();this.setState({currentTab:t[0],tabs:t})}},t.prototype.computeTabs=function(){var e=this.props.hotspot;return[{key:ut.RiskDescription,label:Object(C.translate)("hotspots.tabs.risk_description"),content:e.rule.riskDescription||""},{key:ut.VulnerabilityDescription,label:Object(C.translate)("hotspots.tabs.vulnerability_description"),content:e.rule.vulnerabilityDescription||""},{key:ut.FixRecommendation,label:Object(C.translate)("hotspots.tabs.fix_recommendations"),content:e.rule.fixRecommendations||""}].filter((function(e){return Boolean(e.content)}))},t.prototype.render=function(){var e=this.state,t=e.tabs,n=e.currentTab;return 0===t.length?null:i.createElement(i.Fragment,null,i.createElement(gt.a,{onSelect:this.handleSelectTabs,selected:n.key,tabs:t}),i.createElement("div",{className:"bordered huge-spacer-bottom"},i.createElement("div",{className:"markdown big-padded",dangerouslySetInnerHTML:{__html:Object(Ge.sanitize)(n.content)}})))},t}(i.PureComponent),vt=n(664),Et=n.n(vt);n(1763);function Ot(e){var t=e.statusOption,n=e.showTitle;return i.createElement("div",null,i.createElement("h3",null,n&&Object(C.translate)("status")+": ",Object(C.translate)("hotspots.status_option",t)),i.createElement("span",null,Object(C.translate)("hotspots.status_option",t,"description")))}var xt=n(785),kt=n.n(xt);function Ct(e){var t=e.comment,n=e.loading,o=e.selectedStatus,s=e.submitDisabled,r=function(t){return i.createElement(kt.a,{checked:o===t,className:"big-spacer-bottom",onCheck:e.onStatusChange,value:t},i.createElement(Ot,{statusOption:t}))};return i.createElement(i.Fragment,null,i.createElement("div",{className:"big-padded"},r(E.d.TO_REVIEW),r(E.d.FIXED),r(E.d.SAFE)),i.createElement("hr",null),i.createElement("div",{className:"big-padded display-flex-column"},i.createElement("label",{className:"text-bold",htmlFor:"comment-textarea"},Object(C.translate)("hotspots.status.add_comment")),i.createElement("textarea",{className:"spacer-top form-field fixed-width spacer-bottom",id:"comment-textarea",onChange:function(t){return e.onCommentChange(t.currentTarget.value)},rows:4,value:t}),i.createElement(Xe.a,null),i.createElement("div",{className:"big-spacer-top display-flex-justify-end display-flex-center"},i.createElement(Ee.SubmitButton,{disabled:s||n,onClick:e.onSubmit},Object(C.translate)("hotspots.status.change_status")),n&&i.createElement("i",{className:"spacer-left spinner"}))))}var _t=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),St=function(){return(St=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},jt=function(e){function t(t){var n=e.call(this,t)||this;n.mounted=!1,n.handleStatusChange=function(e){n.setState({selectedStatus:e})},n.handleCommentChange=function(e){n.setState({comment:e})},n.handleSubmit=function(){var e,t,o,s=n.props.hotspot,r=n.state,a=r.comment,i=r.initialStatus,c=r.selectedStatus;c&&c!==i&&(n.setState({loading:!0}),(e=s.key,t=St(St({},(o=c,ce[o])),{comment:a||void 0}),Object(p.post)("/api/hotspots/change_status",d({hotspot:e},t)).catch(u.a)).then((function(){n.setState({loading:!1}),n.props.onStatusOptionChange(c)})).then((function(){return Object(_e.a)(Object(C.translateWithParameters)("hotspots.update.success",Object(C.translate)("hotspots.status_option",c)))})).catch((function(){return n.setState({loading:!1})})))};var o=ie(t.hotspot.status,t.hotspot.resolution);return n.state={loading:!1,initialStatus:o,selectedStatus:o},n}return _t(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.state,t=e.comment,n=e.initialStatus,o=e.loading,s=e.selectedStatus,r=s===n;return i.createElement(Ct,{comment:t,loading:o,onCommentChange:this.handleCommentChange,onStatusChange:this.handleStatusChange,onSubmit:this.handleSubmit,selectedStatus:s,submitDisabled:r})},t}(i.PureComponent);var wt=Object(f.a)((function(e){var t=e.currentUser,n=e.hotspot,o=i.useState(!1),s=o[0],r=o[1],a=ie(n.status,n.resolution),c=!n.canChangeStatus||!Object(v.b)(t),l=i.createElement("div",{"aria-expanded":s,"aria-haspopup":!0,className:J("padded bordered display-flex-column display-flex-justify-center",{readonly:c}),id:"status-trigger",onClick:function(){return!c&&r(!0)},role:"button",tabIndex:0},i.createElement("div",{className:"display-flex-center display-flex-space-between"},s?i.createElement("span",{className:"h3"},Object(C.translate)("hotspots.status.select_status")):i.createElement(Ot,{showTitle:!0,statusOption:a}),!c&&i.createElement(pe.a,{className:"big-spacer-left"}))),p=i.createElement(Qe.a,{closeOnClickOutside:!0,closeOnEscape:!0,onRequestClose:function(){return r(!1)},open:s,overlay:i.createElement(Ie.DropdownOverlay,{noPadding:!0,placement:Ue.PopupPlacement.Bottom},i.createElement(jt,{hotspot:n,onStatusOptionChange:function(){r(!1),e.onStatusChange()}}))},l);return i.createElement("div",{className:"dropdown"},c?i.createElement(Et.a,{overlay:Object(C.translate)("hotspots.status.cannot_change_status"),placement:"bottom"},l):p)})),Nt=function(){return(Nt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};var Lt=Object(f.a)((function(e){var t=e.branchLike,n=e.component,o=e.currentUser,s=e.hotspot,r=e.loading,a=e.securityCategories,c=e.commentTextRef,l=e.commentVisible,p=e.parentScrollRef,u=Object(N.getPathUrlAsString)(Object(Ce.j)(n.key,Nt(Nt({},Object(b.d)(t)),{hotspots:null==s?void 0:s.key})),!1);return i.createElement(k.a,{loading:r},s&&i.createElement("div",{className:"big-padded hotspot-content",ref:p},i.createElement("div",{className:"huge-spacer-bottom display-flex-space-between"},i.createElement("strong",{className:"big big-spacer-right"},s.message),i.createElement("div",{className:"display-flex-row flex-0"},Object(v.b)(o)&&i.createElement("div",{className:"dropdown spacer-right flex-1-0-auto"},i.createElement(Ee.Button,{onClick:e.onOpenComment},Object(C.translate)("hotspots.comment.open"))),i.createElement(Oe.ClipboardButton,{className:"flex-1-0-auto",copyValue:u},i.createElement(ke.a,{className:"spacer-right"}),i.createElement("span",null,Object(C.translate)("hotspots.get_permalink"))))),i.createElement("div",{className:"huge-spacer-bottom display-flex-row"},i.createElement("div",{className:"hotspot-information display-flex-column display-flex-space-between"},i.createElement("div",{className:"display-flex-center"},i.createElement("span",{className:"big-spacer-right"},Object(C.translate)("category")),i.createElement("strong",{className:"nowrap"},a[s.rule.securityCategory].title)),i.createElement("div",{className:"display-flex-center"},i.createElement("span",{className:"big-spacer-right"},Object(C.translate)("hotspots.risk_exposure")),i.createElement("div",{className:J("hotspot-risk-badge",s.rule.vulnerabilityProbability)},Object(C.translate)("risk_exposure",s.rule.vulnerabilityProbability))),i.createElement("div",{className:"display-flex-center"},i.createElement("span",{className:"big-spacer-right"},Object(C.translate)("assignee")),i.createElement("div",null,i.createElement(ze,{hotspot:s,onAssigneeChange:e.onUpdateHotspot})))),i.createElement("div",{className:"huge-spacer-left"},i.createElement(wt,{hotspot:s,onStatusChange:e.onUpdateHotspot}))),i.createElement(mt,{branchLike:t,component:n,hotspot:s}),i.createElement(yt,{hotspot:s}),i.createElement(ot,{commentTextRef:c,commentVisible:l,currentUser:o,hotspot:s,onCloseComment:e.onCloseComment,onCommentUpdate:e.onUpdateHotspot,onOpenComment:e.onOpenComment})))})),At=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pt=function(e){function t(t){var n=e.call(this,t)||this;return n.mounted=!1,n.fetchHotspot=function(){return n.setState({loading:!0}),(e=n.props.hotspotKey,Object(p.getJSON)("/api/hotspots/show",{hotspot:e}).then((function(e){var t=e.users,n=h(e,["users"]);return t&&(n.assignee&&(n.assigneeUser=t.find((function(e){return e.login===n.assignee}))||{active:!0,login:n.assignee}),n.authorUser=t.find((function(e){return e.login===n.author}))||{active:!0,login:n.author},n.comment.forEach((function(e){e.user=t.find((function(t){return t.login===e.login}))||{active:!0,login:e.login}}))),n})).catch(u.a)).then((function(e){return n.mounted&&n.setState({hotspot:e,loading:!1}),e})).catch((function(){return n.mounted&&n.setState({loading:!1})}));var e},n.handleHotspotUpdate=function(){return n.fetchHotspot().then((function(e){if(e)return n.props.onUpdateHotspot(e.key)}))},n.handleOpenComment=function(){n.setState({commentVisible:!0}),n.commentTextRef.current&&n.commentTextRef.current.focus({preventScroll:!0}),n.commentTextRef.current&&n.parentScrollRef.current&&Object(ve.scrollToElement)(n.commentTextRef.current,{parent:n.parentScrollRef.current,bottomOffset:100})},n.handleCloseComment=function(){n.setState({commentVisible:!1})},n.commentTextRef=i.createRef(),n.parentScrollRef=i.createRef(),n.state={loading:!1,commentVisible:!1},n}return At(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.fetchHotspot()},t.prototype.componentDidUpdate=function(e,t){e.hotspotKey!==this.props.hotspotKey&&this.fetchHotspot(),this.commentTextRef.current&&!t.commentVisible&&this.state.commentVisible&&this.commentTextRef.current.focus({preventScroll:!0})},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.props,t=e.branchLike,n=e.component,o=e.securityCategories,s=this.state,r=s.hotspot,a=s.loading,c=s.commentVisible;return i.createElement(Lt,{branchLike:t,component:n,commentTextRef:this.commentTextRef,commentVisible:c,hotspot:r,loading:a,onCloseComment:this.handleCloseComment,onOpenComment:this.handleOpenComment,onUpdateHotspot:this.handleHotspotUpdate,parentScrollRef:this.parentScrollRef,securityCategories:o})},t}(i.PureComponent);n(1511);function Mt(e){var t=e.branchLike,n=e.component,o=e.hotspots,s=e.hotspotsReviewedMeasure,r=e.hotspotsTotal,a=e.isStaticListOfHotspots,c=e.loading,l=e.loadingMeasure,p=e.loadingMore,u=e.securityCategories,d=e.selectedHotspot,h=e.filters;return i.createElement("div",{id:"security_hotspots"},i.createElement(z,{component:n,filters:h,hotspotsReviewedMeasure:s,isStaticListOfHotspots:a,loadingMeasure:l,onBranch:Object(b.f)(t),onChangeFilters:e.onChangeFilters,onShowAllHotspots:e.onShowAllHotspots}),i.createElement(j.a,null,(function(s){var l=s.top;return i.createElement("div",{className:"wrapper",style:{top:l}},i.createElement(S.a,{suggestions:"security_hotspots"}),i.createElement(O.a,{title:Object(C.translate)("hotspots.page")}),i.createElement(_.a,{anchor:"security_hotspots_main"}),c?i.createElement(k.a,{className:"huge-spacer-left big-spacer-top"}):i.createElement(i.Fragment,null,0!==o.length&&d?i.createElement("div",{className:"layout-page"},i.createElement("div",{className:"sidebar"},i.createElement(ye,{hotspots:o,hotspotsTotal:r,isStaticListOfHotspots:a,loadingMore:p,onHotspotClick:e.onHotspotClick,onLoadMore:e.onLoadMore,securityCategories:u,selectedHotspot:d,statusFilter:h.status})),i.createElement("div",{className:"main"},i.createElement(Pt,{branchLike:t,component:n,hotspotKey:d.key,onUpdateHotspot:e.onUpdateHotspot,securityCategories:u}))):i.createElement(L,{filtered:h.assignedToMe||Object(b.f)(t)&&h.sinceLeakPeriod||h.status!==E.c.TO_REVIEW,isStaticListOfHotspots:a})))})))}var It=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Rt=function(){return(Rt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},Ht=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),s=0;for(t=0;t<n;t++)for(var r=arguments[t],a=0,i=r.length;a<i;a++,s++)o[s]=r[a];return o},Tt=function(e){function t(t){var n=e.call(this,t)||this;return n.mounted=!1,n.handleCallFailure=function(){n.mounted&&n.setState({loading:!1,loadingMore:!1})},n.fetchSecurityHotspotsReviewed=function(){var e=n.props,t=e.branchLike,o=e.component,s=n.state.filters,r=s.sinceLeakPeriod?"new_security_hotspots_reviewed":"security_hotspots_reviewed";return n.setState({loadingMeasure:!0}),Object(l.d)(Rt({component:o.key,metricKeys:r},Object(b.d)(t))).then((function(e){if(n.mounted){var t=e&&e.length>0?e[0]:void 0,o=s.sinceLeakPeriod?Object(g.b)(t):null==t?void 0:t.value;n.setState({hotspotsReviewedMeasure:o,loadingMeasure:!1})}})).catch((function(){n.mounted&&n.setState({loadingMeasure:!1})}))},n.reloadSecurityHotspotList=function(){return n.setState({loading:!0}),n.fetchSecurityHotspots().then((function(e){var t=e.hotspots,o=e.paging;n.mounted&&n.setState({hotspots:t,hotspotsPageIndex:1,hotspotsTotal:o.total,loading:!1,selectedHotspot:t.length>0?t[0]:void 0})})).catch(n.handleCallFailure)},n.handleChangeFilters=function(e){n.setState((function(t){var n=t.filters;return{filters:Rt(Rt({},n),e)}}),(function(){n.reloadSecurityHotspotList(),void 0!==e.sinceLeakPeriod&&n.fetchSecurityHotspotsReviewed()}))},n.handleHotspotClick=function(e){return n.setState({selectedHotspot:e})},n.handleHotspotUpdate=function(e){var t=n.state,o=t.hotspots,r=t.hotspotsPageIndex,i=o.findIndex((function(t){return t.key===e}));return Promise.all(s()(r).map((function(e){return n.fetchSecurityHotspots(e+1)}))).then((function(e){var t=a()(e,"hotspots"),o=e[e.length-1].paging,s=t[Math.min(i,t.length-1)];n.setState({hotspots:t,hotspotsPageIndex:o.pageIndex,hotspotsTotal:o.total,selectedHotspot:s})})).then(n.fetchSecurityHotspotsReviewed)},n.handleShowAllHotspots=function(){n.props.router.push(Rt(Rt({},n.props.location),{query:Rt(Rt({},n.props.location.query),{hotspots:void 0})}))},n.handleLoadMore=function(){var e=n.state,t=e.hotspots,o=e.hotspotsPageIndex;return n.setState({loadingMore:!0}),n.fetchSecurityHotspots(o+1).then((function(e){var s=e.hotspots;n.mounted&&n.setState({hotspots:Ht(t,s),hotspotsPageIndex:o+1,loadingMore:!1})})).catch(n.handleCallFailure)},n.state={loading:!0,loadingMeasure:!1,loadingMore:!1,hotspots:[],hotspotsPageIndex:1,securityCategories:{},selectedHotspot:void 0,filters:Rt(Rt({},n.constructFiltersFromProps(t)),{status:E.c.TO_REVIEW})},n}return It(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,Object(c.addNoFooterPageClass)(),this.fetchInitialData()},t.prototype.componentDidUpdate=function(e){var t=this;this.props.component.key===e.component.key&&this.props.location.query.hotspots===e.location.query.hotspots||this.fetchInitialData(),Object(b.i)(this.props.branchLike,e.branchLike)&&Object(v.b)(this.props.currentUser)===Object(v.b)(e.currentUser)&&this.props.location.query.assignedToMe===e.location.query.assignedToMe&&this.props.location.query.sinceLeakPeriod===e.location.query.sinceLeakPeriod||this.setState((function(e){var n=e.filters;return{filters:Rt(Rt({},t.constructFiltersFromProps),n)}}))},t.prototype.componentWillUnmount=function(){Object(c.removeNoFooterPageClass)(),this.mounted=!1},t.prototype.constructFiltersFromProps=function(e){return{assignedToMe:"true"===e.location.query.assignedToMe&&Object(v.b)(e.currentUser),sinceLeakPeriod:Object(b.h)(e.branchLike)||"true"===e.location.query.sinceLeakPeriod}},t.prototype.fetchInitialData=function(){var e=this;return Promise.all([Object(y.a)(),this.fetchSecurityHotspots(),this.fetchSecurityHotspotsReviewed()]).then((function(t){var n=t[0].sonarsourceSecurity,o=t[1],s=o.hotspots,r=o.paging;e.mounted&&e.setState({hotspots:s,hotspotsTotal:r.total,loading:!1,securityCategories:n,selectedHotspot:s.length>0?s[0]:void 0})})).catch(this.handleCallFailure)},t.prototype.fetchSecurityHotspots=function(e){void 0===e&&(e=1);var t=this.props,n=t.branchLike,o=t.component,s=t.location,r=this.state.filters,a=s.query.hotspots?s.query.hotspots.split(","):void 0;if(this.setState({hotspotKeys:a}),a&&a.length>0)return function(e,t){return Object(p.getJSON)("/api/hotspots/search",d(d({},t),{hotspots:e.join()})).catch(u.a)}(a,Rt({projectKey:o.key},Object(b.d)(n)));var i,c=r.status===E.c.TO_REVIEW?E.b.TO_REVIEW:E.b.REVIEWED,l=r.status===E.c.TO_REVIEW?void 0:E.a[r.status];return i=Rt({projectKey:o.key,p:e,ps:500,status:c,resolution:l,onlyMine:r.assignedToMe,sinceLeakPeriod:r.sinceLeakPeriod},Object(b.d)(n)),Object(p.getJSON)("/api/hotspots/search",i).catch(u.a)},t.prototype.render=function(){var e=this.props,t=e.branchLike,n=e.component,o=this.state,s=o.hotspotKeys,r=o.hotspots,a=o.hotspotsReviewedMeasure,c=o.hotspotsTotal,l=o.loading,p=o.loadingMeasure,u=o.loadingMore,d=o.securityCategories,h=o.selectedHotspot,m=o.filters;return i.createElement(Mt,{branchLike:t,component:n,filters:m,hotspots:r,hotspotsReviewedMeasure:a,hotspotsTotal:c,isStaticListOfHotspots:Boolean(s&&s.length>0),loading:l,loadingMeasure:p,loadingMore:u,onChangeFilters:this.handleChangeFilters,onHotspotClick:this.handleHotspotClick,onLoadMore:this.handleLoadMore,onShowAllHotspots:this.handleShowAllHotspots,onUpdateHotspot:this.handleHotspotUpdate,securityCategories:d,selectedHotspot:h})},t}(i.PureComponent);t.default=Object(f.a)(Tt)},680:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o,s=n(13),r=n(705),a=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function i(e){var t=e.suggestions;return s.createElement(r.a.Consumer,null,(function(e){var n=e.addSuggestions,o=e.removeSuggestions;return s.createElement(c,{addSuggestions:n,removeSuggestions:o,suggestions:t})}))}var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.componentDidMount=function(){this.props.addSuggestions(this.props.suggestions)},t.prototype.componentDidUpdate=function(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))},t.prototype.componentWillUnmount=function(){this.props.removeSuggestions(this.props.suggestions)},t.prototype.render=function(){return null},t}(s.PureComponent)},699:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o,s=n(13),r=n(37),a=n(749),i=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(){return(c=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function l(e){return s.createElement(a.a.Consumer,null,(function(t){var n=t.addA11ySkipLink,o=t.removeA11ySkipLink;return s.createElement(p,c({addA11ySkipLink:n,removeA11ySkipLink:o},e))}))}var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getLink=function(){var e=t.props,n=e.anchor,o=e.label;return{key:n,label:void 0===o?Object(r.translate)("skip_to_content"):o,weight:e.weight}},t}return i(t,e),t.prototype.componentDidMount=function(){this.props.addA11ySkipLink(this.getLink())},t.prototype.componentWillUnmount=function(){this.props.removeA11ySkipLink(this.getLink())},t.prototype.render=function(){var e=this.props.anchor;return s.createElement("span",{id:"a11y_target__"+e})},t}(s.PureComponent)},767:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(735),s=n(734);function r(e){Object(s.default)().dispatch(o.b(e))}},903:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}));var o=n(51);function s(e){return Object(o.post)("/api/favorites/add",{component:e})}function r(e){return Object(o.post)("/api/favorites/remove",{component:e})}}}]);
//# sourceMappingURL=330.1588858339197.chunk.js.map