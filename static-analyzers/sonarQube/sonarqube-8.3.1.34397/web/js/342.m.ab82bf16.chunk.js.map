{"version":3,"sources":["webpack:///./src/main/js/apps/issues/styles.css?d1f0","webpack:///./src/main/js/apps/issues/styles.css","webpack:///./src/main/js/apps/issues/actions.ts","webpack:///./src/main/js/apps/issues/components/LocationNavigationKeyboardShortcuts.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/ConciseIssueLocationBadge.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/ConciseIssueLocations.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/ConciseIssueLocationsNavigatorLocation.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/CrossFileLocationsNavigator.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/ConciseIssueLocationsNavigator.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/ConciseIssueBox.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/ConciseIssueComponent.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/ConciseIssue.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/ConciseIssuesList.tsx","webpack:///./src/main/js/apps/issues/components/IssuesCounter.tsx","webpack:///./src/main/js/apps/issues/conciseIssuesList/ConciseIssuesListHeader.tsx","webpack:///./src/main/js/apps/issues/sidebar/AssigneeFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/AuthorFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/CreationDateFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/DirectoryFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/FileFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/LanguageFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/ProjectFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/ResolutionFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/RuleFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/SeverityFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/StatusFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/TagFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/TypeFacet.tsx","webpack:///./src/main/js/apps/issues/sidebar/Sidebar.tsx","webpack:///./src/main/js/apps/issues/components/BulkChangeModal.tsx","webpack:///./src/main/js/apps/issues/components/ComponentBreadcrumbs.tsx","webpack:///./src/main/js/apps/issues/components/ListItem.tsx","webpack:///./src/main/js/apps/issues/components/IssuesList.tsx","webpack:///./src/main/js/apps/issues/crossComponentSourceViewer/CrossComponentSourceViewer.tsx","webpack:///./src/main/js/apps/issues/components/IssuesSourceViewer.tsx","webpack:///./src/main/js/apps/issues/components/MyIssuesFilter.tsx","webpack:///./src/main/js/apps/issues/components/NoIssues.tsx","webpack:///./src/main/js/apps/issues/components/NoMyIssues.tsx","webpack:///./src/main/js/apps/issues/components/TotalEffort.tsx","webpack:///./src/main/js/apps/issues/components/PageActions.tsx","webpack:///./src/main/js/apps/issues/components/App.tsx","webpack:///./src/main/js/app/components/embed-docs-modal/Suggestions.tsx","webpack:///./src/main/js/app/components/a11y/A11ySkipTarget.tsx","webpack:///./src/main/js/api/rules.ts","webpack:///./src/main/js/apps/issues/sidebar/StandardFacet.tsx"],"names":["api","content","__esModule","default","module","i","options","exported","locals","exports","___CSS_LOADER_API_IMPORT___","push","enableLocationsNavigator","state","openIssue","selectedLocationIndex","secondaryLocations","length","flows","selectedFlowIndex","undefined","locationsNavigator","disableLocationsNavigator","selectNextLocation","index","lastLocationIdx","selectPreviousLocation","selectNextFlow","selectPreviousFlow","LocationNavigationKeyboardShortcuts","issue","hasSeveralFlows","className","ConciseIssueLocationBadge","props","mouseEnterDelay","overlay","count","LocationIndex","onClick","selected","collapsed","handleExpandClick","this","setState","badges","key","forEach","flow","onFlowSelect","slice","LIMIT","renderExpandButton","handleClick","event","preventDefault","node","scroll","prevProps","message","ref","href","LocationMessage","handleMoreLocationsClick","currentTarget","blur","groupByFile","locations","groups","currentComponent","currentComponentName","currentLocations","currentFirstLocationIndex","location","component","componentName","firstLocationIndex","renderLocation","onLocationSelect","renderGroup","group","groupIndex","onlyFirst","onlyLast","lastLocationIndex","msg","map","nextProps","nextLocations","firstGroup","lastGroup","every","locationComponents","handleScroll","rootElement","messageElement","window","innerHeight","clickAttributesMain","role","tabIndex","clickAttributesTitle","TypeHelper","type","ConciseIssueComponent","path","previousIssue","displayComponent","componentLongName","onSelect","element","bottomOffset","scrollableElement","document","querySelector","topOffset","parent","issues","onIssueSelect","IssuesCounter","PageCounter","current","label","total","ConciseIssuesListHeader","displayBackButton","paging","selectedIndex","disabled","loading","onBackClick","onReload","handleSearch","query","page","organization","handleItemClick","itemValue","multiple","assignees","onChange","assigned","newValue","includes","handleClear","getAssigneeName","assignee","user","referencedUsers","name","login","loadSearchResultCount","getSortedItems","stats","Object","keys","renderFacetItem","userName","Avatar","hash","avatar","size","renderSearchResult","result","displayName","values","ListStyleFacet","facetHeader","fetching","getFacetItemText","getSearchResultKey","getSearchResultText","onClear","onItemClick","onSearch","onToggle","open","property","searchPlaceholder","identity","author","_page","project","qualifier","ps","q","then","authors","maxResults","results","term","hasValue","createdAfter","createdAt","createdBefore","createdInLast","sinceLeakPeriod","handleHeaderClick","resetTo","changes","handleBarClick","handlePeriodChange","from","to","handlePeriodClick","period","handleLeakPeriodClick","formatDate","intl","periods","data","start","startDate","endDate","setDate","getDate","tooltipEndDate","Date","tooltip","x","y","barsWidth","Math","floor","width","maxValue","d","xValues","height","onBarClick","padding","date","DateRangeInput","value","FacetItem","active","renderExactDate","renderBarChart","renderPeriodSelectors","renderPredefinedPeriods","FacetBox","FacetHeader","getValues","renderInner","defaultProps","directory","componentKey","p","components","filter","dir","directories","renderDirectory","minSearchLength","getFilePath","fileUuid","referencedComponents","getReferencedComponent","find","uuid","file","files","renderFile","fileUuids","getLanguageName","language","referencedLanguages","getAllPossibleOptions","toLowerCase","pageIndex","pageSize","Promise","resolve","installedLanguages","languages","qualifiers","refKey","getProjectName","projects","renderProject","Organization","link","organizationKey","RESOLUTIONS","resolutions","resolved","renderItem","resolution","isFacetItemActive","stat","getStat","halfWidth","getFacetItemName","FacetItemsList","MultipleSelectionHint","f","join","s","include_external","response","rules","rule","getRuleName","ruleKey","referencedRules","formatRuleName","langName","SEVERITIES","severities","severity","SeverityHelper","STATUSES","statuses","status","StatusHelper","title","tags","getTagName","tag","renderTag","fill","gray60","types","t","facets","loadingFacets","openFacets","commonProps","onFilterChange","onFacetToggle","referencedComponentsById","hideAuthorFacet","displayProjectsFacet","displayAuthorFacet","StandardFacet","cwe","cweOpen","cweStats","fetchingCwe","fetchingOwaspTop10","owaspTop10","fetchingSansTop25","sansTop25","fetchingSonarSourceSecurity","sonarsourceSecurity","standards","owaspTop10Open","owaspTop10Stats","sansTop25Open","sansTop25Stats","sonarsourceSecurityOpen","sonarsourceSecurityStats","referencedComponentsByKey","renderComponentFacets","myIssues","AssigneeSelect","TagSelect","super","mounted","loadIssues","fetchIssues","additionalFields","getDefaultAssignee","currentUser","handleAssigneeSearch","r","userInfo","handleAssigneeSelect","handleTagsSearch","handleTagsSelect","field","handleFieldCheck","checked","handleRadioTransitionChange","transition","handleCommentChange","comment","handleSelectFieldChange","handleSubmit","add_tags","addTags","assign","do_transition","remove_tags","removeTags","sendNotifications","notifications","set_severity","set_type","issueKeys","submitting","onDone","error","throwGlobalError","renderLoading","onClose","renderAffected","affected","renderField","input","id","htmlFor","renderAssigneeOption","option","renderAssigneeField","hasAction","clearable","defaultOptions","renderOption","resetOnBlur","renderTypeField","optionRenderer","searchable","valueRenderer","renderSeverityField","renderTagOption","renderTagsField","allowCreate","initialTags","canCreate","minimumQueryLength","multi","onMultiSelect","promptTextCreator","promptCreateTag","renderTransitionsField","transitions","getAvailableTransitions","onCheck","renderCommentField","rows","MarkdownTips","renderNotificationsField","right","renderForm","limitReached","onSubmit","Alert","variant","defaultMessage","max","all","contentLabel","onRequestClose","action","actions","ComponentBreadcrumbs","displayOrganization","displayProject","displaySubProject","selectedLocation","projectName","subProject","subProjectName","handleFilter","issuesReset","startsWith","substr","projectKey","subProjectUuid","modules","componentUuid","branchLike","Issue","onFilter","onPopupToggle","openPopup","prerender","setTimeout","selectedIssue","onIssueChange","onIssueCheck","onIssueClick","lazyLoadComponent","scrollToIssue","smooth","offset","handleLoaded","shouldScrollBackToIssue","loc","highlightedLocationMessage","text","onLoaded","aroundLine","textRange","startLine","endLine","allMessagesEmpty","highlightedLocations","SourceViewer","displayAllIssues","displayIssueLocationsCount","displayIssueLocationsLink","displayLocationMarkers","slimHeader","onMyIssuesChange","NoIssues","NoMyIssues","TotalEffort","effort","0","effortTotal","renderShortcuts","canSetHome","HomePageSelect","currentPage","DEFAULT_QUERY","handleKeyDown","keyCode","altKey","handleKeyUp","getOpenIssue","selectNextIssue","getSelectedIndex","selectPreviousIssue","issueKey","pathname","scrollToSelectedIssue","router","replace","closeIssue","openSelectedIssue","additional","requestFacets","requestOrganizations","facet","parameters","componentKeys","sort","asc","Boolean","multiOrganizations","fetchIssuesPage","fetchIssuesUntil","done","recursiveFetch","prevIssues","pageIssues","other","fetchMoreIssues","reject","checkAll","loadingMore","fetchIssuesForComponent","_component","_from","isSameComponent","lastIssue","nextIssues","fetchFacet","users","isFiltered","serialized","getCheckedIssues","getButtonLabel","min","handleFilterChange","handleMyIssuesChange","closeFacet","handleFacetToggle","willOpenProperty","newState","handleReset","handlePopupToggle","popupName","samePopup","handleIssueCheck","handleIssueChange","refreshBranchStatus","candidate","handleOpenBulkChange","bulkChangeModal","handleCloseBulkChange","handleBulkChangeDone","fetchFirstIssues","handleReload","onBranchesChange","handleReloadAndOpenFirst","selectLocation","nextIndex","handleCheckAll","selectFlow","fetchBranchStatus","isLoggedIn","attachShortcuts","prevState","prevQuery","detachShortcuts","addEventListener","removeEventListener","findIndex","openIssueKey","fetchPromise","some","cannotShowOpenIssue","isAllChecked","thirdState","isChecked","userOrganizations","userOrganization","o","FiltersHeader","displayReset","onReset","loadMore","ScreenPositionHelper","top","style","A11ySkipTarget","anchor","weight","renderConciseIssuesList","renderFacets","noIssuesMessage","EmptySearch","renderBulkChange","branch","pullRequest","renderList","Suggestions","suggestions","defer","renderSide","renderHeader","renderPage","Consumer","addSuggestions","removeSuggestions","SuggestionsInner","addA11ySkipLink","removeA11ySkipLink","A11ySkipTargetInner","getLink","getRulesApp","catch","searchRules","takeFacet","getRuleDetails","getRuleTags","createRule","deleteRule","updateRule","loadStandards","item","handleOwaspTop10HeaderClick","handleSansTop25HeaderClick","handleSonarSourceSecurityHeaderClick","prop","items","handleOwaspTop10ItemClick","handleSansTop25ItemClick","handleSonarSourceSecurityItemClick","handleCWESearch","loadCWESearchResultCount","categories","statsProp","valuesProp","renderName","renderFacetItemsList","renderTooltip","category","renderHint","renderSonarSourceSecurityList","renderSonarSourceSecurityHint","renderOwaspTop10List","renderOwaspTop10Hint","renderSansTop25List","renderSansTop25Hint","renderSubFacets"],"mappings":"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","file":"js/342.m.ab82bf16.chunk.js","sourcesContent":["var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".issues-main-header .component-name{line-height:24px}.issues-main-header-spinner{margin-right:2px}.concise-issues-list-header-inner{width:260px;text-align:center}.concise-issues-list-header .spinner{margin-top:4px;margin-left:1px;margin-right:1px}.concise-issues-list-header-button{border:none}.concise-issues-list-header-button path{fill:#777;transition:fill .3s ease}.concise-issues-list-header-button:hover path{fill:#4b9fd5}.concise-issue-component{margin-top:16px;margin-bottom:4px;padding-left:8px;padding-right:8px}.concise-issue-box{position:relative;z-index:1;margin-bottom:4px;padding:7px;border:2px solid #e6e6e6;background-color:#fff;cursor:pointer;transition:background-color .3s ease,border-color .3s ease}.concise-issue-box:hover{border:2px dashed #4b9fd5}.concise-issue-box:focus{outline:none}.concise-issue-box.selected{z-index:2;border:2px solid #4b9fd5;cursor:default}.concise-issue-box-message{overflow:hidden;text-overflow:ellipsis;font-weight:700}.concise-issue-box-message:focus{outline:none}.concise-issue-box.selected .concise-issue-box-message{cursor:pointer}.concise-issue-box-attributes{margin-top:8px;line-height:16px;font-size:12px;display:flex;align-items:flex-start;flex-wrap:wrap;justify-content:flex-start}.concise-issue-box:not(.selected) .location-index{background-color:#ccc}.concise-issue-locations{display:inline-block;margin-bottom:-4px;margin-left:8px}.concise-issue-box-attributes>.location-index{margin-bottom:4px;margin-right:4px}.concise-issue-box-attributes>.concise-issue-expand{background-color:transparent;border:1px solid #d18582;height:16px;color:#d18582;font-weight:700;font-size:16px;line-height:8px;padding-bottom:6px}.concise-issue-box-attributes>.concise-issue-expand:hover{background-color:#d18582;color:#fff}.concise-issue-locations-navigator-location{position:relative;z-index:3;display:inline-flex;align-items:flex-start;max-width:100%;border:none}.concise-issue-locations-navigator-file{position:relative}.concise-issue-locations-navigator-file+.concise-issue-locations-navigator-file{margin-top:12px}.concise-issue-locations-navigator-file:not(:last-child):before{position:absolute;display:block;width:0;top:13px;bottom:-16px;left:4px;border-left:1px dotted #d18582;content:\\\"\\\"}.concise-issue-location-file{height:16px;padding-bottom:4px;font-size:12px;font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.concise-issue-location-file-circle,.concise-issue-location-file-circle-multiple,.concise-issue-location-file-circle-multiple:after,.concise-issue-location-file-circle-multiple:before{position:relative;top:1px;display:inline-block;width:9px;height:9px;border:1px solid #d18582;border-radius:100%;box-sizing:border-box;background-color:#f2dede}.concise-issue-location-file-circle-multiple{top:-2px}.concise-issue-location-file-circle-multiple:before{position:absolute;z-index:7;top:2px;left:-1px;content:\\\"\\\"}.concise-issue-location-file-circle-multiple:after{position:absolute;z-index:8;top:5px;left:-1px;content:\\\"\\\"}.concise-issue-location-file-locations{padding-left:16px}.concise-issue-location-file-more{border-color:rgba(209,133,130,.2);color:#d18582!important;font-style:italic;font-weight:400}.concise-issue-location-file-more:focus,.concise-issue-location-file-more:hover{border-color:rgba(209,133,130,.6)}.component-source-container{border:1px solid #cdcdcd}.component-source-container+.component-source-container{margin-top:8px}.component-source-container-header{background-color:#efefef;padding:8px}.issues-my-issues-filter{margin-bottom:24px;text-align:center}.issues-page-actions{display:inline-block;min-width:80px;text-align:right}.issues .issue-list{min-width:640px;width:800px}.issues .issue{border:2px solid transparent;cursor:pointer}.issues .issue:focus-within,.issues .issue:hover{border:2px dashed #4b9fd5;transition:all .3s ease;outline:0}.issues .issue a:focus,.issues .issue button:focus{box-shadow:none;outline:1px dotted #4b9fd5}@media (max-width:1320px){.issues .issue-list{width:calc(60vw - 40px)}}.issue-location{display:inline-block;vertical-align:top;line-height:18px;height:18px;box-sizing:border-box;background-color:#f2dede;transition:background-color .3s ease}.issues-workspace-list-component{padding:10px 10px 6px}.issues-workspace-list-item+.issues-workspace-list-item{margin-top:5px}.issues-workspace-list-component+.issues-workspace-list-item{margin-top:10px}.issues-workspace-list-item:first-child .issues-workspace-list-component{padding-top:0}.issues-workspace-list-component+.issues-workspace-list-item{margin-top:0}.issues-predefined-periods{display:flex}.issues-predefined-periods .search-navigator-facet{width:auto;margin-right:4px}.bulk-change-radio-button{margin:0 -4px;padding:0 4px}.bulk-change-radio-button:hover{background-color:#f3f3f3}.navigation-keyboard-shortcuts>span{background-color:hsla(0,0%,78.4%,.5);border-radius:16px;display:inline-block;font-size:12px;height:16px;padding:4px 8px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { State } from './components/App';\nimport { allLocationsEmpty } from './utils';\n\nexport function enableLocationsNavigator(state: State) {\n  const { openIssue, selectedLocationIndex } = state;\n  if (openIssue && (openIssue.secondaryLocations.length > 0 || openIssue.flows.length > 0)) {\n    const selectedFlowIndex =\n      state.selectedFlowIndex || (openIssue.flows.length > 0 ? 0 : undefined);\n\n    if (!allLocationsEmpty(openIssue, selectedFlowIndex)) {\n      return {\n        locationsNavigator: true,\n        selectedFlowIndex,\n        // Also reset index = -1 to 0, we don't want to start on the issue when enabling the location navigator\n        selectedLocationIndex:\n          !selectedLocationIndex || selectedLocationIndex < 0 ? 0 : selectedLocationIndex\n      };\n    }\n  }\n  return null;\n}\n\nexport function disableLocationsNavigator() {\n  return { locationsNavigator: false };\n}\n\nexport function selectLocation(nextIndex: number) {\n  return (state: Pick<State, 'selectedLocationIndex' | 'openIssue'>) => {\n    const { selectedLocationIndex: index, openIssue } = state;\n    if (openIssue) {\n      if (index === nextIndex) {\n        // disable locations when selecting (clicking) the same location\n        return {\n          locationsNavigator: false,\n          selectedLocationIndex: undefined\n        };\n      } else {\n        return { locationsNavigator: true, selectedLocationIndex: nextIndex };\n      }\n    }\n    return null;\n  };\n}\n\nexport function selectNextLocation(\n  state: Pick<State, 'selectedFlowIndex' | 'selectedLocationIndex' | 'openIssue'>\n) {\n  const { selectedFlowIndex, selectedLocationIndex: index, openIssue } = state;\n  if (openIssue) {\n    const locations =\n      selectedFlowIndex !== undefined\n        ? openIssue.flows[selectedFlowIndex]\n        : openIssue.secondaryLocations;\n    const lastLocationIdx = locations.length - 1;\n    if (index === lastLocationIdx) {\n      // -1 to jump back to the issue itself\n      return { selectedLocationIndex: -1 };\n    }\n    return {\n      selectedLocationIndex: index !== undefined && index < lastLocationIdx ? index + 1 : index\n    };\n  }\n  return null;\n}\n\nexport function selectPreviousLocation(state: State) {\n  const { selectedFlowIndex, selectedLocationIndex: index, openIssue } = state;\n  if (openIssue) {\n    if (index === -1) {\n      const locations =\n        selectedFlowIndex !== undefined\n          ? openIssue.flows[selectedFlowIndex]\n          : openIssue.secondaryLocations;\n      const lastLocationIdx = locations.length - 1;\n      return { selectedLocationIndex: lastLocationIdx };\n    }\n    return { selectedLocationIndex: index !== undefined && index > 0 ? index - 1 : index };\n  }\n  return null;\n}\n\nexport function selectFlow(nextIndex?: number) {\n  return () => {\n    return { locationsNavigator: true, selectedFlowIndex: nextIndex, selectedLocationIndex: 0 };\n  };\n}\n\nexport function selectNextFlow(state: State) {\n  const { openIssue, selectedFlowIndex } = state;\n  if (\n    openIssue &&\n    selectedFlowIndex !== undefined &&\n    openIssue.flows.length > selectedFlowIndex + 1\n  ) {\n    return { selectedFlowIndex: selectedFlowIndex + 1, selectedLocationIndex: 0 };\n  }\n  return null;\n}\n\nexport function selectPreviousFlow(state: State) {\n  const { openIssue, selectedFlowIndex } = state;\n  if (openIssue && selectedFlowIndex !== undefined && selectedFlowIndex > 0) {\n    return { selectedFlowIndex: selectedFlowIndex - 1, selectedLocationIndex: 0 };\n  }\n  return null;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\nexport interface Props {\n  issue: Pick<T.Issue, 'flows' | 'secondaryLocations'> | undefined;\n}\n\nexport default function LocationNavigationKeyboardShortcuts({ issue }: Props) {\n  if (!issue || (!issue.secondaryLocations.length && !issue.flows.length)) {\n    return null;\n  }\n  const hasSeveralFlows = issue.flows.length > 1;\n  return (\n    <div className=\"navigation-keyboard-shortcuts big-spacer-top text-center\">\n      <span>\n        alt +   {hasSeveralFlows && <></>}\n        {translate('issues.to_navigate_issue_locations')}\n      </span>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\nimport LocationIndex from '../../../components/common/LocationIndex';\n\ninterface Props {\n  count: number;\n  onClick?: () => void;\n  selected: boolean;\n}\n\nexport default function ConciseIssueLocationBadge(props: Props) {\n  return (\n    <Tooltip\n      mouseEnterDelay={0.5}\n      overlay={translateWithParameters(\n        'issue.this_issue_involves_x_code_locations',\n        formatMeasure(props.count, 'INT')\n      )}>\n      <LocationIndex onClick={props.onClick} selected={props.selected}>\n        {'+'}\n        {props.count}\n      </LocationIndex>\n    </Tooltip>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport ConciseIssueLocationBadge from './ConciseIssueLocationBadge';\n\ninterface Props {\n  issue: Pick<T.Issue, 'flows' | 'secondaryLocations'>;\n  onFlowSelect: (index: number) => void;\n  selectedFlowIndex: number | undefined;\n}\n\ninterface State {\n  collapsed: boolean;\n}\n\nconst LIMIT = 8;\n\nexport default class ConciseIssueLocations extends React.PureComponent<Props, State> {\n  state: State = { collapsed: true };\n\n  handleExpandClick = () => {\n    this.setState({ collapsed: false });\n  };\n\n  renderExpandButton() {\n    return (\n      <Button\n        className=\"concise-issue-expand location-index link-no-underline\"\n        onClick={this.handleExpandClick}>\n        ...\n      </Button>\n    );\n  }\n\n  render() {\n    const { secondaryLocations, flows } = this.props.issue;\n\n    const badges: JSX.Element[] = [];\n\n    if (secondaryLocations.length > 0) {\n      badges.push(\n        <ConciseIssueLocationBadge\n          count={secondaryLocations.length}\n          key=\"-1\"\n          selected={!this.props.selectedFlowIndex}\n        />\n      );\n    }\n\n    flows.forEach((flow, index) => {\n      badges.push(\n        <ConciseIssueLocationBadge\n          count={flow.length}\n          key={index}\n          onClick={() => this.props.onFlowSelect(index)}\n          selected={index === this.props.selectedFlowIndex}\n        />\n      );\n    });\n\n    if (!this.state.collapsed || badges.length <= LIMIT) {\n      return badges;\n    }\n\n    return (\n      <>\n        {badges.slice(0, LIMIT - 1)}\n        {this.renderExpandButton()}\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport LocationIndex from '../../../components/common/LocationIndex';\nimport LocationMessage from '../../../components/common/LocationMessage';\n\ninterface Props {\n  index: number;\n  message: string | undefined;\n  onClick: (index: number) => void;\n  scroll: (element: Element) => void;\n  selected: boolean;\n}\n\nexport default class ConciseIssueLocationsNavigatorLocation extends React.PureComponent<Props> {\n  node?: HTMLElement | null;\n\n  componentDidMount() {\n    if (this.props.selected && this.node) {\n      this.props.scroll(this.node);\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.selected && prevProps.selected !== this.props.selected && this.node) {\n      this.props.scroll(this.node);\n    }\n  }\n\n  handleClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    this.props.onClick(this.props.index);\n  };\n\n  render() {\n    const { index, message, selected } = this.props;\n\n    return (\n      <div className=\"little-spacer-top\" ref={node => (this.node = node)}>\n        <a\n          className=\"concise-issue-locations-navigator-location\"\n          href=\"#\"\n          onClick={this.handleClick}>\n          <LocationIndex selected={selected}>{index + 1}</LocationIndex>\n          <LocationMessage selected={selected}>{message}</LocationMessage>\n        </a>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { collapsePath } from 'sonar-ui-common/helpers/path';\nimport ConciseIssueLocationsNavigatorLocation from './ConciseIssueLocationsNavigatorLocation';\n\ninterface Props {\n  issue: Pick<T.Issue, 'key' | 'type'>;\n  locations: T.FlowLocation[];\n  onLocationSelect: (index: number) => void;\n  scroll: (element: Element) => void;\n  selectedLocationIndex: number | undefined;\n}\n\ninterface State {\n  collapsed: boolean;\n}\n\ninterface LocationGroup {\n  component: string | undefined;\n  componentName: string | undefined;\n  firstLocationIndex: number;\n  locations: T.FlowLocation[];\n}\n\nconst MAX_PATH_LENGTH = 15;\n\nexport default class CrossFileLocationsNavigator extends React.PureComponent<Props, State> {\n  state: State = { collapsed: true };\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (nextProps.issue.key !== this.props.issue.key) {\n      this.setState({ collapsed: true });\n    }\n\n    // expand locations list as soon as a location in the middle of the list is selected\n    const { locations: nextLocations } = nextProps;\n    if (\n      nextProps.selectedLocationIndex &&\n      nextProps.selectedLocationIndex > 0 &&\n      nextLocations !== undefined &&\n      nextProps.selectedLocationIndex < nextLocations.length - 1\n    ) {\n      this.setState({ collapsed: false });\n    }\n  }\n\n  handleMoreLocationsClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.setState({ collapsed: false });\n  };\n\n  groupByFile = (locations: T.FlowLocation[]) => {\n    const groups: LocationGroup[] = [];\n\n    let currentLocations: T.FlowLocation[] = [];\n    let currentComponent: string | undefined;\n    let currentComponentName: string | undefined;\n    let currentFirstLocationIndex = 0;\n\n    for (let index = 0; index < locations.length; index++) {\n      const location = locations[index];\n      if (location.component === currentComponent) {\n        currentLocations.push(location);\n      } else {\n        if (currentLocations.length > 0) {\n          groups.push({\n            component: currentComponent,\n            componentName: currentComponentName,\n            firstLocationIndex: currentFirstLocationIndex,\n            locations: currentLocations\n          });\n        }\n        currentLocations = [location];\n        currentComponent = location.component;\n        currentComponentName = location.componentName;\n        currentFirstLocationIndex = index;\n      }\n    }\n\n    if (currentLocations.length > 0) {\n      groups.push({\n        component: currentComponent,\n        componentName: currentComponentName,\n        firstLocationIndex: currentFirstLocationIndex,\n        locations: currentLocations\n      });\n    }\n\n    return groups;\n  };\n\n  renderLocation = (index: number, message: string | undefined) => {\n    return (\n      <ConciseIssueLocationsNavigatorLocation\n        index={index}\n        key={index}\n        message={message}\n        onClick={this.props.onLocationSelect}\n        scroll={this.props.scroll}\n        selected={index === this.props.selectedLocationIndex}\n      />\n    );\n  };\n\n  renderGroup = (\n    group: LocationGroup,\n    groupIndex: number,\n    { onlyFirst = false, onlyLast = false } = {}\n  ) => {\n    const { firstLocationIndex } = group;\n    const lastLocationIndex = group.locations.length - 1;\n    return (\n      <div className=\"concise-issue-locations-navigator-file\" key={groupIndex}>\n        <div className=\"concise-issue-location-file\">\n          <i className=\"concise-issue-location-file-circle little-spacer-right\" />\n          {collapsePath(group.componentName || '', MAX_PATH_LENGTH)}\n        </div>\n        {group.locations.length > 0 && (\n          <div className=\"concise-issue-location-file-locations\">\n            {onlyFirst && this.renderLocation(firstLocationIndex, group.locations[0].msg)}\n\n            {onlyLast &&\n              this.renderLocation(\n                firstLocationIndex + lastLocationIndex,\n                group.locations[lastLocationIndex].msg\n              )}\n\n            {!onlyFirst &&\n              !onlyLast &&\n              group.locations.map((location, index) =>\n                this.renderLocation(firstLocationIndex + index, location.msg)\n              )}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  render() {\n    const { locations } = this.props;\n    const groups = this.groupByFile(locations);\n\n    if (locations.length > 2 && groups.length > 1 && this.state.collapsed) {\n      const firstGroup = groups[0];\n      const lastGroup = groups[groups.length - 1];\n      return (\n        <div className=\"concise-issue-locations-navigator spacer-top\">\n          {this.renderGroup(firstGroup, 0, { onlyFirst: true })}\n          <div className=\"concise-issue-locations-navigator-file\">\n            <div className=\"concise-issue-location-file\">\n              <i className=\"concise-issue-location-file-circle-multiple little-spacer-right\" />\n              <a\n                className=\"concise-issue-location-file-more\"\n                href=\"#\"\n                onClick={this.handleMoreLocationsClick}>\n                {translateWithParameters('issues.x_more_locations', locations.length - 2)}\n              </a>\n            </div>\n          </div>\n          {this.renderGroup(lastGroup, groups.length - 1, { onlyLast: true })}\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"concise-issue-locations-navigator spacer-top\">\n          {groups.map((group, groupIndex) => this.renderGroup(group, groupIndex))}\n        </div>\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { uniq } from 'lodash';\nimport * as React from 'react';\nimport { getLocations } from '../utils';\nimport ConciseIssueLocationsNavigatorLocation from './ConciseIssueLocationsNavigatorLocation';\nimport CrossFileLocationsNavigator from './CrossFileLocationsNavigator';\n\ninterface Props {\n  issue: Pick<T.Issue, 'component' | 'key' | 'flows' | 'secondaryLocations' | 'type'>;\n  onLocationSelect: (index: number) => void;\n  scroll: (element: Element) => void;\n  selectedFlowIndex: number | undefined;\n  selectedLocationIndex: number | undefined;\n}\n\nexport default class ConciseIssueLocationsNavigator extends React.PureComponent<Props> {\n  render() {\n    const locations = getLocations(this.props.issue, this.props.selectedFlowIndex);\n\n    if (!locations || locations.length === 0 || locations.every(location => !location.msg)) {\n      return null;\n    }\n\n    const locationComponents = [\n      this.props.issue.component,\n      ...locations.map(location => location.component)\n    ];\n    const isCrossFile = uniq(locationComponents).length > 1;\n\n    if (isCrossFile) {\n      return (\n        <CrossFileLocationsNavigator\n          issue={this.props.issue}\n          locations={locations}\n          onLocationSelect={this.props.onLocationSelect}\n          scroll={this.props.scroll}\n          selectedLocationIndex={this.props.selectedLocationIndex}\n        />\n      );\n    } else {\n      return (\n        <div className=\"concise-issue-locations-navigator spacer-top\">\n          {locations.map((location, index) => (\n            <ConciseIssueLocationsNavigatorLocation\n              index={index}\n              key={index}\n              message={location.msg}\n              onClick={this.props.onLocationSelect}\n              scroll={this.props.scroll}\n              selected={index === this.props.selectedLocationIndex}\n            />\n          ))}\n        </div>\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport TypeHelper from '../../../components/shared/TypeHelper';\nimport LocationNavigationKeyboardShortcuts from '../components/LocationNavigationKeyboardShortcuts';\nimport ConciseIssueLocations from './ConciseIssueLocations';\nimport ConciseIssueLocationsNavigator from './ConciseIssueLocationsNavigator';\n\ninterface Props {\n  issue: T.Issue;\n  onClick: (issueKey: string) => void;\n  onFlowSelect: (index: number) => void;\n  onLocationSelect: (index: number) => void;\n  scroll: (element: Element, bottomOffset?: number) => void;\n  selected: boolean;\n  selectedFlowIndex: number | undefined;\n  selectedLocationIndex: number | undefined;\n}\n\nexport default class ConciseIssueBox extends React.PureComponent<Props> {\n  messageElement?: HTMLElement | null;\n  rootElement?: HTMLElement | null;\n\n  componentDidMount() {\n    if (this.props.selected) {\n      this.handleScroll();\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.selected && prevProps.selected !== this.props.selected) {\n      this.handleScroll();\n    }\n  }\n\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    this.props.onClick(this.props.issue.key);\n  };\n\n  handleScroll = () => {\n    const { selectedFlowIndex } = this.props;\n    const { flows, secondaryLocations } = this.props.issue;\n\n    const locations = flows.length > 0 ? flows[selectedFlowIndex || 0] : secondaryLocations;\n\n    if (!locations || locations.length < 15) {\n      // if there are no locations, or there are just few\n      // then ensuse that the whole box is visible\n      if (this.rootElement) {\n        this.props.scroll(this.rootElement);\n      }\n    } else if (this.messageElement) {\n      // otherwise scroll until the the message element is located on top\n      this.props.scroll(this.messageElement, window.innerHeight - 250);\n    }\n  };\n\n  render() {\n    const { issue, selected } = this.props;\n\n    const clickAttributesMain = selected\n      ? {}\n      : { onClick: this.handleClick, role: 'listitem', tabIndex: 0 };\n\n    const clickAttributesTitle = selected\n      ? { onClick: this.handleClick, role: 'listitem', tabIndex: 0 }\n      : {};\n\n    return (\n      <div\n        className={classNames('concise-issue-box', 'clearfix', { selected })}\n        ref={node => (this.rootElement = node)}\n        {...clickAttributesMain}>\n        <div\n          className=\"concise-issue-box-message\"\n          {...clickAttributesTitle}\n          ref={node => (this.messageElement = node)}>\n          {issue.message}\n        </div>\n        <div className=\"concise-issue-box-attributes\">\n          <TypeHelper className=\"display-block little-spacer-right\" type={issue.type} />\n          <ConciseIssueLocations\n            issue={issue}\n            onFlowSelect={this.props.onFlowSelect}\n            selectedFlowIndex={this.props.selectedFlowIndex}\n          />\n        </div>\n        {selected && (\n          <>\n            <ConciseIssueLocationsNavigator\n              issue={issue}\n              onLocationSelect={this.props.onLocationSelect}\n              scroll={this.props.scroll}\n              selectedFlowIndex={this.props.selectedFlowIndex}\n              selectedLocationIndex={this.props.selectedLocationIndex}\n            />\n            <LocationNavigationKeyboardShortcuts issue={issue} />\n          </>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { collapsePath } from 'sonar-ui-common/helpers/path';\n\ninterface Props {\n  path: string;\n}\n\nexport default function ConciseIssueComponent(props: Props) {\n  return (\n    <div className=\"concise-issue-component note text-ellipsis\">{collapsePath(props.path, 20)}</div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ConciseIssueBox from './ConciseIssueBox';\nimport ConciseIssueComponent from './ConciseIssueComponent';\n\ninterface Props {\n  issue: T.Issue;\n  onFlowSelect: (index: number) => void;\n  onLocationSelect: (index: number) => void;\n  onSelect: (issueKey: string) => void;\n  previousIssue: T.Issue | undefined;\n  scroll: (element: Element) => void;\n  selected: boolean;\n  selectedFlowIndex: number | undefined;\n  selectedLocationIndex: number | undefined;\n}\n\nexport default class ConciseIssue extends React.PureComponent<Props> {\n  render() {\n    const { issue, previousIssue, selected } = this.props;\n\n    const displayComponent = !previousIssue || previousIssue.component !== issue.component;\n\n    return (\n      <div>\n        {displayComponent && <ConciseIssueComponent path={issue.componentLongName} />}\n        <ConciseIssueBox\n          issue={issue}\n          onClick={this.props.onSelect}\n          onFlowSelect={this.props.onFlowSelect}\n          onLocationSelect={this.props.onLocationSelect}\n          scroll={this.props.scroll}\n          selected={selected}\n          selectedFlowIndex={selected ? this.props.selectedFlowIndex : undefined}\n          selectedLocationIndex={selected ? this.props.selectedLocationIndex : undefined}\n        />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { scrollToElement } from 'sonar-ui-common/helpers/scrolling';\nimport ConciseIssue from './ConciseIssue';\n\ninterface Props {\n  issues: T.Issue[];\n  onFlowSelect: (index: number) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onLocationSelect: (index: number) => void;\n  selected: string | undefined;\n  selectedFlowIndex: number | undefined;\n  selectedLocationIndex: number | undefined;\n}\n\nexport default class ConciseIssuesList extends React.PureComponent<Props> {\n  handleScroll = (element: Element, bottomOffset = 100) => {\n    const scrollableElement = document.querySelector('.layout-page-side');\n    if (element && scrollableElement) {\n      scrollToElement(element, { topOffset: 150, bottomOffset, parent: scrollableElement });\n    }\n  };\n\n  render() {\n    return (\n      <div>\n        {this.props.issues.map((issue, index) => (\n          <ConciseIssue\n            issue={issue}\n            key={issue.key}\n            onFlowSelect={this.props.onFlowSelect}\n            onLocationSelect={this.props.onLocationSelect}\n            onSelect={this.props.onIssueSelect}\n            previousIssue={index > 0 ? this.props.issues[index - 1] : undefined}\n            scroll={this.handleScroll}\n            selected={issue.key === this.props.selected}\n            selectedFlowIndex={this.props.selectedFlowIndex}\n            selectedLocationIndex={this.props.selectedLocationIndex}\n          />\n        ))}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport PageCounter from '../../../components/common/PageCounter';\n\ninterface Props {\n  className?: string;\n  current: number | undefined;\n  total: number;\n}\n\nexport default function IssuesCounter(props: Props) {\n  return (\n    <PageCounter\n      className=\"spacer-left\"\n      current={props.current}\n      label={translate('issues.issues')}\n      total={props.total}\n    />\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport BackButton from 'sonar-ui-common/components/controls/BackButton';\nimport ReloadButton from 'sonar-ui-common/components/controls/ReloadButton';\nimport IssuesCounter from '../components/IssuesCounter';\n\ninterface Props {\n  displayBackButton?: boolean;\n  loading: boolean;\n  onBackClick: () => void;\n  onReload: () => void;\n  paging: T.Paging | undefined;\n  selectedIndex: number | undefined;\n}\n\nexport default function ConciseIssuesListHeader(props: Props) {\n  const { displayBackButton = true, paging, selectedIndex } = props;\n\n  return (\n    <header className=\"layout-page-header-panel concise-issues-list-header\">\n      <div className=\"layout-page-header-panel-inner concise-issues-list-header-inner\">\n        {displayBackButton && (\n          <BackButton className=\"pull-left\" disabled={props.loading} onClick={props.onBackClick} />\n        )}\n        {props.loading ? (\n          <i className=\"spinner pull-right\" />\n        ) : (\n          <ReloadButton className=\"pull-right\" onClick={props.onReload} />\n        )}\n        {paging && <IssuesCounter current={selectedIndex} total={paging.total} />}\n      </div>\n    </header>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit, sortBy, without } from 'lodash';\nimport * as React from 'react';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport Avatar from '../../../components/ui/Avatar';\nimport { isUserActive } from '../../../helpers/users';\nimport { Facet, Query, searchAssignees } from '../utils';\n\ninterface Props {\n  assigned: boolean;\n  assignees: string[];\n  fetching: boolean;\n  loadSearchResultCount: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  organization: string | undefined;\n  query: Query;\n  stats: T.Dict<number> | undefined;\n  referencedUsers: T.Dict<T.UserBase>;\n}\n\nexport default class AssigneeFacet extends React.PureComponent<Props> {\n  handleSearch = (query: string, page?: number) => {\n    return searchAssignees(query, this.props.organization, page);\n  };\n\n  handleItemClick = (itemValue: string, multiple: boolean) => {\n    const { assignees } = this.props;\n    if (itemValue === '') {\n      // unassigned\n      this.props.onChange({ assigned: !this.props.assigned, assignees: [] });\n    } else if (multiple) {\n      const newValue = sortBy(\n        assignees.includes(itemValue) ? without(assignees, itemValue) : [...assignees, itemValue]\n      );\n      this.props.onChange({ assigned: true, assignees: newValue });\n    } else {\n      this.props.onChange({\n        assigned: true,\n        assignees: assignees.includes(itemValue) && assignees.length < 2 ? [] : [itemValue]\n      });\n    }\n  };\n\n  handleClear = () => {\n    this.props.onChange({ assigned: true, assignees: [] });\n  };\n\n  getAssigneeName = (assignee: string) => {\n    if (assignee === '') {\n      return translate('unassigned');\n    } else {\n      const user = this.props.referencedUsers[assignee];\n      if (!user) {\n        return assignee;\n      }\n      return isUserActive(user) ? user.name : translateWithParameters('user.x_deleted', user.login);\n    }\n  };\n\n  loadSearchResultCount = (assignees: T.UserBase[]) => {\n    return this.props.loadSearchResultCount('assignees', {\n      assigned: undefined,\n      assignees: assignees.map(assignee => assignee.login)\n    });\n  };\n\n  getSortedItems = () => {\n    const { stats = {} } = this.props;\n    return sortBy(\n      Object.keys(stats),\n      // put \"not assigned\" first\n      key => (key === '' ? 0 : 1),\n      // the sort by number\n      key => -stats[key]\n    );\n  };\n\n  renderFacetItem = (assignee: string) => {\n    if (assignee === '') {\n      return translate('unassigned');\n    }\n\n    const user = this.props.referencedUsers[assignee];\n\n    if (!user) {\n      return assignee;\n    }\n\n    const userName = user.name || user.login;\n\n    return (\n      <>\n        <Avatar className=\"little-spacer-right\" hash={user.avatar} name={userName} size={16} />\n        {isUserActive(user) ? userName : translateWithParameters('user.x_deleted', userName)}\n      </>\n    );\n  };\n\n  renderSearchResult = (result: T.UserBase, query: string) => {\n    const displayName = isUserActive(result)\n      ? result.name\n      : translateWithParameters('user.x_deleted', result.login);\n    return (\n      <>\n        <Avatar\n          className=\"little-spacer-right\"\n          hash={result.avatar}\n          name={result.name || result.login}\n          size={16}\n        />\n        {highlightTerm(displayName, query)}\n      </>\n    );\n  };\n\n  render() {\n    const values = [...this.props.assignees];\n    if (!this.props.assigned) {\n      values.push('');\n    }\n\n    return (\n      <ListStyleFacet<T.UserBase>\n        facetHeader={translate('issues.facet.assignees')}\n        fetching={this.props.fetching}\n        getFacetItemText={this.getAssigneeName}\n        getSearchResultKey={user => user.login}\n        getSearchResultText={user => user.name || user.login}\n        // put \"not assigned\" item first\n        getSortedItems={this.getSortedItems}\n        loadSearchResultCount={this.loadSearchResultCount}\n        onChange={this.props.onChange}\n        onClear={this.handleClear}\n        onItemClick={this.handleItemClick}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"assignees\"\n        query={omit(this.props.query, 'assigned', 'assignees')}\n        renderFacetItem={this.renderFacetItem}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_users')}\n        stats={this.props.stats}\n        values={values}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport { searchIssueAuthors } from '../../../api/issues';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport { Facet, Query } from '../utils';\n\ninterface Props {\n  component: T.Component | undefined;\n  fetching: boolean;\n  loadSearchResultCount: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  organization: string | undefined;\n  query: Query;\n  stats: T.Dict<number> | undefined;\n  authors: string[];\n}\n\nconst SEARCH_SIZE = 100;\n\nexport default class AuthorFacet extends React.PureComponent<Props> {\n  identity = (author: string) => {\n    return author;\n  };\n\n  handleSearch = (query: string, _page: number) => {\n    const { component } = this.props;\n    const project =\n      component && ['TRK', 'VW', 'APP'].includes(component.qualifier) ? component.key : undefined;\n    return searchIssueAuthors({\n      organization: this.props.organization,\n      project,\n      ps: SEARCH_SIZE, // maximum\n      q: query\n    }).then(authors => ({ maxResults: authors.length === SEARCH_SIZE, results: authors }));\n  };\n\n  loadSearchResultCount = (authors: string[]) => {\n    return this.props.loadSearchResultCount('authors', { authors });\n  };\n\n  renderSearchResult = (author: string, term: string) => {\n    return highlightTerm(author, term);\n  };\n\n  render() {\n    return (\n      <ListStyleFacet<string>\n        facetHeader={translate('issues.facet.authors')}\n        fetching={this.props.fetching}\n        getFacetItemText={this.identity}\n        getSearchResultKey={this.identity}\n        getSearchResultText={this.identity}\n        loadSearchResultCount={this.loadSearchResultCount}\n        onChange={this.props.onChange}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"authors\"\n        query={omit(this.props.query, 'authors')}\n        renderFacetItem={this.identity}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_authors')}\n        stats={this.props.stats}\n        values={this.props.authors}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as isSameDay from 'date-fns/is_same_day';\nimport { max } from 'lodash';\nimport * as React from 'react';\nimport { InjectedIntlProps, injectIntl } from 'react-intl';\nimport BarChart from 'sonar-ui-common/components/charts/BarChart';\nimport { longFormatterOption } from 'sonar-ui-common/components/intl/DateFormatter';\nimport DateFromNow from 'sonar-ui-common/components/intl/DateFromNow';\nimport DateTimeFormatter from 'sonar-ui-common/components/intl/DateTimeFormatter';\nimport { parseDate } from 'sonar-ui-common/helpers/dates';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\nimport DateRangeInput from '../../../components/controls/DateRangeInput';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport FacetItem from '../../../components/facet/FacetItem';\nimport { Query } from '../utils';\n\ninterface Props {\n  component: T.Component | undefined;\n  createdAfter: Date | undefined;\n  createdAt: string;\n  createdBefore: Date | undefined;\n  createdInLast: string;\n  fetching: boolean;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  sinceLeakPeriod: boolean;\n  stats: T.Dict<number> | undefined;\n}\n\nclass CreationDateFacet extends React.PureComponent<Props & InjectedIntlProps> {\n  property = 'createdAt';\n\n  static defaultProps = {\n    open: true\n  };\n\n  hasValue = () =>\n    this.props.createdAfter !== undefined ||\n    this.props.createdAt.length > 0 ||\n    this.props.createdBefore !== undefined ||\n    this.props.createdInLast.length > 0 ||\n    this.props.sinceLeakPeriod;\n\n  handleHeaderClick = () => {\n    this.props.onToggle(this.property);\n  };\n\n  handleClear = () => {\n    this.resetTo({});\n  };\n\n  resetTo = (changes: Partial<Query>) => {\n    this.props.onChange({\n      createdAfter: undefined,\n      createdAt: undefined,\n      createdBefore: undefined,\n      createdInLast: undefined,\n      sinceLeakPeriod: undefined,\n      ...changes\n    });\n  };\n\n  handleBarClick = ({\n    createdAfter,\n    createdBefore\n  }: {\n    createdAfter: Date;\n    createdBefore?: Date;\n  }) => {\n    this.resetTo({ createdAfter, createdBefore });\n  };\n\n  handlePeriodChange = ({ from, to }: { from?: Date; to?: Date }) => {\n    this.resetTo({ createdAfter: from, createdBefore: to });\n  };\n\n  handlePeriodClick = (period: string) => this.resetTo({ createdInLast: period });\n\n  handleLeakPeriodClick = () => this.resetTo({ sinceLeakPeriod: true });\n\n  getValues() {\n    const { createdAfter, createdAt, createdBefore, createdInLast, sinceLeakPeriod } = this.props;\n    const { formatDate } = this.props.intl;\n    const values = [];\n    if (createdAfter) {\n      values.push(formatDate(createdAfter, longFormatterOption));\n    }\n    if (createdAt) {\n      values.push(formatDate(createdAt, longFormatterOption));\n    }\n    if (createdBefore) {\n      values.push(formatDate(createdBefore, longFormatterOption));\n    }\n    if (createdInLast === '1w') {\n      values.push(translate('issues.facet.createdAt.last_week'));\n    }\n    if (createdInLast === '1m') {\n      values.push(translate('issues.facet.createdAt.last_month'));\n    }\n    if (createdInLast === '1y') {\n      values.push(translate('issues.facet.createdAt.last_year'));\n    }\n    if (sinceLeakPeriod) {\n      values.push(translate('issues.new_code'));\n    }\n    return values;\n  }\n\n  renderBarChart() {\n    const { createdBefore, stats } = this.props;\n\n    if (!stats) {\n      return null;\n    }\n\n    const periods = Object.keys(stats);\n\n    if (periods.length < 2 || periods.every(period => !stats[period])) {\n      return null;\n    }\n\n    const { formatDate } = this.props.intl;\n    const data = periods.map((start, index) => {\n      const startDate = parseDate(start);\n      let endDate;\n      if (index < periods.length - 1) {\n        endDate = parseDate(periods[index + 1]);\n        endDate.setDate(endDate.getDate() - 1);\n      } else {\n        endDate = createdBefore ? parseDate(createdBefore) : undefined;\n      }\n\n      const tooltipEndDate = endDate || new Date();\n      const tooltip = (\n        // eslint-disable-next-line react/jsx-fragments\n        <React.Fragment>\n          {formatMeasure(stats[start], 'SHORT_INT')}\n          <br />\n          {formatDate(startDate, longFormatterOption)}\n          {!isSameDay(tooltipEndDate, startDate) &&\n            ` - ${formatDate(tooltipEndDate, longFormatterOption)}`}\n        </React.Fragment>\n      );\n\n      return {\n        createdAfter: startDate,\n        createdBefore: endDate,\n        tooltip,\n        x: index,\n        y: stats[start]\n      };\n    });\n\n    const barsWidth = Math.floor(250 / data.length);\n    const width = barsWidth * data.length - 1 + 10;\n\n    const maxValue = max(data.map(d => d.y));\n    const xValues = data.map(d => (d.y === maxValue ? formatMeasure(maxValue, 'SHORT_INT') : ''));\n\n    return (\n      <BarChart\n        barsWidth={barsWidth - 1}\n        data={data}\n        height={75}\n        onBarClick={this.handleBarClick}\n        padding={[25, 0, 5, 10]}\n        width={width}\n        xValues={xValues}\n      />\n    );\n  }\n\n  renderExactDate() {\n    return (\n      <div className=\"search-navigator-facet-container\">\n        <DateTimeFormatter date={this.props.createdAt} />\n        <br />\n        <span className=\"note\">\n          <DateFromNow date={this.props.createdAt} />\n        </span>\n      </div>\n    );\n  }\n\n  renderPeriodSelectors() {\n    const { createdAfter, createdBefore } = this.props;\n    return (\n      <div className=\"search-navigator-date-facet-selection\">\n        <DateRangeInput\n          onChange={this.handlePeriodChange}\n          value={{ from: createdAfter, to: createdBefore }}\n        />\n      </div>\n    );\n  }\n\n  renderPredefinedPeriods() {\n    const { component, createdInLast, sinceLeakPeriod } = this.props;\n    return (\n      <div className=\"spacer-top issues-predefined-periods\">\n        <FacetItem\n          active={!this.hasValue()}\n          name={translate('issues.facet.createdAt.all')}\n          onClick={this.handlePeriodClick}\n          tooltip={translate('issues.facet.createdAt.all')}\n          value=\"\"\n        />\n        {component ? (\n          <FacetItem\n            active={sinceLeakPeriod}\n            name={translate('issues.new_code')}\n            onClick={this.handleLeakPeriodClick}\n            tooltip={translate('issues.new_code_period')}\n            value=\"\"\n          />\n        ) : (\n          <>\n            <FacetItem\n              active={createdInLast === '1w'}\n              name={translate('issues.facet.createdAt.last_week')}\n              onClick={this.handlePeriodClick}\n              tooltip={translate('issues.facet.createdAt.last_week')}\n              value=\"1w\"\n            />\n            <FacetItem\n              active={createdInLast === '1m'}\n              name={translate('issues.facet.createdAt.last_month')}\n              onClick={this.handlePeriodClick}\n              tooltip={translate('issues.facet.createdAt.last_month')}\n              value=\"1m\"\n            />\n            <FacetItem\n              active={createdInLast === '1y'}\n              name={translate('issues.facet.createdAt.last_year')}\n              onClick={this.handlePeriodClick}\n              tooltip={translate('issues.facet.createdAt.last_year')}\n              value=\"1y\"\n            />\n          </>\n        )}\n      </div>\n    );\n  }\n\n  renderInner() {\n    const { createdAt } = this.props;\n    return createdAt ? (\n      this.renderExactDate()\n    ) : (\n      <div>\n        {this.renderBarChart()}\n        {this.renderPeriodSelectors()}\n        {this.renderPredefinedPeriods()}\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <FacetBox property={this.property}>\n        <FacetHeader\n          fetching={this.props.fetching}\n          name={translate('issues.facet', this.property)}\n          onClear={this.handleClear}\n          onClick={this.handleHeaderClick}\n          open={this.props.open}\n          values={this.getValues()}\n        />\n\n        {this.props.open && this.renderInner()}\n      </FacetBox>\n    );\n  }\n}\n\nexport default injectIntl(CreationDateFacet);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit } from 'lodash';\nimport * as React from 'react';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { collapsePath } from 'sonar-ui-common/helpers/path';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport { getDirectories, TreeComponentWithPath } from '../../../api/components';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport { Facet, Query } from '../utils';\n\ninterface Props {\n  componentKey: string;\n  directories: string[];\n  fetching: boolean;\n  loadSearchResultCount: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  query: Query;\n  stats: Facet | undefined;\n}\n\nexport default class DirectoryFacet extends React.PureComponent<Props> {\n  getFacetItemText = (path: string) => {\n    return collapsePath(path, 15);\n  };\n\n  getSearchResultKey = (directory: TreeComponentWithPath) => {\n    return directory.path;\n  };\n\n  getSearchResultText = (directory: TreeComponentWithPath) => {\n    return directory.name;\n  };\n\n  handleSearch = (query: string, page: number) => {\n    return getDirectories({\n      component: this.props.componentKey,\n      q: query,\n      p: page,\n      ps: 30\n    }).then(({ components, paging }) => ({\n      paging,\n      results: components.filter(dir => dir.path !== undefined)\n    }));\n  };\n\n  loadSearchResultCount = (directories: TreeComponentWithPath[]) => {\n    return this.props.loadSearchResultCount('directories', {\n      directories: directories.map(directory => directory.path)\n    });\n  };\n\n  renderDirectory = (directory: React.ReactNode) => (\n    <>\n      <QualifierIcon className=\"little-spacer-right\" qualifier=\"DIR\" />\n      {directory}\n    </>\n  );\n\n  renderFacetItem = (path: string) => {\n    return this.renderDirectory(collapsePath(path, 15));\n  };\n\n  renderSearchResult = (directory: TreeComponentWithPath, term: string) => {\n    return this.renderDirectory(highlightTerm(collapsePath(directory.path, 15), term));\n  };\n\n  render() {\n    return (\n      <ListStyleFacet<TreeComponentWithPath>\n        facetHeader={translate('issues.facet.directories')}\n        fetching={this.props.fetching}\n        getFacetItemText={this.getFacetItemText}\n        getSearchResultKey={this.getSearchResultKey}\n        getSearchResultText={this.getSearchResultText}\n        loadSearchResultCount={this.loadSearchResultCount}\n        minSearchLength={3}\n        onChange={this.props.onChange}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"directories\"\n        query={omit(this.props.query, 'directories')}\n        renderFacetItem={this.renderFacetItem}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_directories')}\n        stats={this.props.stats}\n        values={this.props.directories}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit } from 'lodash';\nimport * as React from 'react';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { collapsePath } from 'sonar-ui-common/helpers/path';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport { isDefined } from 'sonar-ui-common/helpers/types';\nimport { getFiles, TreeComponentWithPath } from '../../../api/components';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport { Facet, Query, ReferencedComponent } from '../utils';\n\ninterface Props {\n  componentKey: string;\n  fetching: boolean;\n  fileUuids: string[];\n  loadSearchResultCount: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  query: Query;\n  referencedComponents: T.Dict<ReferencedComponent>;\n  stats: Facet | undefined;\n}\n\nexport default class FileFacet extends React.PureComponent<Props> {\n  getFilePath = (fileUuid: string) => {\n    const { referencedComponents } = this.props;\n    return referencedComponents[fileUuid]\n      ? collapsePath(referencedComponents[fileUuid].path || '', 15)\n      : fileUuid;\n  };\n\n  getReferencedComponent = (key: string) => {\n    const { referencedComponents } = this.props;\n    const fileUuid = Object.keys(referencedComponents).find(uuid => {\n      return referencedComponents[uuid].key === key;\n    });\n    return fileUuid ? referencedComponents[fileUuid] : undefined;\n  };\n\n  getFacetItemText = (fileUuid: string) => {\n    const { referencedComponents } = this.props;\n    return referencedComponents[fileUuid] ? referencedComponents[fileUuid].path || '' : fileUuid;\n  };\n\n  getSearchResultKey = (file: TreeComponentWithPath) => {\n    const component = this.getReferencedComponent(file.key);\n    return component ? component.uuid : file.key;\n  };\n\n  getSearchResultText = (file: TreeComponentWithPath) => {\n    return file.path;\n  };\n\n  handleSearch = (query: string, page: number) => {\n    return getFiles({\n      component: this.props.componentKey,\n      q: query,\n      p: page,\n      ps: 30\n    }).then(({ components, paging }) => ({\n      paging,\n      results: components.filter(file => file.path !== undefined)\n    }));\n  };\n\n  loadSearchResultCount = (files: TreeComponentWithPath[]) => {\n    return this.props.loadSearchResultCount('files', {\n      files: files\n        .map(file => {\n          const component = this.getReferencedComponent(file.key);\n          return component && component.uuid;\n        })\n        .filter(isDefined)\n    });\n  };\n\n  renderFile = (file: React.ReactNode) => (\n    <>\n      <QualifierIcon className=\"little-spacer-right\" qualifier=\"FIL\" />\n      {file}\n    </>\n  );\n\n  renderFacetItem = (fileUuid: string) => {\n    const name = this.getFilePath(fileUuid);\n    return this.renderFile(name);\n  };\n\n  renderSearchResult = (file: TreeComponentWithPath, term: string) => {\n    return this.renderFile(highlightTerm(collapsePath(file.path, 15), term));\n  };\n\n  render() {\n    return (\n      <ListStyleFacet<TreeComponentWithPath>\n        facetHeader={translate('issues.facet.files')}\n        fetching={this.props.fetching}\n        getFacetItemText={this.getFacetItemText}\n        getSearchResultKey={this.getSearchResultKey}\n        getSearchResultText={this.getSearchResultText}\n        loadSearchResultCount={this.loadSearchResultCount}\n        minSearchLength={3}\n        onChange={this.props.onChange}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"files\"\n        query={omit(this.props.query, 'files')}\n        renderFacetItem={this.renderFacetItem}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_files')}\n        stats={this.props.stats}\n        values={this.props.fileUuids}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit, uniqBy } from 'lodash';\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport { getLanguages, Store } from '../../../store/rootReducer';\nimport { Facet, Query, ReferencedLanguage } from '../utils';\n\ninterface InstalledLanguage {\n  key: string;\n  name: string;\n}\n\ninterface Props {\n  fetching: boolean;\n  installedLanguages: InstalledLanguage[];\n  languages: string[];\n  loadSearchResultCount: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  query: Query;\n  referencedLanguages: T.Dict<ReferencedLanguage>;\n  stats: T.Dict<number> | undefined;\n}\n\nclass LanguageFacet extends React.PureComponent<Props> {\n  getLanguageName = (language: string) => {\n    const { referencedLanguages } = this.props;\n    return referencedLanguages[language] ? referencedLanguages[language].name : language;\n  };\n\n  handleSearch = (query: string) => {\n    const options = this.getAllPossibleOptions();\n    const results = options.filter(language =>\n      language.name.toLowerCase().includes(query.toLowerCase())\n    );\n    const paging = { pageIndex: 1, pageSize: results.length, total: results.length };\n    return Promise.resolve({ paging, results });\n  };\n\n  getAllPossibleOptions = () => {\n    const { installedLanguages, stats = {} } = this.props;\n\n    // add any language that presents in the facet, but might not be installed\n    // for such language we don't know their display name, so let's just use their key\n    // and make sure we reference each language only once\n    return uniqBy(\n      [...installedLanguages, ...Object.keys(stats).map(key => ({ key, name: key }))],\n      language => language.key\n    );\n  };\n\n  loadSearchResultCount = (languages: InstalledLanguage[]) => {\n    return this.props.loadSearchResultCount('languages', {\n      languages: languages.map(language => language.key)\n    });\n  };\n\n  renderSearchResult = ({ name }: InstalledLanguage, term: string) => {\n    return highlightTerm(name, term);\n  };\n\n  render() {\n    return (\n      <ListStyleFacet<InstalledLanguage>\n        facetHeader={translate('issues.facet.languages')}\n        fetching={this.props.fetching}\n        getFacetItemText={this.getLanguageName}\n        getSearchResultKey={language => language.key}\n        getSearchResultText={language => language.name}\n        loadSearchResultCount={this.loadSearchResultCount}\n        minSearchLength={1}\n        onChange={this.props.onChange}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"languages\"\n        query={omit(this.props.query, 'languages')}\n        renderFacetItem={this.getLanguageName}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_languages')}\n        stats={this.props.stats}\n        values={this.props.languages}\n      />\n    );\n  }\n}\n\nconst mapStateToProps = (state: Store) => ({\n  installedLanguages: Object.values(getLanguages(state))\n});\n\nexport default connect(mapStateToProps)(LanguageFacet);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit } from 'lodash';\nimport * as React from 'react';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport { getTree, searchProjects } from '../../../api/components';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport Organization from '../../../components/shared/Organization';\nimport { Facet, Query, ReferencedComponent } from '../utils';\n\ninterface Props {\n  component: T.Component | undefined;\n  loadSearchResultCount: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  fetching: boolean;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  organization: { key: string } | undefined;\n  projects: string[];\n  query: Query;\n  referencedComponents: T.Dict<ReferencedComponent>;\n  stats: T.Dict<number> | undefined;\n}\n\ninterface SearchedProject {\n  key: string;\n  name: string;\n  organization: string;\n}\n\nexport default class ProjectFacet extends React.PureComponent<Props> {\n  handleSearch = (\n    query: string,\n    page = 1\n  ): Promise<{ results: SearchedProject[]; paging: T.Paging }> => {\n    const { component, organization } = this.props;\n    if (component && ['VW', 'SVW', 'APP'].includes(component.qualifier)) {\n      return getTree({\n        component: component.key,\n        p: page,\n        ps: 30,\n        q: query,\n        qualifiers: 'TRK'\n      }).then(({ components, paging }) => ({\n        paging,\n        results: components.map(component => ({\n          key: component.refKey || component.key,\n          name: component.name,\n          organization: component.organization\n        }))\n      }));\n    }\n\n    return searchProjects({\n      p: page,\n      ps: 30,\n      filter: query ? `query = \"${query}\"` : '',\n      organization: organization && organization.key\n    }).then(({ components, paging }) => ({\n      paging,\n      results: components.map(component => ({\n        key: component.key,\n        name: component.name,\n        organization: component.organization\n      }))\n    }));\n  };\n\n  getProjectName = (project: string) => {\n    const { referencedComponents } = this.props;\n    return referencedComponents[project] ? referencedComponents[project].name : project;\n  };\n\n  loadSearchResultCount = (projects: SearchedProject[]) => {\n    return this.props.loadSearchResultCount('projects', {\n      projects: projects.map(project => project.key)\n    });\n  };\n\n  renderFacetItem = (project: string) => {\n    const { referencedComponents } = this.props;\n    return referencedComponents[project] ? (\n      this.renderProject(referencedComponents[project])\n    ) : (\n      <span>\n        <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n        {project}\n      </span>\n    );\n  };\n\n  renderProject = (project: Pick<SearchedProject, 'name' | 'organization'>) => (\n    <span>\n      <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n      {!this.props.organization && (\n        <Organization link={false} organizationKey={project.organization} />\n      )}\n      {project.name}\n    </span>\n  );\n\n  renderSearchResult = (project: Pick<SearchedProject, 'name' | 'organization'>, term: string) => (\n    <>\n      <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n      {!this.props.organization && (\n        <Organization link={false} organizationKey={project.organization} />\n      )}\n      {highlightTerm(project.name, term)}\n    </>\n  );\n\n  render() {\n    return (\n      <ListStyleFacet<SearchedProject>\n        facetHeader={translate('issues.facet.projects')}\n        fetching={this.props.fetching}\n        getFacetItemText={this.getProjectName}\n        getSearchResultKey={project => project.key}\n        getSearchResultText={project => project.name}\n        loadSearchResultCount={this.loadSearchResultCount}\n        onChange={this.props.onChange}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"projects\"\n        query={omit(this.props.query, 'projects')}\n        renderFacetItem={this.renderFacetItem}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_projects')}\n        stats={this.props.stats}\n        values={this.props.projects}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { orderBy, without } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport FacetItem from '../../../components/facet/FacetItem';\nimport FacetItemsList from '../../../components/facet/FacetItemsList';\nimport MultipleSelectionHint from '../../../components/facet/MultipleSelectionHint';\nimport { formatFacetStat, Query } from '../utils';\n\ninterface Props {\n  fetching: boolean;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  resolved: boolean;\n  resolutions: string[];\n  stats: T.Dict<number> | undefined;\n}\n\nconst RESOLUTIONS = ['', 'FALSE-POSITIVE', 'FIXED', 'REMOVED', 'WONTFIX'];\n\nexport default class ResolutionFacet extends React.PureComponent<Props> {\n  property = 'resolutions';\n\n  static defaultProps = {\n    open: true\n  };\n\n  handleItemClick = (itemValue: string, multiple: boolean) => {\n    const { resolutions } = this.props;\n    if (itemValue === '') {\n      // unresolved\n      this.props.onChange({ resolved: !this.props.resolved, resolutions: [] });\n    } else if (multiple) {\n      const newValue = orderBy(\n        resolutions.includes(itemValue)\n          ? without(resolutions, itemValue)\n          : [...resolutions, itemValue]\n      );\n      this.props.onChange({ resolved: true, [this.property]: newValue });\n    } else {\n      this.props.onChange({\n        resolved: true,\n        [this.property]:\n          resolutions.includes(itemValue) && resolutions.length < 2 ? [] : [itemValue]\n      });\n    }\n  };\n\n  handleHeaderClick = () => {\n    this.props.onToggle(this.property);\n  };\n\n  handleClear = () => {\n    this.props.onChange({ resolved: false, resolutions: [] });\n  };\n\n  isFacetItemActive(resolution: string) {\n    return resolution === '' ? !this.props.resolved : this.props.resolutions.includes(resolution);\n  }\n\n  getFacetItemName(resolution: string) {\n    return resolution === '' ? translate('unresolved') : translate('issue.resolution', resolution);\n  }\n\n  getStat(resolution: string) {\n    const { stats } = this.props;\n    return stats ? stats[resolution] : undefined;\n  }\n\n  renderItem = (resolution: string) => {\n    const active = this.isFacetItemActive(resolution);\n    const stat = this.getStat(resolution);\n\n    return (\n      <FacetItem\n        active={active}\n        disabled={stat === 0 && !active}\n        halfWidth={true}\n        key={resolution}\n        name={this.getFacetItemName(resolution)}\n        onClick={this.handleItemClick}\n        stat={formatFacetStat(stat)}\n        tooltip={this.getFacetItemName(resolution)}\n        value={resolution}\n      />\n    );\n  };\n\n  render() {\n    const { resolutions, stats = {} } = this.props;\n    const values = resolutions.map(resolution => this.getFacetItemName(resolution));\n\n    return (\n      <FacetBox property={this.property}>\n        <FacetHeader\n          fetching={this.props.fetching}\n          name={translate('issues.facet', this.property)}\n          onClear={this.handleClear}\n          onClick={this.handleHeaderClick}\n          open={this.props.open}\n          values={values}\n        />\n\n        {this.props.open && (\n          <>\n            <FacetItemsList>{RESOLUTIONS.map(this.renderItem)}</FacetItemsList>\n            <MultipleSelectionHint\n              options={Object.keys(stats).length}\n              values={resolutions.length}\n            />\n          </>\n        )}\n      </FacetBox>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { searchRules } from '../../../api/rules';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport { Facet, Query, ReferencedRule } from '../utils';\n\ninterface Props {\n  fetching: boolean;\n  languages: string[];\n  loadSearchResultCount: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  organization: string | undefined;\n  query: Query;\n  referencedRules: T.Dict<ReferencedRule>;\n  rules: string[];\n  stats: T.Dict<number> | undefined;\n}\n\nexport default class RuleFacet extends React.PureComponent<Props> {\n  handleSearch = (query: string, page = 1) => {\n    const { languages, organization } = this.props;\n    return searchRules({\n      f: 'name,langName',\n      languages: languages.length ? languages.join() : undefined,\n      organization,\n      q: query,\n      p: page,\n      ps: 30,\n      s: 'name',\n      include_external: true\n    }).then(response => ({\n      paging: { pageIndex: response.p, pageSize: response.ps, total: response.total },\n      results: response.rules\n    }));\n  };\n\n  loadSearchResultCount = (rules: T.Rule[]) => {\n    return this.props.loadSearchResultCount('rules', { rules: rules.map(rule => rule.key) });\n  };\n\n  getRuleName = (ruleKey: string) => {\n    const rule = this.props.referencedRules[ruleKey];\n    return rule ? this.formatRuleName(rule.name, rule.langName) : ruleKey;\n  };\n\n  formatRuleName = (name: string, langName: string | undefined) => {\n    // external rules don't have a language associated\n    // see https://jira.sonarsource.com/browse/MMF-1407\n    return langName ? `(${langName}) ${name}` : name;\n  };\n\n  renderSearchResult = (rule: T.Rule) => {\n    return this.formatRuleName(rule.name, rule.langName);\n  };\n\n  render() {\n    return (\n      <ListStyleFacet<T.Rule>\n        facetHeader={translate('issues.facet.rules')}\n        fetching={this.props.fetching}\n        getFacetItemText={this.getRuleName}\n        getSearchResultKey={rule => rule.key}\n        getSearchResultText={rule => rule.name}\n        loadSearchResultCount={this.loadSearchResultCount}\n        onChange={this.props.onChange}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"rules\"\n        query={omit(this.props.query, 'rules')}\n        renderFacetItem={this.getRuleName}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_rules')}\n        stats={this.props.stats}\n        values={this.props.rules}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { orderBy, without } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport FacetItem from '../../../components/facet/FacetItem';\nimport FacetItemsList from '../../../components/facet/FacetItemsList';\nimport MultipleSelectionHint from '../../../components/facet/MultipleSelectionHint';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport { formatFacetStat, Query } from '../utils';\n\ninterface Props {\n  fetching: boolean;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  severities: string[];\n  stats: T.Dict<number> | undefined;\n}\n\nconst SEVERITIES = ['BLOCKER', 'MINOR', 'CRITICAL', 'INFO', 'MAJOR'];\n\nexport default class SeverityFacet extends React.PureComponent<Props> {\n  property = 'severities';\n\n  static defaultProps = {\n    open: true\n  };\n\n  handleItemClick = (itemValue: string, multiple: boolean) => {\n    const { severities } = this.props;\n    if (multiple) {\n      const newValue = orderBy(\n        severities.includes(itemValue) ? without(severities, itemValue) : [...severities, itemValue]\n      );\n      this.props.onChange({ [this.property]: newValue });\n    } else {\n      this.props.onChange({\n        [this.property]: severities.includes(itemValue) && severities.length < 2 ? [] : [itemValue]\n      });\n    }\n  };\n\n  handleHeaderClick = () => {\n    this.props.onToggle(this.property);\n  };\n\n  handleClear = () => {\n    this.props.onChange({ [this.property]: [] });\n  };\n\n  getStat(severity: string) {\n    const { stats } = this.props;\n    return stats ? stats[severity] : undefined;\n  }\n\n  renderItem = (severity: string) => {\n    const active = this.props.severities.includes(severity);\n    const stat = this.getStat(severity);\n\n    return (\n      <FacetItem\n        active={active}\n        disabled={stat === 0 && !active}\n        halfWidth={true}\n        key={severity}\n        name={<SeverityHelper severity={severity} />}\n        onClick={this.handleItemClick}\n        stat={formatFacetStat(stat)}\n        tooltip={translate('severity', severity)}\n        value={severity}\n      />\n    );\n  };\n\n  render() {\n    const { severities, stats = {} } = this.props;\n    const values = severities.map(severity => translate('severity', severity));\n\n    return (\n      <FacetBox property={this.property}>\n        <FacetHeader\n          fetching={this.props.fetching}\n          name={translate('issues.facet', this.property)}\n          onClear={this.handleClear}\n          onClick={this.handleHeaderClick}\n          open={this.props.open}\n          values={values}\n        />\n\n        {this.props.open && (\n          <>\n            <FacetItemsList>{SEVERITIES.map(this.renderItem)}</FacetItemsList>\n            <MultipleSelectionHint options={Object.keys(stats).length} values={severities.length} />\n          </>\n        )}\n      </FacetBox>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { orderBy, without } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport FacetItem from '../../../components/facet/FacetItem';\nimport FacetItemsList from '../../../components/facet/FacetItemsList';\nimport MultipleSelectionHint from '../../../components/facet/MultipleSelectionHint';\nimport StatusHelper from '../../../components/shared/StatusHelper';\nimport { formatFacetStat, Query } from '../utils';\n\ninterface Props {\n  fetching: boolean;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  stats: T.Dict<number> | undefined;\n  statuses: string[];\n}\n\nconst STATUSES = ['OPEN', 'CONFIRMED', 'REOPENED', 'RESOLVED', 'CLOSED'];\n\nexport default class StatusFacet extends React.PureComponent<Props> {\n  property = 'statuses';\n\n  static defaultProps = { open: true };\n\n  handleItemClick = (itemValue: string, multiple: boolean) => {\n    const { statuses } = this.props;\n    if (multiple) {\n      const newValue = orderBy(\n        statuses.includes(itemValue) ? without(statuses, itemValue) : [...statuses, itemValue]\n      );\n      this.props.onChange({ [this.property]: newValue });\n    } else {\n      this.props.onChange({\n        [this.property]: statuses.includes(itemValue) && statuses.length < 2 ? [] : [itemValue]\n      });\n    }\n  };\n\n  handleHeaderClick = () => {\n    this.props.onToggle(this.property);\n  };\n\n  handleClear = () => {\n    this.props.onChange({ [this.property]: [] });\n  };\n\n  getStat(status: string) {\n    const { stats } = this.props;\n    return stats ? stats[status] : undefined;\n  }\n\n  renderItem = (status: string) => {\n    const active = this.props.statuses.includes(status);\n    const stat = this.getStat(status);\n\n    return (\n      <FacetItem\n        active={active}\n        disabled={stat === 0 && !active}\n        halfWidth={true}\n        key={status}\n        name={<StatusHelper resolution={undefined} status={status} />}\n        onClick={this.handleItemClick}\n        stat={formatFacetStat(stat)}\n        tooltip={translate('issue.status', status)}\n        value={status}\n      />\n    );\n  };\n\n  render() {\n    const { statuses, stats = {} } = this.props;\n    const values = statuses.map(status => translate('issue.status', status));\n\n    return (\n      <FacetBox property={this.property}>\n        <FacetHeader\n          fetching={this.props.fetching}\n          name={translate('issues.facet', this.property)}\n          onClear={this.handleClear}\n          onClick={this.handleHeaderClick}\n          open={this.props.open}\n          values={values}\n        />\n\n        {this.props.open && (\n          <>\n            <FacetItemsList title={translate('issues')}>\n              {STATUSES.map(this.renderItem)}\n            </FacetItemsList>\n            <MultipleSelectionHint options={Object.keys(stats).length} values={statuses.length} />\n          </>\n        )}\n      </FacetBox>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit } from 'lodash';\nimport * as React from 'react';\nimport TagsIcon from 'sonar-ui-common/components/icons/TagsIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport { searchIssueTags } from '../../../api/issues';\nimport { colors } from '../../../app/theme';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport { Facet, Query } from '../utils';\n\ninterface Props {\n  component: T.Component | undefined;\n  fetching: boolean;\n  loadSearchResultCount: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  organization: string | undefined;\n  query: Query;\n  stats: T.Dict<number> | undefined;\n  tags: string[];\n}\n\nconst SEARCH_SIZE = 100;\n\nexport default class TagFacet extends React.PureComponent<Props> {\n  handleSearch = (query: string) => {\n    const { component } = this.props;\n    const project =\n      component && ['TRK', 'VW', 'APP'].includes(component.qualifier) ? component.key : undefined;\n    return searchIssueTags({\n      organization: this.props.organization,\n      project,\n      ps: SEARCH_SIZE,\n      q: query\n    }).then(tags => ({ maxResults: tags.length === SEARCH_SIZE, results: tags }));\n  };\n\n  getTagName = (tag: string) => {\n    return tag;\n  };\n\n  loadSearchResultCount = (tags: string[]) => {\n    return this.props.loadSearchResultCount('tags', { tags });\n  };\n\n  renderTag = (tag: string) => {\n    return (\n      <>\n        <TagsIcon className=\"little-spacer-right\" fill={colors.gray60} />\n        {tag}\n      </>\n    );\n  };\n\n  renderSearchResult = (tag: string, term: string) => (\n    <>\n      <TagsIcon className=\"little-spacer-right\" fill={colors.gray60} />\n      {highlightTerm(tag, term)}\n    </>\n  );\n\n  render() {\n    return (\n      <ListStyleFacet<string>\n        facetHeader={translate('issues.facet.tags')}\n        fetching={this.props.fetching}\n        getFacetItemText={this.getTagName}\n        getSearchResultKey={tag => tag}\n        getSearchResultText={tag => tag}\n        loadSearchResultCount={this.loadSearchResultCount}\n        onChange={this.props.onChange}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"tags\"\n        query={omit(this.props.query, 'tags')}\n        renderFacetItem={this.renderTag}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_tags')}\n        stats={this.props.stats}\n        values={this.props.tags}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { orderBy, without } from 'lodash';\nimport * as React from 'react';\nimport IssueTypeIcon from 'sonar-ui-common/components/icons/IssueTypeIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport FacetItem from '../../../components/facet/FacetItem';\nimport FacetItemsList from '../../../components/facet/FacetItemsList';\nimport MultipleSelectionHint from '../../../components/facet/MultipleSelectionHint';\nimport { ISSUE_TYPES } from '../../../helpers/constants';\nimport { formatFacetStat, Query } from '../utils';\n\ninterface Props {\n  fetching: boolean;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  stats: T.Dict<number> | undefined;\n  types: string[];\n}\n\nexport default class TypeFacet extends React.PureComponent<Props> {\n  property = 'types';\n\n  static defaultProps = {\n    open: true\n  };\n\n  handleItemClick = (itemValue: string, multiple: boolean) => {\n    const { types } = this.props;\n    if (multiple) {\n      const newValue = orderBy(\n        types.includes(itemValue) ? without(types, itemValue) : [...types, itemValue]\n      );\n      this.props.onChange({ [this.property]: newValue });\n    } else {\n      this.props.onChange({\n        [this.property]: types.includes(itemValue) && types.length < 2 ? [] : [itemValue]\n      });\n    }\n  };\n\n  handleHeaderClick = () => {\n    this.props.onToggle(this.property);\n  };\n\n  handleClear = () => {\n    this.props.onChange({ [this.property]: [] });\n  };\n\n  getStat(type: string) {\n    const { stats } = this.props;\n    return stats ? stats[type] : undefined;\n  }\n\n  isFacetItemActive(type: string) {\n    return this.props.types.includes(type);\n  }\n\n  renderItem = (type: string) => {\n    const active = this.isFacetItemActive(type);\n    const stat = this.getStat(type);\n\n    return (\n      <FacetItem\n        active={active}\n        disabled={stat === 0 && !active}\n        key={type}\n        name={\n          <span className=\"display-flex-center\">\n            <IssueTypeIcon className=\"little-spacer-right\" query={type} />{' '}\n            {translate('issue.type', type)}\n          </span>\n        }\n        onClick={this.handleItemClick}\n        stat={formatFacetStat(stat)}\n        value={type}\n      />\n    );\n  };\n\n  render() {\n    const { types, stats = {} } = this.props;\n    const values = types.map(type => translate('issue.type', type));\n\n    return (\n      <FacetBox property={this.property}>\n        <FacetHeader\n          fetching={this.props.fetching}\n          name={translate('issues.facet', this.property)}\n          onClear={this.handleClear}\n          onClick={this.handleHeaderClick}\n          open={this.props.open}\n          values={values}\n        />\n\n        {this.props.open && (\n          <>\n            <FacetItemsList>\n              {ISSUE_TYPES.filter(t => t !== 'SECURITY_HOTSPOT').map(this.renderItem)}\n            </FacetItemsList>\n            <MultipleSelectionHint options={Object.keys(stats).length} values={types.length} />\n          </>\n        )}\n      </FacetBox>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Facet, Query, ReferencedComponent, ReferencedLanguage, ReferencedRule } from '../utils';\nimport AssigneeFacet from './AssigneeFacet';\nimport AuthorFacet from './AuthorFacet';\nimport CreationDateFacet from './CreationDateFacet';\nimport DirectoryFacet from './DirectoryFacet';\nimport FileFacet from './FileFacet';\nimport LanguageFacet from './LanguageFacet';\nimport ProjectFacet from './ProjectFacet';\nimport ResolutionFacet from './ResolutionFacet';\nimport RuleFacet from './RuleFacet';\nimport SeverityFacet from './SeverityFacet';\nimport StandardFacet from './StandardFacet';\nimport StatusFacet from './StatusFacet';\nimport TagFacet from './TagFacet';\nimport TypeFacet from './TypeFacet';\n\nexport interface Props {\n  component: T.Component | undefined;\n  facets: T.Dict<Facet | undefined>;\n  hideAuthorFacet?: boolean;\n  loadSearchResultCount: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  loadingFacets: T.Dict<boolean>;\n  myIssues: boolean;\n  onFacetToggle: (property: string) => void;\n  onFilterChange: (changes: Partial<Query>) => void;\n  openFacets: T.Dict<boolean>;\n  organization: { key: string } | undefined;\n  query: Query;\n  referencedComponentsById: T.Dict<ReferencedComponent>;\n  referencedComponentsByKey: T.Dict<ReferencedComponent>;\n  referencedLanguages: T.Dict<ReferencedLanguage>;\n  referencedRules: T.Dict<ReferencedRule>;\n  referencedUsers: T.Dict<T.UserBase>;\n}\n\nexport default class Sidebar extends React.PureComponent<Props> {\n  renderComponentFacets() {\n    const { component, facets, loadingFacets, openFacets, query } = this.props;\n    if (!component) {\n      return null;\n    }\n    const commonProps = {\n      componentKey: component.key,\n      loadSearchResultCount: this.props.loadSearchResultCount,\n      onChange: this.props.onFilterChange,\n      onToggle: this.props.onFacetToggle,\n      query\n    };\n    return (\n      <>\n        {component.qualifier !== 'DIR' && (\n          <DirectoryFacet\n            directories={query.directories}\n            fetching={loadingFacets.directories === true}\n            open={!!openFacets.directories}\n            stats={facets.directories}\n            {...commonProps}\n          />\n        )}\n        <FileFacet\n          fetching={loadingFacets.files === true}\n          fileUuids={query.files}\n          open={!!openFacets.files}\n          referencedComponents={this.props.referencedComponentsById}\n          stats={facets.files}\n          {...commonProps}\n        />\n      </>\n    );\n  }\n\n  render() {\n    const { component, facets, hideAuthorFacet, openFacets, query } = this.props;\n\n    const displayProjectsFacet =\n      !component || !['TRK', 'BRC', 'DIR', 'DEV_PRJ'].includes(component.qualifier);\n    const displayAuthorFacet = !hideAuthorFacet && (!component || component.qualifier !== 'DEV');\n\n    const organizationKey =\n      (component && component.organization) ||\n      (this.props.organization && this.props.organization.key);\n\n    return (\n      <>\n        <TypeFacet\n          fetching={this.props.loadingFacets.types === true}\n          onChange={this.props.onFilterChange}\n          onToggle={this.props.onFacetToggle}\n          open={!!openFacets.types}\n          stats={facets.types}\n          types={query.types}\n        />\n        <SeverityFacet\n          fetching={this.props.loadingFacets.severities === true}\n          onChange={this.props.onFilterChange}\n          onToggle={this.props.onFacetToggle}\n          open={!!openFacets.severities}\n          severities={query.severities}\n          stats={facets.severities}\n        />\n        <ResolutionFacet\n          fetching={this.props.loadingFacets.resolutions === true}\n          onChange={this.props.onFilterChange}\n          onToggle={this.props.onFacetToggle}\n          open={!!openFacets.resolutions}\n          resolutions={query.resolutions}\n          resolved={query.resolved}\n          stats={facets.resolutions}\n        />\n        <StatusFacet\n          fetching={this.props.loadingFacets.statuses === true}\n          onChange={this.props.onFilterChange}\n          onToggle={this.props.onFacetToggle}\n          open={!!openFacets.statuses}\n          stats={facets.statuses}\n          statuses={query.statuses}\n        />\n        <StandardFacet\n          cwe={query.cwe}\n          cweOpen={!!openFacets.cwe}\n          cweStats={facets.cwe}\n          fetchingCwe={this.props.loadingFacets.cwe === true}\n          fetchingOwaspTop10={this.props.loadingFacets.owaspTop10 === true}\n          fetchingSansTop25={this.props.loadingFacets.sansTop25 === true}\n          fetchingSonarSourceSecurity={this.props.loadingFacets.sonarsourceSecurity === true}\n          loadSearchResultCount={this.props.loadSearchResultCount}\n          onChange={this.props.onFilterChange}\n          onToggle={this.props.onFacetToggle}\n          open={!!openFacets.standards}\n          owaspTop10={query.owaspTop10}\n          owaspTop10Open={!!openFacets.owaspTop10}\n          owaspTop10Stats={facets.owaspTop10}\n          query={query}\n          sansTop25={query.sansTop25}\n          sansTop25Open={!!openFacets.sansTop25}\n          sansTop25Stats={facets.sansTop25}\n          sonarsourceSecurity={query.sonarsourceSecurity}\n          sonarsourceSecurityOpen={!!openFacets.sonarsourceSecurity}\n          sonarsourceSecurityStats={facets.sonarsourceSecurity}\n        />\n        <CreationDateFacet\n          component={component}\n          createdAfter={query.createdAfter}\n          createdAt={query.createdAt}\n          createdBefore={query.createdBefore}\n          createdInLast={query.createdInLast}\n          fetching={this.props.loadingFacets.createdAt === true}\n          onChange={this.props.onFilterChange}\n          onToggle={this.props.onFacetToggle}\n          open={!!openFacets.createdAt}\n          sinceLeakPeriod={query.sinceLeakPeriod}\n          stats={facets.createdAt}\n        />\n        <LanguageFacet\n          fetching={this.props.loadingFacets.languages === true}\n          languages={query.languages}\n          loadSearchResultCount={this.props.loadSearchResultCount}\n          onChange={this.props.onFilterChange}\n          onToggle={this.props.onFacetToggle}\n          open={!!openFacets.languages}\n          query={query}\n          referencedLanguages={this.props.referencedLanguages}\n          stats={facets.languages}\n        />\n        <RuleFacet\n          fetching={this.props.loadingFacets.rules === true}\n          languages={query.languages}\n          loadSearchResultCount={this.props.loadSearchResultCount}\n          onChange={this.props.onFilterChange}\n          onToggle={this.props.onFacetToggle}\n          open={!!openFacets.rules}\n          organization={organizationKey}\n          query={query}\n          referencedRules={this.props.referencedRules}\n          rules={query.rules}\n          stats={facets.rules}\n        />\n        <TagFacet\n          component={component}\n          fetching={this.props.loadingFacets.tags === true}\n          loadSearchResultCount={this.props.loadSearchResultCount}\n          onChange={this.props.onFilterChange}\n          onToggle={this.props.onFacetToggle}\n          open={!!openFacets.tags}\n          organization={organizationKey}\n          query={query}\n          stats={facets.tags}\n          tags={query.tags}\n        />\n        {displayProjectsFacet && (\n          <ProjectFacet\n            component={component}\n            fetching={this.props.loadingFacets.projects === true}\n            loadSearchResultCount={this.props.loadSearchResultCount}\n            onChange={this.props.onFilterChange}\n            onToggle={this.props.onFacetToggle}\n            open={!!openFacets.projects}\n            organization={this.props.organization}\n            projects={query.projects}\n            query={query}\n            referencedComponents={this.props.referencedComponentsByKey}\n            stats={facets.projects}\n          />\n        )}\n        {this.renderComponentFacets()}\n        {!this.props.myIssues && (\n          <AssigneeFacet\n            assigned={query.assigned}\n            assignees={query.assignees}\n            fetching={this.props.loadingFacets.assignees === true}\n            loadSearchResultCount={this.props.loadSearchResultCount}\n            onChange={this.props.onFilterChange}\n            onToggle={this.props.onFacetToggle}\n            open={!!openFacets.assignees}\n            organization={organizationKey}\n            query={query}\n            referencedUsers={this.props.referencedUsers}\n            stats={facets.assignees}\n          />\n        )}\n        {displayAuthorFacet && (\n          <AuthorFacet\n            authors={query.authors}\n            component={component}\n            fetching={this.props.loadingFacets.authors === true}\n            loadSearchResultCount={this.props.loadSearchResultCount}\n            onChange={this.props.onFilterChange}\n            onToggle={this.props.onFacetToggle}\n            open={!!openFacets.authors}\n            organization={organizationKey}\n            query={query}\n            stats={facets.authors}\n          />\n        )}\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { pickBy, sortBy } from 'lodash';\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport Checkbox from 'sonar-ui-common/components/controls/Checkbox';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport Modal from 'sonar-ui-common/components/controls/Modal';\nimport Radio from 'sonar-ui-common/components/controls/Radio';\nimport SearchSelect from 'sonar-ui-common/components/controls/SearchSelect';\nimport Select from 'sonar-ui-common/components/controls/Select';\nimport IssueTypeIcon from 'sonar-ui-common/components/icons/IssueTypeIcon';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { bulkChangeIssues, searchIssueTags } from '../../../api/issues';\nimport throwGlobalError from '../../../app/utils/throwGlobalError';\nimport MarkdownTips from '../../../components/common/MarkdownTips';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport Avatar from '../../../components/ui/Avatar';\nimport { isLoggedIn, isUserActive } from '../../../helpers/users';\nimport { searchAssignees } from '../utils';\n\ninterface AssigneeOption {\n  avatar?: string;\n  email?: string;\n  label: string;\n  value: string;\n}\n\ninterface TagOption {\n  label: string;\n  value: string;\n}\n\ninterface Props {\n  component: T.Component | undefined;\n  currentUser: T.CurrentUser;\n  fetchIssues: (x: {}) => Promise<{ issues: T.Issue[]; paging: T.Paging }>;\n  onClose: () => void;\n  onDone: () => void;\n  organization: { key: string } | undefined;\n}\n\ninterface FormFields {\n  addTags?: Array<{ label: string; value: string }>;\n  assignee?: AssigneeOption;\n  comment?: string;\n  notifications?: boolean;\n  organization?: string;\n  removeTags?: Array<{ label: string; value: string }>;\n  severity?: string;\n  transition?: string;\n  type?: string;\n}\n\ninterface State extends FormFields {\n  initialTags: Array<{ label: string; value: string }>;\n  issues: T.Issue[];\n  // used for initial loading of issues\n  loading: boolean;\n  paging?: T.Paging;\n  // used when submitting a form\n  submitting: boolean;\n}\n\ntype AssigneeSelectType = new () => SearchSelect<AssigneeOption>;\nconst AssigneeSelect = SearchSelect as AssigneeSelectType;\n\ntype TagSelectType = new () => SearchSelect<TagOption>;\nconst TagSelect = SearchSelect as TagSelectType;\n\nexport const MAX_PAGE_SIZE = 500;\n\nexport default class BulkChangeModal extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    let organization = props.component && props.component.organization;\n    if (props.organization && !organization) {\n      organization = props.organization.key;\n    }\n    this.state = { initialTags: [], issues: [], loading: true, submitting: false, organization };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n\n    Promise.all([\n      this.loadIssues(),\n      searchIssueTags({ organization: this.state.organization })\n    ]).then(\n      ([{ issues, paging }, tags]) => {\n        if (this.mounted) {\n          if (issues.length > MAX_PAGE_SIZE) {\n            issues = issues.slice(0, MAX_PAGE_SIZE);\n          }\n\n          this.setState({\n            initialTags: tags.map(tag => ({ label: tag, value: tag })),\n            issues,\n            loading: false,\n            paging\n          });\n        }\n      },\n      () => {}\n    );\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadIssues = () => {\n    return this.props.fetchIssues({ additionalFields: 'actions,transitions', ps: MAX_PAGE_SIZE });\n  };\n\n  getDefaultAssignee = () => {\n    const { currentUser } = this.props;\n    const { issues } = this.state;\n    const options = [];\n\n    if (isLoggedIn(currentUser)) {\n      const canBeAssignedToMe =\n        issues.filter(issue => issue.assignee !== currentUser.login).length > 0;\n      if (canBeAssignedToMe) {\n        options.push({\n          avatar: currentUser.avatar,\n          label: currentUser.name,\n          value: currentUser.login\n        });\n      }\n    }\n\n    const canBeUnassigned = issues.filter(issue => issue.assignee).length > 0;\n    if (canBeUnassigned) {\n      options.push({ label: translate('unassigned'), value: '' });\n    }\n\n    return options;\n  };\n\n  handleAssigneeSearch = (query: string) => {\n    return searchAssignees(query, this.state.organization).then(({ results }) =>\n      results.map(r => {\n        const userInfo = r.name || r.login;\n\n        return {\n          avatar: r.avatar,\n          label: isUserActive(r) ? userInfo : translateWithParameters('user.x_deleted', userInfo),\n          value: r.login\n        };\n      })\n    );\n  };\n\n  handleAssigneeSelect = (assignee: AssigneeOption) => {\n    this.setState({ assignee });\n  };\n\n  handleTagsSearch = (query: string) => {\n    return searchIssueTags({ organization: this.state.organization, q: query }).then(tags =>\n      tags.map(tag => ({ label: tag, value: tag }))\n    );\n  };\n\n  handleTagsSelect = (field: 'addTags' | 'removeTags') => (\n    options: Array<{ label: string; value: string }>\n  ) => {\n    this.setState<keyof FormFields>({ [field]: options });\n  };\n\n  handleFieldCheck = (field: keyof FormFields) => (checked: boolean) => {\n    if (!checked) {\n      this.setState<keyof FormFields>({ [field]: undefined });\n    } else if (field === 'notifications') {\n      this.setState<keyof FormFields>({ [field]: true });\n    }\n  };\n\n  handleRadioTransitionChange = (transition: string) => {\n    this.setState({ transition });\n  };\n\n  handleCommentChange = (event: React.SyntheticEvent<HTMLTextAreaElement>) => {\n    this.setState({ comment: event.currentTarget.value });\n  };\n\n  handleSelectFieldChange = (field: 'severity' | 'type') => (data: { value: string } | null) => {\n    if (data) {\n      this.setState<keyof FormFields>({ [field]: data.value });\n    } else {\n      this.setState<keyof FormFields>({ [field]: undefined });\n    }\n  };\n\n  handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n\n    const query = pickBy(\n      {\n        add_tags: this.state.addTags && this.state.addTags.map(t => t.value).join(),\n        assign: this.state.assignee ? this.state.assignee.value : null,\n        comment: this.state.comment,\n        do_transition: this.state.transition,\n        remove_tags: this.state.removeTags && this.state.removeTags.map(t => t.value).join(),\n        sendNotifications: this.state.notifications,\n        set_severity: this.state.severity,\n        set_type: this.state.type\n      },\n      x => x !== undefined\n    );\n\n    const issueKeys = this.state.issues.map(issue => issue.key);\n\n    this.setState({ submitting: true });\n    bulkChangeIssues(issueKeys, query).then(\n      () => {\n        this.setState({ submitting: false });\n        this.props.onDone();\n      },\n      error => {\n        this.setState({ submitting: false });\n        throwGlobalError(error);\n      }\n    );\n  };\n\n  getAvailableTransitions(issues: T.Issue[]) {\n    const transitions: T.Dict<number> = {};\n    issues.forEach(issue => {\n      if (issue.transitions) {\n        issue.transitions.forEach(t => {\n          if (transitions[t] !== undefined) {\n            transitions[t]++;\n          } else {\n            transitions[t] = 1;\n          }\n        });\n      }\n    });\n    return sortBy(Object.keys(transitions)).map(transition => ({\n      transition,\n      count: transitions[transition]\n    }));\n  }\n\n  renderLoading = () => (\n    <div>\n      <div className=\"modal-head\">\n        <h2>{translate('bulk_change')}</h2>\n      </div>\n      <div className=\"modal-body\">\n        <div className=\"text-center\">\n          <i className=\"spinner spacer\" />\n        </div>\n      </div>\n      <div className=\"modal-foot\">\n        <ResetButtonLink onClick={this.props.onClose}>{translate('cancel')}</ResetButtonLink>\n      </div>\n    </div>\n  );\n\n  renderAffected = (affected: number) => (\n    <div className=\"pull-right note\">\n      ({translateWithParameters('issue_bulk_change.x_issues', affected)})\n    </div>\n  );\n\n  renderField = (\n    field: 'addTags' | 'assignee' | 'removeTags' | 'severity' | 'type',\n    label: string,\n    affected: number | undefined,\n    input: React.ReactNode\n  ) => (\n    <div className=\"modal-field\" id={`issues-bulk-change-${field}`}>\n      <label htmlFor={field}>{translate(label)}</label>\n      {input}\n      {affected !== undefined && this.renderAffected(affected)}\n    </div>\n  );\n\n  renderAssigneeOption = (option: AssigneeOption) => {\n    return (\n      <span>\n        {option.avatar !== undefined && (\n          <Avatar className=\"spacer-right\" hash={option.avatar} name={option.label} size={16} />\n        )}\n        {option.label}\n      </span>\n    );\n  };\n\n  renderAssigneeField = () => {\n    const affected = this.state.issues.filter(hasAction('assign')).length;\n\n    if (affected === 0) {\n      return null;\n    }\n\n    const input = (\n      <AssigneeSelect\n        className=\"input-super-large\"\n        clearable={true}\n        defaultOptions={this.getDefaultAssignee()}\n        onSearch={this.handleAssigneeSearch}\n        onSelect={this.handleAssigneeSelect}\n        renderOption={this.renderAssigneeOption}\n        resetOnBlur={false}\n        value={this.state.assignee}\n      />\n    );\n\n    return this.renderField('assignee', 'issue.assign.formlink', affected, input);\n  };\n\n  renderTypeField = () => {\n    const affected = this.state.issues.filter(hasAction('set_type')).length;\n\n    if (affected === 0) {\n      return null;\n    }\n\n    const types: T.IssueType[] = ['BUG', 'VULNERABILITY', 'CODE_SMELL'];\n    const options = types.map(type => ({ label: translate('issue.type', type), value: type }));\n\n    const optionRenderer = (option: { label: string; value: string }) => (\n      <>\n        <IssueTypeIcon query={option.value} />\n        <span className=\"little-spacer-left\">{option.label}</span>\n      </>\n    );\n\n    const input = (\n      <Select\n        className=\"input-super-large\"\n        clearable={true}\n        onChange={this.handleSelectFieldChange('type')}\n        optionRenderer={optionRenderer}\n        options={options}\n        searchable={false}\n        value={this.state.type}\n        valueRenderer={optionRenderer}\n      />\n    );\n\n    return this.renderField('type', 'issue.set_type', affected, input);\n  };\n\n  renderSeverityField = () => {\n    const affected = this.state.issues.filter(hasAction('set_severity')).length;\n\n    if (affected === 0) {\n      return null;\n    }\n\n    const severities = ['BLOCKER', 'CRITICAL', 'MAJOR', 'MINOR', 'INFO'];\n    const options = severities.map(severity => ({\n      label: translate('severity', severity),\n      value: severity\n    }));\n\n    const input = (\n      <Select\n        className=\"input-super-large\"\n        clearable={true}\n        onChange={this.handleSelectFieldChange('severity')}\n        optionRenderer={(option: { value: string }) => <SeverityHelper severity={option.value} />}\n        options={options}\n        searchable={false}\n        value={this.state.severity}\n        valueRenderer={(option: { value: string }) => <SeverityHelper severity={option.value} />}\n      />\n    );\n\n    return this.renderField('severity', 'issue.set_severity', affected, input);\n  };\n\n  renderTagOption = (option: TagOption) => {\n    return <span>{option.label}</span>;\n  };\n\n  renderTagsField = (field: 'addTags' | 'removeTags', label: string, allowCreate: boolean) => {\n    const { initialTags } = this.state;\n    const affected = this.state.issues.filter(hasAction('set_tags')).length;\n\n    if (initialTags === undefined || affected === 0) {\n      return null;\n    }\n\n    const input = (\n      <TagSelect\n        canCreate={allowCreate}\n        className=\"input-super-large\"\n        clearable={true}\n        defaultOptions={this.state.initialTags}\n        minimumQueryLength={0}\n        multi={true}\n        onMultiSelect={this.handleTagsSelect(field)}\n        onSearch={this.handleTagsSearch}\n        promptTextCreator={promptCreateTag}\n        renderOption={this.renderTagOption}\n        resetOnBlur={false}\n        value={this.state[field]}\n      />\n    );\n\n    return this.renderField(field, label, affected, input);\n  };\n\n  renderTransitionsField = () => {\n    const transitions = this.getAvailableTransitions(this.state.issues);\n\n    if (transitions.length === 0) {\n      return null;\n    }\n\n    return (\n      <div className=\"modal-field\">\n        <label>{translate('issue.transition')}</label>\n        {transitions.map(transition => (\n          <span\n            className=\"bulk-change-radio-button display-flex-center display-flex-space-between\"\n            key={transition.transition}>\n            <Radio\n              checked={this.state.transition === transition.transition}\n              onCheck={this.handleRadioTransitionChange}\n              value={transition.transition}>\n              {translate('issue.transition', transition.transition)}\n            </Radio>\n            {this.renderAffected(transition.count)}\n          </span>\n        ))}\n      </div>\n    );\n  };\n\n  renderCommentField = () => {\n    const affected = this.state.issues.filter(hasAction('comment')).length;\n\n    if (affected === 0) {\n      return null;\n    }\n\n    return (\n      <div className=\"modal-field\">\n        <label htmlFor=\"comment\">\n          <span className=\"text-middle\">{translate('issue.comment.formlink')}</span>\n          <HelpTooltip\n            className=\"spacer-left\"\n            overlay={translate('issue_bulk_change.comment.help')}\n          />\n        </label>\n        <textarea\n          id=\"comment\"\n          onChange={this.handleCommentChange}\n          rows={4}\n          value={this.state.comment || ''}\n        />\n        <MarkdownTips className=\"modal-field-descriptor text-right\" />\n      </div>\n    );\n  };\n\n  renderNotificationsField = () => (\n    <Checkbox\n      checked={this.state.notifications !== undefined}\n      className=\"display-inline-block spacer-top\"\n      id=\"send-notifications\"\n      onCheck={this.handleFieldCheck('notifications')}\n      right={true}>\n      <strong className=\"little-spacer-right\">{translate('issue.send_notifications')}</strong>\n    </Checkbox>\n  );\n\n  renderForm = () => {\n    const { issues, paging, submitting } = this.state;\n\n    const limitReached = paging && paging.total > MAX_PAGE_SIZE;\n\n    return (\n      <form id=\"bulk-change-form\" onSubmit={this.handleSubmit}>\n        <div className=\"modal-head\">\n          <h2>{translateWithParameters('issue_bulk_change.form.title', issues.length)}</h2>\n        </div>\n\n        <div className=\"modal-body modal-container\">\n          {limitReached && (\n            <Alert variant=\"warning\">\n              <FormattedMessage\n                defaultMessage={translate('issue_bulk_change.max_issues_reached')}\n                id=\"issue_bulk_change.max_issues_reached\"\n                values={{ max: <strong>{MAX_PAGE_SIZE}</strong> }}\n              />\n            </Alert>\n          )}\n\n          {this.renderAssigneeField()}\n          {this.renderTypeField()}\n          {this.renderSeverityField()}\n          {this.renderTagsField('addTags', 'issue.add_tags', true)}\n          {this.renderTagsField('removeTags', 'issue.remove_tags', false)}\n          {this.renderTransitionsField()}\n          {this.renderCommentField()}\n          {issues.length > 0 && this.renderNotificationsField()}\n          {issues.length === 0 && (\n            <Alert variant=\"warning\">{translate('issue_bulk_change.no_match')}</Alert>\n          )}\n        </div>\n\n        <div className=\"modal-foot\">\n          {submitting && <i className=\"spinner spacer-right\" />}\n          <SubmitButton disabled={submitting || issues.length === 0} id=\"bulk-change-submit\">\n            {translate('apply')}\n          </SubmitButton>\n          <ResetButtonLink onClick={this.props.onClose}>{translate('cancel')}</ResetButtonLink>\n        </div>\n      </form>\n    );\n  };\n\n  render() {\n    return (\n      <Modal contentLabel=\"modal\" onRequestClose={this.props.onClose} size=\"small\">\n        {this.state.loading ? this.renderLoading() : this.renderForm()}\n      </Modal>\n    );\n  }\n}\n\nfunction hasAction(action: string) {\n  return (issue: T.Issue) => issue.actions && issue.actions.includes(action);\n}\n\nfunction promptCreateTag(label: string) {\n  return `+ ${label}`;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { collapsePath, limitComponentName } from 'sonar-ui-common/helpers/path';\nimport Organization from '../../../components/shared/Organization';\nimport { getSelectedLocation } from '../utils';\n\ninterface Props {\n  component?: T.Component;\n  issue: Pick<\n    T.Issue,\n    | 'component'\n    | 'componentLongName'\n    | 'flows'\n    | 'organization'\n    | 'project'\n    | 'projectName'\n    | 'secondaryLocations'\n    | 'subProject'\n    | 'subProjectName'\n  >;\n  link?: boolean;\n  organization: { key: string } | undefined;\n  selectedFlowIndex?: number;\n  selectedLocationIndex?: number;\n}\n\nexport default function ComponentBreadcrumbs({\n  component,\n  issue,\n  organization,\n  selectedFlowIndex,\n  selectedLocationIndex\n}: Props) {\n  const displayOrganization =\n    !organization && (!component || ['VW', 'SVW'].includes(component.qualifier));\n  const displayProject = !component || !['TRK', 'BRC', 'DIR'].includes(component.qualifier);\n  const displaySubProject = !component || !['BRC', 'DIR'].includes(component.qualifier);\n\n  const selectedLocation = getSelectedLocation(issue, selectedFlowIndex, selectedLocationIndex);\n  const componentName = selectedLocation ? selectedLocation.componentName : issue.componentLongName;\n\n  return (\n    <div className=\"component-name text-ellipsis\">\n      {displayOrganization && <Organization link={false} organizationKey={issue.organization} />}\n\n      {displayProject && (\n        <span title={issue.projectName}>\n          {limitComponentName(issue.projectName)}\n          <span className=\"slash-separator\" />\n        </span>\n      )}\n\n      {displaySubProject && issue.subProject !== undefined && issue.subProjectName !== undefined && (\n        <span title={issue.subProjectName}>\n          {limitComponentName(issue.subProjectName)}\n          <span className=\"slash-separator\" />\n        </span>\n      )}\n\n      {collapsePath(componentName || '')}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Issue from '../../../components/issue/Issue';\nimport { BranchLike } from '../../../types/branch-like';\nimport { Query } from '../utils';\nimport ComponentBreadcrumbs from './ComponentBreadcrumbs';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  checked: boolean;\n  component: T.Component | undefined;\n  issue: T.Issue;\n  onChange: (issue: T.Issue) => void;\n  onCheck: ((issueKey: string) => void) | undefined;\n  onClick: (issueKey: string) => void;\n  onFilterChange: (changes: Partial<Query>) => void;\n  onPopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  openPopup: string | undefined;\n  organization: { key: string } | undefined;\n  previousIssue: T.Issue | undefined;\n  selected: boolean;\n}\n\nexport default class ListItem extends React.PureComponent<Props> {\n  handleFilter = (property: string, issue: T.Issue) => {\n    const { onFilterChange } = this.props;\n\n    const issuesReset = { issues: [] };\n\n    if (property.startsWith('tag###')) {\n      const tag = property.substr(6);\n      onFilterChange({ ...issuesReset, tags: [tag] });\n    } else {\n      switch (property) {\n        case 'type':\n          onFilterChange({ ...issuesReset, types: [issue.type] });\n          break;\n        case 'severity':\n          onFilterChange({ ...issuesReset, severities: [issue.severity] });\n          break;\n        case 'status':\n          onFilterChange({ ...issuesReset, statuses: [issue.status] });\n          break;\n        case 'resolution':\n          if (issue.resolution) {\n            onFilterChange({ ...issuesReset, resolved: true, resolutions: [issue.resolution] });\n          } else {\n            onFilterChange({ ...issuesReset, resolved: false, resolutions: [] });\n          }\n          break;\n        case 'assignee':\n          if (issue.assignee) {\n            onFilterChange({ ...issuesReset, assigned: true, assignees: [issue.assignee] });\n          } else {\n            onFilterChange({ ...issuesReset, assigned: false, assignees: [] });\n          }\n          break;\n        case 'rule':\n          onFilterChange({ ...issuesReset, rules: [issue.rule] });\n          break;\n        case 'project':\n          onFilterChange({ ...issuesReset, projects: [issue.projectKey] });\n          break;\n        case 'module':\n          if (issue.subProjectUuid) {\n            onFilterChange({ ...issuesReset, modules: [issue.subProjectUuid] });\n          }\n          break;\n        case 'file':\n          onFilterChange({ ...issuesReset, files: [issue.componentUuid] });\n      }\n    }\n  };\n\n  render() {\n    const { branchLike, component, issue, previousIssue } = this.props;\n\n    const displayComponent = !previousIssue || previousIssue.component !== issue.component;\n\n    return (\n      <div className=\"issues-workspace-list-item\">\n        {displayComponent && (\n          <div className=\"issues-workspace-list-component note\">\n            <ComponentBreadcrumbs\n              component={component}\n              issue={this.props.issue}\n              organization={this.props.organization}\n            />\n          </div>\n        )}\n        <Issue\n          branchLike={branchLike}\n          checked={this.props.checked}\n          issue={issue}\n          onChange={this.props.onChange}\n          onCheck={this.props.onCheck}\n          onClick={this.props.onClick}\n          onFilter={this.handleFilter}\n          onPopupToggle={this.props.onPopupToggle}\n          openPopup={this.props.openPopup}\n          selected={this.props.selected}\n        />\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { BranchLike } from '../../../types/branch-like';\nimport { Query, scrollToIssue } from '../utils';\nimport ListItem from './ListItem';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  checked: string[];\n  component: T.Component | undefined;\n  issues: T.Issue[];\n  onFilterChange: (changes: Partial<Query>) => void;\n  onIssueChange: (issue: T.Issue) => void;\n  onIssueCheck: ((issueKey: string) => void) | undefined;\n  onIssueClick: (issueKey: string) => void;\n  onPopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  openPopup: { issue: string; name: string } | undefined;\n  organization: { key: string } | undefined;\n  selectedIssue: T.Issue | undefined;\n}\n\ninterface State {\n  prerender: boolean;\n}\n\nexport default class IssuesList extends React.PureComponent<Props, State> {\n  state: State = {\n    prerender: true\n  };\n\n  componentDidMount() {\n    // ! \\\\ This prerender state variable is to enable the page to be displayed\n    //      immediately, displaying a loader before attempting to render the\n    //      list of issues. See https://jira.sonarsource.com/browse/SONAR-11681\n    setTimeout(() => {\n      this.setState({ prerender: false });\n      if (this.props.selectedIssue) {\n        scrollToIssue(this.props.selectedIssue.key, false);\n      }\n    }, 42);\n  }\n\n  render() {\n    const { branchLike, checked, component, issues, openPopup, selectedIssue } = this.props;\n    const { prerender } = this.state;\n\n    if (prerender) {\n      return (\n        <div>\n          <i className=\"spinner\" />\n        </div>\n      );\n    }\n\n    return (\n      <div>\n        {issues.map((issue, index) => (\n          <ListItem\n            branchLike={branchLike}\n            checked={checked.includes(issue.key)}\n            component={component}\n            issue={issue}\n            key={issue.key}\n            onChange={this.props.onIssueChange}\n            onCheck={this.props.onIssueCheck}\n            onClick={this.props.onIssueClick}\n            onFilterChange={this.props.onFilterChange}\n            onPopupToggle={this.props.onPopupToggle}\n            openPopup={openPopup && openPopup.issue === issue.key ? openPopup.name : undefined}\n            organization={this.props.organization}\n            previousIssue={index > 0 ? issues[index - 1] : undefined}\n            selected={selectedIssue != null && selectedIssue.key === issue.key}\n          />\n        ))}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { lazyLoadComponent } from 'sonar-ui-common/components/lazyLoadComponent';\n\nconst CrossComponentSourceViewer = lazyLoadComponent(\n  () => import(/* webpackPrefetch: true */ './CrossComponentSourceViewerWrapper'),\n  'CrossComponentSourceViewer'\n);\n\nexport default CrossComponentSourceViewer;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { scrollToElement } from 'sonar-ui-common/helpers/scrolling';\nimport SourceViewer from '../../../components/SourceViewer/SourceViewer';\nimport { BranchLike } from '../../../types/branch-like';\nimport CrossComponentSourceViewer from '../crossComponentSourceViewer/CrossComponentSourceViewer';\nimport { getLocations, getSelectedLocation } from '../utils';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  issues: T.Issue[];\n  loadIssues: (component: string, from: number, to: number) => Promise<T.Issue[]>;\n  locationsNavigator: boolean;\n  onIssueChange: (issue: T.Issue) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onLocationSelect: (index: number) => void;\n  openIssue: T.Issue;\n  selectedFlowIndex: number | undefined;\n  selectedLocationIndex: number | undefined;\n}\n\nexport default class IssuesSourceViewer extends React.PureComponent<Props> {\n  node?: HTMLElement | null;\n\n  componentDidUpdate(prevProps: Props) {\n    const { openIssue, selectedLocationIndex } = this.props;\n\n    // Scroll back to the issue when the selected location is set to -1\n    const shouldScrollBackToIssue =\n      selectedLocationIndex === -1 && selectedLocationIndex !== prevProps.selectedLocationIndex;\n    if (\n      prevProps.openIssue.component === openIssue.component &&\n      (prevProps.openIssue !== openIssue || shouldScrollBackToIssue)\n    ) {\n      this.scrollToIssue();\n    }\n  }\n\n  scrollToIssue = (smooth = true) => {\n    if (this.node) {\n      const element = this.node.querySelector(`[data-issue=\"${this.props.openIssue.key}\"]`);\n      if (element) {\n        this.handleScroll(element, undefined, smooth);\n      }\n    }\n  };\n\n  handleScroll = (element: Element, offset = window.innerHeight / 2, smooth = true) => {\n    scrollToElement(element, { topOffset: offset - 100, bottomOffset: offset, smooth });\n  };\n\n  handleLoaded = () => {\n    this.scrollToIssue(false);\n  };\n\n  render() {\n    const { openIssue, selectedFlowIndex, selectedLocationIndex } = this.props;\n\n    const locations = getLocations(openIssue, selectedFlowIndex).map((loc, index) => {\n      loc.index = index;\n      return loc;\n    });\n    const selectedLocation = getSelectedLocation(\n      openIssue,\n      selectedFlowIndex,\n      selectedLocationIndex\n    );\n\n    const highlightedLocationMessage =\n      this.props.locationsNavigator && selectedLocationIndex !== undefined\n        ? selectedLocation && { index: selectedLocationIndex, text: selectedLocation.msg }\n        : undefined;\n\n    if (locations.length > 0) {\n      return (\n        <div ref={node => (this.node = node)}>\n          <CrossComponentSourceViewer\n            branchLike={this.props.branchLike}\n            highlightedLocationMessage={highlightedLocationMessage}\n            issue={openIssue}\n            issues={this.props.issues}\n            locations={locations}\n            onIssueChange={this.props.onIssueChange}\n            onLoaded={this.handleLoaded}\n            onLocationSelect={this.props.onLocationSelect}\n            scroll={this.handleScroll}\n            selectedFlowIndex={selectedFlowIndex}\n          />\n        </div>\n      );\n    } else {\n      // if location is selected, show (and load) code around it\n      // otherwise show code around the open issue\n      const aroundLine = selectedLocation\n        ? selectedLocation.textRange.startLine\n        : openIssue.textRange && openIssue.textRange.endLine;\n\n      const component = selectedLocation ? selectedLocation.component : openIssue.component;\n      const allMessagesEmpty =\n        locations !== undefined && locations.every(location => !location.msg);\n\n      const highlightedLocations = locations.filter(location => location.component === component);\n\n      // do not load issues when open another file for a location\n      const loadIssues =\n        component === openIssue.component ? this.props.loadIssues : () => Promise.resolve([]);\n      const selectedIssue = component === openIssue.component ? openIssue.key : undefined;\n\n      return (\n        <div ref={node => (this.node = node)}>\n          <SourceViewer\n            aroundLine={aroundLine}\n            branchLike={this.props.branchLike}\n            component={component}\n            displayAllIssues={true}\n            displayIssueLocationsCount={true}\n            displayIssueLocationsLink={false}\n            displayLocationMarkers={!allMessagesEmpty}\n            highlightedLocationMessage={highlightedLocationMessage}\n            highlightedLocations={highlightedLocations}\n            loadIssues={loadIssues}\n            onIssueChange={this.props.onIssueChange}\n            onIssueSelect={this.props.onIssueSelect}\n            onLoaded={this.handleLoaded}\n            onLocationSelect={this.props.onLocationSelect}\n            scroll={this.handleScroll}\n            selectedIssue={selectedIssue}\n            slimHeader={true}\n          />\n        </div>\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  myIssues: boolean;\n  onMyIssuesChange: (myIssues: boolean) => void;\n}\n\nexport default class MyIssuesFilter extends React.PureComponent<Props> {\n  handleClick = (myIssues: boolean) => () => {\n    this.props.onMyIssuesChange(myIssues);\n  };\n\n  render() {\n    const { myIssues } = this.props;\n\n    return (\n      <div className=\"issues-my-issues-filter\">\n        <div className=\"button-group\">\n          <Button\n            className={myIssues ? 'button-active' : undefined}\n            onClick={this.handleClick(true)}>\n            {translate('issues.my_issues')}\n          </Button>\n          <Button\n            className={myIssues ? undefined : 'button-active'}\n            onClick={this.handleClick(false)}>\n            {translate('all')}\n          </Button>\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport '../../../components/common/EmptySearch.css';\n\nexport default function NoIssues() {\n  return (\n    <div className=\"empty-search\">\n      <h3>{translate('issues.no_issues')}</h3>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport '../../../components/common/EmptySearch.css';\n\nexport default function NoMyIssues() {\n  return (\n    <div className=\"empty-search\">\n      <h3>{translate('issues.no_my_issues')}</h3>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\n\nexport default function TotalEffort({ effort }: { effort: number }) {\n  return (\n    <div className=\"display-inline-block bordered-left spacer-left\">\n      <div className=\"spacer-left\">\n        <FormattedMessage\n          defaultMessage={translate('issue.x_effort')}\n          id=\"issue.x_effort\"\n          values={{ 0: <strong>{formatMeasure(effort, 'WORK_DUR')}</strong> }}\n        />\n      </div>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ReloadButton from 'sonar-ui-common/components/controls/ReloadButton';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport HomePageSelect from '../../../components/controls/HomePageSelect';\nimport { isSonarCloud } from '../../../helpers/system';\nimport IssuesCounter from './IssuesCounter';\nimport TotalEffort from './TotalEffort';\n\ninterface Props {\n  canSetHome: boolean;\n  effortTotal: number | undefined;\n  onReload: () => void;\n  paging: T.Paging | undefined;\n  selectedIndex: number | undefined;\n}\n\nexport default class PageActions extends React.PureComponent<Props> {\n  renderShortcuts() {\n    return (\n      <span className=\"note big-spacer-right\">\n        <span className=\"big-spacer-right\">\n          <span className=\"shortcut-button little-spacer-right\"></span>\n          <span className=\"shortcut-button little-spacer-right\"></span>\n          {translate('issues.to_select_issues')}\n        </span>\n\n        <span>\n          <span className=\"shortcut-button little-spacer-right\"></span>\n          <span className=\"shortcut-button little-spacer-right\"></span>\n          {translate('issues.to_navigate')}\n        </span>\n      </span>\n    );\n  }\n\n  render() {\n    const { effortTotal, paging, selectedIndex } = this.props;\n\n    return (\n      <div className=\"pull-right\">\n        {this.renderShortcuts()}\n\n        <div className=\"issues-page-actions\">\n          <ReloadButton onClick={this.props.onReload} />\n          {paging != null && (\n            <IssuesCounter className=\"spacer-left\" current={selectedIndex} total={paging.total} />\n          )}\n          {effortTotal !== undefined && <TotalEffort effort={effortTotal} />}\n        </div>\n\n        {this.props.canSetHome && (\n          <HomePageSelect\n            className=\"huge-spacer-left\"\n            currentPage={isSonarCloud() ? { type: 'MY_ISSUES' } : { type: 'ISSUES' }}\n          />\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as key from 'keymaster';\nimport { debounce, keyBy, omit, without } from 'lodash';\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { FormattedMessage } from 'react-intl';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport Checkbox from 'sonar-ui-common/components/controls/Checkbox';\nimport ListFooter from 'sonar-ui-common/components/controls/ListFooter';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport handleRequiredAuthentication from 'sonar-ui-common/helpers/handleRequiredAuthentication';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport {\n  addSideBarClass,\n  addWhitePageClass,\n  removeSideBarClass,\n  removeWhitePageClass\n} from 'sonar-ui-common/helpers/pages';\nimport A11ySkipTarget from '../../../app/components/a11y/A11ySkipTarget';\nimport Suggestions from '../../../app/components/embed-docs-modal/Suggestions';\nimport EmptySearch from '../../../components/common/EmptySearch';\nimport FiltersHeader from '../../../components/common/FiltersHeader';\nimport ScreenPositionHelper from '../../../components/common/ScreenPositionHelper';\nimport { Location, Router } from '../../../components/hoc/withRouter';\nimport '../../../components/search-navigator.css';\nimport {\n  fillBranchLike,\n  getBranchLikeQuery,\n  isPullRequest,\n  isSameBranchLike\n} from '../../../helpers/branch-like';\nimport { isSonarCloud } from '../../../helpers/system';\nimport { BranchLike } from '../../../types/branch-like';\nimport * as actions from '../actions';\nimport ConciseIssuesList from '../conciseIssuesList/ConciseIssuesList';\nimport ConciseIssuesListHeader from '../conciseIssuesList/ConciseIssuesListHeader';\nimport Sidebar from '../sidebar/Sidebar';\nimport '../styles.css';\nimport {\n  areMyIssuesSelected,\n  areQueriesEqual,\n  Facet,\n  getOpen,\n  mapFacet,\n  parseFacets,\n  parseQuery,\n  Query,\n  RawFacet,\n  ReferencedComponent,\n  ReferencedLanguage,\n  ReferencedRule,\n  saveMyIssues,\n  scrollToIssue,\n  serializeQuery,\n  shouldOpenSonarSourceSecurityFacet,\n  shouldOpenStandardsChildFacet,\n  shouldOpenStandardsFacet,\n  STANDARDS\n} from '../utils';\nimport BulkChangeModal, { MAX_PAGE_SIZE } from './BulkChangeModal';\nimport IssuesList from './IssuesList';\nimport IssuesSourceViewer from './IssuesSourceViewer';\nimport MyIssuesFilter from './MyIssuesFilter';\nimport NoIssues from './NoIssues';\nimport NoMyIssues from './NoMyIssues';\nimport PageActions from './PageActions';\n\ninterface FetchIssuesPromise {\n  components: ReferencedComponent[];\n  effortTotal: number;\n  facets: RawFacet[];\n  issues: T.Issue[];\n  languages: ReferencedLanguage[];\n  paging: T.Paging;\n  rules: ReferencedRule[];\n  users: T.UserBase[];\n}\n\ninterface Props {\n  branchLike?: BranchLike;\n  component?: T.Component;\n  currentUser: T.CurrentUser;\n  fetchBranchStatus: (branchLike: BranchLike, projectKey: string) => Promise<void>;\n  fetchIssues: (query: T.RawQuery, requestOrganizations?: boolean) => Promise<FetchIssuesPromise>;\n  hideAuthorFacet?: boolean;\n  location: Location;\n  multiOrganizations?: boolean;\n  myIssues?: boolean;\n  onBranchesChange?: () => void;\n  organization?: { key: string };\n  router: Pick<Router, 'push' | 'replace'>;\n  userOrganizations: T.Organization[];\n}\n\nexport interface State {\n  bulkChangeModal: boolean;\n  cannotShowOpenIssue?: boolean;\n  checkAll?: boolean;\n  checked: string[];\n  effortTotal?: number;\n  facets: T.Dict<Facet>;\n  issues: T.Issue[];\n  loading: boolean;\n  loadingFacets: T.Dict<boolean>;\n  loadingMore: boolean;\n  locationsNavigator: boolean;\n  myIssues: boolean;\n  openFacets: T.Dict<boolean>;\n  openIssue?: T.Issue;\n  openPopup?: { issue: string; name: string };\n  paging?: T.Paging;\n  query: Query;\n  referencedComponentsById: T.Dict<ReferencedComponent>;\n  referencedComponentsByKey: T.Dict<ReferencedComponent>;\n  referencedLanguages: T.Dict<ReferencedLanguage>;\n  referencedRules: T.Dict<ReferencedRule>;\n  referencedUsers: T.Dict<T.UserBase>;\n  selected?: string;\n  selectedFlowIndex?: number;\n  selectedLocationIndex?: number;\n}\n\nconst DEFAULT_QUERY = { resolved: 'false' };\nconst MAX_INITAL_FETCH = 1000;\n\nexport default class App extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    const query = parseQuery(props.location.query);\n    this.state = {\n      bulkChangeModal: false,\n      checked: [],\n      facets: {},\n      issues: [],\n      loading: true,\n      loadingFacets: {},\n      loadingMore: false,\n      locationsNavigator: false,\n      myIssues: props.myIssues || areMyIssuesSelected(props.location.query),\n      openFacets: {\n        owaspTop10: shouldOpenStandardsChildFacet({}, query, 'owaspTop10'),\n        sansTop25: shouldOpenStandardsChildFacet({}, query, 'sansTop25'),\n        severities: true,\n        sonarsourceSecurity: shouldOpenSonarSourceSecurityFacet({}, query),\n        standards: shouldOpenStandardsFacet({}, query),\n        types: true\n      },\n      query,\n      referencedComponentsById: {},\n      referencedComponentsByKey: {},\n      referencedLanguages: {},\n      referencedRules: {},\n      referencedUsers: {},\n      selected: getOpen(props.location.query)\n    };\n    this.refreshBranchStatus = debounce(this.refreshBranchStatus, 1000);\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n\n    if (this.state.myIssues && !this.props.currentUser.isLoggedIn) {\n      handleRequiredAuthentication();\n      return;\n    }\n\n    addWhitePageClass();\n    addSideBarClass();\n    this.attachShortcuts();\n    this.fetchFirstIssues();\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    const { issues, selected } = this.state;\n    const openIssue = this.getOpenIssue(nextProps, issues);\n\n    if (openIssue && openIssue.key !== selected) {\n      this.setState({\n        locationsNavigator: false,\n        selected: openIssue.key,\n        selectedFlowIndex: undefined,\n        selectedLocationIndex: undefined\n      });\n    }\n\n    if (!openIssue) {\n      this.setState({ selectedFlowIndex: undefined, selectedLocationIndex: undefined });\n    }\n\n    this.setState({\n      myIssues: nextProps.myIssues || areMyIssuesSelected(nextProps.location.query),\n      openIssue,\n      query: parseQuery(nextProps.location.query)\n    });\n  }\n\n  componentDidUpdate(prevProps: Props, prevState: State) {\n    const { query } = this.props.location;\n    const { query: prevQuery } = prevProps.location;\n    if (\n      prevProps.component !== this.props.component ||\n      !isSameBranchLike(prevProps.branchLike, this.props.branchLike) ||\n      !areQueriesEqual(prevQuery, query) ||\n      areMyIssuesSelected(prevQuery) !== areMyIssuesSelected(query)\n    ) {\n      this.fetchFirstIssues();\n      this.setState({ checkAll: false });\n    } else if (\n      !this.state.openIssue &&\n      (prevState.selected !== this.state.selected || prevState.openIssue)\n    ) {\n      // if user simply selected another issue\n      // or if he went from the source code back to the list of issues\n      this.scrollToSelectedIssue();\n    }\n  }\n\n  componentWillUnmount() {\n    this.detachShortcuts();\n    this.mounted = false;\n    removeWhitePageClass();\n    removeSideBarClass();\n  }\n\n  attachShortcuts() {\n    key.setScope('issues');\n    key('up', 'issues', () => {\n      this.selectPreviousIssue();\n      return false;\n    });\n    key('down', 'issues', () => {\n      this.selectNextIssue();\n      return false;\n    });\n    key('right', 'issues', () => {\n      this.openSelectedIssue();\n      return false;\n    });\n    key('left', 'issues', () => {\n      if (this.state.query.issues.length !== 1) {\n        this.closeIssue();\n      }\n      return false;\n    });\n    window.addEventListener('keydown', this.handleKeyDown);\n    window.addEventListener('keyup', this.handleKeyUp);\n  }\n\n  detachShortcuts() {\n    key.deleteScope('issues');\n    window.removeEventListener('keydown', this.handleKeyDown);\n    window.removeEventListener('keyup', this.handleKeyUp);\n  }\n\n  handleKeyDown = (event: KeyboardEvent) => {\n    if (key.getScope() !== 'issues') {\n      return;\n    }\n    if (event.keyCode === 18) {\n      // alt\n      event.preventDefault();\n      this.setState(actions.enableLocationsNavigator);\n    } else if (event.keyCode === 40 && event.altKey) {\n      // alt + down\n      event.preventDefault();\n      this.selectNextLocation();\n    } else if (event.keyCode === 38 && event.altKey) {\n      // alt + up\n      event.preventDefault();\n      this.selectPreviousLocation();\n    } else if (event.keyCode === 37 && event.altKey) {\n      // alt + left\n      event.preventDefault();\n      this.selectPreviousFlow();\n    } else if (event.keyCode === 39 && event.altKey) {\n      // alt + right\n      event.preventDefault();\n      this.selectNextFlow();\n    }\n  };\n\n  handleKeyUp = (event: KeyboardEvent) => {\n    if (key.getScope() !== 'issues') {\n      return;\n    }\n    if (event.keyCode === 18) {\n      // alt\n      this.setState(actions.disableLocationsNavigator);\n    }\n  };\n\n  getSelectedIndex() {\n    const { issues = [], selected } = this.state;\n    const index = issues.findIndex(issue => issue.key === selected);\n    return index !== -1 ? index : undefined;\n  }\n\n  getOpenIssue = (props: Props, issues: T.Issue[]) => {\n    const open = getOpen(props.location.query);\n    return open ? issues.find(issue => issue.key === open) : undefined;\n  };\n\n  selectNextIssue = () => {\n    const { issues } = this.state;\n    const selectedIndex = this.getSelectedIndex();\n    if (selectedIndex !== undefined && selectedIndex < issues.length - 1) {\n      if (this.state.openIssue) {\n        this.openIssue(issues[selectedIndex + 1].key);\n      } else {\n        this.setState({\n          selected: issues[selectedIndex + 1].key,\n          selectedFlowIndex: undefined,\n          selectedLocationIndex: undefined\n        });\n      }\n    }\n  };\n\n  selectPreviousIssue = () => {\n    const { issues } = this.state;\n    const selectedIndex = this.getSelectedIndex();\n    if (selectedIndex !== undefined && selectedIndex > 0) {\n      if (this.state.openIssue) {\n        this.openIssue(issues[selectedIndex - 1].key);\n      } else {\n        this.setState({\n          selected: issues[selectedIndex - 1].key,\n          selectedFlowIndex: undefined,\n          selectedLocationIndex: undefined\n        });\n      }\n    }\n  };\n\n  openIssue = (issueKey: string) => {\n    const path = {\n      pathname: this.props.location.pathname,\n      query: {\n        ...serializeQuery(this.state.query),\n        ...getBranchLikeQuery(this.props.branchLike),\n        id: this.props.component && this.props.component.key,\n        myIssues: this.state.myIssues ? 'true' : undefined,\n        open: issueKey\n      }\n    };\n    if (this.state.openIssue) {\n      if (path.query.open && path.query.open === this.state.openIssue.key) {\n        this.setState(\n          {\n            locationsNavigator: false,\n            selectedFlowIndex: undefined,\n            selectedLocationIndex: undefined\n          },\n          this.scrollToSelectedIssue\n        );\n      } else {\n        this.props.router.replace(path);\n      }\n    } else {\n      this.props.router.push(path);\n    }\n  };\n\n  closeIssue = () => {\n    if (this.state.query) {\n      this.props.router.push({\n        pathname: this.props.location.pathname,\n        query: {\n          ...serializeQuery(this.state.query),\n          ...getBranchLikeQuery(this.props.branchLike),\n          id: this.props.component && this.props.component.key,\n          myIssues: this.state.myIssues ? 'true' : undefined,\n          open: undefined\n        }\n      });\n    }\n  };\n\n  openSelectedIssue = () => {\n    const { selected } = this.state;\n    if (selected) {\n      this.openIssue(selected);\n    }\n  };\n\n  scrollToSelectedIssue = (smooth = true) => {\n    const { selected } = this.state;\n    if (selected) {\n      scrollToIssue(selected, smooth);\n    }\n  };\n\n  fetchIssues = (\n    additional: T.RawQuery,\n    requestFacets = false,\n    requestOrganizations = true\n  ): Promise<FetchIssuesPromise> => {\n    const { component } = this.props;\n    const { myIssues, openFacets, query } = this.state;\n\n    const facets = requestFacets\n      ? Object.keys(openFacets)\n          .filter(facet => openFacets[facet])\n          .filter(facet => facet !== STANDARDS)\n          .map(mapFacet)\n          .join(',')\n      : undefined;\n\n    const organizationKey =\n      (component && component.organization) ||\n      (this.props.organization && this.props.organization.key);\n\n    const parameters = {\n      ...getBranchLikeQuery(this.props.branchLike),\n      componentKeys: component && component.key,\n      s: 'FILE_LINE',\n      ...serializeQuery(query),\n      ps: '100',\n      organization: organizationKey,\n      facets,\n      ...additional\n    };\n\n    // only sorting by CREATION_DATE is allowed, so let's sort DESC\n    if (query.sort) {\n      Object.assign(parameters, { asc: 'false' });\n    }\n\n    if (myIssues) {\n      Object.assign(parameters, { assignees: '__me__' });\n    }\n\n    return this.props.fetchIssues(\n      parameters,\n      Boolean(requestOrganizations && this.props.multiOrganizations)\n    );\n  };\n\n  fetchFirstIssues() {\n    const prevQuery = this.props.location.query;\n    const openIssueKey = getOpen(this.props.location.query);\n    let fetchPromise;\n\n    this.setState({ checked: [], loading: true });\n    if (openIssueKey !== undefined) {\n      fetchPromise = this.fetchIssuesUntil(1, (pageIssues: T.Issue[], paging: T.Paging) => {\n        if (\n          paging.total <= paging.pageIndex * paging.pageSize ||\n          paging.pageIndex * paging.pageSize >= MAX_INITAL_FETCH\n        ) {\n          return true;\n        }\n        return pageIssues.some(issue => issue.key === openIssueKey);\n      });\n    } else {\n      fetchPromise = this.fetchIssues({}, true);\n    }\n\n    return fetchPromise.then(\n      ({ effortTotal, facets, issues, paging, ...other }) => {\n        if (this.mounted && areQueriesEqual(prevQuery, this.props.location.query)) {\n          const openIssue = this.getOpenIssue(this.props, issues);\n          let selected: string | undefined = undefined;\n          if (issues.length > 0) {\n            selected = openIssue ? openIssue.key : issues[0].key;\n          }\n          this.setState(state => ({\n            cannotShowOpenIssue: Boolean(openIssueKey && !openIssue),\n            effortTotal,\n            facets: { ...state.facets, ...parseFacets(facets) },\n            loading: false,\n            issues,\n            openIssue,\n            paging,\n            referencedComponentsById: keyBy(other.components, 'uuid'),\n            referencedComponentsByKey: keyBy(other.components, 'key'),\n            referencedLanguages: keyBy(other.languages, 'key'),\n            referencedRules: keyBy(other.rules, 'key'),\n            referencedUsers: keyBy(other.users, 'login'),\n            selected,\n            selectedFlowIndex: undefined,\n            selectedLocationIndex: undefined\n          }));\n        }\n        return issues;\n      },\n      () => {\n        if (this.mounted && areQueriesEqual(prevQuery, this.props.location.query)) {\n          this.setState({ loading: false });\n        }\n        return [];\n      }\n    );\n  }\n\n  fetchIssuesPage = (p: number) => {\n    return this.fetchIssues({ p });\n  };\n\n  fetchIssuesUntil = (\n    p: number,\n    done: (pageIssues: T.Issue[], paging: T.Paging) => boolean\n  ): Promise<FetchIssuesPromise> => {\n    const recursiveFetch = (p: number, prevIssues: T.Issue[]): Promise<FetchIssuesPromise> => {\n      return this.fetchIssuesPage(p).then(({ issues: pageIssues, paging, ...other }) => {\n        const issues = [...prevIssues, ...pageIssues];\n        return done(pageIssues, paging)\n          ? { issues, paging, ...other }\n          : recursiveFetch(p + 1, issues);\n      });\n    };\n\n    return recursiveFetch(p, []);\n  };\n\n  fetchMoreIssues = () => {\n    const { paging } = this.state;\n\n    if (!paging) {\n      return Promise.reject();\n    }\n\n    const p = paging.pageIndex + 1;\n\n    this.setState({ checkAll: false, loadingMore: true });\n    return this.fetchIssuesPage(p).then(\n      response => {\n        if (this.mounted) {\n          this.setState(state => ({\n            loadingMore: false,\n            issues: [...state.issues, ...response.issues],\n            paging: response.paging\n          }));\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loadingMore: false });\n        }\n      }\n    );\n  };\n\n  fetchIssuesForComponent = (_component: string, _from: number, to: number) => {\n    const { issues, openIssue, paging } = this.state;\n\n    if (!openIssue || !paging) {\n      return Promise.reject(undefined);\n    }\n\n    const isSameComponent = (issue: T.Issue) => issue.component === openIssue.component;\n\n    const done = (pageIssues: T.Issue[], paging: T.Paging) => {\n      const lastIssue = pageIssues[pageIssues.length - 1];\n      if (paging.total <= paging.pageIndex * paging.pageSize) {\n        return true;\n      }\n      if (lastIssue.component !== openIssue.component) {\n        return true;\n      }\n      return lastIssue.textRange !== undefined && lastIssue.textRange.endLine > to;\n    };\n\n    if (done(issues, paging)) {\n      return Promise.resolve(issues.filter(isSameComponent));\n    }\n\n    this.setState({ loading: true });\n    return this.fetchIssuesUntil(paging.pageIndex + 1, done).then(\n      response => {\n        const nextIssues = [...issues, ...response.issues];\n        if (this.mounted) {\n          this.setState({\n            issues: nextIssues,\n            loading: false,\n            paging: response.paging\n          });\n        }\n        return nextIssues.filter(isSameComponent);\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n        return [];\n      }\n    );\n  };\n\n  fetchFacet = (facet: string) => {\n    const requestOrganizations = facet === 'projects';\n    return this.fetchIssues({ ps: 1, facets: mapFacet(facet) }, false, requestOrganizations).then(\n      ({ facets, ...other }) => {\n        if (this.mounted) {\n          this.setState(state => ({\n            facets: { ...state.facets, ...parseFacets(facets) },\n            loadingFacets: omit(state.loadingFacets, facet),\n            referencedComponentsById: {\n              ...state.referencedComponentsById,\n              ...keyBy(other.components, 'uuid')\n            },\n            referencedComponentsByKey: {\n              ...state.referencedComponentsByKey,\n              ...keyBy(other.components, 'key')\n            },\n            referencedLanguages: {\n              ...state.referencedLanguages,\n              ...keyBy(other.languages, 'key')\n            },\n            referencedRules: { ...state.referencedRules, ...keyBy(other.rules, 'key') },\n            referencedUsers: { ...state.referencedUsers, ...keyBy(other.users, 'login') }\n          }));\n        }\n      },\n      () => {}\n    );\n  };\n\n  isFiltered = () => {\n    const serialized = serializeQuery(this.state.query);\n    return !areQueriesEqual(serialized, DEFAULT_QUERY);\n  };\n\n  getCheckedIssues = () => {\n    const issues = this.state.checked\n      .map(checked => this.state.issues.find(issue => issue.key === checked))\n      .filter((issue): issue is T.Issue => issue !== undefined);\n    const paging = { pageIndex: 1, pageSize: issues.length, total: issues.length };\n    return Promise.resolve({ issues, paging });\n  };\n\n  getButtonLabel = (checked: string[], checkAll?: boolean, paging?: T.Paging) => {\n    if (checked.length > 0) {\n      let count;\n      if (checkAll && paging) {\n        count = paging.total > MAX_PAGE_SIZE ? MAX_PAGE_SIZE : paging.total;\n      } else {\n        count = Math.min(checked.length, MAX_PAGE_SIZE);\n      }\n\n      return translateWithParameters('issues.bulk_change_X_issues', count);\n    } else {\n      return translate('bulk_change');\n    }\n  };\n\n  handleFilterChange = (changes: Partial<Query>) => {\n    this.props.router.push({\n      pathname: this.props.location.pathname,\n      query: {\n        ...serializeQuery({ ...this.state.query, ...changes }),\n        ...getBranchLikeQuery(this.props.branchLike),\n        id: this.props.component && this.props.component.key,\n        myIssues: this.state.myIssues ? 'true' : undefined\n      }\n    });\n    this.setState(({ openFacets }) => ({\n      openFacets: {\n        ...openFacets,\n        sonarsourceSecurity: shouldOpenSonarSourceSecurityFacet(openFacets, changes),\n        standards: shouldOpenStandardsFacet(openFacets, changes)\n      }\n    }));\n  };\n\n  handleMyIssuesChange = (myIssues: boolean) => {\n    this.closeFacet('assignees');\n    if (!this.props.component) {\n      saveMyIssues(myIssues);\n    }\n    this.props.router.push({\n      pathname: this.props.location.pathname,\n      query: {\n        ...serializeQuery({ ...this.state.query, assigned: true, assignees: [] }),\n        ...getBranchLikeQuery(this.props.branchLike),\n        id: this.props.component && this.props.component.key,\n        myIssues: myIssues ? 'true' : undefined\n      }\n    });\n  };\n\n  loadSearchResultCount = (property: string, changes: Partial<Query>) => {\n    const { component } = this.props;\n    const { myIssues, query } = this.state;\n\n    const organizationKey =\n      (component && component.organization) ||\n      (this.props.organization && this.props.organization.key);\n\n    const parameters = {\n      ...getBranchLikeQuery(this.props.branchLike),\n      componentKeys: component && component.key,\n      facets: mapFacet(property),\n      s: 'FILE_LINE',\n      ...serializeQuery({ ...query, ...changes }),\n      ps: 1,\n      organization: organizationKey\n    };\n\n    if (myIssues) {\n      Object.assign(parameters, { assignees: '__me__' });\n    }\n\n    return this.props\n      .fetchIssues(parameters, false)\n      .then(({ facets }) => parseFacets(facets)[property]);\n  };\n\n  closeFacet = (property: string) => {\n    this.setState(state => ({\n      openFacets: { ...state.openFacets, [property]: false }\n    }));\n  };\n\n  handleFacetToggle = (property: string) => {\n    this.setState(state => {\n      const willOpenProperty = !state.openFacets[property];\n      const newState = {\n        loadingFacets: state.loadingFacets,\n        openFacets: { ...state.openFacets, [property]: willOpenProperty }\n      };\n\n      // Try to open sonarsource security \"subfacet\" by default if the standard facet is open\n      if (willOpenProperty && property === STANDARDS) {\n        newState.openFacets.sonarsourceSecurity = shouldOpenSonarSourceSecurityFacet(\n          newState.openFacets,\n          state.query\n        );\n        // Force loading of sonarsource security facet data\n        property = newState.openFacets.sonarsourceSecurity ? 'sonarsourceSecurity' : property;\n      }\n\n      // No need to load facets data for standard facet\n      if (property !== STANDARDS && !state.facets[property]) {\n        newState.loadingFacets[property] = true;\n        this.fetchFacet(property);\n      }\n\n      return newState;\n    });\n  };\n\n  handleReset = () => {\n    this.props.router.push({\n      pathname: this.props.location.pathname,\n      query: {\n        ...DEFAULT_QUERY,\n        ...getBranchLikeQuery(this.props.branchLike),\n        id: this.props.component && this.props.component.key,\n        myIssues: this.state.myIssues ? 'true' : undefined\n      }\n    });\n  };\n\n  handlePopupToggle = (issue: string, popupName: string, open?: boolean) => {\n    this.setState((state: State) => {\n      const { openPopup } = state;\n      const samePopup = openPopup && openPopup.name === popupName && openPopup.issue === issue;\n\n      if (open !== false && !samePopup) {\n        return { ...state, openPopup: { issue, name: popupName } };\n      } else if (open !== true && samePopup) {\n        return { ...state, openPopup: undefined };\n      }\n\n      return state;\n    });\n  };\n\n  handleIssueCheck = (issue: string) => {\n    this.setState(state => ({\n      checkAll: false,\n      checked: state.checked.includes(issue)\n        ? without(state.checked, issue)\n        : [...state.checked, issue]\n    }));\n  };\n\n  handleIssueChange = (issue: T.Issue) => {\n    this.refreshBranchStatus();\n    this.setState(state => ({\n      issues: state.issues.map(candidate => (candidate.key === issue.key ? issue : candidate))\n    }));\n  };\n\n  handleOpenBulkChange = () => {\n    key.setScope('issues-bulk-change');\n    this.setState({ bulkChangeModal: true });\n  };\n\n  handleCloseBulkChange = () => {\n    key.setScope('issues');\n    this.setState({ bulkChangeModal: false });\n  };\n\n  handleBulkChangeDone = () => {\n    this.setState({ checkAll: false });\n    this.refreshBranchStatus();\n    this.fetchFirstIssues();\n    this.handleCloseBulkChange();\n  };\n\n  handleReload = () => {\n    this.fetchFirstIssues();\n    this.refreshBranchStatus();\n    const { branchLike, onBranchesChange } = this.props;\n    if (onBranchesChange && isPullRequest(branchLike)) {\n      onBranchesChange();\n    }\n  };\n\n  handleReloadAndOpenFirst = () => {\n    this.fetchFirstIssues().then(\n      (issues: T.Issue[]) => {\n        if (issues.length > 0) {\n          this.openIssue(issues[0].key);\n        }\n      },\n      () => {}\n    );\n  };\n\n  selectLocation = (index: number) => {\n    this.setState(actions.selectLocation(index));\n  };\n\n  selectNextLocation = () => {\n    this.setState(actions.selectNextLocation);\n  };\n\n  selectPreviousLocation = () => {\n    this.setState(actions.selectPreviousLocation);\n  };\n\n  handleCheckAll = (checked: boolean) => {\n    if (checked) {\n      this.setState(state => ({\n        checkAll: true,\n        checked: state.issues.map(issue => issue.key)\n      }));\n    } else {\n      this.setState({ checkAll: false, checked: [] });\n    }\n  };\n\n  selectFlow = (index?: number) => {\n    this.setState(actions.selectFlow(index));\n  };\n\n  selectNextFlow = () => {\n    this.setState(actions.selectNextFlow);\n  };\n\n  selectPreviousFlow = () => {\n    this.setState(actions.selectPreviousFlow);\n  };\n\n  refreshBranchStatus = () => {\n    const { branchLike, component } = this.props;\n    if (branchLike && component && isPullRequest(branchLike)) {\n      this.props.fetchBranchStatus(branchLike, component.key);\n    }\n  };\n\n  renderBulkChange(openIssue: T.Issue | undefined) {\n    const { component, currentUser } = this.props;\n    const { checkAll, bulkChangeModal, checked, issues, paging } = this.state;\n\n    const isAllChecked = checked.length > 0 && issues.length === checked.length;\n    const thirdState = checked.length > 0 && !isAllChecked;\n    const isChecked = isAllChecked || thirdState;\n\n    if (!currentUser.isLoggedIn || openIssue) {\n      return null;\n    }\n\n    return (\n      <div className=\"pull-left\">\n        <Checkbox\n          checked={isChecked}\n          className=\"spacer-right text-middle\"\n          disabled={issues.length === 0}\n          id=\"issues-selection\"\n          onCheck={this.handleCheckAll}\n          thirdState={thirdState}\n          title={translate('issues.select_all_issues')}\n        />\n        <Button\n          disabled={checked.length === 0}\n          id=\"issues-bulk-change\"\n          onClick={this.handleOpenBulkChange}>\n          {this.getButtonLabel(checked, checkAll, paging)}\n        </Button>\n\n        {bulkChangeModal && (\n          <BulkChangeModal\n            component={component}\n            currentUser={currentUser}\n            fetchIssues={checkAll ? this.fetchIssues : this.getCheckedIssues}\n            onClose={this.handleCloseBulkChange}\n            onDone={this.handleBulkChangeDone}\n            organization={this.props.organization}\n          />\n        )}\n      </div>\n    );\n  }\n\n  renderFacets() {\n    const { component, currentUser, userOrganizations } = this.props;\n    const { query } = this.state;\n\n    const organizationKey =\n      (component && component.organization) ||\n      (this.props.organization && this.props.organization.key);\n\n    const userOrganization =\n      !isSonarCloud() ||\n      userOrganizations.find(o => {\n        return o.key === organizationKey;\n      });\n    const hideAuthorFacet =\n      this.props.hideAuthorFacet || (isSonarCloud() && this.props.myIssues) || !userOrganization;\n\n    return (\n      <div className=\"layout-page-filters\">\n        {currentUser.isLoggedIn && !isSonarCloud() && (\n          <MyIssuesFilter\n            myIssues={this.state.myIssues}\n            onMyIssuesChange={this.handleMyIssuesChange}\n          />\n        )}\n        <FiltersHeader displayReset={this.isFiltered()} onReset={this.handleReset} />\n        <Sidebar\n          component={component}\n          facets={this.state.facets}\n          hideAuthorFacet={hideAuthorFacet}\n          loadSearchResultCount={this.loadSearchResultCount}\n          loadingFacets={this.state.loadingFacets}\n          myIssues={this.state.myIssues}\n          onFacetToggle={this.handleFacetToggle}\n          onFilterChange={this.handleFilterChange}\n          openFacets={this.state.openFacets}\n          organization={this.props.organization}\n          query={query}\n          referencedComponentsById={this.state.referencedComponentsById}\n          referencedComponentsByKey={this.state.referencedComponentsByKey}\n          referencedLanguages={this.state.referencedLanguages}\n          referencedRules={this.state.referencedRules}\n          referencedUsers={this.state.referencedUsers}\n        />\n      </div>\n    );\n  }\n\n  renderConciseIssuesList() {\n    const { issues, loadingMore, paging, query } = this.state;\n\n    return (\n      <div className=\"layout-page-filters\">\n        <ConciseIssuesListHeader\n          displayBackButton={query.issues.length !== 1}\n          loading={this.state.loading}\n          onBackClick={this.closeIssue}\n          onReload={this.handleReloadAndOpenFirst}\n          paging={paging}\n          selectedIndex={this.getSelectedIndex()}\n        />\n        <ConciseIssuesList\n          issues={issues}\n          onFlowSelect={this.selectFlow}\n          onIssueSelect={this.openIssue}\n          onLocationSelect={this.selectLocation}\n          selected={this.state.selected}\n          selectedFlowIndex={this.state.selectedFlowIndex}\n          selectedLocationIndex={this.state.selectedLocationIndex}\n        />\n        {paging && paging.total > 0 && (\n          <ListFooter\n            count={issues.length}\n            loadMore={this.fetchMoreIssues}\n            loading={loadingMore}\n            total={paging.total}\n          />\n        )}\n      </div>\n    );\n  }\n\n  renderSide(openIssue: T.Issue | undefined) {\n    return (\n      <ScreenPositionHelper className=\"layout-page-side-outer\">\n        {({ top }) => (\n          <div className=\"layout-page-side\" style={{ top }}>\n            <div className=\"layout-page-side-inner\">\n              <A11ySkipTarget\n                anchor=\"issues_sidebar\"\n                label={\n                  openIssue ? translate('issues.skip_to_list') : translate('issues.skip_to_filters')\n                }\n                weight={10}\n              />\n              {openIssue ? this.renderConciseIssuesList() : this.renderFacets()}\n            </div>\n          </div>\n        )}\n      </ScreenPositionHelper>\n    );\n  }\n\n  renderList() {\n    const { branchLike, component, currentUser, organization } = this.props;\n    const { issues, loading, loadingMore, openIssue, paging } = this.state;\n    const selectedIndex = this.getSelectedIndex();\n    const selectedIssue = selectedIndex !== undefined ? issues[selectedIndex] : undefined;\n\n    if (!paging || openIssue) {\n      return null;\n    }\n\n    let noIssuesMessage = null;\n    if (paging.total === 0 && !loading) {\n      if (this.isFiltered()) {\n        noIssuesMessage = <EmptySearch />;\n      } else if (this.state.myIssues) {\n        noIssuesMessage = <NoMyIssues />;\n      } else {\n        noIssuesMessage = <NoIssues />;\n      }\n    }\n\n    return (\n      <div>\n        {paging.total > 0 && (\n          <IssuesList\n            branchLike={branchLike}\n            checked={this.state.checked}\n            component={component}\n            issues={issues}\n            onFilterChange={this.handleFilterChange}\n            onIssueChange={this.handleIssueChange}\n            onIssueCheck={currentUser.isLoggedIn ? this.handleIssueCheck : undefined}\n            onIssueClick={this.openIssue}\n            onPopupToggle={this.handlePopupToggle}\n            openPopup={this.state.openPopup}\n            organization={organization}\n            selectedIssue={selectedIssue}\n          />\n        )}\n\n        {paging.total > 0 && (\n          <ListFooter\n            count={issues.length}\n            loadMore={this.fetchMoreIssues}\n            loading={loadingMore}\n            total={paging.total}\n          />\n        )}\n\n        {noIssuesMessage}\n      </div>\n    );\n  }\n\n  renderHeader({\n    openIssue,\n    paging,\n    selectedIndex\n  }: {\n    openIssue: T.Issue | undefined;\n    paging: T.Paging | undefined;\n    selectedIndex: number | undefined;\n  }) {\n    return openIssue ? (\n      <A11ySkipTarget anchor=\"issues_main\" />\n    ) : (\n      <div className=\"layout-page-header-panel layout-page-main-header issues-main-header\">\n        <div className=\"layout-page-header-panel-inner layout-page-main-header-inner\">\n          <div className=\"layout-page-main-inner\">\n            <A11ySkipTarget anchor=\"issues_main\" />\n\n            {this.renderBulkChange(openIssue)}\n            <PageActions\n              canSetHome={Boolean(\n                !this.props.organization &&\n                  !this.props.component &&\n                  (!isSonarCloud() || this.props.myIssues)\n              )}\n              effortTotal={this.state.effortTotal}\n              onReload={this.handleReload}\n              paging={paging}\n              selectedIndex={selectedIndex}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  renderPage() {\n    const { cannotShowOpenIssue, checkAll, issues, loading, openIssue, paging } = this.state;\n    return (\n      <div className=\"layout-page-main-inner\">\n        {openIssue ? (\n          <IssuesSourceViewer\n            branchLike={fillBranchLike(openIssue.branch, openIssue.pullRequest)}\n            issues={issues}\n            loadIssues={this.fetchIssuesForComponent}\n            locationsNavigator={this.state.locationsNavigator}\n            onIssueChange={this.handleIssueChange}\n            onIssueSelect={this.openIssue}\n            onLocationSelect={this.selectLocation}\n            openIssue={openIssue}\n            selectedFlowIndex={this.state.selectedFlowIndex}\n            selectedLocationIndex={this.state.selectedLocationIndex}\n          />\n        ) : (\n          <DeferredSpinner loading={loading}>\n            {checkAll && paging && paging.total > MAX_PAGE_SIZE && (\n              <Alert className=\"big-spacer-bottom\" variant=\"warning\">\n                <FormattedMessage\n                  defaultMessage={translate('issue_bulk_change.max_issues_reached')}\n                  id=\"issue_bulk_change.max_issues_reached\"\n                  values={{ max: <strong>{MAX_PAGE_SIZE}</strong> }}\n                />\n              </Alert>\n            )}\n            {cannotShowOpenIssue && (\n              <Alert className=\"big-spacer-bottom\" variant=\"warning\">\n                {translateWithParameters(\n                  'issues.cannot_open_issue_max_initial_X_fetched',\n                  MAX_INITAL_FETCH\n                )}\n              </Alert>\n            )}\n            {this.renderList()}\n          </DeferredSpinner>\n        )}\n      </div>\n    );\n  }\n\n  render() {\n    const { openIssue, paging } = this.state;\n    const selectedIndex = this.getSelectedIndex();\n    return (\n      <div className=\"layout-page issues\" id=\"issues-page\">\n        <Suggestions suggestions=\"issues\" />\n        <Helmet defer={false} title={openIssue ? openIssue.message : translate('issues.page')} />\n\n        {this.renderSide(openIssue)}\n\n        <div className=\"layout-page-main\">\n          {this.renderHeader({ openIssue, paging, selectedIndex })}\n\n          {this.renderPage()}\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { SuggestionsContext } from './SuggestionsContext';\n\ninterface Props {\n  suggestions: string;\n}\n\nexport default function Suggestions({ suggestions }: Props) {\n  return (\n    <SuggestionsContext.Consumer>\n      {({ addSuggestions, removeSuggestions }) => (\n        <SuggestionsInner\n          addSuggestions={addSuggestions}\n          removeSuggestions={removeSuggestions}\n          suggestions={suggestions}\n        />\n      )}\n    </SuggestionsContext.Consumer>\n  );\n}\n\ninterface SuggestionsInnerProps {\n  addSuggestions: (key: string) => void;\n  removeSuggestions: (key: string) => void;\n  suggestions: string;\n}\n\nclass SuggestionsInner extends React.PureComponent<SuggestionsInnerProps> {\n  componentDidMount() {\n    this.props.addSuggestions(this.props.suggestions);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.suggestions !== this.props.suggestions) {\n      this.props.removeSuggestions(this.props.suggestions);\n      this.props.addSuggestions(prevProps.suggestions);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.removeSuggestions(this.props.suggestions);\n  }\n\n  render() {\n    return null;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { A11yContext } from './A11yContext';\n\ninterface Props {\n  anchor: string;\n  label?: string;\n  weight?: number;\n}\n\nexport default function A11ySkipTarget(props: Props) {\n  return (\n    <A11yContext.Consumer>\n      {({ addA11ySkipLink, removeA11ySkipLink }) => (\n        <A11ySkipTargetInner\n          addA11ySkipLink={addA11ySkipLink}\n          removeA11ySkipLink={removeA11ySkipLink}\n          {...props}\n        />\n      )}\n    </A11yContext.Consumer>\n  );\n}\n\ninterface InnerProps {\n  addA11ySkipLink: (link: T.A11ySkipLink) => void;\n  removeA11ySkipLink: (link: T.A11ySkipLink) => void;\n}\n\nexport class A11ySkipTargetInner extends React.PureComponent<Props & InnerProps> {\n  componentDidMount() {\n    this.props.addA11ySkipLink(this.getLink());\n  }\n\n  componentWillUnmount() {\n    this.props.removeA11ySkipLink(this.getLink());\n  }\n\n  getLink = (): T.A11ySkipLink => {\n    const { anchor: key, label = translate('skip_to_content'), weight } = this.props;\n    return { key, label, weight };\n  };\n\n  render() {\n    const { anchor } = this.props;\n    return <span id={`a11y_target__${anchor}`} />;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, post, postJSON } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\n\nexport interface GetRulesAppResponse {\n  canWrite?: boolean;\n  repositories: { key: string; language: string; name: string }[];\n}\n\nexport function getRulesApp(data: {\n  organization: string | undefined;\n}): Promise<GetRulesAppResponse> {\n  return getJSON('/api/rules/app', data).catch(throwGlobalError);\n}\n\nexport interface SearchRulesResponse {\n  actives?: T.Dict<T.RuleActivation[]>;\n  facets?: { property: string; values: { count: number; val: string }[] }[];\n  p: number;\n  ps: number;\n  rules: T.Rule[];\n  total: number;\n}\n\nexport function searchRules(data: {\n  organization: string | undefined;\n  [x: string]: any;\n}): Promise<SearchRulesResponse> {\n  return getJSON('/api/rules/search', data).catch(throwGlobalError);\n}\n\nexport function takeFacet(response: any, property: string) {\n  const facet = response.facets.find((facet: any) => facet.property === property);\n  return facet ? facet.values : [];\n}\n\nexport function getRuleDetails(parameters: {\n  actives?: boolean;\n  key: string;\n  organization: string | undefined;\n}): Promise<{ actives?: T.RuleActivation[]; rule: T.RuleDetails }> {\n  return getJSON('/api/rules/show', parameters).catch(throwGlobalError);\n}\n\nexport function getRuleTags(parameters: {\n  organization: string | undefined;\n  ps?: number;\n  q: string;\n}): Promise<string[]> {\n  return getJSON('/api/rules/tags', parameters).then(r => r.tags, throwGlobalError);\n}\n\nexport function createRule(data: {\n  custom_key: string;\n  markdown_description: string;\n  name: string;\n  organization: string | undefined;\n  params?: string;\n  prevent_reactivation?: boolean;\n  severity?: string;\n  status?: string;\n  template_key: string;\n  type?: string;\n}): Promise<T.RuleDetails> {\n  return postJSON('/api/rules/create', data).then(\n    r => r.rule,\n    response => {\n      // do not show global error if the status code is 409\n      // this case should be handled inside a component\n      if (response && response.status === 409) {\n        return Promise.reject(response);\n      } else {\n        return throwGlobalError(response);\n      }\n    }\n  );\n}\n\nexport function deleteRule(parameters: { key: string; organization: string | undefined }) {\n  return post('/api/rules/delete', parameters).catch(throwGlobalError);\n}\n\nexport function updateRule(data: {\n  key: string;\n  markdown_description?: string;\n  markdown_note?: string;\n  name?: string;\n  organization: string | undefined;\n  params?: string;\n  remediation_fn_base_effort?: string;\n  remediation_fn_type?: string;\n  remediation_fy_gap_multiplier?: string;\n  severity?: string;\n  status?: string;\n  tags?: string;\n}): Promise<T.RuleDetails> {\n  return postJSON('/api/rules/update', data).then(r => r.rule, throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit, sortBy, without } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport FacetItem from '../../../components/facet/FacetItem';\nimport FacetItemsList from '../../../components/facet/FacetItemsList';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport MultipleSelectionHint from '../../../components/facet/MultipleSelectionHint';\nimport {\n  getStandards,\n  renderCWECategory,\n  renderOwaspTop10Category,\n  renderSansTop25Category,\n  renderSonarSourceSecurityCategory\n} from '../../../helpers/security-standard';\nimport { Facet, formatFacetStat, Query, STANDARDS } from '../utils';\n\ninterface Props {\n  cwe: string[];\n  cweOpen: boolean;\n  cweStats: T.Dict<number> | undefined;\n  fetchingCwe: boolean;\n  fetchingOwaspTop10: boolean;\n  fetchingSansTop25: boolean;\n  fetchingSonarSourceSecurity: boolean;\n  loadSearchResultCount?: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  owaspTop10: string[];\n  owaspTop10Open: boolean;\n  owaspTop10Stats: T.Dict<number> | undefined;\n  query: Partial<Query>;\n  sansTop25: string[];\n  sansTop25Open: boolean;\n  sansTop25Stats: T.Dict<number> | undefined;\n  sonarsourceSecurity: string[];\n  sonarsourceSecurityOpen: boolean;\n  sonarsourceSecurityStats: T.Dict<number> | undefined;\n}\n\ninterface State {\n  standards: T.Standards;\n}\n\ntype StatsProp = 'owaspTop10Stats' | 'cweStats' | 'sansTop25Stats' | 'sonarsourceSecurityStats';\ntype ValuesProp = T.StandardType;\n\nexport default class StandardFacet extends React.PureComponent<Props, State> {\n  mounted = false;\n  property = STANDARDS;\n  state: State = {\n    standards: { owaspTop10: {}, sansTop25: {}, cwe: {}, sonarsourceSecurity: {} }\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n\n    // load standards.json only if the facet is open, or there is a selected value\n    if (\n      this.props.open ||\n      this.props.owaspTop10.length > 0 ||\n      this.props.cwe.length > 0 ||\n      this.props.sansTop25.length > 0 ||\n      this.props.sonarsourceSecurity.length > 0\n    ) {\n      this.loadStandards();\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (!prevProps.open && this.props.open) {\n      this.loadStandards();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadStandards = () => {\n    getStandards().then(\n      ({ owaspTop10, sansTop25, cwe, sonarsourceSecurity }: T.Standards) => {\n        if (this.mounted) {\n          this.setState({ standards: { owaspTop10, sansTop25, cwe, sonarsourceSecurity } });\n        }\n      },\n      () => {}\n    );\n  };\n\n  getValues = () => {\n    return [\n      ...this.props.sonarsourceSecurity.map(item =>\n        renderSonarSourceSecurityCategory(this.state.standards, item, true)\n      ),\n      ...this.props.owaspTop10.map(item =>\n        renderOwaspTop10Category(this.state.standards, item, true)\n      ),\n      ...this.props.sansTop25.map(item =>\n        renderSansTop25Category(this.state.standards, item, true)\n      ),\n      ...this.props.cwe.map(item => renderCWECategory(this.state.standards, item))\n    ];\n  };\n\n  handleHeaderClick = () => {\n    this.props.onToggle(this.property);\n  };\n\n  handleOwaspTop10HeaderClick = () => {\n    this.props.onToggle('owaspTop10');\n  };\n\n  handleSansTop25HeaderClick = () => {\n    this.props.onToggle('sansTop25');\n  };\n\n  handleSonarSourceSecurityHeaderClick = () => {\n    this.props.onToggle('sonarsourceSecurity');\n  };\n\n  handleClear = () => {\n    this.props.onChange({\n      [this.property]: [],\n      owaspTop10: [],\n      sansTop25: [],\n      cwe: [],\n      sonarsourceSecurity: []\n    });\n  };\n\n  handleItemClick = (prop: ValuesProp, itemValue: string, multiple: boolean) => {\n    const items = this.props[prop];\n    if (multiple) {\n      const newValue = sortBy(\n        items.includes(itemValue) ? without(items, itemValue) : [...items, itemValue]\n      );\n      this.props.onChange({ [prop]: newValue });\n    } else {\n      this.props.onChange({\n        [prop]: items.includes(itemValue) && items.length < 2 ? [] : [itemValue]\n      });\n    }\n  };\n\n  handleOwaspTop10ItemClick = (itemValue: string, multiple: boolean) => {\n    this.handleItemClick('owaspTop10', itemValue, multiple);\n  };\n\n  handleSansTop25ItemClick = (itemValue: string, multiple: boolean) => {\n    this.handleItemClick('sansTop25', itemValue, multiple);\n  };\n\n  handleSonarSourceSecurityItemClick = (itemValue: string, multiple: boolean) => {\n    this.handleItemClick('sonarsourceSecurity', itemValue, multiple);\n  };\n\n  handleCWESearch = (query: string) => {\n    return Promise.resolve({\n      results: Object.keys(this.state.standards.cwe).filter(cwe =>\n        renderCWECategory(this.state.standards, cwe)\n          .toLowerCase()\n          .includes(query.toLowerCase())\n      )\n    });\n  };\n\n  loadCWESearchResultCount = (categories: string[]) => {\n    const { loadSearchResultCount } = this.props;\n    return loadSearchResultCount\n      ? loadSearchResultCount('cwe', { cwe: categories })\n      : Promise.resolve({});\n  };\n\n  renderList = (\n    statsProp: StatsProp,\n    valuesProp: ValuesProp,\n    renderName: (standards: T.Standards, category: string) => string,\n    onClick: (x: string, multiple?: boolean) => void\n  ) => {\n    const stats = this.props[statsProp];\n    const values = this.props[valuesProp];\n    if (!stats) {\n      return null;\n    }\n    const categories = sortBy(Object.keys(stats), key => -stats[key]);\n    return this.renderFacetItemsList(stats, values, categories, renderName, renderName, onClick);\n  };\n\n  // eslint-disable-next-line max-params\n  renderFacetItemsList = (\n    stats: any,\n    values: string[],\n    categories: string[],\n    renderName: (standards: T.Standards, category: string) => React.ReactNode,\n    renderTooltip: (standards: T.Standards, category: string) => string,\n    onClick: (x: string, multiple?: boolean) => void\n  ) => {\n    if (!categories.length) {\n      return (\n        <div className=\"search-navigator-facet-empty little-spacer-top\">\n          {translate('no_results')}\n        </div>\n      );\n    }\n\n    const getStat = (category: string) => {\n      return stats ? stats[category] : undefined;\n    };\n\n    return (\n      <FacetItemsList>\n        {categories.map(category => (\n          <FacetItem\n            active={values.includes(category)}\n            key={category}\n            name={renderName(this.state.standards, category)}\n            onClick={onClick}\n            stat={formatFacetStat(getStat(category))}\n            tooltip={renderTooltip(this.state.standards, category)}\n            value={category}\n          />\n        ))}\n      </FacetItemsList>\n    );\n  };\n\n  renderHint = (statsProp: StatsProp, valuesProp: ValuesProp) => {\n    const stats = this.props[statsProp] || {};\n    const values = this.props[valuesProp];\n    return <MultipleSelectionHint options={Object.keys(stats).length} values={values.length} />;\n  };\n\n  renderOwaspTop10List() {\n    return this.renderList(\n      'owaspTop10Stats',\n      'owaspTop10',\n      renderOwaspTop10Category,\n      this.handleOwaspTop10ItemClick\n    );\n  }\n\n  renderOwaspTop10Hint() {\n    return this.renderHint('owaspTop10Stats', 'owaspTop10');\n  }\n\n  renderSansTop25List() {\n    return this.renderList(\n      'sansTop25Stats',\n      'sansTop25',\n      renderSansTop25Category,\n      this.handleSansTop25ItemClick\n    );\n  }\n\n  renderSansTop25Hint() {\n    return this.renderHint('sansTop25Stats', 'sansTop25');\n  }\n\n  renderSonarSourceSecurityList() {\n    return this.renderList(\n      'sonarsourceSecurityStats',\n      'sonarsourceSecurity',\n      renderSonarSourceSecurityCategory,\n      this.handleSonarSourceSecurityItemClick\n    );\n  }\n\n  renderSonarSourceSecurityHint() {\n    return this.renderHint('sonarsourceSecurityStats', 'sonarsourceSecurity');\n  }\n\n  renderSubFacets() {\n    return (\n      <>\n        <FacetBox className=\"is-inner\" property=\"sonarsourceSecurity\">\n          <FacetHeader\n            fetching={this.props.fetchingSonarSourceSecurity}\n            name={translate('issues.facet.sonarsourceSecurity')}\n            onClick={this.handleSonarSourceSecurityHeaderClick}\n            open={this.props.sonarsourceSecurityOpen}\n            values={this.props.sonarsourceSecurity.map(item =>\n              renderSonarSourceSecurityCategory(this.state.standards, item)\n            )}\n          />\n          {this.props.sonarsourceSecurityOpen && (\n            <>\n              {this.renderSonarSourceSecurityList()}\n              {this.renderSonarSourceSecurityHint()}\n            </>\n          )}\n        </FacetBox>\n        <FacetBox className=\"is-inner\" property=\"owaspTop10\">\n          <FacetHeader\n            fetching={this.props.fetchingOwaspTop10}\n            name={translate('issues.facet.owaspTop10')}\n            onClick={this.handleOwaspTop10HeaderClick}\n            open={this.props.owaspTop10Open}\n            values={this.props.owaspTop10.map(item =>\n              renderOwaspTop10Category(this.state.standards, item)\n            )}\n          />\n          {this.props.owaspTop10Open && (\n            <>\n              {this.renderOwaspTop10List()}\n              {this.renderOwaspTop10Hint()}\n            </>\n          )}\n        </FacetBox>\n        <FacetBox className=\"is-inner\" property=\"sansTop25\">\n          <FacetHeader\n            fetching={this.props.fetchingSansTop25}\n            name={translate('issues.facet.sansTop25')}\n            onClick={this.handleSansTop25HeaderClick}\n            open={this.props.sansTop25Open}\n            values={this.props.sansTop25.map(item =>\n              renderSansTop25Category(this.state.standards, item)\n            )}\n          />\n          {this.props.sansTop25Open && (\n            <>\n              {this.renderSansTop25List()}\n              {this.renderSansTop25Hint()}\n            </>\n          )}\n        </FacetBox>\n        <ListStyleFacet<string>\n          className=\"is-inner\"\n          facetHeader={translate('issues.facet.cwe')}\n          fetching={this.props.fetchingCwe}\n          getFacetItemText={item => renderCWECategory(this.state.standards, item)}\n          getSearchResultKey={item => item}\n          getSearchResultText={item => renderCWECategory(this.state.standards, item)}\n          loadSearchResultCount={this.loadCWESearchResultCount}\n          onChange={this.props.onChange}\n          onSearch={this.handleCWESearch}\n          onToggle={this.props.onToggle}\n          open={this.props.cweOpen}\n          property=\"cwe\"\n          query={omit(this.props.query, 'cwe')}\n          renderFacetItem={item => renderCWECategory(this.state.standards, item)}\n          renderSearchResult={(item, query) =>\n            highlightTerm(renderCWECategory(this.state.standards, item), query)\n          }\n          searchPlaceholder={translate('search.search_for_cwe')}\n          stats={this.props.cweStats}\n          values={this.props.cwe}\n        />\n      </>\n    );\n  }\n\n  render() {\n    return (\n      <FacetBox property={this.property}>\n        <FacetHeader\n          name={translate('issues.facet', this.property)}\n          onClear={this.handleClear}\n          onClick={this.handleHeaderClick}\n          open={this.props.open}\n          values={this.getValues()}\n        />\n\n        {this.props.open && this.renderSubFacets()}\n      </FacetBox>\n    );\n  }\n}\n"],"sourceRoot":""}