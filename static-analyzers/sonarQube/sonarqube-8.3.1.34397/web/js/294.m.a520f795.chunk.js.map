{"version":3,"sources":["webpack:///./src/main/js/apps/coding-rules/components/RuleDetailsTagsPopup.tsx","webpack:///./src/main/js/apps/coding-rules/components/RuleDetailsMeta.tsx","webpack:///./src/main/js/apps/coding-rules/components/RemoveExtendedDescriptionModal.tsx","webpack:///./src/main/js/apps/coding-rules/components/RuleDetailsDescription.tsx","webpack:///./src/main/js/apps/coding-rules/components/ActivationFormModal.tsx","webpack:///../sonar-docs/src/tooltips/rules/rules-quality-profiles.md","webpack:///../sonar-docs/src/tooltips/rules/rule-templates.md","webpack:///../sonar-docs/src/tooltips/rules/custom-rule-removal.md","webpack:///./src/main/js/apps/coding-rules/components/BulkChangeModal.tsx","webpack:///./src/main/js/apps/coding-rules/components/BulkChange.tsx","webpack:///./src/main/js/apps/coding-rules/components/Facet.tsx","webpack:///./src/main/js/apps/coding-rules/components/ActivationSeverityFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/AvailableSinceFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/DefaultSeverityFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/InheritanceFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/LanguageFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/ProfileFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/RepositoryFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/StatusFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/TagFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/TemplateFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/TypeFacet.tsx","webpack:///./src/main/js/apps/coding-rules/components/FacetsList.tsx","webpack:///./src/main/js/apps/coding-rules/components/PageActions.tsx","webpack:///./src/main/js/apps/coding-rules/components/CustomRuleFormModal.tsx","webpack:///./src/main/js/apps/coding-rules/components/CustomRuleButton.tsx","webpack:///./src/main/js/apps/coding-rules/components/RuleDetailsCustomRules.tsx","webpack:///./src/main/js/apps/coding-rules/components/RuleDetailsIssues.tsx","webpack:///./src/main/js/apps/coding-rules/components/RuleDetailsParameters.tsx","webpack:///./src/main/js/apps/coding-rules/components/ActivationButton.tsx","webpack:///./src/main/js/apps/coding-rules/components/RuleInheritanceIcon.tsx","webpack:///./src/main/js/apps/coding-rules/components/RuleDetailsProfiles.tsx","webpack:///./src/main/js/apps/coding-rules/components/RuleDetails.tsx","webpack:///./src/main/js/apps/coding-rules/components/RuleListItem.tsx","webpack:///./src/main/js/apps/coding-rules/components/App.tsx","webpack:///./src/main/js/app/components/embed-docs-modal/Suggestions.tsx","webpack:///./src/main/js/components/hoc/utils.ts","webpack:///./src/main/js/components/docs/DocTooltip.tsx","webpack:///./src/main/js/app/components/a11y/A11ySkipTarget.tsx","webpack:///./src/main/js/api/quality-profiles.ts","webpack:///./src/main/js/helpers/markdown.js","webpack:///./src/main/js/components/shared/SeverityHelper.tsx","webpack:///./src/main/js/api/rules.ts","webpack:///./src/main/js/components/hoc/withAppState.tsx","webpack:///./src/main/js/components/tags/TagsList.css?d861","webpack:///./src/main/js/components/facet/FacetBox.tsx","webpack:///./src/main/js/components/common/ScreenPositionHelper.tsx","webpack:///./src/main/js/components/facet/FacetHeader.tsx","webpack:///./src/main/js/components/facet/FacetItem.tsx","webpack:///./src/main/js/components/common/MultiSelectOption.tsx","webpack:///./src/main/js/components/common/MultiSelect.tsx","webpack:///./src/main/js/components/tags/TagsList.tsx","webpack:///./src/main/js/components/common/MarkdownTips.tsx","webpack:///./src/main/js/components/facet/FacetItemsList.tsx","webpack:///./src/main/js/components/tags/TagsList.css","webpack:///./src/main/js/components/facet/ListStyleFacetFooter.tsx","webpack:///./src/main/js/components/facet/ListStyleFacet.tsx","webpack:///./src/main/js/helpers/organizations.ts","webpack:///./src/main/js/components/tags/TagsSelector.tsx","webpack:///./src/main/js/components/controls/DateInput.tsx","webpack:///./src/main/js/components/controls/DayPicker.css?d7e1","webpack:///./src/main/js/components/controls/DayPicker.css","webpack:///./src/main/js/components/controls/styles.css?5633","webpack:///./src/main/js/components/controls/styles.css","webpack:///./src/main/js/components/search-navigator.css?9a2e","webpack:///./src/main/js/components/search-navigator.css","webpack:///./src/main/js/components/facet/MultipleSelectionHint.tsx","webpack:///./src/main/js/helpers/security-standard.ts","webpack:///./src/main/js/apps/quality-profiles/components/BuiltInQualityProfileBadge.tsx","webpack:///../sonar-docs/src/tooltips/quality-profiles/built-in-quality-profile.md","webpack:///./src/main/js/apps/coding-rules/components/SimilarRulesFilter.tsx","webpack:///./src/main/js/components/common/FiltersHeader.tsx","webpack:///./src/main/js/apps/coding-rules/styles.css?8cf5","webpack:///./src/main/js/apps/coding-rules/styles.css","webpack:///./src/main/js/apps/issues/sidebar/StandardFacet.tsx","webpack:///./src/main/js/components/facet/MultipleSelectionHint.css?3321","webpack:///./src/main/js/components/facet/MultipleSelectionHint.css","webpack:///./src/main/js/components/common/PageCounter.tsx","webpack:///./src/main/js/components/shared/TypeHelper.tsx","webpack:///../sonar-docs/src/tooltips/rules/custom-rules.md"],"names":["mounted","state","searchResult","onSearch","query","q","ps","Math","min","this","props","tags","length","organization","then","setState","sysTags","onSelect","tag","setTags","onUnselect","availableTags","TagsSelector","listSize","selectedTags","renderType","ruleDetails","overlay","type","className","renderSeverity","SeverityHelper","severity","renderStatus","status","renderTags","canWrite","allTags","closeOnClick","closeOnClickOutside","onTagsChange","overlayPlacement","BottomLeft","TagsList","allowUpdate","renderCreationDate","date","createdAt","renderRepository","referencedRepositories","repository","repo","name","langName","renderTemplate","isTemplate","renderParentTemplate","templateKey","to","DocTooltip","doc","renderRemediation","debtRemFnType","undefined","debtRemFnOffset","debtRemFnCoeff","effortToFixDescription","renderScope","scope","renderExternalBadge","engine","replace","RegExp","displayedKey","key","startsWith","substr","hasTypeData","isExternal","renderKey","title","hideSimilarRulesFilter","SimilarRulesFilter","onFilterChange","rule","RemoveExtendedDescriptionModal","onCancel","onSubmit","header","onClose","onCloseClick","onFormSubmit","submitting","disabled","onClick","description","descriptionForm","removeDescriptionModal","handleDescriptionChange","event","currentTarget","value","handleCancelClick","handleSaveClick","updateDescription","handleRemoveDescriptionClick","handleCancelRemoving","handleConfirmRemoving","text","markdown_note","onChange","handleExtendDescriptionClick","mdNote","renderDescription","id","htmlNote","dangerouslySetInnerHTML","__html","renderForm","colSpan","autoFocus","rows","MarkdownTips","hasDescription","htmlDesc","ActivationFormModal","super","getParams","activation","params","param","defaultValue","getQualityProfilesWithDepth","profiles","filter","profile","isBuiltIn","actions","edit","language","lang","map","depth","handleFormSubmit","preventDefault","data","onDone","handleParameterChange","handleProfileChange","handleSeverityChange","renderSeverityOption","profilesWithDepth","isCustomRule","activeInAllProfiles","isUpdateMode","contentLabel","modalHeader","onRequestClose","size","variant","clearable","options","label","repeat","optionRenderer","searchable","valueRenderer","placeholder","handleProfileSelect","selectedProfiles","option","getAvailableQualityProfiles","referencedProfiles","Object","values","languages","includes","processResponse","response","result","failed","succeeded","results","sendRequests","looper","Promise","resolve","method","action","targetKey","finished","renderResult","profileKey","Alert","renderProfileSelect","languageName","multi","availableProfiles","push","total","htmlFor","modal","getSelectedProfile","closeModal","handleActivateClick","blur","handleActivateInProfileClick","handleDeactivateClick","handleDeactivateInProfileClick","some","Boolean","canChangeProfile","allowActivateOnProfile","allowDeactivateOnProfile","href","handleItemClick","itemValue","multiple","newValue","singleSelection","property","handleHeaderClick","onToggle","handleClear","getStat","stats","renderItem","active","stat","renderName","defaultRenderName","renderTextName","FacetItem","halfWidth","tooltip","items","keys","toLowerCase","FacetBox","FacetHeader","disabledHelper","onClear","open","children","FacetItemsList","renderFooter","availableSince","handlePeriodChange","getValues","intl","formatDate","DateInput","getLanguageName","languageKey","installedLanguages","find","l","handleSearch","getAllPossibleOptions","paging","pageIndex","pageSize","renderSearchResult","term","ListStyleFacet","facetHeader","fetching","getFacetItemText","getSearchResultKey","getSearchResultText","minSearchLength","renderFacetItem","searchPlaceholder","selected","compareToProfile","activationSeverities","inheritance","handleActiveClick","stopPropagation","handleInactiveClick","getTextValue","getTooltip","base","renderActivation","isCompare","role","tabIndex","referencedLanguages","repositoryKey","facetProps","handleSelect","getTagName","renderTag","fill","gray60","handleChange","changes","template","Array","isArray","String","FacetsList","languageDisabled","hideProfileFacet","inheritanceDisabled","selectedProfile","isInherited","activationSeverityDisabled","onFacetToggle","openFacets","facets","types","repositories","severities","statuses","StandardFacet","cwe","cweOpen","cweStats","fetchingCwe","fetchingOwaspTop10","fetchingSansTop25","fetchingSonarSourceSecurity","standards","owaspTop10","owaspTop10Open","owaspTop10Stats","sansTop25","sansTop25Open","sansTop25Stats","sonarsourceSecurity","sonarsourceSecurityOpen","sonarsourceSecurityStats","organizationsEnabled","PageActions","Shortcuts","loading","onReload","PageCounter","current","selectedIndex","prepareRequest","customRule","templateRule","csv","join","ruleData","markdown_description","custom_key","prevent_reactivation","reactivating","template_key","newRuleDetails","handleNameChange","keyModifiedByUser","handleKeyChange","handleTypeChange","handleStatusChange","renderNameField","required","renderKeyField","renderDescriptionField","renderTypeOption","TypeHelper","renderTypeField","renderSeverityField","renderStatusField","renderParameterField","mdDesc","submit","handleClick","handleModalClose","handleDone","fetchRules","f","rules","handleRuleCreate","handleRuleDelete","ruleKey","renderRule","canChange","confirmButtonText","confirmData","isDestructive","modalBody","onConfirm","prevProps","fetchIssues","resolved","facet","components","projects","item","project","component","val","count","renderTotal","path","totalItem","appState","branchesEnabled","renderProject","withAppState","renderParameter","handleButtonClick","handleCloseModal","buttonText","RuleInheritanceIcon","other","red","baseFontColor","height","version","viewBox","width","xmlSpace","xmlnsXlink","d","style","fillRule","handleActivate","onActivate","handleDeactivate","onDeactivate","handleRevert","reset","renderInheritedProfile","parentName","profilePath","inherit","parentActivation","originalParam","p","originalValue","renderParameters","renderActions","canEdit","hasParent","parentKey","activations","qProfile","x","BuiltInQualityProfileBadge","canActivate","InstanceMessage","message","fetchRuleDetails","actives","handleRuleChange","handleTagsChange","oldTags","catch","handleDelete","onDelete","allowCustomRules","hideQualityProfiles","isCustom","isEditable","RuleDetailsMeta","RuleDetailsDescription","handleNameClick","isLeftClickEvent","button","metaKey","altKey","ctrlKey","shiftKey","onOpen","isLoggedIn","canCopy","copy","renderDeactivateButton","overlayTranslationKey","attachShortcuts","selectPreviousRule","selectNextRule","openSelectedRule","handleBack","detachShortcuts","getOpenRule","location","getFacetsToFetch","getFieldsToFetch","fields","getSearchParameters","s","stopLoading","fetchInitialData","all","fetchQualityProfiles","fetchFirstRules","makeFetchRequest","rawActives","rawFacets","entries","parseActives","rawFacet","rawValue","parseFacets","openRule","usingPermalink","fetchMoreRules","nextPage","fetchFacet","currentUser","userOrganizations","getSelectedIndex","index","findIndex","getRulePath","pathname","router","closeRule","scrollToSelectedRule","smooth","element","document","querySelector","topOffset","bottomOffset","getRuleActivation","closeFacet","handleRuleOpen","handleReset","handleFilterChange","handleFacetToggle","willOpenProperty","newState","handleReload","pickRuleAround","handleRuleActivate","handleRuleDeactivate","newRule","searchQuery","isFiltered","renderBulkButton","nextProps","prevState","Suggestions","suggestions","defer","content","ScreenPositionHelper","top","A11ySkipTarget","anchor","weight","FiltersHeader","displayReset","onReset","minLength","loadMore","ready","Consumer","addSuggestions","removeSuggestions","SuggestionsInner","getWrappedDisplayName","WrappedComponent","hocName","wrappedDisplayName","displayName","DocMarkdownBlock","default","childProps","overlayProps","isTooltip","addA11ySkipLink","removeA11ySkipLink","A11ySkipTargetInner","getLink","searchQualityProfiles","parameters","getQualityProfile","compareToSonarWay","createQualityProfile","restoreQualityProfile","getProfileProjects","getProfileInheritance","qualityProfile","setDefaultProfile","renameProfile","copyProfile","fromKey","toName","deleteProfile","changeProfileParent","parentProfile","parentQualityProfile","getQualityProfileBackupUrl","queryParams","encodeURIComponent","getQualityProfileExporterUrl","exporterKey","getImporters","r","importers","getExporters","exporters","getProfileChangelog","since","page","compareProfiles","leftKey","rightKey","associateProject","dissociateProject","searchUsers","searchGroups","addUser","removeUser","addGroup","removeGroup","bulkActivateRules","bulkDeactivateRules","activateRule","deactivateRule","getFrontMatterPosition","lines","firstLine","lastLine","i","trim","parseFrontMatter","tokens","split","cutConditionalContent","beginning","ending","newContent","start","indexOf","end","substring","console","error","Error","module","exports","getFrontMatter","position","slice","separateFrontMatter","frontmatter","filterContent","regexBase","isSonarCloud","getInstance","contentWithoutStatic","getRulesApp","searchRules","takeFacet","getRuleDetails","getRuleTags","createRule","reject","deleteRule","updateRule","Wrapper","api","__esModule","exported","locals","getPosition","containerPos","container","getBoundingClientRect","window","pageYOffset","left","pageXOffset","debouncedOnResize","forceUpdate","addEventListener","removeEventListener","ref","helper","showClearButton","renderHelper","renderValueIndicator","renderValue","defaultProps","MultiSelectOption","custom","onHover","renderLabel","onFocus","onMouseOver","checked","onCheck","onSelectChange","handleSelectChange","onSelectItem","onUnselectItem","handleSearchChange","onSearchQuery","validateSearchInput","handleElementHover","activeIdx","getAllElements","handleKeyboard","evt","keyCode","selectNextElement","selectPreviousElement","toggleSelect","isNewElement","elem","selectedElements","elements","updateSelectedElements","filterSelected","updateUnselectedElements","unselectedElements","setElementActive","idx","allElements","totalElements","searchInput","focus","allowSelection","allowNewElements","footerNode","activeElement","showNewElement","infiniteList","listClasses","div","___CSS_LOADER_API_IMPORT___","handleShowMoreClick","showMore","handleShowLessClick","showLess","hasMore","allShown","searching","searchResultsCounts","showFullList","onItemClick","stopSearching","search","loadCountsForSearchResults","maxResults","searchMaxResults","searchResults","searchPaging","searchMore","loadSearchResultCount","resultsToLoad","hideFullList","maxInitialItems","sortedItems","getSortedItems","limitedList","selectedBelowLimit","mightHaveMoreResults","maxItems","formatFacetStat","loadingResults","showList","renderSearch","renderList","renderSearchResults","MultipleSelectionHint","isPaidOrganization","subscription","hasPrivateAccess","isCurrentUserMemberOf","admin","org","validateTag","DayPicker","input","openCalendar","handleResetClick","closeCalendar","currentMonth","Date","lastHovered","handleDayClick","day","modifiers","handleDayMouseEnter","handleCurrentMonthChange","handleCurrentYearChange","handlePreviousMonthClick","handleNextMonthClick","highlightFrom","highlightTo","minDate","after","maxDate","months","years","getFullYear","selectedDays","lastHoveredOrValue","highlighted","from","weekdaysLong","weekdaysShort","onClickOutside","InputWrapper","inputClassName","innerRef","node","readOnly","iconProps","month","getMonth","year","captionElement","NullComponent","disabledDays","before","firstDayOfWeek","navbarElement","onDayClick","onDayMouseEnter","formattedValue","navigator","userAgent","getStandards","renderCWECategory","category","record","renderOwaspTop10Category","withPrefix","addPrefix","toUpperCase","renderSansTop25Category","renderSonarSourceSecurityCategory","prefix","badge","handleLanguageClick","handleTypeClick","handleSeverityClick","handleTagClick","dataset","loadStandards","handleOwaspTop10HeaderClick","handleSansTop25HeaderClick","handleSonarSourceSecurityHeaderClick","prop","handleOwaspTop10ItemClick","handleSansTop25ItemClick","handleSonarSourceSecurityItemClick","handleCWESearch","loadCWESearchResultCount","categories","statsProp","valuesProp","renderFacetItemsList","renderTooltip","renderHint","renderSonarSourceSecurityList","renderSonarSourceSecurityHint","renderOwaspTop10List","renderOwaspTop10Hint","renderSansTop25List","renderSansTop25Hint","renderSubFacets"],"mappings":"yYAqCe,MAAM,UAA6B,gBAAlD,c,oBACE,KAAAA,SAAU,EACV,KAAAC,MAAe,CAAEC,aAAc,IAU/B,KAAAC,SAAYC,GACH,YAAY,CACjBC,EAAGD,EACHE,GAAIC,KAAKC,IAAIC,KAAKC,MAAMC,KAAKC,OAjBjB,GAiBqC,KACjDC,aAAcJ,KAAKC,MAAMG,eACxBC,KACDH,IACMF,KAAKT,SAEPS,KAAKM,SAAS,CAAEb,aAAc,IAAQS,KAASF,KAAKC,MAAMM,YAG9D,QAIJ,KAAAC,SAAYC,IACVT,KAAKC,MAAMS,QAAQ,IAAK,IAAIV,KAAKC,MAAMC,KAAMO,MAG/C,KAAAE,WAAcF,IACZT,KAAKC,MAAMS,QAAQ,IAAQV,KAAKC,MAAMC,KAAMO,KA7B9C,oBACET,KAAKT,SAAU,EAGjB,uBACES,KAAKT,SAAU,EA2BjB,SACE,MAAMqB,EAAgB,IAAWZ,KAAKR,MAAMC,aAAcO,KAAKC,MAAMC,MACrE,OACE,gBAACW,EAAA,EAAY,CACXC,SA1CU,GA2CVpB,SAAUM,KAAKN,SACfc,SAAUR,KAAKQ,SACfG,WAAYX,KAAKW,WACjBI,aAAcf,KAAKC,MAAMC,KACzBA,KAAMU,K,aChCC,MAAM,UAAwB,gBAA7C,c,oBACE,KAAAI,WAAa,KACX,MAAM,YAAEC,GAAgBjB,KAAKC,MAC7B,OACE,gBAAC,IAAO,CAACiB,QAAS,oBAAU,4BAA6BD,EAAYE,OACnE,sBAAIC,UAAU,+BAA8B,YAAW,QACrD,gBAAC,IAAa,CAACA,UAAU,sBAAsBzB,MAAOsB,EAAYE,OACjE,oBAAU,aAAcF,EAAYE,SAM7C,KAAAE,eAAiB,IACf,gBAAC,IAAO,CAACH,QAAS,oBAAU,qBAC1B,sBAAIE,UAAU,+BAA8B,YAAW,YACrD,gBAACE,EAAA,EAAc,CACbF,UAAU,6BACVG,SAAUvB,KAAKC,MAAMgB,YAAYM,aAMzC,KAAAC,aAAe,KACb,MAAM,YAAEP,GAAgBjB,KAAKC,MAC7B,MAA2B,UAAvBgB,EAAYQ,OACP,KAGP,gBAAC,IAAO,CAACP,QAAS,oBAAU,WAC1B,sBAAIE,UAAU,+BAA8B,YAAW,UACrD,wBAAMA,UAAU,qBAAqB,oBAAU,eAAgBH,EAAYQ,YAMnF,KAAAC,WAAa,KACX,MAAM,SAAEC,EAAF,YAAYV,GAAgBjB,KAAKC,OACjC,QAAEM,EAAU,GAAZ,KAAgBL,EAAO,IAAOe,EAC9BW,EAAU,IAAIrB,KAAYL,GAEhC,OACE,sBAAIkB,UAAU,+BAA8B,YAAW,QACpDpB,KAAKC,MAAM0B,SACV,gBAAC,IAAQ,CACPE,cAAc,EACdC,qBAAqB,EACrBZ,QACE,gBAAC,EAAoB,CACnBd,aAAcJ,KAAKC,MAAMG,aACzBM,QAASV,KAAKC,MAAM8B,aACpBxB,QAASA,EACTL,KAAMA,IAGV8B,iBAAkB,iBAAeC,YACjC,gBAAC,aAAU,KACT,gBAACC,EAAA,EAAQ,CACPC,YAAaR,EACbzB,KAAM0B,EAAQzB,OAAS,EAAIyB,EAAU,CAAC,oBAAU,6BAKtD,gBAACM,EAAA,EAAQ,CACPC,YAAaR,EACbP,UAAU,sBACVlB,KAAM0B,EAAQzB,OAAS,EAAIyB,EAAU,CAAC,oBAAU,6BAO1D,KAAAQ,mBAAqB,IACnB,sBAAIhB,UAAU,+BAA8B,YAAW,mBACrD,wBAAMA,UAAU,uBAAuB,oBAAU,iCACjD,gBAAC,IAAa,CAACiB,KAAMrC,KAAKC,MAAMgB,YAAYqB,aAIhD,KAAAC,iBAAmB,KACjB,MAAM,uBAAEC,EAAF,YAA0BvB,GAAgBjB,KAAKC,MAC/CwC,EAAaD,EAAuBvB,EAAYyB,MACtD,OAAKD,EAIH,gBAAC,IAAO,CAACvB,QAAS,oBAAU,qCAC1B,sBAAIE,UAAU,+BAA8B,YAAW,cACpDqB,EAAWE,K,KAAQ1B,EAAY2B,SAC7B,MANA,MAWX,KAAAC,eAAiB,IACV7C,KAAKC,MAAMgB,YAAY6B,WAI1B,gBAAC,IAAO,CAAC5B,QAAS,oBAAU,qCAC1B,sBAAIE,UAAU,gCAAgC,oBAAU,gCAJnD,KASX,KAAA2B,qBAAuB,KACrB,MAAM,YAAE9B,GAAgBjB,KAAKC,MAC7B,OAAKgB,EAAY+B,YAIf,sBAAI5B,UAAU,gCACX,oBAAU,4BACV,KACD,gBAAC,OAAI,CAAC6B,GAAI,YAAWhC,EAAY+B,YAAahD,KAAKC,MAAMG,eACtD,oBAAU,+BAEZ,IACD,gBAAC8C,EAAA,EAAU,CACT9B,UAAU,qBACV+B,IAAK,4CAZF,MAkBX,KAAAC,kBAAoB,KAClB,MAAM,YAAEnC,GAAgBjB,KAAKC,MAC7B,OAAKgB,EAAYoC,cAIf,gBAAC,IAAO,CAACnC,QAAS,oBAAU,sCAC1B,sBAAIE,UAAU,+BAA8B,YAAW,wBACpD,oBAAU,oCAAqCH,EAAYoC,eAC3D,SACgCC,IAAhCrC,EAAYsC,iBAAZ,WAAiDtC,EAAYsC,sBAC9BD,IAA/BrC,EAAYuC,gBAAZ,YAAiDvC,EAAYuC,qBACtBF,IAAvCrC,EAAYwC,wBAAZ,WACKxC,EAAYwC,0BAVf,MAgBX,KAAAC,YAAc,KACZ,MAAMC,EAAQ3D,KAAKC,MAAMgB,YAAY0C,OAAS,OAC9C,OACE,gBAAC,IAAO,CAACzC,QAAS,oBAAU,6BAC1B,sBAAIE,UAAU,gCACZ,gBAAC,IAAa,CAACA,UAAU,wBACxB,oBAAU,qBAAsBuC,MAMzC,KAAAC,oBAAsB,KACpB,MAAM,YAAE3C,GAAgBjB,KAAKC,MAC7B,IAAKgB,EAAYyB,KACf,OAAO,KAET,MAAMmB,EAAS5C,EAAYyB,KAAKoB,QAAQ,IAAIC,OAAJ,WAxKV,cAwKuD,IACrF,OAAKF,EAIH,gBAAC,IAAO,CAAC3C,QAAS,kCAAwB,oCAAqC2C,IAC7E,sBAAIzC,UAAU,gCACZ,uBAAKA,UAAU,mCAAmCyC,KAL/C,MAWX,YACE,MACM,YAAE5C,GAAgBjB,KAAKC,MACvB+D,EAAe/C,EAAYgD,IAAIC,WAFb,aAGpBjD,EAAYgD,IAAIE,OAHI,YAGmBhE,QACvCc,EAAYgD,IAChB,OAAO,wBAAM7C,UAAU,oBAAoB4C,GAG7C,SACE,MAAM,YAAE/C,GAAgBjB,KAAKC,MACvBmE,GAAenD,EAAYoD,YAAmC,YAArBpD,EAAYE,KAC3D,OACE,uBAAKC,UAAU,gBACb,0BAAQA,UAAU,eAChB,uBAAKA,UAAU,cACZpB,KAAKsE,aACJrD,EAAYoD,YACZ,gBAAC,OAAI,CACHjD,UAAU,0EACVmD,MAAO,oBAAU,aACjBtB,GAAI,YAAWhC,EAAYgD,IAAKjE,KAAKC,MAAMG,eAC3C,gBAAC,IAAQ,QAGXJ,KAAKC,MAAMuE,wBACX,gBAACC,EAAA,EAAkB,CAACC,eAAgB1E,KAAKC,MAAMyE,eAAgBC,KAAM1D,KAGzE,sBAAIG,UAAU,yCACZ,2BAAMH,EAAY0B,QAIrByB,GACC,sBAAIhD,UAAU,kCACXpB,KAAKgB,aACLhB,KAAKqB,kBACJJ,EAAYoD,YACZ,gCACGrE,KAAKwB,eACLxB,KAAK0D,eAGT1D,KAAK0B,cACJT,EAAYoD,YAAcrE,KAAKoC,qBAChCpC,KAAKuC,oBACJtB,EAAYoD,YACZ,gCACGrE,KAAK6C,iBACL7C,KAAK+C,uBACL/C,KAAKoD,qBAGTnC,EAAYoD,YAAcrE,KAAK4D,2B,mIC9P7B,SAASgB,GAA+B,SAAEC,EAAF,SAAYC,IACjE,MAAMC,EAAS,oBAAU,4CACzB,OACE,gBAAC,IAAW,CAACA,OAAQA,EAAQC,QAASH,EAAUC,SAAUA,GACvD,EAAGG,eAAcC,eAAcC,gBAC9B,wBAAML,SAAUI,GACd,0BAAQ9D,UAAU,cAChB,0BAAK2D,IAGP,uBAAK3D,UAAU,cACZ,oBAAU,qDAGb,0BAAQA,UAAU,cACf+D,GAAc,qBAAG/D,UAAU,yBAC5B,gBAAC,eAAY,CAACA,UAAU,aAAagE,SAAUD,GAC5C,oBAAU,WAEb,gBAAC,kBAAe,CAACE,QAASJ,GAAe,oBAAU,cCRhD,MAAM,UAA+B,gBAApD,c,oBACE,KAAA1F,SAAU,EACV,KAAAC,MAAe,CACb8F,YAAa,GACbC,iBAAiB,EACjBJ,YAAY,EACZK,wBAAwB,GAW1B,KAAAC,wBAA2BC,GACzB1F,KAAKM,SAAS,CAAEgF,YAAaI,EAAMC,cAAcC,QAEnD,KAAAC,kBAAoB,KAClB7F,KAAKM,SAAS,CAAEiF,iBAAiB,KAGnC,KAAAO,gBAAkB,KAChB9F,KAAK+F,kBAAkB/F,KAAKR,MAAM8F,cAGpC,KAAAU,6BAA+B,KAC7BhG,KAAKM,SAAS,CAAEkF,wBAAwB,KAG1C,KAAAS,qBAAuB,IAAMjG,KAAKM,SAAS,CAAEkF,wBAAwB,IAErE,KAAAU,sBAAwB,KACtBlG,KAAKM,SAAS,CAAEkF,wBAAwB,IACxCxF,KAAK+F,kBAAkB,KAGzB,KAAAA,kBAAqBI,IACnBnG,KAAKM,SAAS,CAAE6E,YAAY,IAE5B,YAAW,CACTlB,IAAKjE,KAAKC,MAAMgB,YAAYgD,IAC5BmC,cAAeD,EACf/F,aAAcJ,KAAKC,MAAMG,eACxBC,KACDY,IACEjB,KAAKC,MAAMoG,SAASpF,GAChBjB,KAAKT,SACPS,KAAKM,SAAS,CAAE6E,YAAY,EAAOI,iBAAiB,KAGxD,KACMvF,KAAKT,SACPS,KAAKM,SAAS,CAAE6E,YAAY,OAMpC,KAAAmB,6BAA+B,KAC7BtG,KAAKM,SAAS,CAEZgF,YAAatF,KAAKC,MAAMgB,YAAYsF,QAAU,GAC9ChB,iBAAiB,KAIrB,KAAAiB,kBAAoB,IAClB,uBAAKC,GAAG,8CAC+BnD,IAApCtD,KAAKC,MAAMgB,YAAYyF,UACtB,uBACEtF,UAAU,mCAEVuF,wBAAyB,CAAEC,OAAQ5G,KAAKC,MAAMgB,YAAYyF,YAG7D1G,KAAKC,MAAM0B,UACV,gBAAC,SAAM,CACL8E,GAAG,yCACHpB,QAASrF,KAAKsG,8BACb,oBAAU,qCAMnB,KAAAO,WAAa,IACX,uBAAKzF,UAAU,+CACb,yBAAOA,UAAU,aACf,6BACE,0BACE,sBAAI0F,QAAS,GACX,4BACEC,WAAW,EACX3F,UAAU,iCACVqF,GAAG,8CACHJ,SAAUrG,KAAKyF,wBACfuB,KAAM,EACNpB,MAAO5F,KAAKR,MAAM8F,gBAIxB,0BACE,0BACE,gBAAC,SAAM,CACLF,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAG,gDACHpB,QAASrF,KAAK8F,iBACb,oBAAU,cAEsBxC,IAAlCtD,KAAKC,MAAMgB,YAAYsF,QACtB,gCACE,gBAAC,SAAM,CACLnF,UAAU,yBACVgE,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAG,gDACHpB,QAASrF,KAAKgG,8BACb,oBAAU,WAEZhG,KAAKR,MAAMgG,wBACV,gBAACZ,EAA8B,CAC7BC,SAAU7E,KAAKiG,qBACfnB,SAAU9E,KAAKkG,yBAKvB,gBAAC,kBAAe,CACd9E,UAAU,cACVgE,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAG,gDACHpB,QAASrF,KAAK6F,mBACb,oBAAU,WAEZ7F,KAAKR,MAAM2F,YAAc,qBAAG/D,UAAU,yBAEzC,sBAAIA,UAAU,cACZ,gBAAC6F,EAAA,EAAY,WAlIzB,oBACEjH,KAAKT,SAAU,EAGjB,uBACES,KAAKT,SAAU,EAqIjB,SACE,MAAM,YAAE0B,GAAgBjB,KAAKC,MACvBiH,GAAkBjG,EAAYoD,YAAmC,YAArBpD,EAAYE,KAE9D,OACE,uBAAKC,UAAU,uBACZ8F,EACC,uBACE9F,UAAU,qDAEVuF,wBAAyB,CAAEC,OAAQ3F,EAAYkG,UAAY,MAG7D,uBAAK/F,UAAU,sDACZ,kCAAwB,mCAAoCH,EAAY0B,QAI3E1B,EAAY+B,aACZ,uBAAK5B,UAAU,0EACXpB,KAAKR,MAAM+F,iBAAmBvF,KAAKwG,oBACpCxG,KAAKR,MAAM+F,iBAAmBvF,KAAKC,MAAM0B,UAAY3B,KAAK6G,kB,63BChKxD,MAAMO,UAA4B,gBAG/C,YAAYnH,GACVoH,MAAMpH,GAHR,KAAAV,SAAU,EAqBV,KAAA+H,UAAY,EAAGC,aAAY5C,QAAS3E,KAAKC,SACvC,MAAMuH,EAAyB,GAC/B,GAAI7C,GAAQA,EAAK6C,OAAQ,CACvB,IAAK,MAAMC,KAAS9C,EAAK6C,OACvBA,EAAOC,EAAMxD,KAAOwD,EAAMC,cAAgB,GAE5C,GAAIH,GAAcA,EAAWC,OAC3B,IAAK,MAAMC,KAASF,EAAWC,OAC7BA,EAAOC,EAAMxD,KAAOwD,EAAM7B,MAIhC,OAAO4B,GAIT,KAAAG,4BAA8B,EAAGC,YAAa5H,KAAKC,QAC1C,YACL2H,EAASC,OACPC,IACGA,EAAQC,WACTD,EAAQE,SACRF,EAAQE,QAAQC,MAChBH,EAAQI,WAAalI,KAAKC,MAAM0E,KAAKwD,OAEzCC,IAAIN,GAAO,KACRA,EADQ,CAGXO,MAAOP,EAAQO,MAAQ,KAI3B,KAAAC,iBAAoB5C,IAClBA,EAAM6C,iBACNvI,KAAKM,SAAS,CAAE6E,YAAY,IAC5B,MAAMqD,EAAO,CACXvE,IAAKjE,KAAKR,MAAMsI,QAChB1H,aAAcJ,KAAKC,MAAMG,aACzBoH,OAAQxH,KAAKR,MAAMgI,OACnB7C,KAAM3E,KAAKC,MAAM0E,KAAKV,IACtB1C,SAAUvB,KAAKR,MAAM+B,UAEvB,YAAaiH,GACVnI,KAAK,IAAML,KAAKC,MAAMwI,OAAOD,EAAKjH,WAClClB,KACC,KACML,KAAKT,UACPS,KAAKM,SAAS,CAAE6E,YAAY,IAC5BnF,KAAKC,MAAM+E,YAGf,KACMhF,KAAKT,SACPS,KAAKM,SAAS,CAAE6E,YAAY,OAMtC,KAAAuD,sBAAyBhD,IACvB,MAAM,KAAE/C,EAAF,MAAQiD,GAAUF,EAAMC,cAC9B3F,KAAKM,SAAUd,IAAD,CAAqBgI,OAAO,EAAD,GAAOhI,EAAMgI,OAAb,CAAqB,CAAC7E,GAAOiD,QAGxE,KAAA+C,oBAAsB,EAAG/C,YACvB5F,KAAKM,SAAS,CAAEwH,QAASlC,KAG3B,KAAAgD,qBAAuB,EAAGhD,YACxB5F,KAAKM,SAAS,CAAEiB,SAAUqE,KAG5B,KAAAiD,qBAAuB,EAAGjD,WACjB,gBAAC,IAAc,CAACrE,SAAUqE,IA1FjC,MAAMkD,EAAoB9I,KAAK2H,4BAA4B1H,GAC3DD,KAAKR,MAAQ,CACXgI,OAAQxH,KAAKsH,UAAUrH,GACvB6H,QAASgB,EAAkB3I,OAAS,EAAI2I,EAAkB,GAAG7E,IAAM,GACnE1C,SAAUtB,EAAMsH,WAAatH,EAAMsH,WAAWhG,SAAWtB,EAAM0E,KAAKpD,SACpE4D,YAAY,GAIhB,oBACEnF,KAAKT,SAAU,EAGjB,uBACES,KAAKT,SAAU,EA+EjB,SACE,MAAM,WAAEgI,EAAF,KAAc5C,GAAS3E,KAAKC,OAC5B,QAAE6H,EAAF,SAAWvG,EAAX,WAAqB4D,GAAenF,KAAKR,OACzC,OAAEgI,EAAS,IAAO7C,EAClBmE,EAAoB9I,KAAK2H,8BACzBoB,IAAkBpE,EAAuB3B,YACzCgG,EAAsBF,EAAkB3I,QAAU,EAClD8I,IAAiB1B,EAEvB,OACE,gBAAC,IAAK,CAAC2B,aAAclJ,KAAKC,MAAMkJ,YAAaC,eAAgBpJ,KAAKC,MAAM+E,QAASqE,KAAK,SACpF,wBAAMvE,SAAU9E,KAAKsI,kBACnB,uBAAKlH,UAAU,cACb,0BAAKpB,KAAKC,MAAMkJ,cAGlB,uBAAK/H,UAAW,EAAW,aAAc,CAAE,kBAAmBoG,EAAOrH,OAAS,MAC1E8I,GAAgBD,GAChB,gBAAC,QAAK,CAACM,QAAQ,QAAQ,oBAAU,wCAGnC,uBAAKlI,UAAU,eACb,6BAAQ,oBAAU,iCAClB,gBAAC,IAAM,CACLA,UAAU,aACVmI,WAAW,EACXnE,SAAUD,GAA2C,IAA7B2D,EAAkB3I,OAC1CkG,SAAUrG,KAAK2I,oBACfa,QAASV,EAAkBV,IAAIN,IAAO,CACpC2B,MAAO,MAAMC,OAAO5B,EAAQO,OAASP,EAAQnF,KAC7CiD,MAAOkC,EAAQ7D,OAEjB2B,MAAOkC,KAGX,uBAAK1G,UAAU,eACb,6BAAQ,oBAAU,aAClB,gBAAC,IAAM,CACLA,UAAU,cACVmI,WAAW,EACXnE,SAAUD,EACVkB,SAAUrG,KAAK4I,qBACfe,eAAgB3J,KAAK6I,qBACrBW,QAAS,IAAWpB,IAAI7G,IAAQ,CAC9BkI,MAAO,oBAAU,WAAYlI,GAC7BqE,MAAOrE,KAETqI,YAAY,EACZhE,MAAOrE,EACPsI,cAAe7J,KAAK6I,wBAGvBE,EACC,uBAAK3H,UAAU,eACb,qBAAGA,UAAU,QAAQ,oBAAU,gDAGjCoG,EAAOY,IAAIX,GACT,uBAAKrG,UAAU,cAAc6C,IAAKwD,EAAMxD,KACtC,yBAAOM,MAAOkD,EAAMxD,KAAMwD,EAAMxD,KAChB,SAAfwD,EAAMtG,KACL,4BACEiE,SAAUD,EACVxC,KAAM8E,EAAMxD,IACZoC,SAAUrG,KAAK0I,sBACfoB,YAAarC,EAAMC,aACnBV,KAAM,EACNpB,MAAO5F,KAAKR,MAAMgI,OAAOC,EAAMxD,MAAQ,KAGzC,yBACEmB,SAAUD,EACVxC,KAAM8E,EAAMxD,IACZoC,SAAUrG,KAAK0I,sBACfoB,YAAarC,EAAMC,aACnBvG,KAAK,OACLyE,MAAO5F,KAAKR,MAAMgI,OAAOC,EAAMxD,MAAQ,KAG3C,uBACE7C,UAAU,OAEVuF,wBAAyB,CAAEC,OAAQa,EAAMN,UAAY,SAO/D,0BAAQ/F,UAAU,cACf+D,GAAc,qBAAG/D,UAAU,yBAC5B,gBAAC,eAAY,CAACgE,SAAUD,GAAc6D,GACnCC,EAAe,oBAAU,QAAU,oBAAU,0BAEhD,gBAAC,kBAAe,CAAC7D,SAAUD,EAAYE,QAASrF,KAAKC,MAAM+E,SACxD,oBAAU,iB,kCCjPzB,OAAe,yK,kCCAf,OAAe,iO,kCCAf,OAAe,sO,qnCCqDA,MAAM,UAAwB,gBAG3C,YAAY/E,GACVoH,MAAMpH,GAHR,KAAAV,SAAU,EAuBV,KAAAwK,oBAAuBP,IACrB,MAAMQ,EAAmBR,EAAQpB,IAAI6B,GAAUA,EAAOrE,OACtD5F,KAAKM,SAAS,CAAE0J,sBAGlB,KAAAE,4BAA8B,EAAGvK,QAAOwK,sBAAuBnK,KAAKC,SAClE,IAAI2H,EAAWwC,OAAOC,OAAOF,GAI7B,OAHIxK,EAAM2K,UAAUnK,OAAS,IAC3ByH,EAAWA,EAASC,OAAOC,GAAWnI,EAAM2K,UAAUC,SAASzC,EAAQI,YAElEN,EACJC,OAAOC,GAAWA,EAAQE,SAAWF,EAAQE,QAAQC,MACrDJ,OAAOC,IAAYA,EAAQC,YAGhC,KAAAyC,gBAAkB,CAAC1C,EAAiB2C,KAClC,GAAIzK,KAAKT,QAAS,CAChB,MAAMmL,EAA2B,CAC/BC,OAAQF,EAASE,QAAU,EAC3B7C,UACA8C,UAAWH,EAASG,WAAa,GAEnC5K,KAAKM,SAASd,IAAK,CAAOqL,QAAS,IAAIrL,EAAMqL,QAASH,QAI1D,KAAAI,aAAe,KACb,IAAIC,EAASC,QAAQC,UAGrB,MAAMzC,EAAO,YAAexI,KAAKC,MAAMN,cAChC6I,EAAKV,QAEZ,MAAMoD,EAA+B,aAAtBlL,KAAKC,MAAMkL,OAAwB,IAAoB,IAIhEvD,EAAqB5H,KAAKC,MAAM6H,QAClC,CAAC9H,KAAKC,MAAM6H,QAAQ7D,KACpBjE,KAAKR,MAAMwK,iBAEf,IAAK,MAAMlC,KAAWF,EACpBmD,EAASA,EAAO1K,KAAK,IACnB6K,EAAO,EAAD,GACD1C,EADC,CAEJpI,aAAcJ,KAAKC,MAAMG,aACzBgL,UAAWtD,KACVzH,KAAKoK,GAAYzK,KAAKwK,gBAAgB1C,EAAS2C,KAGtD,OAAOM,GAGT,KAAAzC,iBAAoB5C,IAClBA,EAAM6C,iBACNvI,KAAKM,SAAS,CAAE6E,YAAY,IAC5BnF,KAAK8K,eAAezK,KAClB,KACML,KAAKT,SACPS,KAAKM,SAAS,CAAE+K,UAAU,EAAMlG,YAAY,KAGhD,KACMnF,KAAKT,SACPS,KAAKM,SAAS,CAAE6E,YAAY,OAMpC,KAAAmG,aAAgBZ,IACd,MAAQ5C,QAASyD,GAAeb,EAC1B5C,EAAU9H,KAAKC,MAAMkK,mBAAmBoB,GAC9C,IAAKzD,EACH,OAAO,KAET,MAAM,UAAEwC,GAActK,KAAKC,MACrBiI,EAAWoC,EAAUxC,EAAQI,UAC/BoC,EAAUxC,EAAQI,UAAUvF,KAC5BmF,EAAQI,SACZ,OACE,gBAACsD,EAAA,MAAK,CAACvH,IAAKyG,EAAO5C,QAASwB,QAA2B,IAAlBoB,EAAOC,OAAe,UAAY,WACpED,EAAOC,OACJ,kCACE,mCACA7C,EAAQnF,KACRuF,EACAwC,EAAOE,UACPF,EAAOC,QAET,kCACE,mCACA7C,EAAQnF,KACRuF,EACAwC,EAAOE,aAMnB,KAAAa,oBAAsB,KACpB,MACMjC,EADWxJ,KAAKkK,8BACG9B,IAAIN,IAAO,CAClC2B,MAAM,GAAD,OAAK3B,EAAQnF,KAAb,cAAuBmF,EAAQ4D,cACpC9F,MAAOkC,EAAQ7D,OAEjB,OACE,gBAAC,IAAM,CACL0H,OAAO,EACPtF,SAAUrG,KAAK+J,oBACfP,QAASA,EACT5D,MAAO5F,KAAKR,MAAMwK,oBAhItB,MAAMA,EAAmB,GACnB4B,EAAoB5L,KAAKkK,4BAA4BjK,GAC1B,IAA7B2L,EAAkBzL,QACpB6J,EAAiB6B,KAAKD,EAAkB,GAAG3H,KAG7CjE,KAAKR,MAAQ,CAAE6L,UAAU,EAAOR,QAAS,GAAIb,mBAAkB7E,YAAY,GAG7E,oBACEnF,KAAKT,SAAU,EAGjB,uBACES,KAAKT,SAAU,EAuHjB,SACE,MAAM,OAAE4L,EAAF,QAAUrD,EAAV,MAAmBgE,GAAU9L,KAAKC,MAClC8E,EACO,aAAXoG,EAAA,UACO,oBAAU,4CADjB,aACiE,wBAC3DW,EACA,OAHN,YAIS,oBAAU,uBAJnB,eAKO,oBAAU,8CALjB,aAKmE,wBAC7DA,EACA,OAPN,YAQS,oBAAU,uBARnB,KAUF,OACE,gBAAC,IAAK,CAAC5C,aAAcnE,EAAQqE,eAAgBpJ,KAAKC,MAAM+E,QAASqE,KAAK,SACpE,wBAAMvE,SAAU9E,KAAKsI,kBACnB,0BAAQlH,UAAU,cAChB,0BAAK2D,IAGP,uBAAK3D,UAAU,cACZpB,KAAKR,MAAMqL,QAAQzC,IAAIpI,KAAKsL,eAE3BtL,KAAKR,MAAM6L,WAAarL,KAAKR,MAAM2F,YACnC,uBAAK/D,UAAU,eACb,0BACE,yBAAO2K,QAAQ,oCACD,aAAXZ,EACG,oBAAU,4BACV,oBAAU,gCAGjBrD,EACC,4BACGA,EAAQnF,KACR,MACA,oBAAU,iBAGb3C,KAAKyL,wBAMb,0BAAQrK,UAAU,cACfpB,KAAKR,MAAM2F,YAAc,qBAAG/D,UAAU,0BACrCpB,KAAKR,MAAM6L,UACX,gBAAC,eAAY,CAACjG,SAAUpF,KAAKR,MAAM2F,WAAYsB,GAAG,mCAC/C,oBAAU,UAGf,gBAAC,kBAAe,CAACpB,QAASrF,KAAKC,MAAM+E,SAClChF,KAAKR,MAAM6L,SAAW,oBAAU,SAAW,oBAAU,e,aC3MrD,MAAM,UAAmB,gBAAxC,c,oBACE,KAAA7L,MAAe,CAAEwM,OAAO,GAExB,KAAAC,mBAAqB,KACnB,MAAM,QAAEnE,GAAY9H,KAAKC,MAAMN,MAC/B,OAAQmI,GAAW9H,KAAKC,MAAMkK,mBAAmBrC,SAAaxE,GAGhE,KAAA4I,WAAa,IAAMlM,KAAKM,SAAS,CAAE6K,YAAQ7H,EAAW0I,OAAO,EAAOlE,aAASxE,IAE7E,KAAA6I,oBAAuBzG,IACrBA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OACpBpM,KAAKM,SAAS,CAAE6K,OAAQ,WAAYa,OAAO,EAAMlE,aAASxE,KAG5D,KAAA+I,6BAAgC3G,IAC9BA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OACpBpM,KAAKM,SAAS,CAAE6K,OAAQ,WAAYa,OAAO,EAAMlE,QAAS9H,KAAKiM,wBAGjE,KAAAK,sBAAyB5G,IACvBA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OACpBpM,KAAKM,SAAS,CAAE6K,OAAQ,aAAca,OAAO,EAAMlE,aAASxE,KAG9D,KAAAiJ,+BAAkC7G,IAChCA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OACpBpM,KAAKM,SAAS,CAAE6K,OAAQ,aAAca,OAAO,EAAMlE,QAAS9H,KAAKiM,wBAGnE,SAKE,IAHsB7B,OAAOC,OAAOrK,KAAKC,MAAMkK,oBAAoBqC,KAAK1E,GACtE2E,QAAQ3E,EAAQE,SAAWF,EAAQE,QAAQC,OAG3C,OACE,gBAAC,IAAO,CAAC/G,QAAS,oBAAU,qCAC1B,gBAAC,SAAM,CAACE,UAAU,iBAAiBgE,UAAU,GAC1C,oBAAU,iBAMnB,MAAM,WAAEmC,GAAevH,KAAKC,MAAMN,MAC5BmI,EAAU9H,KAAKiM,qBACfS,EAAmBD,QACvB3E,IAAYA,EAAQC,WAAaD,EAAQE,SAAWF,EAAQE,QAAQC,MAEhE0E,EAAyBD,IAAmC,IAAfnF,EAC7CqF,EAA2BF,IAAmC,IAAfnF,EAErD,OACE,gCACE,gBAAC,IAAQ,CACPnG,UAAU,YACVY,iBAAkB,iBAAeC,WACjCf,QACE,sBAAIE,UAAU,QACZ,0BACE,qBAAGyL,KAAK,IAAIxH,QAASrF,KAAKmM,qBACvB,oBAAU,4BACT,MAELQ,GAA0B7E,GACzB,0BACE,qBAAG+E,KAAK,IAAIxH,QAASrF,KAAKqM,8BACvB,oBAAU,4B,IAA6B,8BAASvE,EAAQnF,QAI/D,0BACE,qBAAGkK,KAAK,IAAIxH,QAASrF,KAAKsM,uBACvB,oBAAU,8BACT,MAELM,GAA4B9E,GAC3B,0BACE,qBAAG+E,KAAK,IAAIxH,QAASrF,KAAKuM,gCACvB,oBAAU,8B,IAA+B,8BAASzE,EAAQnF,UAMrE,gBAAC,SAAM,CAACvB,UAAU,kBAAkB,oBAAU,iBAE/CpB,KAAKR,MAAMwM,OAAShM,KAAKR,MAAM2L,QAC9B,gBAAC,EAAe,CACdA,OAAQnL,KAAKR,MAAM2L,OACnBb,UAAWtK,KAAKC,MAAMqK,UACtBtF,QAAShF,KAAKkM,WACd9L,aAAcJ,KAAKC,MAAMG,aACzB0H,QAAS9H,KAAKR,MAAMsI,QACpBnI,MAAOK,KAAKC,MAAMN,MAClBwK,mBAAoBnK,KAAKC,MAAMkK,mBAC/B2B,MAAO9L,KAAKC,MAAM6L,U,2IC5Ff,MAAM,WAAc,gBAAnC,c,oBACE,KAAAgB,gBAAkB,CAACC,EAAmBC,KACpC,MAAM,OAAE3C,GAAWrK,KAAKC,MACxB,IAAIgN,EACJ,GAAIjN,KAAKC,MAAMiN,gBAAiB,CAE9BD,EAAWF,KADG1C,EAAOlK,OAASkK,EAAO,QAAK/G,QACTA,EAAYyJ,OAE7CE,EADSD,EACE,KACT3C,EAAOE,SAASwC,GAAa,IAAQ1C,EAAQ0C,GAAa,IAAI1C,EAAQ0C,IAG7D1C,EAAOE,SAASwC,IAAc1C,EAAOlK,OAAS,EAAI,GAAK,CAAC4M,GAErE/M,KAAKC,MAAMoG,SAAS,CAAE,CAACrG,KAAKC,MAAMkN,UAAWF,KAG/C,KAAAG,kBAAoB,IAAMpN,KAAKC,MAAMoN,SAASrN,KAAKC,MAAMkN,UAEzD,KAAAG,YAAc,IAAMtN,KAAKC,MAAMoG,SAAS,CAAE,CAACrG,KAAKC,MAAMkN,UAAW,KAEjE,KAAAI,QAAW3H,GAAkB5F,KAAKC,MAAMuN,OAASxN,KAAKC,MAAMuN,MAAM5H,GAElE,KAAA6H,WAAc7H,IACZ,MAAM8H,EAAS1N,KAAKC,MAAMoK,OAAOE,SAAS3E,GACpC+H,EAAO3N,KAAKuN,QAAQ3H,IACpB,WAAEgI,EAAaC,GAAf,eAAkCC,EAAiBD,IAAsB7N,KAAKC,MAEpF,OACE,gBAAC8N,GAAA,EAAS,CACRL,OAAQA,EACRtI,SAAmB,IAATuI,IAAeD,EACzBM,UAAWhO,KAAKC,MAAM+N,UACtB/J,IAAK2B,EACLjD,KAAMiL,EAAWhI,GACjBP,QAASrF,KAAK8M,gBACda,KAAMA,GAAQ,wBAAcA,EAAM,aAClCM,QAASH,EAAelI,GACxBA,MAAOA,KAKb,SACE,MAAM,SAAER,EAAF,eAAY0I,EAAiBD,GAA7B,MAAgDL,GAAUxN,KAAKC,MAC/DoK,EAASrK,KAAKC,MAAMoK,OAAOjC,IAAI0F,GAC/BI,EACJlO,KAAKC,MAAMuJ,SACVgE,GACC,KACEpD,OAAO+D,KAAKX,GACZvJ,IAAQuJ,EAAMvJ,GACdA,GAAO6J,EAAe7J,GAAKmK,eAGjC,OACE,gBAACC,GAAA,EAAQ,CACPjN,UAAW,GAAW,CAAE,uCAAwCgE,IAChE+H,SAAUnN,KAAKC,MAAMkN,UACrB,gBAACmB,GAAA,EAAW,CACV3L,KACE,gBAAC,IAAO,CAACzB,QAASkE,EAAWpF,KAAKC,MAAMsO,oBAAiBjL,GACvD,4BAAO,oBAAU,qBAAsBtD,KAAKC,MAAMkN,YAGtDqB,QAASxO,KAAKsN,YACdjI,QAASD,OAAW9B,EAAYtD,KAAKoN,kBACrCqB,KAAMzO,KAAKC,MAAMwO,OAASrJ,EAC1BiF,OAAQA,GACPrK,KAAKC,MAAMyO,UAGb1O,KAAKC,MAAMwO,WAAkBnL,IAAV4K,GAClB,gBAACS,GAAA,EAAc,KAAET,EAAM9F,IAAIpI,KAAKyN,aAGjCzN,KAAKC,MAAMwO,WAAoCnL,IAA5BtD,KAAKC,MAAM2O,cAA8B5O,KAAKC,MAAM2O,iBAMhF,SAASf,GAAkBjI,GACzB,OAAOA,EC1GM,MAAM,WAAgC,gBAArD,c,oBACE,KAAAgI,WAAcrM,GAAqB,gBAACD,EAAA,EAAc,CAACC,SAAUA,IAE7D,KAAAuM,eAAkBvM,GAAqB,oBAAU,WAAYA,GAE7D,SACE,OACE,gBAAC,GAAK,iBACAvB,KAAKC,MAAK,CACdmF,SAAUpF,KAAKC,MAAMmF,SACrBmJ,eAAgB,oBAAU,iDAC1BP,WAAW,EACXxE,QAAS,IACT2D,SAAS,uBACTS,WAAY5N,KAAK4N,WACjBE,eAAgB9N,KAAK8N,mB,kCCT7B,MAAM,WAA4B,gBAAlC,c,oBACE,KAAAV,kBAAoB,KAClBpN,KAAKC,MAAMoN,SAAS,mBAGtB,KAAAC,YAAc,KACZtN,KAAKC,MAAMoG,SAAS,CAAEwI,oBAAgBvL,KAGxC,KAAAwL,mBAAsBzM,IACpBrC,KAAKC,MAAMoG,SAAS,CAAEwI,eAAgBxM,KAGxC,KAAA0M,UAAY,IACV/O,KAAKC,MAAM2F,MACP,CAAC5F,KAAKC,MAAM+O,KAAKC,WAAWjP,KAAKC,MAAM2F,MAAO,8BAC9CtC,EAEN,SACE,OACE,gBAAC+K,GAAA,EAAQ,CAAClB,SAAS,kBACjB,gBAACmB,GAAA,EAAW,CACV3L,KAAM,oBAAU,sCAChB6L,QAASxO,KAAKsN,YACdjI,QAASrF,KAAKoN,kBACdqB,KAAMzO,KAAKC,MAAMwO,KACjBpE,OAAQrK,KAAK+O,cAGd/O,KAAKC,MAAMwO,MACV,gBAACS,GAAA,EAAS,CACRvM,KAAK,kBACL0D,SAAUrG,KAAK8O,mBACfhF,YAAa,oBAAU,QACvBlE,MAAO5F,KAAKC,MAAM2F,UAQf,6BAAW,ICpDX,MAAM,WAA6B,gBAAlD,c,oBACE,KAAAgI,WAAcrM,GAAqB,gBAACD,EAAA,EAAc,CAACC,SAAUA,IAE7D,KAAAuM,eAAkBvM,GAAqB,oBAAU,WAAYA,GAE7D,SACE,OACE,gBAAC,GAAK,iBACAvB,KAAKC,MAAK,CACd+N,WAAW,EACXxE,QAAS,IACT2D,SAAS,aACTS,WAAY5N,KAAK4N,WACjBE,eAAgB9N,KAAK8N,mB,qXCVd,MAAM,WAAyB,gBAA9C,c,oBACE,KAAAF,WAAchI,GACZ,oBAAU,mCAAoCA,EAAMwI,eAEtD,SACE,MAAM,EAAsBpO,KAAKC,OAA3B,MAAE2F,GAAR,EAAkB3F,EAAlB,gBAEA,OACE,gBAAC,GAAK,iBACAA,EAAK,CACTmF,SAAUpF,KAAKC,MAAMmF,SACrBmJ,eAAgB,oBAAU,6CAC1B/E,QAAS,CAAC,OAAQ,YAAa,aAC/B2D,SAAS,cACTS,WAAY5N,KAAK4N,WACjBE,eAAgB9N,KAAK4N,WACrBV,iBAAiB,EACjB7C,OAAQzE,EAAQ,CAACA,GAAS,O,6CCPlC,MAAM,WAAsB,gBAA5B,c,oBACE,KAAAuJ,gBAAmBC,IACjB,MAAMlH,EAAWlI,KAAKC,MAAMoP,mBAAmBC,KAAKC,GAAKA,EAAEtL,MAAQmL,GACnE,OAAOlH,EAAWA,EAASvF,KAAOyM,GAGpC,KAAAI,aAAgB7P,IACd,MACMkL,EADU7K,KAAKyP,wBACG5H,OAAOK,GAC7BA,EAASvF,KAAKyL,cAAc7D,SAAS5K,EAAMyO,gBAEvCsB,EAAS,CAAEC,UAAW,EAAGC,SAAU/E,EAAQ1K,OAAQ2L,MAAOjB,EAAQ1K,QACxE,OAAO6K,QAAQC,QAAQ,CAAEyE,SAAQ7E,aAGnC,KAAA4E,sBAAwB,KACtB,MAAM,mBAAEJ,EAAF,MAAsB7B,EAAQ,IAAOxN,KAAKC,MAKhD,OAAO,KACL,IAAIoP,KAAuBjF,OAAO+D,KAAKX,GAAOpF,IAAInE,IAAG,CAAOA,MAAKtB,KAAMsB,MACvEiE,GAAYA,EAASjE,MAIzB,KAAA4L,mBAAqB,EAAGlN,QAA2BmN,IAC1C,yBAAcnN,EAAMmN,GAG7B,SACE,OACE,gBAACC,GAAA,EAAc,CACb3K,SAAUpF,KAAKC,MAAMmF,SACrBmJ,eAAgB,oBAAU,0CAC1ByB,YAAa,oBAAU,gCACvBC,UAAU,EACVC,iBAAkBlQ,KAAKmP,gBACvBgB,mBAAoBjI,GAAYA,EAASjE,IACzCmM,oBAAqBlI,GAAYA,EAASvF,KAC1C0N,gBAAiB,EACjBhK,SAAUrG,KAAKC,MAAMoG,SACrB3G,SAAUM,KAAKwP,aACfnC,SAAUrN,KAAKC,MAAMoN,SACrBoB,KAAMzO,KAAKC,MAAMwO,KACjBtB,SAAS,YACTmD,gBAAiBtQ,KAAKmP,gBACtBU,mBAAoB7P,KAAK6P,mBACzBU,kBAAmB,oBAAU,+BAC7B/C,MAAOxN,KAAKC,MAAMuN,MAClBnD,OAAQrK,KAAKC,MAAMoK,UAUZ,yBAJU7K,IAAD,CACtB6P,mBAAoBjF,OAAOC,OAAO,uBAAa7K,MAGlC,CAAyB,I,UCzDzB,MAAM,WAAqB,gBAA1C,c,oBACE,KAAAsN,gBAAmB0D,IACjB,MAAMvD,EAAWjN,KAAKC,MAAM2F,QAAU4K,EAAW,GAAKA,EACtDxQ,KAAKC,MAAMoG,SAAS,CAClBkB,gBAAsCjE,IAA1BtD,KAAKC,MAAMsH,YAAkCvH,KAAKC,MAAMsH,WACpEkJ,sBAAkBnN,EAClBwE,QAASmF,KAIb,KAAAG,kBAAoB,IAAMpN,KAAKC,MAAMoN,SAAS,WAE9C,KAAAC,YAAc,IACZtN,KAAKC,MAAMoG,SAAS,CAClBkB,gBAAYjE,EACZoN,qBAAsB,GACtBD,sBAAkBnN,EAClBqN,iBAAarN,EACbwE,aAASxE,IAGb,KAAAsN,kBAAqBlL,IACnB1F,KAAK6Q,gBAAgBnL,GACrB1F,KAAKC,MAAMoG,SAAS,CAAEkB,YAAY,EAAMkJ,sBAAkBnN,KAG5D,KAAAwN,oBAAuBpL,IACrB1F,KAAK6Q,gBAAgBnL,GACrB1F,KAAKC,MAAMoG,SAAS,CAAEkB,YAAY,EAAOkJ,sBAAkBnN,KAG7D,KAAAuN,gBAAmBnL,IACjBA,EAAM6C,iBACN7C,EAAMmL,kBACNnL,EAAMC,cAAcyG,QAGtB,KAAA2E,aAAe,KACb,MAAM,mBAAE5G,EAAF,MAAsBvE,GAAU5F,KAAKC,MAC3C,GAAI2F,EAAO,CACT,MAAMkC,EAAUqC,EAAmBvE,GAEnC,MAAO,CADOkC,GAAO,UAAOA,EAAQnF,KAAf,YAAuBmF,EAAQ4D,eAAmB9F,GAGvE,MAAO,IAIX,KAAAoL,WAAclJ,IACZ,MAAMmJ,EAAI,UAAMnJ,EAAQnF,KAAd,YAAsBmF,EAAQ4D,cACxC,OAAO5D,EAAQC,UAAR,UAAuBkJ,EAAvB,aAAgC,oBAAU,6BAA1C,KAA4EA,GAGrF,KAAArD,WAAc9F,GACZ,gCACGA,EAAQnF,KACT,wBAAMvB,UAAU,2BACb0G,EAAQ4D,aACR5D,EAAQC,WAAR,YAA0B,oBAAU,6BAApC,OAKP,KAAAmJ,iBAAoBpJ,IAClB,MAAMqJ,EAAYrJ,EAAQ7D,MAAQjE,KAAKC,MAAMwQ,iBACvClJ,IAAa4J,GAAmBnR,KAAKC,MAAMsH,WACjD,OACE,gCACE,uCACgBA,EACdnG,UAAW,GAAW,YAAa,eAAgB,qBAAsB,CACvE,sBAAuBmG,IAEzBlC,QAAS8L,EAAYnR,KAAK6Q,gBAAkB7Q,KAAK4Q,kBACjDQ,KAAK,QACLC,UAAW,GAAC,UAGd,wCACiB9J,EACfnG,UAAW,GAAW,cAAe,eAAgB,mBAAoB,CACvE,uBAAwBmG,IAE1BlC,QAAS8L,EAAYnR,KAAK6Q,gBAAkB7Q,KAAK8Q,oBACjDM,KAAK,QACLC,UAAW,GAAC,cAOpB,KAAA5D,WAAc3F,IACZ,MAAM4F,EAAS,CAAC1N,KAAKC,MAAM2F,MAAO5F,KAAKC,MAAMwQ,kBAAkBlG,SAASzC,EAAQ7D,KAEhF,OACE,gBAAC8J,GAAA,EAAS,CACRL,OAAQA,EACRtM,UAAWpB,KAAKC,MAAMwQ,mBAAqB3I,EAAQ7D,IAAM,eAAYX,EACrEW,IAAK6D,EAAQ7D,IACbtB,KAAM3C,KAAK4N,WAAW9F,GACtBzC,QAASrF,KAAK8M,gBACda,KAAM3N,KAAKkR,iBAAiBpJ,GAC5BmG,QAASjO,KAAKgR,WAAWlJ,GACzBlC,MAAOkC,EAAQ7D,OAKrB,SACE,MAAM,UAAEqG,EAAF,mBAAaH,GAAuBnK,KAAKC,MAC/C,IAAI2H,EAAWwC,OAAOC,OAAOF,GAU7B,OATIG,EAAUnK,OAAS,IACrByH,EAAWA,EAASC,OAAOC,GAAWwC,EAAUC,SAASzC,EAAQI,YAEnEN,EAAW,KACTA,EACAE,GAAWA,EAAQnF,KAAKyL,cACxBtG,GAAWA,EAAQ4D,cAInB,gBAAC2C,GAAA,EAAQ,CAAClB,SAAS,WACjB,gBAACmB,GAAA,EAAW,CACV3L,KAAM,oBAAU,+BAChB6L,QAASxO,KAAKsN,YACdjI,QAASrF,KAAKoN,kBACdqB,KAAMzO,KAAKC,MAAMwO,KACjBpE,OAAQrK,KAAK+Q,gBACb,gBAAC7N,GAAA,EAAU,CACT9B,UAAU,cACV+B,IAAK,6CAIRnD,KAAKC,MAAMwO,MAAQ,gBAACE,GAAA,EAAc,KAAE/G,EAASQ,IAAIpI,KAAKyN,e,qXCjJ/D,MAAM,WAAwB,gBAA9B,c,oBACE,KAAA0B,gBAAmBC,IACjB,MAAM,oBAAEkC,GAAwBtR,KAAKC,MAC/BiI,EAAWoJ,EAAoBlC,GACrC,OAAQlH,GAAYA,EAASvF,MAASyM,GAGxC,KAAAxB,WAAc2D,IACZ,MAAM,uBAAE/O,GAA2BxC,KAAKC,MAClCwC,EAAaD,EAAuB+O,GAC1C,OAAO9O,EACL,gCACGA,EAAWE,KACZ,wBAAMvB,UAAU,2BAA2BpB,KAAKmP,gBAAgB1M,EAAWyF,YAG7EqJ,GAIJ,KAAAzD,eAAkByD,IAChB,MAAM,uBAAE/O,GAA2BxC,KAAKC,MAClCwC,EAAaD,EAAuB+O,GAC1C,OAAQ9O,GAAcA,EAAWE,MAAS4O,GAG5C,SACE,MAAM,EAAiEvR,KAAKC,OAAtE,oBAAEqR,EAAF,uBAAuB9O,GAA7B,EAAwDgP,EAAxD,uDACA,OACE,gBAAC,GAAK,iBACAA,EAAU,CACdrE,SAAS,eACTS,WAAY5N,KAAK4N,WACjBE,eAAgB9N,KAAK8N,mBAUd,yBAJUtO,IAAD,CACtB8R,oBAAqB,uBAAa9R,KAGrB,CAAyB,ICnDzB,MAAM,WAAoB,gBAAzC,c,oBACE,KAAAoO,WAAcnM,GAAmB,oBAAU,eAAgBA,EAAO2M,eAElE,SACE,OACE,gBAAC,GAAK,iBACApO,KAAKC,MAAK,CACduJ,QAAS,IACT2D,SAAS,WACTS,WAAY5N,KAAK4N,WACjBE,eAAgB9N,KAAK4N,e,wDCDd,MAAM,WAAiB,gBAAtC,c,oBACE,KAAA4B,aAAgB7P,GACP,YAAY,CAAES,aAAcJ,KAAKC,MAAMG,aAAcP,GAAI,GAAID,EAAGD,IAASU,KAAKH,IAAI,CACvFwP,OAAQ,CAAEC,UAAW,EAAGC,SAAU1P,EAAKC,OAAQ2L,MAAO5L,EAAKC,QAC3D0K,QAAS3K,KAIb,KAAAuR,aAAgBxH,IACdjK,KAAKC,MAAMoG,SAAS,CAAEnG,KAAM,KAAK,IAAIF,KAAKC,MAAMoK,OAAQJ,EAAOrE,WAGjE,KAAA8L,WAAcjR,GACLA,EAGT,KAAAkR,UAAalR,GACX,gCACE,gBAAC,KAAQ,CAACW,UAAU,sBAAsBwQ,KAAM,UAAOC,SACtDpR,GAIL,KAAAoP,mBAAqB,CAACpP,EAAaqP,IACjC,gCACE,gBAAC,KAAQ,CAAC1O,UAAU,sBAAsBwQ,KAAM,UAAOC,SACtD,yBAAcpR,EAAKqP,IAIxB,SACE,OACE,gBAACC,GAAA,EAAc,CACbC,YAAa,oBAAU,2BACvBC,UAAU,EACVC,iBAAkBlQ,KAAK0R,WACvBvB,mBAAoB1P,GAAOA,EAC3B2P,oBAAqB3P,GAAOA,EAC5B4F,SAAUrG,KAAKC,MAAMoG,SACrB3G,SAAUM,KAAKwP,aACfnC,SAAUrN,KAAKC,MAAMoN,SACrBoB,KAAMzO,KAAKC,MAAMwO,KACjBtB,SAAS,OACTmD,gBAAiBtQ,KAAK2R,UACtB9B,mBAAoB7P,KAAK6P,mBACzBU,kBAAmB,oBAAU,0BAC7B/C,MAAOxN,KAAKC,MAAMuN,MAClBnD,OAAQrK,KAAKC,MAAMoK,U,6sBCnDZ,MAAM,WAAsB,gBAA3C,c,oBACE,KAAAyH,aAAgBC,IACd,MAAMC,EAGJC,MAAMC,QAAQH,EAAQC,gBAAkC1O,IAArByO,EAAQC,cACvC1O,EACqB,SAArByO,EAAQC,SACdhS,KAAKC,MAAMoG,S,kWAAX,IAAyB0L,EAAzB,CAAkCC,eAGpC,KAAApE,WAAcoE,GACC,SAAbA,EACI,oBAAU,6CACV,oBAAU,iDAEhB,SACE,MAAM,EAAgChS,KAAKC,OAArC,SAAEoG,EAAF,MAAYT,GAAlB,EAA4B3F,EAA5B,2BAEA,OACE,gBAAC,GAAK,iBACAA,EAAK,CACToG,SAAUrG,KAAK8R,aACftI,QAAS,CAAC,OAAQ,SAClB2D,SAAS,WACTS,WAAY5N,KAAK4N,WACjBE,eAAgB9N,KAAK4N,WACrBV,iBAAiB,EACjB7C,YAAkB/G,IAAVsC,EAAsB,CAACuM,OAAOvM,IAAU,KAChD,gBAAC1C,GAAA,EAAU,CACT9B,UAAU,cACV+B,IAAK,8C,yBCpCA,MAAM,WAAkB,gBAAvC,c,oBACE,KAAAyK,WAAczM,GACZ,gCACE,gBAAC,KAAa,CAACC,UAAU,sBAAsBzB,MAAOwB,IACrD,oBAAU,aAAcA,IAI7B,KAAA2M,eAAkB3M,GAAiB,oBAAU,aAAcA,GAE3D,SAGE,OACE,gBAAC,GAAK,iBACAnB,KAAKC,MAAK,CACduJ,QALY,CAAC,MAAO,gBAAiB,aAAc,oBAMnD2D,SAAS,QACTS,WAAY5N,KAAK4N,WACjBE,eAAgB9N,KAAK8N,mBCMd,SAASsE,GAAWnS,GACjC,MAAMoS,GAAoBpS,EAAMqS,uBAA4ChP,IAAxBrD,EAAMN,MAAMmI,QAE1DyK,OAC6BjP,IAAjCrD,EAAMN,MAAM8Q,uBACcnN,IAA1BrD,EAAMuS,kBACLvS,EAAMuS,gBAAgBC,YAEnBC,OAC6BpP,IAAjCrD,EAAMN,MAAM8Q,uBACcnN,IAA1BrD,EAAMuS,kBACLvS,EAAMN,MAAM4H,WACf,OACE,gCACE,gBAAC,GAAa,CACZnC,SAAUiN,EACVhM,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAWtI,UACzBkD,MAAOvN,EAAM4S,QAAU5S,EAAM4S,OAAOvI,UACpCD,OAAQpK,EAAMN,MAAM2K,YAEtB,gBAAC,GAAS,CACRjE,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAWE,MACzBtF,MAAOvN,EAAM4S,QAAU5S,EAAM4S,OAAOC,MACpCzI,OAAQpK,EAAMN,MAAMmT,QAEtB,gBAAC,GAAQ,CACPzM,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAW1S,KACzBE,aAAcH,EAAMG,aACpBoN,MAAOvN,EAAM4S,QAAU5S,EAAM4S,OAAO3S,KACpCmK,OAAQpK,EAAMN,MAAMO,OAEtB,gBAAC,GAAe,CACdmG,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAWG,aACzBvQ,uBAAwBvC,EAAMuC,uBAC9BgL,MAAOvN,EAAM4S,QAAU5S,EAAM4S,OAAOE,aACpC1I,OAAQpK,EAAMN,MAAMoT,eAEtB,gBAAC,GAAoB,CACnB1M,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAWI,WACzBxF,MAAOvN,EAAM4S,QAAU5S,EAAM4S,OAAOG,WACpC3I,OAAQpK,EAAMN,MAAMqT,aAEtB,gBAAC,GAAW,CACV3M,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAWK,SACzBzF,MAAOvN,EAAM4S,QAAU5S,EAAM4S,OAAOI,SACpC5I,OAAQpK,EAAMN,MAAMsT,WAEtB,gBAACC,EAAA,EAAa,CACZC,IAAKlT,EAAMN,MAAMwT,IACjBC,UAAWnT,EAAM2S,WAAWO,IAC5BE,SAAUpT,EAAM4S,QAAU5S,EAAM4S,OAAOM,IACvCG,aAAa,EACbC,oBAAoB,EACpBC,mBAAmB,EACnBC,6BAA6B,EAC7BpN,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAWc,UACzBC,WAAY1T,EAAMN,MAAMgU,WACxBC,iBAAkB3T,EAAM2S,WAAWe,WACnCE,gBAAiB5T,EAAM4S,QAAU5S,EAAM4S,OAAOc,WAC9ChU,MAAOM,EAAMN,MACbmU,UAAW7T,EAAMN,MAAMmU,UACvBC,gBAAiB9T,EAAM2S,WAAWkB,UAClCE,eAAgB/T,EAAM4S,QAAU5S,EAAM4S,OAAOiB,UAC7CG,oBAAqBhU,EAAMN,MAAMsU,oBACjCC,0BAA2BjU,EAAM2S,WAAWqB,oBAC5CE,yBAA0BlU,EAAM4S,QAAU5S,EAAM4S,OAAOoB,sBAEzD,gBAAC,GAAmB,CAClB5N,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAW/D,eACzBjJ,MAAO3F,EAAMN,MAAMkP,kBAEnB5O,EAAMmU,sBACN,gBAAC,GAAa,CACZ/N,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAWZ,SACzBpM,MAAO3F,EAAMN,MAAMqS,YAGrB/R,EAAMqS,kBACN,gCACE,gBAAC,GAAY,CACX/K,WAAYtH,EAAMN,MAAM4H,WACxBkJ,iBAAkBxQ,EAAMN,MAAM8Q,iBAC9BnG,UAAWrK,EAAMN,MAAM2K,UACvBjE,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAW9K,QACzBqC,mBAAoBlK,EAAMkK,mBAC1BvE,MAAO3F,EAAMN,MAAMmI,UAErB,gBAAC,GAAgB,CACf1C,SAAUmN,EACVlM,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAWjC,YACzB/K,MAAO3F,EAAMN,MAAMgR,cAErB,gBAAC,GAAuB,CACtBvL,SAAUsN,EACVrM,SAAUpG,EAAMyE,eAChB2I,SAAUpN,EAAM0S,cAChBlE,OAAQxO,EAAM2S,WAAWlC,qBACzBlD,MAAOvN,EAAM4S,QAAU5S,EAAM4S,OAAOnC,qBACpCrG,OAAQpK,EAAMN,MAAM+Q,yB,wDCzIjB,SAAS2D,GAAYpU,GAClC,OACE,uBAAKmB,UAAU,cACb,gBAACkT,GAAS,MAEV,gBAAC,KAAe,CAACC,QAAStU,EAAMsU,SAC9B,gBAAC,KAAY,CAAClP,QAASpF,EAAMuU,YAG9BvU,EAAMyP,QACL,gBAAC+E,GAAA,EAAW,CACVrT,UAAU,cACVsT,QAASzU,EAAM0U,cACflL,MAAO,oBAAU,uBACjBqC,MAAO7L,EAAMyP,OAAO5D,SAO9B,SAASwI,KACP,OACE,wBAAMlT,UAAU,yBACd,wBAAMA,UAAU,oBACd,wBAAMA,UAAU,uCAAqC,KACrD,wBAAMA,UAAU,uCAAqC,KACpD,oBAAU,iCAGb,4BACE,wBAAMA,UAAU,uCAAqC,KACrD,wBAAMA,UAAU,uCAAqC,KACpD,oBAAU,wB,8vBCXJ,MAAM,WAA4B,gBAG/C,YAAYnB,GACVoH,MAAMpH,GAHR,KAAAV,SAAU,EAgCV,KAAAqV,eAAiB,KACf,MAAM,WAAEC,EAAF,aAAczU,EAAd,aAA4B0U,GAAiB9U,KAAKC,MAClDuH,EAAS4C,OAAO+D,KAAKnO,KAAKR,MAAMgI,QACnCY,IAAInE,GAAG,UAAOA,EAAP,YAAc,OAAA8Q,GAAA,WAAU/U,KAAKR,MAAMgI,OAAOvD,MACjD+Q,KAAK,KACFC,EAAW,CACfC,qBAAsBlV,KAAKR,MAAM8F,YACjC3C,KAAM3C,KAAKR,MAAMmD,KACjBvC,eACAoH,SACAjG,SAAUvB,KAAKR,MAAM+B,SACrBE,OAAQzB,KAAKR,MAAMiC,QAErB,OAAOoT,EACH,YAAW,MAAKI,EAAN,CAAgBhR,IAAK4Q,EAAW5Q,OAC1C,YAAW,MACNgR,EADK,CAERE,WAAYnV,KAAKR,MAAMyE,IACvBmR,sBAAuBpV,KAAKR,MAAM6V,aAClCC,aAAcR,EAAa7Q,IAC3B9C,KAAMnB,KAAKR,MAAM2B,SAIzB,KAAAmH,iBAAoB5C,IAClBA,EAAM6C,iBACNvI,KAAKM,SAAS,CAAE6E,YAAY,IAC5BnF,KAAK4U,iBAAiBvU,KACpBkV,IACMvV,KAAKT,UACPS,KAAKM,SAAS,CAAE6E,YAAY,IAC5BnF,KAAKC,MAAMwI,OAAO8M,KAGrB9K,IACKzK,KAAKT,SACPS,KAAKM,SAAS,CAAE+U,aAAkC,MAApB5K,EAAShJ,OAAgB0D,YAAY,OAM3E,KAAAqQ,iBAAoB9P,IAClB,MAAQE,MAAOjD,GAAS+C,EAAMC,cAC9B3F,KAAKM,SAASd,IAAK,CACjBmD,OACAsB,IAAKzE,EAAMiW,kBAAoBjW,EAAMyE,IAAM,oBAAStB,GAAMmB,QAAQ,gBAAiB,SAIvF,KAAA4R,gBAAmBhQ,GACjB1F,KAAKM,SAAS,CAAE2D,IAAKyB,EAAMC,cAAcC,MAAO6P,mBAAmB,IAErE,KAAAhQ,wBAA2BC,GACzB1F,KAAKM,SAAS,CAAEgF,YAAaI,EAAMC,cAAcC,QAEnD,KAAA+P,iBAAmB,EAAG/P,WAA+B5F,KAAKM,SAAS,CAAEa,KAAMyE,IAE3E,KAAAgD,qBAAuB,EAAGhD,WAA+B5F,KAAKM,SAAS,CAAEiB,SAAUqE,IAEnF,KAAAgQ,mBAAqB,EAAGhQ,WAA+B5F,KAAKM,SAAS,CAAEmB,OAAQmE,IAE/E,KAAA8C,sBAAyBhD,IACvB,MAAM,KAAE/C,EAAF,MAAQiD,GAAUF,EAAMC,cAC9B3F,KAAKM,SAAUd,IAAD,CAAqBgI,OAAO,MAAMhI,EAAMgI,OAAb,CAAqB,CAAC7E,GAAOiD,QAGxE,KAAAiQ,gBAAkB,IAChB,uBAAKzU,UAAU,eACb,yBAAO2K,QAAQ,0CACZ,oBAAU,Q,IAAS,sBAAI3K,UAAU,aAAW,MAE/C,yBACE2F,WAAW,EACX3B,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAG,yCACHJ,SAAUrG,KAAKwV,iBACfM,UAAU,EACV3U,KAAK,OACLyE,MAAO5F,KAAKR,MAAMmD,QAKxB,KAAAoT,eAAiB,IACf,uBAAK3U,UAAU,eACb,yBAAO2K,QAAQ,yCACZ,oBAAU,O,KAAU/L,KAAKC,MAAM4U,YAAc,sBAAIzT,UAAU,aAAW,MAGxEpB,KAAKC,MAAM4U,WACV,wBAAMzT,UAAU,sCAAsCmD,MAAOvE,KAAKC,MAAM4U,WAAW5Q,KAChFjE,KAAKC,MAAM4U,WAAW5Q,KAGzB,yBACEmB,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAG,wCACHJ,SAAUrG,KAAK0V,gBACfI,UAAU,EACV3U,KAAK,OACLyE,MAAO5F,KAAKR,MAAMyE,OAM1B,KAAA+R,uBAAyB,IACvB,uBAAK5U,UAAU,eACb,yBAAO2K,QAAQ,sDACZ,oBAAU,e,IAAgB,sBAAI3K,UAAU,aAAW,MAEtD,4BACEgE,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAG,qDACHJ,SAAUrG,KAAKyF,wBACfqQ,UAAU,EACV9O,KAAM,EACNpB,MAAO5F,KAAKR,MAAM8F,cAEpB,gBAAC2B,GAAA,EAAY,CAAC7F,UAAU,uCAI5B,KAAA6U,iBAAmB,EAAGrQ,WACb,gBAACsQ,GAAA,EAAU,CAAC/U,KAAMyE,IAG3B,KAAAuQ,gBAAkB,IAChB,uBAAK/U,UAAU,mCACb,yBAAO2K,QAAQ,iCAAiC,oBAAU,SAC1D,gBAAC,IAAM,CACLxC,WAAW,EACXnE,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAG,gCACHJ,SAAUrG,KAAK2V,iBACfhM,eAAgB3J,KAAKiW,iBACrBzM,QAAS,IAAWpB,IAAIjH,IAAI,CAC1BsI,MAAO,oBAAU,aAActI,GAC/ByE,MAAOzE,KAETyI,YAAY,EACZhE,MAAO5F,KAAKR,MAAM2B,KAClB0I,cAAe7J,KAAKiW,oBAK1B,KAAApN,qBAAuB,EAAGjD,WAA+B,gBAACtE,EAAA,EAAc,CAACC,SAAUqE,IAEnF,KAAAwQ,oBAAsB,IACpB,uBAAKhV,UAAU,mCACb,yBAAO2K,QAAQ,qCAAqC,oBAAU,aAC9D,gBAAC,IAAM,CACLxC,WAAW,EACXnE,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAG,oCACHJ,SAAUrG,KAAK4I,qBACfe,eAAgB3J,KAAK6I,qBACrBW,QAAS,IAAWpB,IAAI7G,IAAQ,CAC9BkI,MAAO,oBAAU,WAAYlI,GAC7BqE,MAAOrE,KAETqI,YAAY,EACZhE,MAAO5F,KAAKR,MAAM+B,SAClBsI,cAAe7J,KAAK6I,wBAK1B,KAAAwN,kBAAoB,IAClB,uBAAKjV,UAAU,sBACb,yBAAO2K,QAAQ,mCACZ,oBAAU,gCAEb,gBAAC,IAAM,CACLxC,WAAW,EACXnE,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAG,kCACHJ,SAAUrG,KAAK4V,mBACfpM,QAAS,IAAcpB,IAAI3G,IAAM,CAC/BgI,MAAO,oBAAU,eAAgBhI,GACjCmE,MAAOnE,KAETmI,YAAY,EACZhE,MAAO5F,KAAKR,MAAMiC,UAKxB,KAAA6U,qBAAwB7O,GACtB,uBAAKrG,UAAU,cAAc6C,IAAKwD,EAAMxD,KACtC,yBAAO7C,UAAU,aAAa2K,QAAStE,EAAMxD,KAC1CwD,EAAMxD,KAGO,SAAfwD,EAAMtG,KACL,4BACEiE,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAIgB,EAAMxD,IACVtB,KAAM8E,EAAMxD,IACZoC,SAAUrG,KAAK0I,sBACfoB,YAAarC,EAAMC,aACnBV,KAAM,EACNpB,MAAO5F,KAAKR,MAAMgI,OAAOC,EAAMxD,MAAQ,KAGzC,yBACEmB,SAAUpF,KAAKR,MAAM2F,WACrBsB,GAAIgB,EAAMxD,IACVtB,KAAM8E,EAAMxD,IACZoC,SAAUrG,KAAK0I,sBACfoB,YAAarC,EAAMC,aACnBvG,KAAK,OACLyE,MAAO5F,KAAKR,MAAMgI,OAAOC,EAAMxD,MAAQ,KAG3C,uBACE7C,UAAU,0BAEVuF,wBAAyB,CAAEC,OAAQa,EAAMN,UAAY,OAxPzD,MAAMK,EAAyB,GAC/B,GAAIvH,EAAM4U,YAAc5U,EAAM4U,WAAWrN,OACvC,IAAK,MAAMC,KAASxH,EAAM4U,WAAWrN,OACnCA,EAAOC,EAAMxD,KAAOwD,EAAMC,cAAgB,GAG9C1H,KAAKR,MAAQ,CACX8F,YAAcrF,EAAM4U,YAAc5U,EAAM4U,WAAW0B,QAAW,GAC9DtS,IAAK,GACLwR,mBAAmB,EACnB9S,KAAO1C,EAAM4U,YAAc5U,EAAM4U,WAAWlS,MAAS,GACrD6E,SACA6N,cAAc,EACd9T,SAAWtB,EAAM4U,YAAc5U,EAAM4U,WAAWtT,UAAatB,EAAM6U,aAAavT,SAChFE,OAASxB,EAAM4U,YAAc5U,EAAM4U,WAAWpT,QAAWxB,EAAM6U,aAAarT,OAC5E0D,YAAY,EACZhE,KAAOlB,EAAM4U,YAAc5U,EAAM4U,WAAW1T,MAASlB,EAAM6U,aAAa3T,MAI5E,oBACEnB,KAAKT,SAAU,EAGjB,uBACES,KAAKT,SAAU,EAoOjB,SACE,MAAM,WAAEsV,EAAF,aAAcC,GAAiB9U,KAAKC,OACpC,aAAEoV,EAAF,WAAgBlQ,GAAenF,KAAKR,OACpC,OAAEgI,EAAS,IAAOsN,EAClB/P,EAAS8P,EACX,oBAAU,mCACV,oBAAU,mCACd,IAAI2B,EAASxW,KAAKC,MAAM4U,WAAa,oBAAU,QAAU,oBAAU,UAInE,OAHI7U,KAAKR,MAAM6V,eACbmB,EAAS,oBAAU,4BAGnB,gBAAC,IAAK,CAACtN,aAAcnE,EAAQqE,eAAgBpJ,KAAKC,MAAM+E,SACtD,wBAAMF,SAAU9E,KAAKsI,kBACnB,uBAAKlH,UAAU,cACb,0BAAK2D,IAGP,uBAAK3D,UAAU,8BACZiU,GACC,gBAAC7J,EAAA,MAAK,CAAClC,QAAQ,WAAW,oBAAU,iCAGrCtJ,KAAK6V,kBACL7V,KAAK+V,iBACN,uBAAK3U,UAAU,+BAEXyT,GAAc7U,KAAKmW,kBACpBnW,KAAKoW,sBACLpW,KAAKqW,qBAEPrW,KAAKgW,yBACLxO,EAAOY,IAAIpI,KAAKsW,uBAGnB,uBAAKlV,UAAU,cACZ+D,GAAc,qBAAG/D,UAAU,yBAC5B,gBAAC,eAAY,CAACgE,SAAUpF,KAAKR,MAAM2F,YAAaqR,GAChD,gBAAC,kBAAe,CACdpR,SAAUD,EACVsB,GAAG,2CACHpB,QAASrF,KAAKC,MAAM+E,SACnB,oBAAU,eChUV,MAAM,WAAyB,gBAA9C,c,oBACE,KAAAzF,SAAU,EACV,KAAAC,MAAe,CAAEwM,OAAO,GAUxB,KAAAyK,YAAc,KACZzW,KAAKM,SAAS,CAAE0L,OAAO,KAGzB,KAAA0K,iBAAmB,KACb1W,KAAKT,SACPS,KAAKM,SAAS,CAAE0L,OAAO,KAI3B,KAAA2K,WAAcpB,IACZvV,KAAK0W,mBACL1W,KAAKC,MAAMwI,OAAO8M,IApBpB,oBACEvV,KAAKT,SAAU,EAGjB,uBACES,KAAKT,SAAU,EAkBjB,SACE,OACE,gCACGS,KAAKC,MAAMyO,SAAS,CAAErJ,QAASrF,KAAKyW,cACpCzW,KAAKR,MAAMwM,OACV,gBAAC,GAAmB,CAClB6I,WAAY7U,KAAKC,MAAM4U,WACvB7P,QAAShF,KAAK0W,iBACdjO,OAAQzI,KAAK2W,WACbvW,aAAcJ,KAAKC,MAAMG,aACzB0U,aAAc9U,KAAKC,MAAM6U,iB,cC7BtB,MAAM,WAA+B,gBAApD,c,oBACE,KAAAvV,SAAU,EACV,KAAAC,MAAe,CAAE+U,SAAS,GAiB1B,KAAAqC,WAAa,KACX5W,KAAKM,SAAS,CAAEiU,SAAS,IACzB,YAAY,CACVsC,EAAG,uBACHzW,aAAcJ,KAAKC,MAAMG,aACzBkV,aAActV,KAAKC,MAAMgB,YAAYgD,MACpC5D,KACD,EAAGyW,YACG9W,KAAKT,SACPS,KAAKM,SAAS,CAAEwW,QAAOvC,SAAS,KAGpC,KACMvU,KAAKT,SACPS,KAAKM,SAAS,CAAEiU,SAAS,OAMjC,KAAAwC,iBAAoBxB,IACdvV,KAAKT,SACPS,KAAKM,SAAS,EAAGwW,QAAQ,OAAX,CACZA,MAAO,IAAIA,EAAOvB,OAKxB,KAAAyB,iBAAoBC,GACX,YAAW,CAAEhT,IAAKgT,EAAS7W,aAAcJ,KAAKC,MAAMG,eAAgBC,KAAK,KAC1EL,KAAKT,SACPS,KAAKM,SAAS,EAAGwW,QAAQ,OAAX,CACZA,MAAOA,EAAMjP,OAAOlD,GAAQA,EAAKV,MAAQgT,QAMjD,KAAAC,WAAcvS,GACZ,kCAAeA,EAAKV,IAAKA,IAAKU,EAAKV,KACjC,sBAAI7C,UAAU,iCACZ,gBAAC,OAAI,CAAC6B,GAAI,aAAW0B,EAAKV,IAAKjE,KAAKC,MAAMG,eAAgBuE,EAAKhC,OAGjE,sBAAIvB,UAAU,qCACZ,gBAACE,EAAA,EAAc,CAACF,UAAU,sBAAsBG,SAAUoD,EAAKpD,YAGjE,sBAAIH,UAAU,uCACXuD,EAAK6C,QACJ7C,EAAK6C,OACFK,OAAOJ,GAASA,EAAMC,cACtBU,IAAIX,GACH,uBAAKrG,UAAU,qCAAqC6C,IAAKwD,EAAMxD,KAC7D,wBAAM7C,UAAU,OAAOqG,EAAMxD,KAC7B,wBAAM7C,UAAU,OAAK,MACrB,wBAAMA,UAAU,QAAQmD,MAAOkD,EAAMC,cAClCD,EAAMC,iBAMlB1H,KAAKC,MAAMkX,WACV,sBAAI/V,UAAU,oCACZ,gBAAC,KAAa,CACZgW,kBAAmB,oBAAU,UAC7BC,YAAa1S,EAAKV,IAClBqT,eAAe,EACfC,UAAW,kCAAwB,qCAAsC5S,EAAKhC,MAC9EwG,YAAa,oBAAU,4BACvBqO,UAAWxX,KAAKgX,kBACf,EAAG3R,aACF,gBAAC,SAAM,CAACjE,UAAU,mCAAmCiE,QAASA,GAC3D,oBAAU,cAzFzB,oBACErF,KAAKT,SAAU,EACfS,KAAK4W,aAGP,mBAAmBa,GACbA,EAAUxW,YAAYgD,MAAQjE,KAAKC,MAAMgB,YAAYgD,KACvDjE,KAAK4W,aAIT,uBACE5W,KAAKT,SAAU,EAsFjB,SACE,MAAM,QAAEgV,EAAF,MAAWuC,EAAQ,IAAO9W,KAAKR,MAErC,OACE,uBAAK4B,UAAU,4CACb,uBAAKA,UAAU,4CACb,uBAAKA,UAAU,kCAEf,sBAAIA,UAAU,6BAA6B,oBAAU,8BAEpDpB,KAAKC,MAAMkX,WACV,gBAAC,GAAgB,CACf1O,OAAQzI,KAAK+W,iBACb3W,aAAcJ,KAAKC,MAAMG,aACzB0U,aAAc9U,KAAKC,MAAMgB,aACxB,EAAGoE,aACF,gBAAC,SAAM,CAACjE,UAAU,oCAAoCiE,QAASA,GAC5D,oBAAU,yBAMnB,gBAAC,KAAe,CAACjE,UAAU,cAAcmT,QAASA,GAC/CuC,EAAM3W,OAAS,GACd,yBAAOiB,UAAU,2BAA2BqF,GAAG,oCAC7C,6BAAQ,KAAOqQ,EAAOnS,GAAQA,EAAKhC,MAAMyF,IAAIpI,KAAKkX,kB,mCC3H3D,MAAM,WAA0B,gBAAvC,c,oBACE,KAAA3X,SAAU,EACV,KAAAC,MAAe,CAAE+U,SAAS,GAiB1B,KAAAmD,YAAc,KACZ,MACEzW,aAAa,IAAEgD,GADX,aAEJ7D,GACEJ,KAAKC,MAETD,KAAKM,SAAS,CAAEiU,SAAS,IACzB,aACE,CACEoD,SAAU,QACVb,MAAO7S,EACP7D,gBAEF,YACAC,KACA,EAAGuX,QAAOnN,eACR,GAAIzK,KAAKT,QAAS,CAChB,MAAM,WAAEsY,EAAa,GAAf,OAAmBnI,GAAWjF,EAC9BqN,EAAW,GACjB,IAAK,MAAMC,KAAQH,EAAO,CACxB,MAAMI,EAAUH,EAAWvI,KAAK2I,GAAaA,EAAUhU,MAAQ8T,EAAKG,KAChEF,GACFF,EAASjM,KAAK,CAAEsM,MAAOJ,EAAKI,MAAOlU,IAAK+T,EAAQ/T,IAAKtB,KAAMqV,EAAQrV,OAGvE3C,KAAKM,SAAS,CAAEwX,WAAUvD,SAAS,EAAOzI,MAAO4D,EAAO5D,UAG5D,KACM9L,KAAKT,SACPS,KAAKM,SAAS,CAAEiU,SAAS,OAMjC,KAAA6D,YAAc,KACZ,MACEnX,aAAa,IAAEgD,GADX,aAEJ7D,GACEJ,KAAKC,OAEH,MAAE6L,GAAU9L,KAAKR,MACvB,QAAc8D,IAAVwI,EACF,OAAO,KAET,MAAMuM,EAAO,aAAa,CAAEV,SAAU,QAASb,MAAO7S,GAAO7D,GAEvDkY,EACJ,wBAAMlX,UAAU,sBACb,IACD,gBAAC,OAAI,CAAC6B,GAAIoV,GAAOvM,GAChB,KAIL,OAAK9L,KAAKC,MAAMsY,SAASC,gBAKvB,gBAAC,IAAO,CAACtX,QAAS,oBAAU,2CAA4CoX,GAJjEA,GAQX,KAAAG,cAAiBT,IACf,MACE/W,aAAa,IAAEgD,GADX,aAEJ7D,GACEJ,KAAKC,MAEHoY,EAAO,aACX,CAAEV,SAAU,QAASb,MAAO7S,EAAK6T,SAAUE,EAAQ/T,KACnD7D,GAEF,OACE,sBAAI6D,IAAK+T,EAAQ/T,KACf,sBAAI7C,UAAU,iCAAiC4W,EAAQrV,MACvD,sBAAIvB,UAAU,uCACZ,gBAAC,OAAI,CAAC6B,GAAIoV,GAAO,wBAAcL,EAAQG,MAAO,WA9FtD,oBACEnY,KAAKT,SAAU,EACfS,KAAK0X,cAGP,mBAAmBD,GACbA,EAAUxW,cAAgBjB,KAAKC,MAAMgB,aACvCjB,KAAK0X,cAIT,uBACE1X,KAAKT,SAAU,EAwFjB,SACE,MAAM,QAAEgV,EAAF,SAAWuD,EAAW,IAAO9X,KAAKR,MAExC,OACE,uBAAK4B,UAAU,sCACb,uBAAKA,UAAU,kCAEf,gBAAC,KAAe,CAACmT,QAASA,GACxB,sBAAInT,UAAU,6BACX,oBAAU,uBACVpB,KAAKoY,eAGPN,EAAS3X,OAAS,GACjB,yBAAOiB,UAAU,gEACf,6BACE,0BACE,sBAAIA,UAAU,gCAAgC0F,QAAS,GACpD,oBAAU,0CAGdgR,EAAS1P,IAAIpI,KAAKyY,oBAUpB,cAAAC,GAAA,GAAa,I,WC5Jb,MAAM,WAA8B,gBAAnD,c,oBACE,KAAAC,gBAAmBlR,GACjB,sBAAIrG,UAAU,gCAAgC6C,IAAKwD,EAAMxD,KACvD,sBAAI7C,UAAU,sCAAsCqG,EAAMxD,KAC1D,sBAAI7C,UAAU,6CACZ,qBACEuF,wBAAyB,CAAEC,OAAQa,EAAMN,UAAY,WAE/B7D,IAAvBmE,EAAMC,cACL,uBAAKtG,UAAU,mBACZ,oBAAU,yCACX,2BACA,wBAAMA,UAAU,uCAAuCqG,EAAMC,iBAOvE,SACE,OACE,uBAAKtG,UAAU,sBACb,sBAAIA,UAAU,6BAA6B,oBAAU,4BACrD,yBAAOA,UAAU,kCACf,6BAAQpB,KAAKC,MAAMuH,OAAOY,IAAIpI,KAAK2Y,qB,yDCX9B,MAAM,WAAyB,gBAA9C,c,oBACE,KAAAnZ,MAAe,CAAEwM,OAAO,GAExB,KAAA4M,kBAAoB,KAClB5Y,KAAKM,SAAS,CAAE0L,OAAO,KAGzB,KAAA6M,iBAAmB,KACjB7Y,KAAKM,SAAS,CAAE0L,OAAO,KAGzB,SACE,OACE,gCACE,gBAAC,SAAM,CACL5K,UAAWpB,KAAKC,MAAMmB,UACtBqF,GAAG,wCACHpB,QAASrF,KAAK4Y,mBACb5Y,KAAKC,MAAM6Y,YAGb9Y,KAAKR,MAAMwM,OACV,gBAAC5E,GAAA,QAAmB,CAClBG,WAAYvH,KAAKC,MAAMsH,WACvB4B,YAAanJ,KAAKC,MAAMkJ,YACxBnE,QAAShF,KAAK6Y,iBACdpQ,OAAQzI,KAAKC,MAAMwI,OACnBrI,aAAcJ,KAAKC,MAAMG,aACzBwH,SAAU5H,KAAKC,MAAM2H,SACrBjD,KAAM3E,KAAKC,MAAM0E,S,qXCzCd,SAASoU,GAAV,GAAyE,IAA3C,UAAE3X,EAAF,YAAauP,GAA8B,EAAdqI,EAAc,kCACrF,MAAMpH,EAAuB,cAAhBjB,EAA8B,UAAOsI,IAAM,UAAOC,cAE/D,OACE,qCACE9X,UAAWA,EACX+X,OAAQ,GACRC,QAAQ,MACRC,QAAQ,YACRC,MAAO,GACPC,SAAS,WACTC,WAAW,gCACPR,GACJ,wBACES,EAAE,uaACFC,MAAO,CAAE9H,OAAM+H,SAAU,cCElB,MAAM,WAA4B,gBAAjD,c,oBACE,KAAAC,eAAiB,IAAM5Z,KAAKC,MAAM4Z,aAElC,KAAAC,iBAAoB7V,IACdA,GACF,YAAe,CACbA,MACA7D,aAAcJ,KAAKC,MAAMG,aACzBuE,KAAM3E,KAAKC,MAAMgB,YAAYgD,MAC5B5D,KAAKL,KAAKC,MAAM8Z,aAAc,SAIrC,KAAAC,aAAgB/V,IACVA,GACF,YAAa,CACXA,MACA7D,aAAcJ,KAAKC,MAAMG,aACzBuE,KAAM3E,KAAKC,MAAMgB,YAAYgD,IAC7BgW,OAAO,IACN5Z,KAAKL,KAAKC,MAAM4Z,WAAY,SAInC,KAAAK,uBAAyB,CAAC3S,EAA8BO,KACtD,IAAKA,EAAQqS,WACX,OAAO,KAET,MAAMC,EAAc,aAClBtS,EAAQqS,WACRrS,EAAQI,SACRlI,KAAKC,MAAMG,cAEb,OACE,uBAAKgB,UAAU,oDACY,cAAvBmG,EAAW8S,SAAkD,cAAvB9S,EAAW8S,UACjD,gCACE,gBAACtB,GAAmB,CAAC3X,UAAU,cAAcuP,YAAapJ,EAAW8S,UACrE,gBAAC,OAAI,CAACjZ,UAAU,iDAAiD6B,GAAImX,GAClEtS,EAAQqS,eAQrB,KAAA9Y,eAAiB,CAACkG,EAA8B+S,IAC9C,sBAAIlZ,UAAU,gDACZ,gBAAC,IAAO,CAACF,QAAS,oBAAU,qCAC1B,4BACE,gBAACI,EAAA,EAAc,CAACF,UAAU,6BAA6BG,SAAUgG,EAAWhG,kBAG1D+B,IAArBgX,GAAkC/S,EAAWhG,WAAa+Y,EAAiB/Y,UAC1E,uBAAKH,UAAU,mDACZ,oBAAU,yB,IAA2B,oBAAU,WAAYkZ,EAAiB/Y,YAMrF,KAAAoX,gBAAkB,CAChBlR,EACA6S,KAEA,MAAMC,EACJD,GAAoBA,EAAiB9S,OAAO8H,KAAKkL,GAAKA,EAAEvW,MAAQwD,EAAMxD,KAClEwW,EAAgBF,GAAiBA,EAAc3U,MAErD,OACE,uBAAKxE,UAAU,gDAAgD6C,IAAKwD,EAAMxD,KACxE,wBAAM7C,UAAU,OAAOqG,EAAMxD,KAC7B,wBAAM7C,UAAU,OAAK,MACrB,wBAAMA,UAAU,QAAQmD,MAAOkD,EAAM7B,OAClC6B,EAAM7B,OAER0U,GAAoB7S,EAAM7B,QAAU6U,GACnC,uBAAKrZ,UAAU,mDACZ,oBAAU,yB,IAA0B,wBAAMA,UAAU,SAASqZ,MAOxE,KAAAC,iBAAmB,CAACnT,EAA8B+S,IAChD,sBAAIlZ,UAAU,kDACXmG,EAAWC,OAAOY,IAAIX,GAASzH,KAAK2Y,gBAAgBlR,EAAO6S,KAIhE,KAAAK,cAAgB,CAACpT,EAA8BO,KAC7C,MAAM8S,EAAU9S,EAAQE,SAAWF,EAAQE,QAAQC,OAASH,EAAQC,WAC9D,YAAE9G,GAAgBjB,KAAKC,MACvB4a,EAAmC,SAAvBtT,EAAW8S,SAAsBvS,EAAQgT,UAC3D,OACE,sBAAI1Z,UAAU,+CACXwZ,GACC,iCACI3Z,EAAY6B,YACZ,gBAAC,GAAgB,CACfyE,WAAYA,EACZuR,WAAY,oBAAU,eACtB1X,UAAU,6CACV+H,YAAa,oBAAU,+BACvBV,OAAQzI,KAAK4Z,eACbxZ,aAAcJ,KAAKC,MAAMG,aACzBwH,SAAU,CAACE,GACXnD,KAAM1D,IAGT4Z,EACwB,cAAvBtT,EAAW8S,SACXvS,EAAQqS,YACN,gBAAC,KAAa,CACZ/C,kBAAmB,oBAAU,OAC7BC,YAAavP,EAAQ7D,IACrBsT,UAAW,kCACT,mDACAzP,EAAQqS,YAEVhR,YAAa,oBAAU,4CACvBqO,UAAWxX,KAAKga,cACf,EAAG3U,aACF,gBAAC,SAAM,CACLjE,UAAU,oEACViE,QAASA,GACR,oBAAU,8CAMnB,gBAAC,KAAa,CACZ+R,kBAAmB,oBAAU,OAC7BC,YAAavP,EAAQ7D,IACrBsT,UAAW,oBAAU,mCACrBpO,YAAa,oBAAU,2BACvBqO,UAAWxX,KAAK8Z,kBACf,EAAGzU,aACF,gBAAC,SAAM,CACLjE,UAAU,wEACViE,QAASA,GACR,oBAAU,gCAW7B,KAAA6L,iBAAoB3J,IAClB,MAAM,YAAEwT,EAAc,GAAhB,YAAoB9Z,GAAgBjB,KAAKC,MACzC6H,EAAU9H,KAAKC,MAAMkK,mBAAmB5C,EAAWyT,UACzD,IAAKlT,EACH,OAAO,KAGT,MAAMwS,EAAmBS,EAAYzL,KAAK2L,GAAKA,EAAED,WAAalT,EAAQgT,WAEtE,OACE,qCAAkBhT,EAAQ7D,IAAKA,IAAK6D,EAAQ7D,KAC1C,sBAAI7C,UAAU,4CACZ,gBAAC,OAAI,CAAC6B,GAAI,aAAqB6E,EAAQnF,KAAMmF,EAAQI,SAAUlI,KAAKC,MAAMG,eACvE0H,EAAQnF,MAEVmF,EAAQC,WAAa,gBAACmT,GAAA,EAA0B,CAAC9Z,UAAU,gBAC3DpB,KAAKka,uBAAuB3S,EAAYO,IAG1C9H,KAAKqB,eAAekG,EAAY+S,IAC/BrZ,EAAY+B,aAAehD,KAAK0a,iBAAiBnT,EAAY+S,GAC9Dta,KAAK2a,cAAcpT,EAAYO,KAKtC,SACE,MAAM,YAAEiT,EAAc,GAAhB,mBAAoB5Q,EAApB,YAAwClJ,GAAgBjB,KAAKC,MAC7Dkb,EAAc/Q,OAAOC,OAAOF,GAAoBqC,KAAK1E,GACzD2E,QAAQ3E,EAAQE,SAAWF,EAAQE,QAAQC,MAAQH,EAAQI,WAAajH,EAAYkH,OAGtF,OACE,uBAAK/G,UAAU,wCACb,uBAAKA,UAAU,gDACb,uBAAKA,UAAU,kCAEf,sBAAIA,UAAU,6BACZ,gBAACga,GAAA,EAAe,CAACC,QAAS,oBAAU,oCAGrCF,GACC,gBAAC,GAAgB,CACfrC,WAAY,oBAAU,yBACtB1X,UAAU,oDACV+H,YAAa,oBAAU,4CACvBV,OAAQzI,KAAK4Z,eACbxZ,aAAcJ,KAAKC,MAAMG,aACzBwH,SAAU,KACR5H,KAAKC,MAAMkK,mBACXrC,IAAYiT,EAAYzL,KAAK/H,GAAcA,EAAWyT,WAAalT,EAAQ7D,MAE7EU,KAAM1D,IAIT8Z,EAAY5a,OAAS,GACpB,yBACEiB,UAAU,iDACVqF,GAAG,wCACH,6BAAQsU,EAAY3S,IAAIpI,KAAKkR,uB,6rBC1M5B,MAAM,WAAoB,gBAAzC,c,oBACE,KAAA3R,SAAU,EACV,KAAAC,MAAe,CAAE+U,SAAS,GAmB1B,KAAA+G,iBAAmB,IACV,YAAe,CACpBC,SAAS,EACTtX,IAAKjE,KAAKC,MAAMgX,QAChB7W,aAAcJ,KAAKC,MAAMG,eACxBC,KACD,EAAGkb,UAAS5W,WACN3E,KAAKT,SACPS,KAAKM,SAAS,CAAEib,UAAShH,SAAS,EAAOtT,YAAa0D,KAG1D,KACM3E,KAAKT,SACPS,KAAKM,SAAS,CAAEiU,SAAS,MAMjC,KAAAiH,iBAAoBva,IACdjB,KAAKT,SACPS,KAAKM,SAAS,CAAEW,iBAIpB,KAAAwa,iBAAoBvb,IAElB,MAAMwb,EAAU1b,KAAKR,MAAMyB,aAAejB,KAAKR,MAAMyB,YAAYf,KACjEF,KAAKM,SAASd,GACZA,EAAMyB,YAAc,CAAEA,YAAY,MAAMzB,EAAMyB,YAAb,CAA0Bf,UAAW,MAExE,YAAW,CACT+D,IAAKjE,KAAKC,MAAMgX,QAChB7W,aAAcJ,KAAKC,MAAMG,aACzBF,KAAMA,EAAK8U,SACV2G,MAAM,KACH3b,KAAKT,SACPS,KAAKM,SAASd,GACZA,EAAMyB,YAAc,CAAEA,YAAY,MAAMzB,EAAMyB,YAAb,CAA0Bf,KAAMwb,KAAc,SAMvF,KAAA9B,eAAiB,IACR5Z,KAAKsb,mBAAmBjb,KAAK,KAClC,MAAM,QAAE4W,EAAF,gBAAWzE,GAAoBxS,KAAKC,MAC1C,GAAIuS,GAAmBxS,KAAKR,MAAM+b,QAAS,CACzC,MAAM7N,EAAS1N,KAAKR,MAAM+b,QAAQjM,KAAK5B,GAAUA,EAAOsN,WAAaxI,EAAgBvO,KACjFyJ,GACF1N,KAAKC,MAAM4Z,WAAWrH,EAAgBvO,IAAKgT,EAASvJ,MAM5D,KAAAoM,iBAAmB,IACV9Z,KAAKsb,mBAAmBjb,KAAK,KAClC,MAAM,QAAE4W,EAAF,gBAAWzE,GAAoBxS,KAAKC,MAExCuS,GACAxS,KAAKR,MAAM+b,UACVvb,KAAKR,MAAM+b,QAAQjM,KAAK5B,GAAUA,EAAOsN,WAAaxI,EAAgBvO,MAEvEjE,KAAKC,MAAM8Z,aAAavH,EAAgBvO,IAAKgT,KAKnD,KAAA2E,aAAe,IACN,YAAW,CAAE3X,IAAKjE,KAAKC,MAAMgX,QAAS7W,aAAcJ,KAAKC,MAAMG,eAAgBC,KAAK,IACzFL,KAAKC,MAAM4b,SAAS7b,KAAKC,MAAMgX,UAxFnC,oBACEjX,KAAKT,SAAU,EACfS,KAAKM,SAAS,CAAEiU,SAAS,IACzBvU,KAAKsb,mBAGP,mBAAmB7D,GACbA,EAAUR,UAAYjX,KAAKC,MAAMgX,UACnCjX,KAAKM,SAAS,CAAEiU,SAAS,IACzBvU,KAAKsb,oBAIT,uBACEtb,KAAKT,SAAU,EA8EjB,SACE,MAAM,YAAE0B,GAAgBjB,KAAKR,MAE7B,IAAKyB,EACH,OAAO,uBAAKG,UAAU,wBAGxB,MAAM,iBACJ0a,EADI,SAEJna,EAFI,oBAGJoa,EAHI,aAIJ3b,EAJI,mBAKJ+J,GACEnK,KAAKC,OACH,OAAEuH,EAAS,IAAOvG,EAElB+a,IAAa/a,EAAY+B,YACzBiZ,EAAata,KAAc3B,KAAKC,MAAM6b,kBAAoBE,EAEhE,OACE,uBAAK5a,UAAU,uBACb,gBAAC,KAAe,CAACmT,QAASvU,KAAKR,MAAM+U,SACnC,gBAAC2H,GAAA,EAAe,CACdva,SAAUA,EACV+C,eAAgB1E,KAAKC,MAAMyE,eAC3B3C,aAAc/B,KAAKyb,iBACnBrb,aAAcA,EACdoC,uBAAwBxC,KAAKC,MAAMuC,uBACnCvB,YAAaA,IAGf,gBAACkb,GAAA,EAAsB,CACrBxa,SAAUA,EACV0E,SAAUrG,KAAKwb,iBACfpb,aAAcA,EACda,YAAaA,IAGduG,EAAOrH,OAAS,GAAK,gBAAC,GAAqB,CAACqH,OAAQA,IAEpDyU,GACC,uBAAK7a,UAAU,uDAGb,gBAAC,GAAgB,CACfyT,WAAY5T,EACZwH,OAAQzI,KAAKwb,iBACbpb,aAAcA,EACd0U,aAAc7T,GACb,EAAGoE,aACF,gBAAC,SAAM,CACLjE,UAAU,iBACVqF,GAAG,yCACHpB,QAASA,GACR,oBAAU,UAIjB,gBAAC,KAAa,CACZ+R,kBAAmB,oBAAU,UAC7BE,eAAe,EACfC,UAAW,kCACT,qCACAtW,EAAY0B,MAEdwG,YAAa,oBAAU,4BACvBqO,UAAWxX,KAAK4b,cACf,EAAGvW,aACF,gCACE,gBAAC,SAAM,CACLjE,UAAU,mCACVqF,GAAG,kCACHpB,QAASA,GACR,oBAAU,WAEb,gBAACnC,GAAA,EAAU,CACT9B,UAAU,cACV+B,IAAK,+CAUhBlC,EAAY6B,YACX,gBAAC,GAAsB,CACrBqU,UAAW2E,GAAoBna,EAC/BvB,aAAcA,EACda,YAAaA,KAIfA,EAAY6B,aAAeiZ,GAC3B,gBAAC,GAAmB,CAClBhB,YAAa/a,KAAKR,MAAM+b,QACxB5Z,SAAUA,EACVkY,WAAY7Z,KAAK4Z,eACjBG,aAAc/Z,KAAK8Z,iBACnB1Z,aAAcA,EACd+J,mBAAoBA,EACpBlJ,YAAaA,KAIfA,EAAY6B,YAAmC,qBAArB7B,EAAYE,MACtC,gBAAC,GAAiB,CAACf,aAAcA,EAAca,YAAaA,O,6CCnNzD,MAAM,WAAqB,gBAA1C,c,oBACE,KAAA6Y,iBAAmB,KACjB,GAAI9Z,KAAKC,MAAMuS,gBAAiB,CAC9B,MAAMhK,EAAO,CACXvE,IAAKjE,KAAKC,MAAMuS,gBAAgBvO,IAChC7D,aAAcJ,KAAKC,MAAMG,aACzBuE,KAAM3E,KAAKC,MAAM0E,KAAKV,KAExB,YAAeuE,GAAMnI,KACnB,IAAML,KAAKC,MAAM8Z,aAAavR,EAAKvE,IAAKuE,EAAK7D,MAC7C,UAKN,KAAAiV,eAAkBrY,IACZvB,KAAKC,MAAMuS,iBACbxS,KAAKC,MAAM4Z,WAAW7Z,KAAKC,MAAMuS,gBAAgBvO,IAAKjE,KAAKC,MAAM0E,KAAKV,IAAK,CACzE1C,WACA8Y,QAAS,SAGNrP,QAAQC,WAGjB,KAAAmR,gBAAmB1W,IAEjB,MAAM2W,EAAoC,IAAjB3W,EAAM4W,WACJ5W,EAAM6W,SAAW7W,EAAM8W,QAAU9W,EAAM+W,SAAW/W,EAAMgX,WAC3DL,IAIxB3W,EAAM6C,iBACNvI,KAAKC,MAAM0c,OAAO3c,KAAKC,MAAM0E,KAAKV,OAGpC,KAAAiN,iBAAmB,KACjB,MAAM,WAAE3J,EAAF,gBAAciL,GAAoBxS,KAAKC,MAC7C,OAAKsH,EAKH,sBAAInG,UAAU,sDACZ,gBAAC,KAAY,CAACG,SAAUgG,EAAWhG,WAClCiR,GAAmBA,EAAgB2H,YAClC,gCAC0B,cAAvB5S,EAAW8S,SACV,gBAAC,IAAO,CACNnZ,QAAS,kCACP,yBACAsR,EAAgB7P,KAChB6P,EAAgB2H,aAElB,gBAACpB,GAAmB,CAClB3X,UAAU,qBACVuP,YAAapJ,EAAW8S,WAIN,cAAvB9S,EAAW8S,SACV,gBAAC,IAAO,CACNnZ,QAAS,kCACP,wBACAsR,EAAgB7P,KAChB6P,EAAgB2H,aAElB,gBAACpB,GAAmB,CAClB3X,UAAU,qBACVuP,YAAapJ,EAAW8S,aA9B7B,MAwCX,KAAAM,cAAgB,KACd,MAAM,WAAEpT,EAAF,WAAcqV,EAAd,KAA0BjY,EAA1B,gBAAgC6N,GAAoBxS,KAAKC,MAC/D,IAAKuS,IAAoBoK,EACvB,OAAO,KAGT,MAAMC,EAAUrK,EAAgBxK,SAAWwK,EAAgBxK,QAAQ8U,KACnE,OAAItK,EAAgBzK,WAAa8U,EAE7B,sBAAIzb,UAAU,8DACXpB,KAAK+c,uBAAuB,GAAI,qCAKvBvK,EAAgBxK,SAAWwK,EAAgBxK,QAAQC,KAMjE,sBAAI7G,UAAU,8DACXmG,EACGvH,KAAK+c,uBAAuBxV,EAAW8S,UACtC1V,EAAK7B,YACJ,gBAAC,GAAgB,CACfgW,WAAY,oBAAU,yBACtB1X,UAAU,+CACV+H,YAAa,oBAAU,4CACvBV,OAAQzI,KAAK4Z,eACbxZ,aAAcJ,KAAKC,MAAMG,aACzBwH,SAAU,CAAC4K,GACX7N,KAAMA,KAfT,MAsBX,KAAAoY,uBAAyB,CACvB1C,EACA2C,EAAwB,oCAEL,SAAZ3C,EACL,gBAAC,KAAa,CACZjD,kBAAmB,oBAAU,OAC7BG,UAAW,oBAAU,mCACrBpO,YAAa,oBAAU,2BACvBqO,UAAWxX,KAAK8Z,kBACf,EAAGzU,aACF,gBAAC,SAAM,CACLjE,UAAU,4DACViE,QAASA,GACR,oBAAU,6BAKjB,gBAAC,IAAO,CAACnE,QAAS,oBAAU8b,IAC1B,gBAAC,SAAM,CAAC5b,UAAU,sEACf,oBAAU,6BAMnB,SACE,MAAM,KAAEuD,EAAF,SAAQ6L,GAAaxQ,KAAKC,MAC1B2B,EAAU,IAAK+C,EAAKzE,MAAQ,MAASyE,EAAKpE,SAAW,IAC3D,OACE,uBAAKa,UAAW,GAAW,cAAe,CAAEoP,aAAW,YAAa7L,EAAKV,KACvE,yBAAO7C,UAAU,qBACf,6BACE,0BACGpB,KAAKkR,mBAEN,0BACE,uBAAK9P,UAAU,qBACb,gBAAC,OAAI,CACHA,UAAU,oBACViE,QAASrF,KAAKoc,gBACdnZ,GAAI,aAAW0B,EAAKV,IAAKjE,KAAKC,MAAMG,eACnCuE,EAAKhC,MAEPgC,EAAK7B,YACJ,gBAAC,IAAO,CAAC5B,QAAS,oBAAU,qCAC1B,wBAAME,UAAU,qBACb,oBAAU,kCAOrB,sBAAIA,UAAU,+BACZ,uBAAKA,UAAU,wCACI,UAAhBuD,EAAKlD,QACJ,wBAAML,UAAU,iCACb,oBAAU,eAAgBuD,EAAKlD,SAGpC,wBAAML,UAAU,+CACbuD,EAAK/B,UAER,gBAAC,IAAO,CAAC1B,QAAS,oBAAU,4BAA6ByD,EAAKxD,OAC5D,wBAAMC,UAAU,+CACd,gBAAC,KAAa,CAACzB,MAAOgF,EAAKxD,OAC3B,wBAAMC,UAAU,kCACb,oBAAU,aAAcuD,EAAKxD,SAInCS,EAAQzB,OAAS,GAChB,gBAAC+B,GAAA,EAAQ,CACPC,aAAa,EACbf,UAAU,8CACVlB,KAAM0B,IAGV,gBAAC6C,GAAA,EAAkB,CAACC,eAAgB1E,KAAKC,MAAMyE,eAAgBC,KAAMA,MAIxE3E,KAAK2a,qB,6rBC3Ib,MAAM,WAAY,gBAGvB,YAAY1a,GACVoH,MAAMpH,GAHR,KAAAV,SAAU,EA+DV,KAAA0d,gBAAkB,KAChB,WAAa,gBACb,EAAI,KAAM,eAAgB,KACxBjd,KAAKkd,sBACE,IAET,EAAI,OAAQ,eAAgB,KAC1Bld,KAAKmd,kBACE,IAET,EAAI,QAAS,eAAgB,KAC3Bnd,KAAKod,oBACE,IAET,EAAI,OAAQ,eAAgB,KAC1Bpd,KAAKqd,cACE,KAIX,KAAAC,gBAAkB,IAAM,cAAgB,gBAExC,KAAAC,YAAc,CAACtd,EAAc6W,KAC3B,MAAMrI,EAAO,YAAQxO,EAAMud,SAAS7d,OACpC,OAAO8O,GAAQqI,EAAMxH,KAAK3K,GAAQA,EAAKV,MAAQwK,IAGjD,KAAAgP,iBAAmB,KACjB,MAAM,WAAE7K,GAAe5S,KAAKR,MAC5B,OAAO4K,OAAO+D,KAAKyE,GAChB/K,OAAQ+P,GAAoBhF,EAAWgF,IACvC/P,OAAQ+P,GAAoB,YAAmBA,IAC/CxP,IAAKwP,GAAoB,YAAeA,KAG7C,KAAA8F,iBAAmB,KACjB,MAAMC,EAAS,CACb,aACA,OACA,OACA,WACA,WACA,SACA,UACA,OACA,eAKF,OAHI3d,KAAKR,MAAMG,MAAMmI,SACnB6V,EAAO9R,KAAK,UAAW,UAElB8R,GAGT,KAAAC,oBAAsB,QACpB/G,EAAG7W,KAAK0d,mBAAmB1I,OAC3BnC,OAAQ7S,KAAKyd,mBAAmBzI,OAChC5U,aAAcJ,KAAKC,MAAMG,cAAgBJ,KAAKC,MAAMG,aAAa6D,IACjEpE,GAzJc,IA0Jdge,EAAG,QACA,YAAe7d,KAAKR,MAAMG,QAG/B,KAAAme,YAAc,KACR9d,KAAKT,SACPS,KAAKM,SAAS,CAAEiU,SAAS,KAI7B,KAAAwJ,iBAAmB,KACjB/d,KAAKM,SAAS,CAAEiU,SAAS,IACzB,MAAMnU,EAAeJ,KAAKC,MAAMG,cAAgBJ,KAAKC,MAAMG,aAAa6D,IACxE+G,QAAQgT,IAAI,CAAC,YAAY,CAAE5d,iBAAiBJ,KAAKie,yBAAyB5d,KACxE,GAAIsB,WAAUoR,iBAAkBnL,gBAC9B5H,KAAKM,SAAS,CACZqB,WACAwI,mBAAoB,IAAMvC,EAAU,OACpCpF,uBAAwB,IAAMuQ,EAAc,SAE9C/S,KAAKke,mBAEPle,KAAK8d,cAIT,KAAAK,iBAAoBxe,GAClB,YAAY,MAAKK,KAAK4d,sBAAX,GAAqCje,IAASU,KACvD,EAAGkb,QAAS6C,EAAYvL,OAAQwL,EAAW7D,IAAG3a,KAAIiX,QAAOhL,YAIhD,CAAEyP,QAHO6C,GA2bxB,SAAsBA,GACpB,MAAM7C,EAAmB,GACzB,IAAK,MAAO5W,EAAMoW,KAAgB3Q,OAAOkU,QAAQF,GAAa,CAC5D7C,EAAQ5W,GAAQ,GAChB,IAAK,MAAM,QAAE0V,EAAF,SAAWW,EAAX,SAAqBzZ,KAAcwZ,EAC5CQ,EAAQ5W,GAAMqW,GAAY,CAAEX,UAAS9Y,YAGzC,OAAOga,EAnc6BgD,CAAaH,GAGzBvL,OAFHwL,GAqcvB,SAAqBA,GACnB,MAAMxL,EAAiB,GACvB,IAAK,MAAM2L,KAAYH,EAAW,CAChC,MAAMhU,EAAyB,GAC/B,IAAK,MAAMoU,KAAYD,EAASnU,OAC9BA,EAAOoU,EAASvG,KAAOuG,EAAStG,MAElCtF,EAAO,YAAY2L,EAASrR,WAAa9C,EAE3C,OAAOwI,EA9c2B6L,CAAYL,GAEd3O,OADX,CAAEC,UAAW6K,EAAG5K,SAAU/P,EAAIiM,SACXgL,WAIxC,KAAAoH,gBAAmBve,IACjBK,KAAKM,SAAS,CAAEiU,SAAS,IACzBvU,KAAKme,iBAAiBxe,GAAOU,KAAK,EAAGkb,UAAS1I,SAAQnD,SAAQoH,YAC5D,GAAI9W,KAAKT,QAAS,CAChB,MAAMof,EAAW3e,KAAKud,YAAYvd,KAAKC,MAAO6W,GACxC8H,EAAiB,YAAW5e,KAAKC,MAAMud,SAAS7d,OAChD6Q,EAAWsG,EAAM3W,OAAS,EAAKwe,GAAYA,EAAS1a,KAAQ6S,EAAM,GAAG7S,SAAMX,EACjFtD,KAAKM,SAAS,CACZib,UACA1I,SACA0B,SAAS,EACToK,WACAjP,SACAoH,QACAtG,WACAoO,qBAGH5e,KAAK8d,cAGV,KAAAe,eAAiB,KACf,MAAM,OAAEnP,GAAW1P,KAAKR,MACxB,GAAIkQ,EAAQ,CACV1P,KAAKM,SAAS,CAAEiU,SAAS,IACzB,MAAMuK,EAAWpP,EAAOC,UAAY,EACpC3P,KAAKme,iBAAiB,CAAE3D,EAAGsE,EAAUjM,YAAQvP,IAAajD,KACxD,EAAGkb,UAAS7L,SAAQoH,YACd9W,KAAKT,SACPS,KAAKM,SAAUd,IAAD,CACZ+b,QAAQ,MAAM/b,EAAM+b,QAAb,GAAyBA,GAChChH,SAAS,EACT7E,SACAoH,MAAO,IAAItX,EAAMsX,SAAUA,OAIjC9W,KAAK8d,eAKX,KAAAiB,WAAcnH,IACZ5X,KAAKme,iBAAiB,CAAEte,GAAI,EAAGgT,OAAQ,YAAe+E,KAAUvX,KAAK,EAAGwS,aAClE7S,KAAKT,SACPS,KAAKM,SAASd,IAAK,CAAOqT,OAAO,MAAMrT,EAAMqT,OAAb,GAAwBA,GAAU0B,SAAS,MAE5EvU,KAAK8d,cAGV,KAAAG,qBAAuB,KACrB,MAAM,YAAEe,EAAF,aAAe5e,EAAf,kBAA6B6e,GAAsBjf,KAAKC,MAC9D,OAAI,YAAiB+e,EAAa5e,EAAc6e,GACvC,YAAsB,CAAE7e,aAAcA,GAAgBA,EAAa6D,MAErE,CAAE2D,SAAU,KAGrB,KAAAsX,iBAAmB,EAAG1O,WAAUsG,SAAU9W,KAAKR,SAC7C,MAAM2f,EAAQrI,EAAMsI,UAAUza,GAAQA,EAAKV,MAAQuM,GACnD,OAAkB,IAAX2O,EAAeA,OAAQ7b,GAGhC,KAAA6Z,eAAiB,KACf,MAAM,MAAErG,EAAF,QAASvC,EAAT,OAAkB7E,GAAW1P,KAAKR,MAClCmV,EAAgB3U,KAAKkf,wBACL5b,IAAlBqR,IAEAA,EAAgBmC,EAAM3W,OAjQC,IAkQtBoU,GACD7E,GACAoH,EAAM3W,OAASuP,EAAO5D,OAEtB9L,KAAK6e,iBAEH/H,GAASnC,EAAgBmC,EAAM3W,OAAS,IACtCH,KAAKR,MAAMmf,SACb3e,KAAK2e,SAAS7H,EAAMnC,EAAgB,GAAG1Q,KAEvCjE,KAAKM,SAAS,CAAEkQ,SAAUsG,EAAMnC,EAAgB,GAAG1Q,SAM3D,KAAAiZ,mBAAqB,KACnB,MAAM,MAAEpG,GAAU9W,KAAKR,MACjBmV,EAAgB3U,KAAKkf,mBACvBpI,QAA2BxT,IAAlBqR,GAA+BA,EAAgB,IACtD3U,KAAKR,MAAMmf,SACb3e,KAAK2e,SAAS7H,EAAMnC,EAAgB,GAAG1Q,KAEvCjE,KAAKM,SAAS,CAAEkQ,SAAUsG,EAAMnC,EAAgB,GAAG1Q,QAKzD,KAAAob,YAAe1a,IAAD,CACZ2a,SAAUtf,KAAKC,MAAMud,SAAS8B,SAC9B3f,MAAM,MAAM,YAAeK,KAAKR,MAAMG,OAAjC,CAAyC8O,KAAM9J,MAGtD,KAAAga,SAAYha,IACV,MAAM0T,EAAOrY,KAAKqf,YAAY1a,GAC1B3E,KAAKR,MAAMmf,SACb3e,KAAKC,MAAMsf,OAAOzb,QAAQuU,GAE1BrY,KAAKC,MAAMsf,OAAO1T,KAAKwM,IAI3B,KAAA+E,iBAAmB,KACjB,MAAM,SAAE5M,GAAaxQ,KAAKR,MACtBgR,GACFxQ,KAAK2e,SAASnO,IAIlB,KAAAgP,UAAY,KACVxf,KAAKC,MAAMsf,OAAO1T,KAAK,CACrByT,SAAUtf,KAAKC,MAAMud,SAAS8B,SAC9B3f,MAAM,MACD,YAAeK,KAAKR,MAAMG,OAD1B,CAEH8O,UAAMnL,MAGVtD,KAAKyf,sBAAqB,IAG5B,KAAAA,qBAAuB,CAACC,GAAS,KAC/B,MAAM,SAAElP,GAAaxQ,KAAKR,MAC1B,GAAIgR,EAAU,CACZ,MAAMmP,EAAUC,SAASC,cAAT,sBAAsCrP,EAAtC,OACZmP,GACF,0BAAgBA,EAAS,CAAEG,UAAW,IAAKC,aAAc,IAAKL,aAKpE,KAAAM,kBAAqBrb,IACnB,MAAM,QAAE4W,EAAF,MAAW5b,GAAUK,KAAKR,MAChC,OAAI+b,GAAWA,EAAQ5W,IAAShF,EAAMmI,QAC7ByT,EAAQ5W,GAAMhF,EAAMmI,cAE3B,GAIJ,KAAAmE,mBAAqB,KACnB,MAAM,MAAEtM,EAAF,mBAASwK,GAAuBnK,KAAKR,MAC3C,OAAIG,EAAMmI,QACDqC,EAAmBxK,EAAMmI,cAEhC,GAIJ,KAAAmY,WAAcrI,GACZ5X,KAAKM,SAASd,IAAK,CACjBoT,WAAW,MAAMpT,EAAMoT,WAAb,CAAyB,CAACgF,IAAQ,OAGhD,KAAAsI,eAAkBjJ,IAChBjX,KAAKC,MAAMsf,OAAO1T,KAAK7L,KAAKqf,YAAYpI,KAG1C,KAAAoG,WAAc3X,IACZ,MAAM,eAAEkZ,GAAmB5e,KAAKR,MAE5BkG,IACFA,EAAM6C,iBACN7C,EAAMC,cAAcyG,QAGlBwS,EACF5e,KAAKmgB,cAELngB,KAAKwf,aAIT,KAAAY,mBAAsBrO,IACpB/R,KAAKC,MAAMsf,OAAO1T,KAAK,CACrByT,SAAUtf,KAAKC,MAAMud,SAAS8B,SAC9B3f,MAAO,YAAe,MAAKK,KAAKR,MAAMG,MAAjB,GAA2BoS,MAGlD/R,KAAKM,SAAS,EAAGsS,iBAAH,CACZA,WAAW,MACNA,EADK,CAERqB,oBAAqB,YAAmCrB,EAAYb,GACpE2B,UAAW,YAAyBd,EAAYb,SAKtD,KAAAsO,kBAAqBlT,IACnBnN,KAAKM,SAASd,IACZ,MAAM8gB,GAAoB9gB,EAAMoT,WAAWzF,GACrCoT,EAAW,CACfhM,QAAS/U,EAAM+U,QACf3B,WAAW,MAAMpT,EAAMoT,WAAb,CAAyB,CAACzF,GAAWmT,KAkBjD,OAdIA,GAAoBnT,IAAa,MACnCoT,EAAS3N,WAAWqB,oBAAsB,YACxCsM,EAAS3N,WACTpT,EAAMG,OAGRwN,EAAWoT,EAAS3N,WAAWqB,oBAAsB,sBAAwB9G,IAG3E,YAAmBA,IAAe3N,EAAMqT,QAAWrT,EAAMqT,OAAO1F,KAClEoT,EAAShM,SAAU,EACnBvU,KAAK+e,WAAW5R,IAGXoT,KAIX,KAAAC,aAAe,IAAMxgB,KAAKke,kBAE1B,KAAAiC,YAAc,IAAMngB,KAAKC,MAAMsf,OAAO1T,KAAK,CAAEyT,SAAUtf,KAAKC,MAAMud,SAAS8B,WAG3E,KAAAmB,eAAiB,CAAC3J,EAAiBnC,KACjC,QAAsBrR,IAAlBqR,GAAgD,IAAjBmC,EAAM3W,OAGzC,OAAIwU,GAAiB,GAAKA,EAAgBmC,EAAM3W,OACvC2W,EAAMnC,GAAe1Q,IAEvB6S,EAAMA,EAAM3W,OAAS,GAAG8D,KAGjC,KAAA+S,iBAAoBC,IACdjX,KAAKR,MAAMG,MAAMsX,UAAYA,EAC/BjX,KAAKmgB,eAELngB,KAAKM,SAASd,IACZ,MAAMsX,EAAQtX,EAAMsX,MAAMjP,OAAOlD,GAAQA,EAAKV,MAAQgT,GAChDtC,EAAgB3U,KAAKkf,iBAAiB1f,GAE5C,MAAO,CAAEsX,QAAOtG,SADCxQ,KAAKygB,eAAe3J,EAAOnC,MAG9C3U,KAAKwf,cAIT,KAAAkB,mBAAqB,CAAC5Y,EAAiBnD,EAAc4C,IACnDvH,KAAKM,SAAUd,IACb,MAAM,QAAE+b,EAAU,IAAO/b,EACzB,OAAK+b,EAAQ5W,GAIN,CAAE4W,QAAQ,MAAMA,EAAP,CAAgB,CAAC5W,GAAD,MAAa4W,EAAQ5W,GAArB,CAA4B,CAACmD,GAAUP,OAH9D,CAAEgU,QAAQ,MAAMA,EAAP,CAAgB,CAAC5W,GAAO,CAAE,CAACmD,GAAUP,QAM3D,KAAAoZ,qBAAuB,CAAC7Y,EAAiBnD,IACvC3E,KAAKM,SAASd,IACZ,MAAM,QAAE+b,GAAY/b,EACpB,GAAI+b,GAAWA,EAAQ5W,GAAO,CAC5B,MAAMic,EAAO,MAAQrF,EAAQ5W,IAE7B,cADOic,EAAQ9Y,GACR,CAAEyT,QAAQ,MAAMA,EAAP,CAAgB,CAAC5W,GAAOic,KAE1C,OAAO,OAGX,KAAApR,aAAgBqR,GAAwB7gB,KAAKogB,mBAAmB,CAAES,gBAElE,KAAAC,WAAa,IAAM1W,OAAO+D,KAAK,YAAenO,KAAKR,MAAMG,QAAQQ,OAAS,EAE1E,KAAA4gB,iBAAmB,KACjB,MAAM,YAAE/B,EAAF,UAAe1U,GAActK,KAAKC,OAClC,SAAE0B,EAAF,OAAY+N,EAAZ,MAAoB/P,EAApB,mBAA2BwK,GAAuBnK,KAAKR,MACvDY,EAAeJ,KAAKC,MAAMG,cAAgBJ,KAAKC,MAAMG,aAAa6D,IAExE,OAAK,YAAW+a,IAAiB,2BAAmB5e,IAAkBuB,EAC7D,KAIP+N,GACE,gBAAC,EAAU,CACTpF,UAAWA,EACXlK,aAAcA,EACdT,MAAOA,EACPwK,mBAAoBA,EACpB2B,MAAO4D,EAAO5D,SA9bpB,MAAMnM,EAAQ,YAAWM,EAAMud,SAAS7d,OACxCK,KAAKR,MAAQ,CACX+U,SAAS,EACT3B,WAAY,CACVtI,WAAW,EACXqJ,WAAY,YAA8B,GAAIhU,EAAO,cACrDmU,UAAW,YAA8B,GAAInU,EAAO,aACpDsU,oBAAqB,YAAmC,GAAItU,GAC5D+T,UAAW,YAAyB,GAAI/T,GACxCmT,OAAO,GAETnT,QACAwK,mBAAoB,GACpB3H,uBAAwB,GACxBsU,MAAO,IAIX,oBACE9W,KAAKT,SAAU,EACf,8BACA,4BACAS,KAAKid,kBACLjd,KAAK+d,mBAGP,0BAA0BiD,GACxBhhB,KAAKM,SAAS,EAAGwW,QAAOtG,eACtB,MAAMmO,EAAW3e,KAAKud,YAAYyD,EAAWlK,GAC7C,MAAO,CACL6H,WACAC,eAAgB,YAAWoC,EAAUxD,SAAS7d,OAC9CA,MAAO,YAAWqhB,EAAUxD,SAAS7d,OACrC6Q,SAAUmO,EAAWA,EAAS1a,IAAMuM,KAK1C,mBAAmBiH,EAAkBwJ,GAC9B,YAAgBxJ,EAAU+F,SAAS7d,MAAOK,KAAKC,MAAMud,SAAS7d,QACjEK,KAAKke,kBAGJle,KAAKR,MAAMmf,UACXsC,EAAUzQ,WAAaxQ,KAAKR,MAAMgR,WAAYyQ,EAAUtC,UAIzD3e,KAAKyf,uBAIT,uBACEzf,KAAKT,SAAU,EACf,iCACA,+BACAS,KAAKsd,kBA4YP,SACE,MAAM,OAAE5N,EAAF,MAAUoH,GAAU9W,KAAKR,MACzBmV,EAAgB3U,KAAKkf,mBACrB9e,EAAeJ,KAAKC,MAAMG,cAAgBJ,KAAKC,MAAMG,aAAa6D,IAClE8X,GAAuB,YAC3B/b,KAAKC,MAAM+e,YACXhf,KAAKC,MAAMG,aACXJ,KAAKC,MAAMgf,mBAGb,OACE,gCACE,gBAACiC,EAAA,EAAW,CAACC,YAAY,iBACzB,gBAAC,IAAM,CAACC,OAAO,EAAO7c,MAAO,oBAAU,sBACrC,wBAAM8c,QAAQ,UAAU1e,KAAK,YAE/B,uBAAKvB,UAAU,cAAcqF,GAAG,qBAC9B,gBAAC6a,EAAA,EAAoB,CAAClgB,UAAU,0BAC7B,EAAGmgB,SACF,uBAAKngB,UAAU,mBAAmBsY,MAAO,CAAE6H,QACzC,uBAAKngB,UAAU,0BACb,uBAAKA,UAAU,uBACb,gBAACogB,EAAA,EAAc,CACbC,OAAO,gBACPhY,MAAO,oBAAU,gCACjBiY,OAAQ,KAEV,gBAACC,EAAA,EAAa,CAACC,aAAc5hB,KAAK8gB,aAAce,QAAS7hB,KAAKmgB,cAC9D,gBAAC,IAAS,CACR/e,UAAU,gBACVqF,GAAG,sBACHqb,UAAW,EACXzb,SAAUrG,KAAKwP,aACf1F,YAAa,oBAAU,2BACvBlE,MAAO5F,KAAKR,MAAMG,MAAMkhB,aAAe,KAEzC,gBAACzO,GAAU,CACTS,OAAQ7S,KAAKR,MAAMqT,OACnBP,iBAAkByJ,EAClBpJ,cAAe3S,KAAKqgB,kBACpB3b,eAAgB1E,KAAKogB,mBACrBxN,WAAY5S,KAAKR,MAAMoT,WACvBxS,aAAcA,EACdgU,qBAAsBpU,KAAKC,MAAMsY,SAASnE,qBAC1CzU,MAAOK,KAAKR,MAAMG,MAClBwK,mBAAoBnK,KAAKR,MAAM2K,mBAC/B3H,uBAAwBxC,KAAKR,MAAMgD,uBACnCgQ,gBAAiBxS,KAAKiM,2BAQlC,uBAAK7K,UAAU,oBACb,uBAAKA,UAAU,oDACb,uBAAKA,UAAU,gEACb,uBAAKA,UAAU,0BACb,gBAACogB,EAAA,EAAc,CAACC,OAAO,eACtBzhB,KAAKR,MAAMmf,SACV,qBACEvd,UAAU,uDACVyL,KAAK,IACLxH,QAASrF,KAAKqd,YACd,gBAAC,IAAQ,CAACjc,UAAU,iBACnBpB,KAAKR,MAAMof,eACR,oBAAU,wBACV,oBAAU,gCAGhB5e,KAAK+gB,oBAEL/gB,KAAKR,MAAMof,gBACX,gBAACvK,GAAW,CACVE,QAASvU,KAAKR,MAAM+U,QACpBC,SAAUxU,KAAKwgB,aACf9Q,OAAQA,EACRiF,cAAeA,OAOzB,uBAAKvT,UAAU,0BACZpB,KAAKR,MAAMmf,SACV,gBAAC,GAAW,CACV7C,kBAAmB9b,KAAKC,MAAMsY,SAASnE,qBACvCzS,SAAU3B,KAAKR,MAAMmC,SACrBoa,oBAAqBA,EACrBlC,WAAY7Z,KAAK0gB,mBACjB3G,aAAc/Z,KAAK2gB,qBACnB9E,SAAU7b,KAAKgX,iBACftS,eAAgB1E,KAAKogB,mBACrBhgB,aAAcA,EACd+J,mBAAoBnK,KAAKR,MAAM2K,mBAC/B3H,uBAAwBxC,KAAKR,MAAMgD,uBACnCyU,QAASjX,KAAKR,MAAMmf,SAAS1a,IAC7BuO,gBAAiBxS,KAAKiM,uBAGxB,gCACG6K,EAAM1O,IAAIzD,GACT,gBAAC,GAAY,CACX4C,WAAYvH,KAAKggB,kBAAkBrb,EAAKV,KACxCtC,SAAU3B,KAAKR,MAAMmC,SACrBib,WAAY,YAAW5c,KAAKC,MAAM+e,aAClC/a,IAAKU,EAAKV,IACV4V,WAAY7Z,KAAK0gB,mBACjB3G,aAAc/Z,KAAK2gB,qBACnBjc,eAAgB1E,KAAKogB,mBACrBzD,OAAQ3c,KAAKkgB,eACb9f,aAAcA,EACduE,KAAMA,EACN6L,SAAU7L,EAAKV,MAAQjE,KAAKR,MAAMgR,SAClCgC,gBAAiBxS,KAAKiM,6BAGd3I,IAAXoM,GACC,gBAAC,IAAU,CACTyI,MAAOrB,EAAM3W,OACb4hB,SAAU/hB,KAAK6e,eACfmD,OAAQhiB,KAAKR,MAAM+U,QACnBzI,MAAO4D,EAAO5D,cA2CrB,+BAAW,kBAPDtM,IAAD,CACtB+Y,SAAU,sBAAY/Y,GACtBwf,YAAa,yBAAexf,GAC5B8K,UAAW,uBAAa9K,GACxByf,kBAAmB,6BAAmBzf,KAGd,CAAyB,M,iCCluBnD,sDA0Be,SAAS0hB,GAAY,YAAEC,IACpC,OACE,gBAAC,IAAmBc,SAAQ,KACzB,EAAGC,iBAAgBC,uBAClB,gBAACC,EAAgB,CACfF,eAAgBA,EAChBC,kBAAmBA,EACnBhB,YAAaA,KAavB,MAAMiB,UAAyB,gBAC7B,oBACEpiB,KAAKC,MAAMiiB,eAAeliB,KAAKC,MAAMkhB,aAGvC,mBAAmB1J,GACbA,EAAU0J,cAAgBnhB,KAAKC,MAAMkhB,cACvCnhB,KAAKC,MAAMkiB,kBAAkBniB,KAAKC,MAAMkhB,aACxCnhB,KAAKC,MAAMiiB,eAAezK,EAAU0J,cAIxC,uBACEnhB,KAAKC,MAAMkiB,kBAAkBniB,KAAKC,MAAMkhB,aAG1C,SACE,OAAO,Q,iCC5CJ,SAASkB,EACdC,EACAC,GAEA,MAAMC,EAAqBF,EAAiBG,aAAeH,EAAiB3f,MAAQ,YACpF,MAAM,GAAN,OAAU4f,EAAV,YAAqBC,EAArB,KAxBF,mC,iCCAA,iFAwBA,MAAME,EAAmB,4BAAkB,IAAM,2FAA8B,oBAchE,MAAMxf,UAAmB,gBAAxC,c,oBACE,KAAA3D,SAAU,EACV,KAAAC,MAAe,GAEf,oBACEQ,KAAKT,SAAU,EACfS,KAAKC,MAAMkD,IAAI9C,KACb,EAAGsiB,QAAStB,MACNrhB,KAAKT,SACPS,KAAKM,SAAS,CAAE+gB,aAGpB,QAIJ,uBACErhB,KAAKT,SAAU,EAGjB,SACE,OAAOS,KAAKR,MAAM6hB,QAChB,gBAAC,IAAW,CACVjgB,UAAWpB,KAAKC,MAAMmB,UACtBF,QACE,uBAAKE,UAAU,iBACb,gBAACshB,EAAgB,CACfE,WAAY5iB,KAAKC,MAAM4iB,aACvBzhB,UAAU,cACVigB,QAAS,wBAAcrhB,KAAKR,MAAM6hB,SAClCyB,WAAW,MAIhB9iB,KAAKC,MAAMyO,UAGd1O,KAAKC,MAAMyO,UAAY,Q,iCC3E7B,6DA6Be,SAAS8S,EAAevhB,GACrC,OACE,gBAAC,IAAYgiB,SAAQ,KAClB,EAAGc,kBAAiBC,wBACnB,gBAACC,EAAmB,eAClBF,gBAAiBA,EACjBC,mBAAoBA,GAChB/iB,KAYP,MAAMgjB,UAA4B,gBAAzC,c,oBASE,KAAAC,QAAU,KACR,MAAQzB,OAAQxd,EAAV,MAAewF,EAAQ,oBAAU,mBAAjC,OAAqDiY,GAAW1hB,KAAKC,MAC3E,MAAO,CAAEgE,MAAKwF,QAAOiY,WAVvB,oBACE1hB,KAAKC,MAAM8iB,gBAAgB/iB,KAAKkjB,WAGlC,uBACEljB,KAAKC,MAAM+iB,mBAAmBhjB,KAAKkjB,WAQrC,SACE,MAAM,OAAEzB,GAAWzhB,KAAKC,MACxB,OAAO,wBAAMwG,GAAE,uBAAkBgb,Q,g4CCM9B,SAAS0B,EACdC,GAEA,OAAO,kBAAQ,8BAA+BA,GAAYzH,MAAM,KAG3D,SAAS0H,GAAkB,kBAChCC,EACAxb,SAAS,IAAE7D,KAKX,OAAO,kBAAQ,4BAA6B,CAAEqf,oBAAmBrf,QAG5D,SAASsf,EAAqB/a,GACnC,OAAO,mBAAS,8BAA+BA,GAAMmT,MAAM,KAGtD,SAAS6H,EAAsBhb,GACpC,OAAO,mBAAS,+BAAgCA,GAAMmT,MAAM,KAUvD,SAAS8H,EACdjb,GAEA,OAAO,kBAAQ,gCAAiCA,GAAMmT,MAAM,KAGvD,SAAS+H,GAAsB,SACpCxb,EACAvF,KAAMghB,EAF8B,aAGpCvjB,IAMA,OAAO,kBAAQ,mCAAoC,CACjD8H,WACAyb,iBACAvjB,iBACCub,MAAM,KAGJ,SAASiI,GAAkB,SAAE1b,EAAUvF,KAAMghB,EAAlB,aAAkCvjB,IAClE,OAAO,eAAK,mCAAoC,CAC9C8H,WACAyb,iBACAvjB,iBAIG,SAASyjB,EAAc5f,EAAatB,GACzC,OAAO,eAAK,8BAA+B,CAAEsB,MAAKtB,SAAQgZ,MAAM,KAG3D,SAASmI,EAAYC,EAAiBC,GAC3C,OAAO,mBAAS,4BAA6B,CAAED,UAASC,WAAUrI,MAAM,KAGnE,SAASsI,GAAc,SAAE/b,EAAUvF,KAAMghB,EAAlB,aAAkCvjB,IAC9D,OAAO,eAAK,8BAA+B,CAAE8H,WAAUyb,iBAAgBvjB,iBAAgBub,MACrF,KAIG,SAASuI,GACd,SAAEhc,EAAUvF,KAAMghB,EAAlB,aAAkCvjB,GAClC+jB,GAEA,OAAO,eAAK,qCAAsC,CAChDjc,WACAyb,iBACAvjB,eACAgkB,qBAAsBD,EAAgBA,EAAcxhB,UAAOW,IAC1DqY,MAAM,KAGJ,SAAS0I,GAA2B,SACzCnc,EACAvF,KAAMghB,EAFmC,aAGzCvjB,IAEA,MAAMkkB,EAAcla,OAAOkU,QAAQ,CAAEpW,WAAUyb,iBAAgBvjB,iBAC5DgI,IAAI,EAAEnE,EAAK2B,KAAP,UAAqB3B,EAArB,YAA4BsgB,mBAAmB3e,KACnDoP,KAAK,KACR,MAAM,+BAAN,OAAsCsP,GAGjC,SAASE,GACZvgB,IAAKwgB,IACP,SAAEvc,EAAUvF,KAAMghB,EAAlB,aAAkCvjB,IAElC,MAAMkkB,EAAcla,OAAOkU,QAAQ,CAAEmG,cAAavc,WAAUyb,iBAAgBvjB,iBACzEgI,IAAI,EAAEnE,EAAK2B,KAAP,UAAqB3B,EAArB,YAA4BsgB,mBAAmB3e,KACnDoP,KAAK,KACR,MAAM,+BAAN,OAAsCsP,GAGjC,SAASI,IAGd,OAAO,kBAAQ,kCAAkCrkB,KAAKskB,GAAKA,EAAEC,UAAW,KAGnE,SAASC,IACd,OAAO,kBAAQ,kCAAkCxkB,KAAKskB,GAAKA,EAAEG,WAGxD,SAASC,EACdC,EACA/hB,GACA,SAAEiF,EAAUvF,KAAMghB,EAAlB,aAAkCvjB,GAClC6kB,GAOA,OAAO,kBAAQ,iCAAkC,CAC/CD,QACA/hB,KACAiF,WACAyb,iBACAvjB,eACAoa,EAAGyK,IAiBA,SAASC,EAAgBC,EAAiBC,GAC/C,OAAO,kBAAQ,+BAAgC,CAAED,UAASC,aAGrD,SAASC,GACd,SAAEnd,EAAUvF,KAAMghB,EAAlB,aAAkCvjB,GAClC4X,GAEA,OAAO,eAAK,mCAAoC,CAC9C9P,WACAyb,iBACAvjB,eACA4X,YACC2D,MAAM,KAGJ,SAAS2J,GACd,SAAEpd,EAAUvF,KAAMghB,EAAlB,aAAkCvjB,GAClC4X,GAEA,OAAO,eAAK,sCAAuC,CACjD9P,WACAyb,iBACAvjB,eACA4X,YACC2D,MAAM,KAgBJ,SAAS4J,EAAYnC,GAC1B,OAAO,kBAAQ,oCAAqCA,GAAYzH,MAAM,KAQjE,SAAS6J,EACdpC,GAEA,OAAO,kBAAQ,qCAAsCA,GAAYzH,MAAM,KAUlE,SAAS8J,EAAQrC,GACtB,OAAO,eAAK,gCAAiCA,GAAYzH,MAAM,KAG1D,SAAS+J,EAAWtC,GACzB,OAAO,eAAK,mCAAoCA,GAAYzH,MAAM,KAU7D,SAASgK,EAASvC,GACvB,OAAO,eAAK,iCAAkCA,GAAYzH,MAAM,KAG3D,SAASiK,EAAYxC,GAC1B,OAAO,eAAK,oCAAqCA,GAAYzH,MAAM,KA2B9D,SAASkK,EAAkBrd,GAChC,OAAO,mBAAS,sCAAuCA,GAGlD,SAASsd,EAAoBtd,GAClC,OAAO,mBAAS,wCAAyCA,GAGpD,SAASud,EAAavd,GAQ3B,MAAMhB,EACJgB,EAAKhB,QAAU,IAAIgB,EAAKhB,OAAQ,CAAC5B,EAAO3B,IAAR,UAAmBA,EAAnB,YAA0B,oBAAU2B,KAAUoP,KAAK,KACrF,OAAO,eAAK,qC,+VAAD,IAA4CxM,EAA5C,CAAkDhB,YAAUmU,MAAM,KAGxE,SAASqK,EAAexd,GAK7B,OAAO,eAAK,uCAAwCA,GAAMmT,MAAM,O,iCC9TlE,SAASsK,EAAuBC,GAC9B,IAAIC,EACAC,EACJ,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAAM/lB,OAAQkmB,IAAK,CAErC,GAAoB,QADPH,EAAMG,GACVC,OAAkB,CACzB,QAAkBhjB,IAAd6iB,EAEG,CACLC,EAAWC,EACX,MAHAF,EAAYE,GAOlB,YAAoB/iB,IAAb8iB,EAAyB,CAAED,YAAWC,iBAAa9iB,EAG5D,SAASijB,EAAiBL,GACxB,MAAM1d,EAAO,GACb,IAAK,IAAI6d,EAAI,EAAGA,EAAIH,EAAM/lB,OAAQkmB,IAAK,CACrC,MAAMG,EAASN,EAAMG,GAAGI,MAAM,KAAKre,IAAI6S,GAAKA,EAAEqL,QACxB,IAAlBE,EAAOrmB,SACTqI,EAAKge,EAAO,IAAMA,EAAO,IAG7B,OAAOhe,EAyBT,SAASke,EAAsBrF,EAAS5gB,GACtC,MAAMkmB,EAAS,kBAAWlmB,EAAX,WACTmmB,EAAM,mBAAYnmB,EAAZ,WAEZ,IAAIomB,EAAaxF,EACbyF,EAAQD,EAAWE,QAAQJ,GAC3BK,EAAMH,EAAWE,QAAQH,GAC7B,MAAkB,IAAXE,IAAyB,IAATE,GACjBF,EAAQE,EACVH,EAAaA,EAAWI,UAAU,EAAGH,GAASD,EAAWI,UAAUD,EAAMJ,EAAOzmB,SAIhF+mB,QAAQC,MACN,IAAIC,MAAJ,gFAC2EP,EAAWI,UAClFD,EACAF,EAAQH,EAAUxmB,QAHtB,OAOF0mB,EACEA,EAAWI,UAAU,EAAGD,GACxBH,EAAWI,UAAUD,EAAMJ,EAAOzmB,OAAQ2mB,GAC1CD,EAAWI,UAAUH,EAAQH,EAAUxmB,SAE3C2mB,EAAQD,EAAWE,QAAQJ,GAC3BK,EAAMH,EAAWE,QAAQH,GAG3B,OAAOC,EApGTQ,EAAOC,QAAU,CAAEC,eAEnB,SAAwBlG,GACtB,MAAM6E,EAAQ7E,EAAQoF,MAAM,MACtBe,EAAWvB,EAAuBC,GACxC,OAAOsB,EAAWjB,EAAiBL,EAAMuB,MAAMD,EAASrB,UAAY,EAAGqB,EAASpB,WAAa,IAL5DsB,oBAQnC,SAA6BrG,GAC3B,MAAM6E,EAAQ7E,EAAQoF,MAAM,MACtBe,EAAWvB,EAAuBC,GACxC,GAAIsB,EAAU,CACZ,MAAMG,EAAcpB,EAAiBL,EAAMuB,MAAMD,EAASrB,UAAY,EAAGqB,EAASpB,WAC5E/E,EAAU6E,EAAMuB,MAAMD,EAASpB,SAAW,GAAGpR,KAAK,MACxD,MAAO,CAAE2S,cAAatG,WAEtB,MAAO,CAAEsG,YAAa,GAAItG,YAhB0BuG,cAoDxD,SAAuBvG,GACrB,MAAMwG,EAAY,oDACZ,aAAEC,EAAF,YAAgBC,GAAgB,EAAQ,IAExCC,EAAuBtB,EADDrF,EAAQvd,QAAQ,eAAgBikB,KACY,UAIxE,OAHwBD,IACpBpB,EAAsBsB,EAAsB,aAC5CtB,EAAsBsB,EAAsB,eAE7ClkB,QAAQ,IAAIC,OAAJ,WAAe8jB,EAAf,kBAA0C,MAAO,IACzD/jB,QAAQ,IAAIC,OAAJ,UAAc8jB,GAAa,KAAM,O,iCClF9C,sEA4Be,SAASvmB,GAAe,UAAEF,EAAF,SAAaG,IAClD,OAAKA,EAIH,wBAAMH,UAAWA,GACf,gBAAC,IAAY,CAACA,UAAU,sBAAsBG,SAAUA,IACvD,oBAAU,WAAYA,IALlB,O,iCC9BX,oSA2BO,SAAS0mB,EAAYzf,GAG1B,OAAO,kBAAQ,iBAAkBA,GAAMmT,MAAM,KAYxC,SAASuM,EAAY1f,GAI1B,OAAO,kBAAQ,oBAAqBA,GAAMmT,MAAM,KAG3C,SAASwM,EAAU1d,EAAe0C,GACvC,MAAMyK,EAAQnN,EAASoI,OAAOvD,KAAMsI,GAAeA,EAAMzK,WAAaA,GACtE,OAAOyK,EAAQA,EAAMvN,OAAS,GAGzB,SAAS+d,EAAehF,GAK7B,OAAO,kBAAQ,kBAAmBA,GAAYzH,MAAM,KAG/C,SAAS0M,EAAYjF,GAK1B,OAAO,kBAAQ,kBAAmBA,GAAY/iB,KAAKskB,GAAKA,EAAEzkB,KAAM,KAG3D,SAASooB,EAAW9f,GAYzB,OAAO,mBAAS,oBAAqBA,GAAMnI,KACzCskB,GAAKA,EAAEhgB,KACP8F,GAGMA,GAAgC,MAApBA,EAAShJ,OAChBuJ,QAAQud,OAAO9d,GAEf,YAAiBA,IAMzB,SAAS+d,EAAWpF,GACzB,OAAO,eAAK,oBAAqBA,GAAYzH,MAAM,KAG9C,SAAS8M,EAAWjgB,GAczB,OAAO,mBAAS,oBAAqBA,GAAMnI,KAAKskB,GAAKA,EAAEhgB,KAAM,O,iCClH/D,wEAwBO,SAAS+T,EACd4J,GAEA,MAAMoG,UAAgB,YAGpB,SACE,OAAO,gBAACpG,EAAgB,iBAAKtiB,KAAKC,SAQtC,OAXS,EAAAwiB,YAAc,YAAsBH,EAAkB,gBAWxD,mBAJP,SAAyB9iB,GACvB,MAAO,CAAE+Y,SAAU,sBAAY/Y,MAG1B,CAAyBkpB,K,oBCvClC,IAAIC,EAAM,EAAQ,KACFtH,EAAU,EAAQ,KAIC,iBAFvBA,EAAUA,EAAQuH,WAAavH,EAAQsB,QAAUtB,KAG/CA,EAAU,CAAC,CAACgG,EAAOhB,EAAIhF,EAAS,MAG9C,IAAI7X,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBqf,GAFSF,EAAItH,EAAS7X,GAEX6X,EAAQyH,OAASzH,EAAQyH,OAAS,IAIjDzB,EAAOC,QAAUuB,G,iCCpBjB,sDA4Be,SAASxa,EAASpO,GAC/B,OACE,uBACEmB,UAAW,EAAW,6BAA8BnB,EAAMmB,WAAU,gBACrDnB,EAAMkN,UACpBlN,EAAMyO,Y,gGCNE,MAAM4S,UAA6B,gBAIhD,YAAYrhB,GACVoH,MAAMpH,GAaR,KAAA8oB,YAAc,KACZ,MAAMC,EAAehpB,KAAKipB,WAAajpB,KAAKipB,UAAUC,wBACtD,OAAKF,EAGE,CACLzH,IAAK4H,OAAOC,YAAcJ,EAAazH,IACvC8H,KAAMF,OAAOG,YAAcN,EAAaK,MAJjC,CAAE9H,IAAK,EAAG8H,KAAM,IAfzBrpB,KAAKupB,kBAAoB,IAAS,IAAMvpB,KAAKwpB,cAAe,KAG9D,oBACExpB,KAAKwpB,cACLL,OAAOM,iBAAiB,SAAUzpB,KAAKupB,mBAGzC,uBACEJ,OAAOO,oBAAoB,SAAU1pB,KAAKupB,mBAc5C,SACE,OACE,uBACEnoB,UAAWpB,KAAKC,MAAMmB,UACtBuoB,IAAKV,GAAcjpB,KAAKipB,UAAYA,GACnCjpB,KAAKC,MAAMyO,SAAS1O,KAAK+oB,mB,iCC7DlC,mHAqCe,MAAMza,UAAoB,gBAAzC,c,oBACE,KAAAmI,YAAe/Q,IACbA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OAChBpM,KAAKC,MAAMoF,SACbrF,KAAKC,MAAMoF,WAIf,eACE,OAAKrF,KAAKC,MAAM2pB,OAGT,gBAAC,IAAW,CAACxoB,UAAU,cAAcF,QAASlB,KAAKC,MAAM2pB,SAFvD,KAKX,uBACE,MAAM,OAAEvf,GAAWrK,KAAKC,MACxB,IAAKoK,IAAWA,EAAOlK,OACrB,OAAO,KAET,MAAMyF,EACc,IAAlByE,EAAOlK,OAAekK,EAAO,GAAK,kCAAwB,aAAcA,EAAOlK,QACjF,OACE,wBAAMiB,UAAU,sBAAsBmD,MAAOqB,GAC1CA,GAKP,SACE,MAAMikB,EACiB,MAArB7pB,KAAKC,MAAMoK,QAAkBrK,KAAKC,MAAMoK,OAAOlK,OAAS,GAA2B,MAAtBH,KAAKC,MAAMuO,QAE1E,OACE,uBAAKpN,UAAU,6DACZpB,KAAKC,MAAMoF,QACV,wBAAMjE,UAAU,qDACd,qBAAGyL,KAAK,IAAIxH,QAASrF,KAAKyW,aACxB,gBAAC,IAAa,CAACrV,UAAU,sBAAsBqN,KAAMzO,KAAKC,MAAMwO,OAC/DzO,KAAKC,MAAM0C,MAEb3C,KAAK8pB,gBAGR,wBAAM1oB,UAAU,qDACbpB,KAAKC,MAAM0C,KACX3C,KAAK8pB,gBAIT9pB,KAAKC,MAAMyO,SAEZ,wBAAMtN,UAAU,iEACbpB,KAAK+pB,wBAGP/pB,KAAKC,MAAMgQ,UACV,wBAAM7O,UAAU,uBACd,gBAAC,IAAe,OAInByoB,GACC,gBAAC,SAAM,CACLzoB,UAAU,+DACViE,QAASrF,KAAKC,MAAMuO,SACnB,oBAAU,c,iCCxGvB,sDAmCe,MAAMT,UAAkB,gBAAvC,c,oBAOE,KAAA0I,YAAe/Q,IACbA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OACpBpM,KAAKC,MAAMoF,QAAQrF,KAAKC,MAAM2F,MAAOF,EAAM+W,SAAW/W,EAAM6W,UAG9D,cACE,OAAuB,MAAnBvc,KAAKC,MAAM0N,KACN,KAGF,wBAAMvM,UAAU,cAAcpB,KAAKC,MAAM0N,MAGlD,SACE,MAAM,KAAEhL,GAAS3C,KAAKC,MAChBmB,EAAY,EAAW,yBAA0BpB,KAAKC,MAAMmB,UAAW,CAC3EsM,OAAQ1N,KAAKC,MAAMyN,OACnB,8BAA+B1N,KAAKC,MAAM+N,YAG5C,OAAOhO,KAAKC,MAAMmF,SAChB,wBAAMhE,UAAWA,EAAS,aAAcpB,KAAKC,MAAM2F,MAAOrB,MAAOvE,KAAKC,MAAMgO,SAC1E,wBAAM7M,UAAU,cAAcuB,GAC7B3C,KAAKgqB,eAGR,qBACE5oB,UAAWA,EAAS,aACRpB,KAAKC,MAAM2F,MACvBiH,KAAK,IACLxH,QAASrF,KAAKyW,YACdlS,MAAOvE,KAAKC,MAAMgO,SAClB,wBAAM7M,UAAU,cAAcuB,GAC7B3C,KAAKgqB,gBAxCL,EAAAC,aAAe,CACpB7kB,UAAU,EACV4I,WAAW,EACXuG,SAAS,I,oJCJE,SAAS2V,EAAkBjqB,GACxC,MAAM,OAAEyN,EAAF,OAAUyc,EAAV,SAAkB/kB,EAAlB,QAA4Bua,EAA5B,SAAqCnP,GAAavQ,EAClDmqB,EAAU,IAAMnqB,EAAMmqB,QAAQzK,GAC9Bve,EAAY,EAAW,CAAEsM,SAAQtI,aACjCqE,EAAQxJ,EAAMoqB,YAAY1K,GAEhC,OACE,sBAAI2K,QAASF,EAASG,YAAaH,GACjC,gBAAC,IAAQ,CACPI,QAAS/d,QAAQ+D,GACjBpP,UAAWA,EACXgE,SAAUA,EACVqB,GAAIkZ,EACJ8K,QAASxqB,EAAMyqB,gBACdP,EACC,+CACiB,oBAAU,sBAD3B,aACqD1gB,GACnDrI,UAAU,sBACV,uCAAmB,EAAMA,UAAU,uBAAqB,KAGvDqI,GAGH,wBAAMrI,UAAU,sBAAsBqI,KCAjC,MAAM,UAAoB,gBAavC,YAAYxJ,GACVoH,MAAMpH,GAXR,KAAAV,SAAU,EA2DV,KAAAorB,mBAAqB,CAACna,EAAmBuH,KACnCvH,EACFxQ,KAAK4qB,aAAa7S,GAElB/X,KAAK6qB,eAAe9S,IAIxB,KAAA+S,mBAAsBllB,IACpB5F,KAAK+qB,cAAe/qB,KAAKC,MAA2B+qB,oBAAoBplB,KAG1E,KAAAqlB,mBAAsBtL,IACpB3f,KAAKM,SAAS,CAAC2gB,EAAWhhB,KACjB,CAAEirB,UAAWlrB,KAAKmrB,eAAelrB,EAAOghB,GAAW8F,QAAQpH,OAItE,KAAAyL,eAAkBC,IAChB,OAAQA,EAAIC,SACV,KAAK,GACHD,EAAIxa,kBACJwa,EAAI9iB,iBACJvI,KAAKM,SAASN,KAAKurB,mBACnB,MACF,KAAK,GACHF,EAAIxa,kBACJwa,EAAI9iB,iBACJvI,KAAKM,SAASN,KAAKwrB,uBACnB,MACF,KAAK,GACL,KAAK,GACHH,EAAIxa,kBACJ,MACF,KAAK,GACC7Q,KAAKR,MAAM0rB,WAAa,GAC1BlrB,KAAKyrB,aAAazrB,KAAKmrB,eAAenrB,KAAKC,MAAOD,KAAKR,OAAOQ,KAAKR,MAAM0rB,cAMjF,KAAAH,cAAiBprB,IACfK,KAAKM,SAAS,CAAE4qB,UAAW,EAAG3W,SAAS,EAAM5U,UAC7CK,KAAKC,MAAMP,SAASC,GAAOU,KAAKL,KAAK8d,YAAa9d,KAAK8d,cAGzD,KAAA8M,aAAgB7S,IACV/X,KAAK0rB,aAAa3T,EAAM/X,KAAKC,QAC/BD,KAAK+qB,cAAc,IAErB/qB,KAAKC,MAAMO,SAASuX,IAGtB,KAAA8S,eAAkB9S,GAAiB/X,KAAKC,MAAMU,WAAWoX,GAEzD,KAAA2T,aAAe,CAACC,GAAgBC,mBAAkBC,cAChDF,EAAKxrB,OAAS,IAAyC,IAApCyrB,EAAiB7E,QAAQ4E,KAA4C,IAA5BE,EAAS9E,QAAQ4E,GAE/E,KAAAG,uBAA0B7rB,IACxBD,KAAKM,SAAUd,GACTA,EAAMG,MACD,CACLisB,iBAAkB3rB,EAAM8rB,eAAevsB,EAAMG,MAAOM,EAAM2rB,mBAGrD,CAAEA,iBAAkB,IAAI3rB,EAAM2rB,qBAK3C,KAAAI,yBAA4B/rB,IAC1BD,KAAKM,SAAUd,GACU,IAAnBS,EAAMa,SACD,CAAEmrB,mBAAoB,IAAWhsB,EAAM4rB,SAAU5rB,EAAM2rB,mBACrD3rB,EAAMa,SAAWtB,EAAMosB,iBAAiBzrB,OAC1C,CAAE8rB,mBAAoB,IAEtB,CACLA,mBAAoB,IAAWhsB,EAAM4rB,SAAU5rB,EAAM2rB,kBAAkBnE,MACrE,EACAxnB,EAAMa,SAAWtB,EAAMosB,iBAAiBzrB,WAOlD,KAAAgrB,eAAiB,CAAClrB,EAAcT,IAC1BQ,KAAK0rB,aAAalsB,EAAMG,MAAOM,GAC1B,IAAIT,EAAMosB,oBAAqBpsB,EAAMysB,mBAAoBzsB,EAAMG,OAE/D,IAAIH,EAAMosB,oBAAqBpsB,EAAMysB,oBAIhD,KAAAC,iBAAoBC,GAAgBnsB,KAAKM,SAAS,CAAE4qB,UAAWiB,IAE/D,KAAAZ,kBAAoB,CAAC/rB,EAAcS,KACjC,MAAM,UAAEirB,GAAc1rB,EAChB4sB,EAAcpsB,KAAKmrB,eAAelrB,EAAOT,GAC/C,OAAI0rB,EAAY,GAAKA,GAAakB,EAAYjsB,OAAS,EAC9C,CAAE+qB,UAAW,GAEb,CAAEA,UAAWA,EAAY,IAIpC,KAAAM,sBAAwB,CAAChsB,EAAcS,KACrC,MAAM,UAAEirB,GAAc1rB,EAChB4sB,EAAcpsB,KAAKmrB,eAAelrB,EAAOT,GAC/C,GAAI0rB,GAAa,EAAG,CAElB,MAAO,CAAEA,UADOkB,EAAYjsB,OAAS,GAGrC,MAAO,CAAE+qB,UAAWA,EAAY,IAIpC,KAAApN,YAAc,KACR9d,KAAKT,SACPS,KAAKM,SAAS,CAAEiU,SAAS,KAI7B,KAAAkX,aAAgB1T,KACqC,IAA/C/X,KAAKC,MAAM2rB,iBAAiB7E,QAAQhP,GACtC/X,KAAK4qB,aAAa7S,GAElB/X,KAAK6qB,eAAe9S,IAhLtB/X,KAAKR,MAAQ,CACX0rB,UAAW,EACX3W,SAAS,EACT5U,MAAO,GACPisB,iBAAkB,GAClBK,mBAAoB,IAIxB,oBACEjsB,KAAKT,SAAU,EACfS,KAAK+qB,cAAc,IACnB/qB,KAAK8rB,uBAAuB9rB,KAAKC,OACjCD,KAAKgsB,yBAAyBhsB,KAAKC,OAC/BD,KAAKipB,WACPjpB,KAAKipB,UAAUQ,iBAAiB,UAAWzpB,KAAKorB,gBAAgB,GAIpE,0BAA0BpK,GACxB,GACEhhB,KAAKC,MAAM4rB,WAAa7K,EAAU6K,UAClC7rB,KAAKC,MAAM2rB,mBAAqB5K,EAAU4K,iBAC1C,CACA5rB,KAAK8rB,uBAAuB9K,GAC5BhhB,KAAKgsB,yBAAyBhL,GAE9B,MAAMqL,EAAgBrsB,KAAKmrB,eAAenK,EAAWhhB,KAAKR,OAAOW,OAC7DH,KAAKR,MAAM0rB,WAAamB,GAC1BrsB,KAAKM,SAAS,CAAE4qB,UAAWmB,EAAgB,KAKjD,qBACMrsB,KAAKssB,aACPtsB,KAAKssB,YAAYC,QAIrB,uBACEvsB,KAAKT,SAAU,EACXS,KAAKipB,WACPjpB,KAAKipB,UAAUS,oBAAoB,UAAW1pB,KAAKorB,gBAyIvD,SACE,MAAM,eAAEoB,GAAiB,EAAnB,iBAAyBC,GAAmB,EAA5C,WAAkDC,EAAa,IAAO1sB,KAAKC,OAC3E,YAAEoqB,GAAgBrqB,KAAKC,OACvB,MAAEN,EAAF,UAASurB,EAAT,iBAAoBU,EAApB,mBAAsCK,GAAuBjsB,KAAKR,MAClEmtB,EAAgB3sB,KAAKmrB,eAAenrB,KAAKC,MAAOD,KAAKR,OAAO0rB,GAC5D0B,EAAiBH,GAAoBzsB,KAAK0rB,aAAa/rB,EAAOK,KAAKC,OACnE4sB,EAAuC,IAAxB7sB,KAAKC,MAAMa,SAC1BgsB,EAAc,EAAW,OAAQ,CACrC,0BAA2BD,EAC3B,aAAcA,EACd,qBAAsBA,EACtB,wBAAyBpgB,QAAQigB,KAGnC,OACE,uBAAKtrB,UAAU,eAAeuoB,IAAKoD,GAAQ/sB,KAAKipB,UAAY8D,GAC1D,uBAAK3rB,UAAU,eACb,gBAAC,IAAS,CACR2F,WAAW,EACX3F,UAAU,oBACVmT,QAASvU,KAAKR,MAAM+U,QACpBlO,SAAUrG,KAAK8qB,mBACfhhB,YAAa9J,KAAKC,MAAM6J,YACxBlE,MAAOjG,KAGX,sBAAIyB,UAAW0rB,GACZlB,EAAiBzrB,OAAS,GACzByrB,EAAiBxjB,IAAIuX,GACnB,gBAACuK,EAAiB,CAChBxc,OAAQif,IAAkBhN,EAC1BA,QAASA,EACT1b,IAAK0b,EACLyK,QAASpqB,KAAKirB,mBACdP,eAAgB1qB,KAAK2qB,mBACrBN,YAAaA,EACb7Z,UAAU,KAGfyb,EAAmB9rB,OAAS,GAC3B8rB,EAAmB7jB,IAAIuX,GACrB,gBAACuK,EAAiB,CAChBxc,OAAQif,IAAkBhN,EAC1Bva,UAAWonB,EACX7M,QAASA,EACT1b,IAAK0b,EACLyK,QAASpqB,KAAKirB,mBACdP,eAAgB1qB,KAAK2qB,mBACrBN,YAAaA,KAGlBuC,GACC,gBAAC1C,EAAiB,CAChBxc,OAAQif,IAAkBhtB,EAC1BwqB,QAAQ,EACRxK,QAAShgB,EACTsE,IAAKtE,EACLyqB,QAASpqB,KAAKirB,mBACdP,eAAgB1qB,KAAK2qB,mBACrBN,YAAaA,KAGfuC,GAAkBhB,EAAiBzrB,OAAS,GAAK8rB,EAAmB9rB,OAAS,GAC7E,sBAAIiB,UAAU,eAAe,kCAAwB,mBAAoBzB,KAG5E+sB,IAhQA,EAAAzC,aAA6B,CAClC8B,eAAgB,CAACpsB,EAAeisB,IAC9BA,EAAiB/jB,OAAO8jB,GAAQA,EAAKphB,SAAS5K,IAChDmB,SAAU,EACVupB,YAAc1K,GAAoBA,EAClCqL,oBAAsBplB,GAAkBA,I,iCCrE5C,wGAgCe,SAAS1D,GAAS,YAAEC,GAAc,EAAhB,UAAuBf,EAAvB,KAAkClB,IACjE,OACE,qCACc,kCAAwB,cAAeA,EAAK8U,KAAK,OAC7D5T,UAAW,EAAW,YAAaA,IACnC,gBAAC,IAAQ,CAACA,UAAU,gBACpB,uCAAmB,EAAMA,UAAU,4BAA4BmD,MAAOrE,EAAK8U,KAAK,OAC7E9U,EAAK8U,KAAK,OAEZ7S,GAAe,gBAAC,IAAY,CAACf,UAAU,mB,iCCzC9C,sEA4Be,MAAM6F,UAAqB,gBACxC,YAAYokB,GACVA,EAAI9iB,iBACJ4gB,OAAO1a,KAAK,cAAsB,WAAY,iDAGhD,SACE,OACE,uBAAKrN,UAAW,EAAW,gBAAiBpB,KAAKC,MAAMmB,YACrD,qBAAGA,UAAU,sBAAsByL,KAAK,IAAIxH,QAASrF,KAAKyW,aACvD,oBAAU,sBAEZ,IACD,wBAAMrV,UAAU,e,IAAgB,oBAAU,QAAgB,KAC1D,wBAAMA,UAAU,e,KAEb,oBAAU,QAEN,MACP,wBAAMA,UAAU,e,KAAiB,oBAAU,uB,iCC/CnD,6CA0Be,SAASuN,GAAe,SAAED,EAAF,MAAYnK,IACjD,OACE,uBAAKnD,UAAU,+BACZmD,GAAS,uBAAKnD,UAAU,qCAAqCmD,GAC7DmK,K,qBC5BP4Y,EADkC,EAAQ,IAChC0F,EAA4B,IAE9BnhB,KAAK,CAACwb,EAAOhB,EAAI,mNAAoN,KAE7OgB,EAAOC,QAAUA,G,uPCyBF,MAAM,UAA6B,gBAAlD,c,oBACE,KAAA2F,oBAAuBvnB,IACrBA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OACpBpM,KAAKC,MAAMitB,YAGb,KAAAC,oBAAuBznB,IACrBA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OAChBpM,KAAKC,MAAMmtB,UACbptB,KAAKC,MAAMmtB,YAIf,SACE,MAAM,MAAEjV,EAAF,MAASrM,GAAU9L,KAAKC,MACxBotB,EAAUvhB,EAAQqM,EAClBmV,EAAW7gB,QAAQX,GAASA,IAAUqM,GAE5C,OACE,0BAAQ/W,UAAU,6CACf,kCAAwB,SAAU,wBAAc+W,EAAO,MAAO,OAE9DkV,GACC,qBAAGjsB,UAAU,yBAAyByL,KAAK,IAAIxH,QAASrF,KAAKitB,qBAC1D,oBAAU,cAIdjtB,KAAKC,MAAMmtB,UAAYE,GACtB,qBAAGlsB,UAAU,yBAAyByL,KAAK,IAAIxH,QAASrF,KAAKmtB,qBAC1D,oBAAU,gB,osBCmBR,MAAM,UAA0B,YAA/C,c,oBACE,KAAA5tB,SAAU,EAQV,KAAAC,MAAkB,CAChBuH,WAAW,EACXpH,MAAO,GACP4tB,WAAW,EACXC,oBAAqB,GACrBC,cAAc,GAqChB,KAAA3gB,gBAAkB,CAACC,EAAmBC,KACpC,GAAIhN,KAAKC,MAAMytB,YACb1tB,KAAKC,MAAMytB,YAAY3gB,EAAWC,OAC7B,CACL,MAAM,OAAE3C,GAAWrK,KAAKC,MACxB,GAAI+M,EAAU,CACZ,MAAMC,EAAW,IACf5C,EAAOE,SAASwC,GAAa,IAAQ1C,EAAQ0C,GAAa,IAAI1C,EAAQ0C,IAExE/M,KAAKC,MAAMoG,SAAS,CAAE,CAACrG,KAAKC,MAAMkN,UAAWF,SAE7CjN,KAAKC,MAAMoG,SAAS,CAClB,CAACrG,KAAKC,MAAMkN,UAAW9C,EAAOE,SAASwC,IAAc1C,EAAOlK,OAAS,EAAI,GAAK,CAAC4M,OAMvF,KAAAK,kBAAoB,KAClBpN,KAAKC,MAAMoN,SAASrN,KAAKC,MAAMkN,WAGjC,KAAAG,YAAc,KACRtN,KAAKC,MAAMuO,QACbxO,KAAKC,MAAMuO,UAEXxO,KAAKC,MAAMoG,SAAS,CAAE,CAACrG,KAAKC,MAAMkN,UAAW,MAIjD,KAAAwgB,cAAgB,KACV3tB,KAAKT,SACPS,KAAKM,SAAS,CAAEitB,WAAW,KAI/B,KAAAK,OAAUjuB,IACJA,EAAMQ,QAAUH,KAAKC,MAAMoQ,iBAC7BrQ,KAAKM,SAAS,CAAEX,QAAO4tB,WAAW,IAClCvtB,KAAKC,MACFP,SAASC,GACTU,KAAKL,KAAK6tB,4BACVxtB,KAAK,EAAGytB,aAAYpe,SAAQ7E,UAAS2C,YAChCxN,KAAKT,SACPS,KAAKM,SAASd,IAAK,CACjB+tB,WAAW,EACXQ,iBAAkBD,EAClBE,cAAenjB,EACfojB,aAAcve,EACd8d,oBAAoB,EAAD,GAAOhuB,EAAMguB,oBAAb,GAAqChgB,QAI7DmO,MAAM3b,KAAK2tB,gBAEd3tB,KAAKM,SAAS,CAAEX,QAAO4tB,WAAW,EAAOS,cAAe,MAI5D,KAAAE,WAAa,KACX,MAAM,MAAEvuB,EAAF,aAASsuB,EAAT,cAAuBD,GAAkBhuB,KAAKR,MAChDG,GAASquB,GAAiBC,IAC5BjuB,KAAKM,SAAS,CAAEitB,WAAW,IAC3BvtB,KAAKC,MACFP,SAASC,EAAOsuB,EAAate,UAAY,GACzCtP,KAAKL,KAAK6tB,4BACVxtB,KAAK,EAAGqP,SAAQ7E,UAAS2C,YACpBxN,KAAKT,SACPS,KAAKM,SAASd,IAAK,CACjB+tB,WAAW,EACXS,cAAe,IAAIA,KAAkBnjB,GACrCojB,aAAcve,EACd8d,oBAAoB,EAAD,GAAOhuB,EAAMguB,oBAAb,GAAqChgB,QAI7DmO,MAAM3b,KAAK2tB,iBAIlB,KAAAE,2BAA8BpjB,IAC5B,MAAM,sBAAE0jB,EAAwB,KAAMnjB,QAAQC,QAAQ,MAAQjL,KAAKC,MAC7DmuB,EAAgB3jB,EAASI,QAAQhD,OAAO6C,IAC5C,MAAMzG,EAAMjE,KAAKC,MAAMkQ,mBAAmBzF,GAC1C,YAA6BpH,IAAtBtD,KAAKuN,QAAQtJ,SAA8DX,IAAxCtD,KAAKR,MAAMguB,oBAAoBvpB,KAE3E,OAAImqB,EAAcjuB,OAAS,EAClBguB,EAAsBC,GAAe/tB,KAAKmN,GAAK,KAAU/C,EAAV,CAAoB+C,WAEnE,EAAP,GAAY/C,EAAZ,CAAsB+C,MAAO,MASjC,KAAAigB,aAAe,KACbztB,KAAKM,SAAS,CAAEmtB,cAAc,KAGhC,KAAAY,aAAe,KACbruB,KAAKM,SAAS,CAAEmtB,cAAc,KAzIhC,oBACEztB,KAAKT,SAAU,EAGjB,mBAAmBkY,IACZA,EAAUhJ,MAAQzO,KAAKC,MAAMwO,KAEhCzO,KAAKM,SAAS,CAAEyG,WAAW,IAE1B0Q,EAAUhJ,OAASzO,KAAKC,MAAMwO,OAC9B,uBAAagJ,EAAU9X,OAAS,GAAIK,KAAKC,MAAMN,OAAS,IAGzDK,KAAKM,SAAS,CACZX,MAAO,GACPouB,sBAAkBzqB,EAClB0qB,mBAAe1qB,EACfiqB,WAAW,EACXC,oBAAqB,GACrBC,cAAc,IAGhBhW,EAAUjK,QAAUxN,KAAKC,MAAMuN,OAC/BpD,OAAO+D,KAAKnO,KAAKC,MAAMuN,OAAS,IAAIrN,OAASH,KAAKC,MAAMquB,iBAGxDtuB,KAAKM,SAAS,CAAEmtB,cAAc,IAIlC,uBACEztB,KAAKT,SAAU,EAgGjB,QAAQwY,GACN,MAAM,MAAEvK,GAAUxN,KAAKC,MACvB,OAAOuN,QAAyBlK,IAAhBkK,EAAMuK,GAAsBvK,GAASA,EAAMuK,QAAQzU,EAWrE,aACE,MAAM,MAAEkK,GAAUxN,KAAKC,MAEvB,IAAKuN,EACH,OAAO,KAGT,MAAM+gB,EAAcvuB,KAAKC,MAAMuuB,eAC3BxuB,KAAKC,MAAMuuB,iBACX,IACEpkB,OAAO+D,KAAKX,GACZvJ,IAAQuJ,EAAMvJ,GACdA,GAAOjE,KAAKC,MAAMiQ,iBAAiBjM,IAGnCwqB,EAAczuB,KAAKR,MAAMiuB,aAC3Bc,EACAA,EAAY9G,MAAM,EAAGznB,KAAKC,MAAMquB,iBAG9BI,EAAqB1uB,KAAKR,MAAMiuB,aAClC,GACAc,EACG9G,MAAMznB,KAAKC,MAAMquB,iBACjBzmB,OAAOkQ,GAAQ/X,KAAKC,MAAMoK,OAAOE,SAASwN,IAE3C4W,EAAuBJ,EAAYpuB,QAAUH,KAAKC,MAAM2uB,SAE9D,OACE,gCACE,gBAACjgB,EAAA,EAAc,KACZ8f,EAAYrmB,IAAI2P,GACf,gBAAChK,EAAA,EAAS,CACRL,OAAQ1N,KAAKC,MAAMoK,OAAOE,SAASwN,GACnC9T,IAAK8T,EACLpV,KAAM3C,KAAKC,MAAMqQ,gBAAgByH,GACjC1S,QAASrF,KAAK8M,gBACda,KAAMkhB,EAAgB7uB,KAAKuN,QAAQwK,IACnC9J,QAASjO,KAAKC,MAAMiQ,iBAAiB6H,GACrCnS,MAAOmS,MAIZ2W,EAAmBvuB,OAAS,GAC3B,gCACE,uBAAKiB,UAAU,kCAAgC,KAC/C,gBAACuN,EAAA,EAAc,KACZ+f,EAAmBtmB,IAAI2P,GACtB,gBAAChK,EAAA,EAAS,CACRL,QAAQ,EACRzJ,IAAK8T,EACLpV,KAAM3C,KAAKC,MAAMqQ,gBAAgByH,GACjC1S,QAASrF,KAAK8M,gBACda,KAAMkhB,EAAgB7uB,KAAKuN,QAAQwK,IACnC9J,QAASjO,KAAKC,MAAMiQ,iBAAiB6H,GACrCnS,MAAOmS,OAMjB,gBAAC,EAAoB,CACnBI,MAAOsW,EAAYtuB,OAASuuB,EAAmBvuB,OAC/CitB,SAAUptB,KAAKR,MAAMiuB,aAAeztB,KAAKquB,kBAAe/qB,EACxD4pB,SAAUltB,KAAKytB,aACf3hB,MAAOyiB,EAAYpuB,SAEpBwuB,GAAwB3uB,KAAKR,MAAMiuB,cAClC,gBAACjiB,EAAA,MAAK,CAACpK,UAAU,aAAakI,QAAQ,WACnC,oBAAU,mCAOrB,eACE,OAAKtJ,KAAKC,MAAMuN,OAAUpD,OAAO+D,KAAKnO,KAAKC,MAAMuN,OAAOrN,OAKtD,gBAAC,IAAS,CACR4G,UAAW/G,KAAKR,MAAMuH,UACtB3F,UAAU,kCACVmT,QAASvU,KAAKR,MAAM+tB,UACpBzL,UAAW9hB,KAAKC,MAAMoQ,gBACtBhK,SAAUrG,KAAK4tB,OACf9jB,YAAa9J,KAAKC,MAAMsQ,kBACxB3K,MAAO5F,KAAKR,MAAMG,QAXb,KAgBX,sBACE,MAAM,UAAE4tB,EAAF,iBAAaQ,EAAb,cAA+BC,EAA/B,aAA8CC,GAAiBjuB,KAAKR,MAE1E,OAAK+tB,GAAeS,GAAkBA,EAAc7tB,OAI/C6tB,EAMH,gCACE,gBAACrf,EAAA,EAAc,KACZqf,EAAc5lB,IAAIsC,GAAU1K,KAAK6P,mBAAmBnF,KAEtDqjB,GACC,gBAACviB,EAAA,MAAK,CAACpK,UAAU,aAAakI,QAAQ,WACnC,oBAAU,kCAGd2kB,GACC,gBAAC,IAAU,CACT7sB,UAAU,gBACV+W,MAAO6V,EAAc7tB,OACrB4hB,SAAU/hB,KAAKkuB,WACflM,OAAQuL,EACRzhB,MAAOmiB,EAAaniB,SAnBnB,KALA,uBAAK1K,UAAU,sBAAsB,oBAAU,eA+B1D,mBAAmBsJ,GACjB,MAAMzG,EAAMjE,KAAKC,MAAMkQ,mBAAmBzF,GACpCgD,EAAS1N,KAAKC,MAAMoK,OAAOE,SAAStG,GACpC0J,EAAO3N,KAAKuN,QAAQtJ,IAAQjE,KAAKR,MAAMguB,oBAAoBvpB,GAC3DmB,GAAYsI,GAAmB,IAATC,EAC5B,OACE,gBAACI,EAAA,EAAS,CACRL,OAAQA,EACRtI,SAAUA,EACVnB,IAAKA,EACLtB,KAAM3C,KAAKC,MAAM4P,mBAAmBnF,EAAQ1K,KAAKR,MAAMG,OACvD0F,QAASrF,KAAK8M,gBACda,KAAMkhB,EAAgBlhB,GACtBM,QAASjO,KAAKC,MAAMmQ,oBAAoB1F,GACxC9E,MAAO3B,IAKb,SACE,MAAM,SAAEmB,EAAF,MAAYoI,EAAQ,IAAOxN,KAAKC,OAChC,MAAEN,EAAF,UAAS4tB,EAAT,cAAoBS,GAAkBhuB,KAAKR,MAC3C6K,EAASrK,KAAKC,MAAMoK,OAAOjC,IAAI2P,GAAQ/X,KAAKC,MAAMiQ,iBAAiB6H,IACnE+W,EACM,KAAVnvB,GAAgB4tB,SAAgCjqB,IAAlB0qB,GAAwD,IAAzBA,EAAc7tB,QACvE4uB,GAAYpvB,GAASmvB,EAC3B,OACE,gBAACzgB,EAAA,EAAQ,CACPjN,UAAW,EAAWpB,KAAKC,MAAMmB,UAAW,CAC1C,uCAAwCgE,IAE1C+H,SAAUnN,KAAKC,MAAMkN,UACrB,gBAACmB,EAAA,EAAW,CACV2B,SAAUjQ,KAAKC,MAAMgQ,SACrBtN,KACE,gBAAC,IAAO,CAACzB,QAASkE,EAAWpF,KAAKC,MAAMsO,oBAAiBjL,GACvD,4BAAOtD,KAAKC,MAAM+P,cAGtBxB,QAASxO,KAAKsN,YACdjI,QAASD,OAAW9B,EAAYtD,KAAKoN,kBACrCqB,KAAMzO,KAAKC,MAAMwO,OAASrJ,EAC1BiF,OAAQA,IAGTrK,KAAKC,MAAMwO,OAASrJ,GACnB,gCACGpF,KAAKgvB,eACLD,EAAW/uB,KAAKivB,aAAejvB,KAAKkvB,sBACrC,gBAACC,EAAA,EAAqB,CAAC3lB,QAASY,OAAO+D,KAAKX,GAAOrN,OAAQkK,OAAQA,EAAOlK,YAQtF,SAAS0uB,EAAgBlhB,GACvB,OAAOA,GAAQ,wBAAcA,EAAM,aArV5B,EAAAsc,aAAe,CACpBqE,gBAAiB,GACjBM,SAAU,IACVve,gBAAiB,I,iCCxFrB,mHAqBO,SAAS+e,EAAmBhvB,GACjC,OAAOqM,QAAQrM,GAA8C,SAA9BA,EAAaivB,cAGvC,SAASC,EACdtQ,EACA5e,EACA6e,GAEA,OACGmQ,EAAmBhvB,IACpBmvB,EAAsBvQ,EAAa5e,EAAc6e,GAI9C,SAASsQ,EACdvQ,EACA5e,EACA6e,GAEA,OAAOxS,QACLrM,GACE,YAAW4e,KACT5e,EAAa4H,SAAW5H,EAAa4H,QAAQwnB,OAC7CvQ,EAAkBzS,KAAKijB,GAAOA,EAAIxrB,MAAQ7D,EAAa6D,S,iCC7C/D,oEAiCe,SAASpD,EAAaZ,GACnC,OACE,gBAAC,IAAW,CACV4rB,SAAU5rB,EAAMC,KAChBY,SAAUb,EAAMa,SAChBpB,SAAUO,EAAMP,SAChBc,SAAUP,EAAMO,SAChBG,WAAYV,EAAMU,WAClBmJ,YAAa,oBAAU,0BACvB8hB,iBAAkB3rB,EAAMc,aACxBiqB,oBAAqB0E,IAKpB,SAASA,EAAY9pB,GAE1B,OAAOA,EAAMwI,cAActK,QAAQ,kBAAmB,M,2oBCPxD,MAAM6rB,EAAY,4BAAkB,IAAM,oCAA4B,aAwBvD,MAAMzgB,UAAkB,gBAGrC,YAAYjP,GACVoH,MAAMpH,GAIR,KAAAssB,MAAQ,KACFvsB,KAAK4vB,OACP5vB,KAAK4vB,MAAMrD,QAEbvsB,KAAK6vB,gBAGP,KAAAC,iBAAmB,KACjB9vB,KAAK+vB,gBACL/vB,KAAKC,MAAMoG,cAAS/C,IAGtB,KAAAusB,aAAe,KACb7vB,KAAKM,SAAS,CACZ0vB,aAAchwB,KAAKC,MAAM2F,OAAS5F,KAAKC,MAAM+vB,cAAgB,IAAIC,KACjEC,iBAAa5sB,EACbmL,MAAM,KAIV,KAAAshB,cAAgB,KACd/vB,KAAKM,SAAS,CAAEmO,MAAM,KAGxB,KAAA0hB,eAAiB,CAACC,EAAWC,KACtBA,EAAUjrB,WACbpF,KAAK+vB,gBACL/vB,KAAKC,MAAMoG,SAAS+pB,KAIxB,KAAAE,oBAAsB,CAACF,EAAWC,KAChCrwB,KAAKM,SAAS,CAAE4vB,YAAaG,EAAUjrB,cAAW9B,EAAY8sB,KAGhE,KAAAG,yBAA2B,EAAG3qB,YAC5B5F,KAAKM,SAAUd,IAAD,CAAqBwwB,aAAc,EAASxwB,EAAMwwB,aAAcpqB,OAGhF,KAAA4qB,wBAA0B,EAAG5qB,YAC3B5F,KAAKM,SAASd,IAAK,CAAOwwB,aAAc,EAAQxwB,EAAMwwB,aAAcpqB,OAGtE,KAAA6qB,yBAA2B,KACzBzwB,KAAKM,SAASd,IAAK,CAAOwwB,aAAc,EAAUxwB,EAAMwwB,aAAc,OAGxE,KAAAU,qBAAuB,KACrB1wB,KAAKM,SAASd,IAAK,CAAOwwB,aAAc,EAAUxwB,EAAMwwB,aAAc,OAnDtEhwB,KAAKR,MAAQ,CAAEwwB,aAAc/vB,EAAM2F,OAAS3F,EAAM+vB,cAAgB,IAAIC,KAAQxhB,MAAM,GAsDtF,SACE,MAAM,cAAEkiB,EAAF,YAAiBC,EAAjB,QAA8BC,EAA9B,MAAuCjrB,GAAU5F,KAAKC,OACtD,YAAEiwB,GAAgBlwB,KAAKR,MAEvBsxB,EAAQ9wB,KAAKC,MAAM8wB,SAAW,IAAId,KAElCe,EAAS,IAAM,IACfC,EAAQ,KAAM,IAAIhB,MAAOiB,cAAgB,IAAI,IAAIjB,MAAOiB,cAAgB,GAExEC,EAA2BvrB,EAAQ,CAACA,GAAS,GACnD,IAAIyqB,EACJ,MAAMe,EAAqBlB,GAAetqB,EAEtC+qB,GAAiBS,IACnBf,EAAY,CAAEgB,YAAa,CAAEC,KAAMX,EAAe1tB,GAAImuB,IACtDD,EAAatlB,KAAK8kB,IAEhBC,GAAeQ,IACjBf,EAAY,CAAEgB,YAAa,CAAEC,KAAMF,EAAoBnuB,GAAI2tB,IAC3DO,EAAatlB,KAAK+kB,IAGpB,MAAMW,EAAe,IAAM,GAAGnpB,IAAI,kBAC5BopB,EAAgB,IAAM,GAAGppB,IAAI,uBAEnC,OACE,gBAAC,IAAmB,CAACqpB,eAAgBzxB,KAAK+vB,eACxC,wBAAM3uB,UAAW,EAAW,qBAAsBpB,KAAKC,MAAMmB,YAC3D,gBAACswB,EAAY,CACXtwB,UAAW,EAAW,2BAA4BpB,KAAKC,MAAM0xB,eAAgB,CAC3E,iBAAkCruB,IAArBtD,KAAKC,MAAM2F,QAE1BgsB,SAAUC,GAAS7xB,KAAK4vB,MAAQiC,EAChClvB,KAAM3C,KAAKC,MAAM0C,KACjB2nB,QAAStqB,KAAK6vB,aACd/lB,YAAa9J,KAAKC,MAAM6J,YACxBgoB,UAAU,EACV3wB,KAAK,OACLyE,MAAOA,IAET,gBAAC,IAAY,CAACxE,UAAU,0BAA0BwQ,KAAK,UACjCtO,IAArBtD,KAAKC,MAAM2F,OACV,gBAAC,cAAW,CACVxE,UAAU,uCACV2wB,UAAW,CAAE1oB,KAAM,IACnBhE,QAASrF,KAAK8vB,mBAGjB9vB,KAAKR,MAAMiP,MACV,uBAAKrN,UAAU,uBACb,uBAAKA,UAAU,2BACb,gBAAC,aAAU,CAACA,UAAU,eAAeiE,QAASrF,KAAKywB,0BACjD,gBAAC,IAAe,OAElB,uBAAKrvB,UAAU,6BACb,gBAAC,IAAM,CACLA,UAAU,mCACViF,SAAUrG,KAAKuwB,yBACf/mB,QAASwnB,EAAO5oB,IAAI4pB,IAAK,CACvBvoB,MAAO,4BAAkBuoB,GACzBpsB,MAAOosB,KAETpsB,MAAO5F,KAAKR,MAAMwwB,aAAaiC,aAEjC,gBAAC,IAAM,CACL7wB,UAAU,+CACViF,SAAUrG,KAAKwwB,wBACfhnB,QAASynB,EAAM7oB,IAAI8pB,IAAI,CAAOzoB,MAAO0I,OAAO+f,GAAOtsB,MAAOssB,KAC1DtsB,MAAO5F,KAAKR,MAAMwwB,aAAakB,iBAGnC,gBAAC,aAAU,CAAC9vB,UAAU,eAAeiE,QAASrF,KAAK0wB,sBACjD,gBAAC,IAAgB,QAGrB,gBAACf,EAAS,CACRwC,eAAgB,gBAACC,EAAa,MAC9BC,aAAc,CAAEvB,QAAOwB,OAAQzB,GAC/B0B,eAAgB,EAChBlC,UAAWA,EACX2B,MAAOhyB,KAAKR,MAAMwwB,aAClBwC,cAAe,gBAACJ,EAAa,MAC7BK,WAAYzyB,KAAKmwB,eACjBuC,gBAAiB1yB,KAAKswB,oBACtBa,aAAcA,EACdI,aAAcA,EACdC,cAAeA,QAU/B,SAASY,IACP,OAAO,KAST,MAAMV,EAAe,qBAAY,IAA0D,IAA1D,SAAEE,EAAF,KAAY5iB,EAAZ,MAAkBpJ,GAAwC,EAA9BoT,EAA8B,iCACzF,MAAM2Z,EACJ/sB,GAASoJ,EAAKC,WAAWrJ,EAAO,CAAEssB,KAAM,UAAWF,MAAO,QAAS5B,IAAK,YAC1E,OAAO,yCAAWpX,EAAK,CAAE2Q,IAAKiI,EAAUhsB,MAAO+sB,GAAkB,S,oBC3OnE,IAAIhK,EAAM,EAAQ,KACFtH,EAAU,EAAQ,KAIC,iBAFvBA,EAAUA,EAAQuH,WAAavH,EAAQsB,QAAUtB,KAG/CA,EAAU,CAAC,CAACgG,EAAOhB,EAAIhF,EAAS,MAG9C,IAAI7X,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBqf,GAFSF,EAAItH,EAAS7X,GAEX6X,EAAQyH,OAASzH,EAAQyH,OAAS,IAIjDzB,EAAOC,QAAUuB,G,qBClBjBvB,EADkC,EAAQ,IAChC0F,EAA4B,IAE9BnhB,KAAK,CAACwb,EAAOhB,EAAI,qpDAAspD,KAE/qDgB,EAAOC,QAAUA,G,oBCNjB,IAAIqB,EAAM,EAAQ,KACFtH,EAAU,EAAQ,KAIC,iBAFvBA,EAAUA,EAAQuH,WAAavH,EAAQsB,QAAUtB,KAG/CA,EAAU,CAAC,CAACgG,EAAOhB,EAAIhF,EAAS,MAG9C,IAAI7X,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBqf,GAFSF,EAAItH,EAAS7X,GAEX6X,EAAQyH,OAASzH,EAAQyH,OAAS,IAIjDzB,EAAOC,QAAUuB,G,qBClBjBvB,EADkC,EAAQ,IAChC0F,EAA4B,IAE9BnhB,KAAK,CAACwb,EAAOhB,EAAI,q0BAAs0B,KAE/1BgB,EAAOC,QAAUA,G,oBCNjB,IAAIqB,EAAM,EAAQ,KACFtH,EAAU,EAAQ,KAIC,iBAFvBA,EAAUA,EAAQuH,WAAavH,EAAQsB,QAAUtB,KAG/CA,EAAU,CAAC,CAACgG,EAAOhB,EAAIhF,EAAS,MAG9C,IAAI7X,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBqf,GAFSF,EAAItH,EAAS7X,GAEX6X,EAAQyH,OAASzH,EAAQyH,OAAS,IAIjDzB,EAAOC,QAAUuB,G,qBClBjBvB,EADkC,EAAQ,IAChC0F,EAA4B,IAE9BnhB,KAAK,CAACwb,EAAOhB,EAAI,+/PAAogQ,KAE7hQgB,EAAOC,QAAUA,G,iCCNjB,2DA4Be,SAAS6H,GAAsB,QAAE3lB,EAAF,OAAWa,IAEvD,OAAe,IAAXA,GAAgBb,EAAU,EACrB,KAIP,uBAAKpI,UAAU,2BACb,uBAAKA,UAAU,iCACZ,qBAW6C,IAA7CwxB,UAAUC,UAAU9L,QAAQ,YATvB,qDACA,sD,iCCrBP,SAAS+L,IACd,OAAO,oCAA2BzyB,KAAK4a,GAAKA,EAAE0H,SAGzC,SAASoQ,EAAkBrf,EAAwBsf,GACxD,MAAMC,EAASvf,EAAUP,IAAI6f,GAC7B,OAAKC,EAEmB,YAAbD,EACFC,EAAO1uB,MAER,OAAN,OAAcyuB,EAAd,cAA4BC,EAAO1uB,OAJ7B,OAAN,OAAcyuB,GAQX,SAASE,EACdxf,EACAsf,EACAG,GAAa,GAEb,MAAMF,EAASvf,EAAUC,WAAWqf,GACpC,OAGSI,EAHJH,EAGc,GAAD,OAAID,EAASK,cAAb,cAAgCJ,EAAO1uB,OAFtCyuB,EAASK,cAEsC,QAASF,GAItE,SAASG,EACd5f,EACAsf,EACAG,GAAa,GAEb,MAAMF,EAASvf,EAAUI,UAAUkf,GACnC,OAAOI,EAAUH,EAASA,EAAO1uB,MAAQyuB,EAAU,OAAQG,GAGtD,SAASI,EACd7f,EACAsf,EACAG,GAAa,GAEb,MAAMF,EAASvf,EAAUO,oBAAoB+e,GAC7C,OAAKC,EAEmB,WAAbD,EACFC,EAAO1uB,MAEP6uB,EAAUH,EAAO1uB,MAAO,QAAS4uB,GAJjCC,EAAUJ,EAASK,cAAe,QAASF,GAQtD,SAASC,EAAU7uB,EAAeivB,EAAgBL,GAChD,OAAOA,EAAU,UAAMK,EAAN,YAAgBjvB,GAAUA,EAxE7C,2K,iCCAA,sEA6Be,SAAS2W,GAA2B,UAAE9Z,EAAF,QAAa6M,GAAU,IACxE,MAAMwlB,EACJ,uBAAKryB,UAAW,EAAW,mBAAoBA,IAC5C,oBAAU,8BAIf,OAAI6M,EAEA,gBAAC,IAAU,CACT9K,IAAK,0CAGJswB,GAIAA,I,iCC9CT,OAAe,qL,iCCAf,uJAkCe,MAAMhvB,UAA2B,gBAAhD,c,oBACE,KAAAivB,oBAAuBhuB,IACrBA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OAChBpM,KAAKC,MAAM0E,KAAKwD,MAClBnI,KAAKC,MAAMyE,eAAe,CAAE4F,UAAW,CAACtK,KAAKC,MAAM0E,KAAKwD,SAI5D,KAAAwrB,gBAAmBjuB,IACjBA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OACpBpM,KAAKC,MAAMyE,eAAe,CAAEoO,MAAO,CAAC9S,KAAKC,MAAM0E,KAAKxD,SAGtD,KAAAyyB,oBAAuBluB,IACrBA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OAChBpM,KAAKC,MAAM0E,KAAKpD,UAClBvB,KAAKC,MAAMyE,eAAe,CAAEsO,WAAY,CAAChT,KAAKC,MAAM0E,KAAKpD,aAI7D,KAAAsyB,eAAkBnuB,IAChBA,EAAM6C,iBACN7C,EAAMC,cAAcyG,OACpB,MAAM,IAAE3L,GAAQiF,EAAMC,cAAcmuB,QAChCrzB,GACFT,KAAKC,MAAMyE,eAAe,CAAExE,KAAM,CAACO,MAIvC,SACE,MAAM,KAAEkE,GAAS3E,KAAKC,OAChB,KAAEC,EAAO,GAAT,QAAaK,EAAU,GAAvB,SAA2BgB,GAAaoD,EACxC/C,EAAU,IAAI1B,KAASK,GAE7B,OACE,gBAAC,IAAQ,CACPa,UAAU,uBACVF,QACE,gCACE,sBAAIE,UAAU,QACZ,sBAAIA,UAAU,eAAe,oBAAU,sCACvC,0BACE,iCACY,iCACVyL,KAAK,IACLxH,QAASrF,KAAK0zB,qBACb/uB,EAAK/B,WAIV,0BACE,qBACExB,UAAU,sBAAqB,YACrB,6BACVyL,KAAK,IACLxH,QAASrF,KAAK2zB,iBACd,gBAAC,IAAa,CAACh0B,MAAOgF,EAAKxD,OAC3B,wBAAMC,UAAU,sBAAsB,oBAAU,aAAcuD,EAAKxD,SAItEI,GACC,0BACE,iCACY,iCACVsL,KAAK,IACLxH,QAASrF,KAAK4zB,qBACd,gBAAC,IAAc,CAACxyB,UAAU,sBAAsBG,SAAUoD,EAAKpD,aAKpEK,EAAQzB,OAAS,GAAK,sBAAIiB,UAAU,YACpCQ,EAAQwG,IAAI3H,GACX,sBAAIwD,IAAKxD,GACP,gCACYA,EAAG,YACH,4BACVoM,KAAK,IACLxH,QAASrF,KAAK6zB,gBACd,gBAAC,IAAQ,CAACzyB,UAAU,0DACpB,wBAAMA,UAAU,eAAeX,SAO3C,qBACEW,UAAU,+DACVyL,KAAK,IACLtI,MAAO,oBAAU,sCACjB,gBAAC,IAAU,CAACnD,UAAU,0BACtB,gBAAC,IAAY,CAACA,UAAU,+B,iCClIlC,6DA4Be,SAASugB,GAAc,aAAEC,EAAF,QAAgBC,IACpD,OACE,uBAAKzgB,UAAU,mCACZwgB,GACC,uBAAKxgB,UAAU,cACb,gBAAC,SAAM,CAACA,UAAU,aAAaqF,GAAG,iCAAiCpB,QAASwc,GACzE,oBAAU,uBAKjB,0BAAK,oBAAU,e,oBCvCrB,IAAI8G,EAAM,EAAQ,KACFtH,EAAU,EAAQ,KAIC,iBAFvBA,EAAUA,EAAQuH,WAAavH,EAAQsB,QAAUtB,KAG/CA,EAAU,CAAC,CAACgG,EAAOhB,EAAIhF,EAAS,MAG9C,IAAI7X,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBqf,GAFSF,EAAItH,EAAS7X,GAEX6X,EAAQyH,OAASzH,EAAQyH,OAAS,IAIjDzB,EAAOC,QAAUuB,G,qBClBjBvB,EADkC,EAAQ,IAChC0F,EAA4B,IAE9BnhB,KAAK,CAACwb,EAAOhB,EAAI,8jIAA+jI,KAExlIgB,EAAOC,QAAUA,G,4NC+DF,MAAMpU,UAAsB,gBAA3C,c,oBACE,KAAA3T,SAAU,EACV,KAAA4N,SAAW,IACX,KAAA3N,MAAe,CACbkU,UAAW,CAAEC,WAAY,GAAIG,UAAW,GAAIX,IAAK,GAAIc,oBAAqB,KA4B5E,KAAA8f,cAAgB,KACd,cAAe1zB,KACb,EAAGsT,aAAYG,YAAWX,MAAKc,0BACzBjU,KAAKT,SACPS,KAAKM,SAAS,CAAEoT,UAAW,CAAEC,aAAYG,YAAWX,MAAKc,0BAG7D,SAIJ,KAAAlF,UAAY,IACH,IACF/O,KAAKC,MAAMgU,oBAAoB7L,IAAI2P,GACpC,YAAkC/X,KAAKR,MAAMkU,UAAWqE,GAAM,OAE7D/X,KAAKC,MAAM0T,WAAWvL,IAAI2P,GAC3B,YAAyB/X,KAAKR,MAAMkU,UAAWqE,GAAM,OAEpD/X,KAAKC,MAAM6T,UAAU1L,IAAI2P,GAC1B,YAAwB/X,KAAKR,MAAMkU,UAAWqE,GAAM,OAEnD/X,KAAKC,MAAMkT,IAAI/K,IAAI2P,GAAQ,YAAkB/X,KAAKR,MAAMkU,UAAWqE,KAI1E,KAAA3K,kBAAoB,KAClBpN,KAAKC,MAAMoN,SAASrN,KAAKmN,WAG3B,KAAA6mB,4BAA8B,KAC5Bh0B,KAAKC,MAAMoN,SAAS,eAGtB,KAAA4mB,2BAA6B,KAC3Bj0B,KAAKC,MAAMoN,SAAS,cAGtB,KAAA6mB,qCAAuC,KACrCl0B,KAAKC,MAAMoN,SAAS,wBAGtB,KAAAC,YAAc,KACZtN,KAAKC,MAAMoG,SAAS,CAClB,CAACrG,KAAKmN,UAAW,GACjBwG,WAAY,GACZG,UAAW,GACXX,IAAK,GACLc,oBAAqB,MAIzB,KAAAnH,gBAAkB,CAACqnB,EAAkBpnB,EAAmBC,KACtD,MAAMkB,EAAQlO,KAAKC,MAAMk0B,GACzB,GAAInnB,EAAU,CACZ,MAAMC,EAAW,IACfiB,EAAM3D,SAASwC,GAAa,IAAQmB,EAAOnB,GAAa,IAAImB,EAAOnB,IAErE/M,KAAKC,MAAMoG,SAAS,CAAE,CAAC8tB,GAAOlnB,SAE9BjN,KAAKC,MAAMoG,SAAS,CAClB,CAAC8tB,GAAOjmB,EAAM3D,SAASwC,IAAcmB,EAAM/N,OAAS,EAAI,GAAK,CAAC4M,MAKpE,KAAAqnB,0BAA4B,CAACrnB,EAAmBC,KAC9ChN,KAAK8M,gBAAgB,aAAcC,EAAWC,IAGhD,KAAAqnB,yBAA2B,CAACtnB,EAAmBC,KAC7ChN,KAAK8M,gBAAgB,YAAaC,EAAWC,IAG/C,KAAAsnB,mCAAqC,CAACvnB,EAAmBC,KACvDhN,KAAK8M,gBAAgB,sBAAuBC,EAAWC,IAGzD,KAAAunB,gBAAmB50B,GACVqL,QAAQC,QAAQ,CACrBJ,QAAST,OAAO+D,KAAKnO,KAAKR,MAAMkU,UAAUP,KAAKtL,OAAOsL,GACpD,YAAkBnT,KAAKR,MAAMkU,UAAWP,GACrC/E,cACA7D,SAAS5K,EAAMyO,kBAKxB,KAAAomB,yBAA4BC,IAC1B,MAAM,sBAAEtG,GAA0BnuB,KAAKC,MACvC,OAAOkuB,EACHA,EAAsB,MAAO,CAAEhb,IAAKshB,IACpCzpB,QAAQC,QAAQ,KAGtB,KAAAgkB,WAAa,CACXyF,EACAC,EACA/mB,EACAvI,KAEA,MAAMmI,EAAQxN,KAAKC,MAAMy0B,GACnBrqB,EAASrK,KAAKC,MAAM00B,GAC1B,IAAKnnB,EACH,OAAO,KAET,MAAMinB,EAAa,IAAOrqB,OAAO+D,KAAKX,GAAQvJ,IAAQuJ,EAAMvJ,IAC5D,OAAOjE,KAAK40B,qBAAqBpnB,EAAOnD,EAAQoqB,EAAY7mB,EAAYA,EAAYvI,IAItF,KAAAuvB,qBAAuB,CACrBpnB,EACAnD,EACAoqB,EACA7mB,EACAinB,EACAxvB,KAEA,IAAKovB,EAAWt0B,OACd,OACE,uBAAKiB,UAAU,kDACZ,oBAAU,eAKjB,MAAMmM,EAAWylB,GACRxlB,EAAQA,EAAMwlB,QAAY1vB,EAGnC,OACE,gBAAC,IAAc,KACZmxB,EAAWrsB,IAAI4qB,GACd,gBAAC,IAAS,CACRtlB,OAAQrD,EAAOE,SAASyoB,GACxB/uB,IAAK+uB,EACLrwB,KAAMiL,EAAW5N,KAAKR,MAAMkU,UAAWsf,GACvC3tB,QAASA,EACTsI,KAAM,YAAgBJ,EAAQylB,IAC9B/kB,QAAS4mB,EAAc70B,KAAKR,MAAMkU,UAAWsf,GAC7CptB,MAAOotB,OAOjB,KAAA8B,WAAa,CAACJ,EAAsBC,KAClC,MAAMnnB,EAAQxN,KAAKC,MAAMy0B,IAAc,GACjCrqB,EAASrK,KAAKC,MAAM00B,GAC1B,OAAO,gBAAC,IAAqB,CAACnrB,QAASY,OAAO+D,KAAKX,GAAOrN,OAAQkK,OAAQA,EAAOlK,UAhLnF,oBACEH,KAAKT,SAAU,GAIbS,KAAKC,MAAMwO,MACXzO,KAAKC,MAAM0T,WAAWxT,OAAS,GAC/BH,KAAKC,MAAMkT,IAAIhT,OAAS,GACxBH,KAAKC,MAAM6T,UAAU3T,OAAS,GAC9BH,KAAKC,MAAMgU,oBAAoB9T,OAAS,IAExCH,KAAK+zB,gBAIT,mBAAmBtc,IACZA,EAAUhJ,MAAQzO,KAAKC,MAAMwO,MAChCzO,KAAK+zB,gBAIT,uBACE/zB,KAAKT,SAAU,EA6JjB,uBACE,OAAOS,KAAKivB,WACV,kBACA,aACA,IACAjvB,KAAKo0B,2BAIT,uBACE,OAAOp0B,KAAK80B,WAAW,kBAAmB,cAG5C,sBACE,OAAO90B,KAAKivB,WACV,iBACA,YACA,IACAjvB,KAAKq0B,0BAIT,sBACE,OAAOr0B,KAAK80B,WAAW,iBAAkB,aAG3C,gCACE,OAAO90B,KAAKivB,WACV,2BACA,sBACA,IACAjvB,KAAKs0B,oCAIT,gCACE,OAAOt0B,KAAK80B,WAAW,2BAA4B,uBAGrD,kBACE,OACE,gCACE,gBAAC,IAAQ,CAAC1zB,UAAU,WAAW+L,SAAS,uBACtC,gBAAC,IAAW,CACV8C,SAAUjQ,KAAKC,MAAMwT,4BACrB9Q,KAAM,oBAAU,oCAChB0C,QAASrF,KAAKk0B,qCACdzlB,KAAMzO,KAAKC,MAAMiU,wBACjB7J,OAAQrK,KAAKC,MAAMgU,oBAAoB7L,IAAI2P,GACzC,YAAkC/X,KAAKR,MAAMkU,UAAWqE,MAG3D/X,KAAKC,MAAMiU,yBACV,gCACGlU,KAAK+0B,gCACL/0B,KAAKg1B,kCAIZ,gBAAC,IAAQ,CAAC5zB,UAAU,WAAW+L,SAAS,cACtC,gBAAC,IAAW,CACV8C,SAAUjQ,KAAKC,MAAMsT,mBACrB5Q,KAAM,oBAAU,2BAChB0C,QAASrF,KAAKg0B,4BACdvlB,KAAMzO,KAAKC,MAAM2T,eACjBvJ,OAAQrK,KAAKC,MAAM0T,WAAWvL,IAAI2P,GAChC,YAAyB/X,KAAKR,MAAMkU,UAAWqE,MAGlD/X,KAAKC,MAAM2T,gBACV,gCACG5T,KAAKi1B,uBACLj1B,KAAKk1B,yBAIZ,gBAAC,IAAQ,CAAC9zB,UAAU,WAAW+L,SAAS,aACtC,gBAAC,IAAW,CACV8C,SAAUjQ,KAAKC,MAAMuT,kBACrB7Q,KAAM,oBAAU,0BAChB0C,QAASrF,KAAKi0B,2BACdxlB,KAAMzO,KAAKC,MAAM8T,cACjB1J,OAAQrK,KAAKC,MAAM6T,UAAU1L,IAAI2P,GAC/B,YAAwB/X,KAAKR,MAAMkU,UAAWqE,MAGjD/X,KAAKC,MAAM8T,eACV,gCACG/T,KAAKm1B,sBACLn1B,KAAKo1B,wBAIZ,gBAAC,IAAc,CACbh0B,UAAU,WACV4O,YAAa,oBAAU,oBACvBC,SAAUjQ,KAAKC,MAAMqT,YACrBpD,iBAAkB6H,GAAQ,YAAkB/X,KAAKR,MAAMkU,UAAWqE,GAClE5H,mBAAoB4H,GAAQA,EAC5B3H,oBAAqB2H,GAAQ,YAAkB/X,KAAKR,MAAMkU,UAAWqE,GACrEoW,sBAAuBnuB,KAAKw0B,yBAC5BnuB,SAAUrG,KAAKC,MAAMoG,SACrB3G,SAAUM,KAAKu0B,gBACflnB,SAAUrN,KAAKC,MAAMoN,SACrBoB,KAAMzO,KAAKC,MAAMmT,QACjBjG,SAAS,MACTxN,MAAO,IAAKK,KAAKC,MAAMN,MAAO,OAC9B2Q,gBAAiByH,GAAQ,YAAkB/X,KAAKR,MAAMkU,UAAWqE,GACjElI,mBAAoB,CAACkI,EAAMpY,IACzB,wBAAc,YAAkBK,KAAKR,MAAMkU,UAAWqE,GAAOpY,GAE/D4Q,kBAAmB,oBAAU,yBAC7B/C,MAAOxN,KAAKC,MAAMoT,SAClBhJ,OAAQrK,KAAKC,MAAMkT,OAM3B,SACE,OACE,gBAAC,IAAQ,CAAChG,SAAUnN,KAAKmN,UACvB,gBAAC,IAAW,CACVxK,KAAM,oBAAU,eAAgB3C,KAAKmN,UACrCqB,QAASxO,KAAKsN,YACdjI,QAASrF,KAAKoN,kBACdqB,KAAMzO,KAAKC,MAAMwO,KACjBpE,OAAQrK,KAAK+O,cAGd/O,KAAKC,MAAMwO,MAAQzO,KAAKq1B,sB,oBCjYjC,IAAI1M,EAAM,EAAQ,KACFtH,EAAU,EAAQ,KAIC,iBAFvBA,EAAUA,EAAQuH,WAAavH,EAAQsB,QAAUtB,KAG/CA,EAAU,CAAC,CAACgG,EAAOhB,EAAIhF,EAAS,MAG9C,IAAI7X,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAIhBqf,GAFSF,EAAItH,EAAS7X,GAEX6X,EAAQyH,OAASzH,EAAQyH,OAAS,IAIjDzB,EAAOC,QAAUuB,G,qBClBjBvB,EADkC,EAAQ,IAChC0F,EAA4B,IAE9BnhB,KAAK,CAACwb,EAAOhB,EAAI,2PAA4P,KAErRgB,EAAOC,QAAUA,G,iCCNjB,+DA8Be,SAAS7S,GAAY,UAAErT,EAAF,QAAasT,EAAb,MAAsBjL,EAAtB,MAA6BqC,IAC/D,OACE,uBAAK1K,UAAW,EAAW,uBAAwBA,IACjD,0BAAQA,UAAU,4BACHkC,IAAZoR,GAAyB,wBAAcA,EAAU,EAAG,OAAS,MAC9D,wBAAMtT,UAAU,yBAAyB,wBAAc0K,EAAO,SAE/DrC,K,iCCrCP,sEA4Be,SAASyM,EAAWjW,GACjC,OACE,wBAAMmB,UAAWnB,EAAMmB,WACrB,gBAAC,IAAa,CAACA,UAAU,sBAAsBzB,MAAOM,EAAMkB,OAC3D,oBAAU,aAAclB,EAAMkB,S,iCChCrC,OAAe","file":"js/294.m.a520f795.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { difference, uniq, without } from 'lodash';\nimport * as React from 'react';\nimport { getRuleTags } from '../../../api/rules';\nimport TagsSelector from '../../../components/tags/TagsSelector';\n\nexport interface Props {\n  organization: string | undefined;\n  setTags: (tags: string[]) => void;\n  sysTags: string[];\n  tags: string[];\n}\n\ninterface State {\n  searchResult: string[];\n}\n\nconst LIST_SIZE = 10;\n\nexport default class RuleDetailsTagsPopup extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { searchResult: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  onSearch = (query: string) => {\n    return getRuleTags({\n      q: query,\n      ps: Math.min(this.props.tags.length + LIST_SIZE, 100),\n      organization: this.props.organization\n    }).then(\n      tags => {\n        if (this.mounted) {\n          // systems tags can not be unset, don't display them in the results\n          this.setState({ searchResult: without(tags, ...this.props.sysTags) });\n        }\n      },\n      () => {}\n    );\n  };\n\n  onSelect = (tag: string) => {\n    this.props.setTags(uniq([...this.props.tags, tag]));\n  };\n\n  onUnselect = (tag: string) => {\n    this.props.setTags(without(this.props.tags, tag));\n  };\n\n  render() {\n    const availableTags = difference(this.state.searchResult, this.props.tags);\n    return (\n      <TagsSelector\n        listSize={LIST_SIZE}\n        onSearch={this.onSearch}\n        onSelect={this.onSelect}\n        onUnselect={this.onUnselect}\n        selectedTags={this.props.tags}\n        tags={availableTags}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { ButtonLink } from 'sonar-ui-common/components/controls/buttons';\nimport Dropdown from 'sonar-ui-common/components/controls/Dropdown';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport IssueTypeIcon from 'sonar-ui-common/components/icons/IssueTypeIcon';\nimport LinkIcon from 'sonar-ui-common/components/icons/LinkIcon';\nimport RuleScopeIcon from 'sonar-ui-common/components/icons/RuleScopeIcon';\nimport DateFormatter from 'sonar-ui-common/components/intl/DateFormatter';\nimport { PopupPlacement } from 'sonar-ui-common/components/ui/popups';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport DocTooltip from '../../../components/docs/DocTooltip';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport TagsList from '../../../components/tags/TagsList';\nimport { getRuleUrl } from '../../../helpers/urls';\nimport { Query } from '../query';\nimport RuleDetailsTagsPopup from './RuleDetailsTagsPopup';\nimport SimilarRulesFilter from './SimilarRulesFilter';\n\ninterface Props {\n  canWrite: boolean | undefined;\n  hideSimilarRulesFilter?: boolean;\n  onFilterChange: (changes: Partial<Query>) => void;\n  onTagsChange: (tags: string[]) => void;\n  organization: string | undefined;\n  referencedRepositories: T.Dict<{ key: string; language: string; name: string }>;\n  ruleDetails: T.RuleDetails;\n}\n\nconst EXTERNAL_RULE_REPO_PREFIX = 'external_';\n\nexport default class RuleDetailsMeta extends React.PureComponent<Props> {\n  renderType = () => {\n    const { ruleDetails } = this.props;\n    return (\n      <Tooltip overlay={translate('coding_rules.type.tooltip', ruleDetails.type)}>\n        <li className=\"coding-rules-detail-property\" data-meta=\"type\">\n          <IssueTypeIcon className=\"little-spacer-right\" query={ruleDetails.type} />\n          {translate('issue.type', ruleDetails.type)}\n        </li>\n      </Tooltip>\n    );\n  };\n\n  renderSeverity = () => (\n    <Tooltip overlay={translate('default_severity')}>\n      <li className=\"coding-rules-detail-property\" data-meta=\"severity\">\n        <SeverityHelper\n          className=\"display-inline-flex-center\"\n          severity={this.props.ruleDetails.severity}\n        />\n      </li>\n    </Tooltip>\n  );\n\n  renderStatus = () => {\n    const { ruleDetails } = this.props;\n    if (ruleDetails.status === 'READY') {\n      return null;\n    }\n    return (\n      <Tooltip overlay={translate('status')}>\n        <li className=\"coding-rules-detail-property\" data-meta=\"status\">\n          <span className=\"badge badge-error\">{translate('rules.status', ruleDetails.status)}</span>\n        </li>\n      </Tooltip>\n    );\n  };\n\n  renderTags = () => {\n    const { canWrite, ruleDetails } = this.props;\n    const { sysTags = [], tags = [] } = ruleDetails;\n    const allTags = [...sysTags, ...tags];\n\n    return (\n      <li className=\"coding-rules-detail-property\" data-meta=\"tags\">\n        {this.props.canWrite ? (\n          <Dropdown\n            closeOnClick={false}\n            closeOnClickOutside={true}\n            overlay={\n              <RuleDetailsTagsPopup\n                organization={this.props.organization}\n                setTags={this.props.onTagsChange}\n                sysTags={sysTags}\n                tags={tags}\n              />\n            }\n            overlayPlacement={PopupPlacement.BottomLeft}>\n            <ButtonLink>\n              <TagsList\n                allowUpdate={canWrite}\n                tags={allTags.length > 0 ? allTags : [translate('coding_rules.no_tags')]}\n              />\n            </ButtonLink>\n          </Dropdown>\n        ) : (\n          <TagsList\n            allowUpdate={canWrite}\n            className=\"display-flex-center\"\n            tags={allTags.length > 0 ? allTags : [translate('coding_rules.no_tags')]}\n          />\n        )}\n      </li>\n    );\n  };\n\n  renderCreationDate = () => (\n    <li className=\"coding-rules-detail-property\" data-meta=\"available-since\">\n      <span className=\"little-spacer-right\">{translate('coding_rules.available_since')}</span>\n      <DateFormatter date={this.props.ruleDetails.createdAt} />\n    </li>\n  );\n\n  renderRepository = () => {\n    const { referencedRepositories, ruleDetails } = this.props;\n    const repository = referencedRepositories[ruleDetails.repo];\n    if (!repository) {\n      return null;\n    }\n    return (\n      <Tooltip overlay={translate('coding_rules.repository_language')}>\n        <li className=\"coding-rules-detail-property\" data-meta=\"repository\">\n          {repository.name} ({ruleDetails.langName})\n        </li>\n      </Tooltip>\n    );\n  };\n\n  renderTemplate = () => {\n    if (!this.props.ruleDetails.isTemplate) {\n      return null;\n    }\n    return (\n      <Tooltip overlay={translate('coding_rules.rule_template.title')}>\n        <li className=\"coding-rules-detail-property\">{translate('coding_rules.rule_template')}</li>\n      </Tooltip>\n    );\n  };\n\n  renderParentTemplate = () => {\n    const { ruleDetails } = this.props;\n    if (!ruleDetails.templateKey) {\n      return null;\n    }\n    return (\n      <li className=\"coding-rules-detail-property\">\n        {translate('coding_rules.custom_rule')}\n        {' ('}\n        <Link to={getRuleUrl(ruleDetails.templateKey, this.props.organization)}>\n          {translate('coding_rules.show_template')}\n        </Link>\n        {')'}\n        <DocTooltip\n          className=\"little-spacer-left\"\n          doc={import(/* webpackMode: \"eager\" */ 'Docs/tooltips/rules/custom-rules.md')}\n        />\n      </li>\n    );\n  };\n\n  renderRemediation = () => {\n    const { ruleDetails } = this.props;\n    if (!ruleDetails.debtRemFnType) {\n      return null;\n    }\n    return (\n      <Tooltip overlay={translate('coding_rules.remediation_function')}>\n        <li className=\"coding-rules-detail-property\" data-meta=\"remediation-function\">\n          {translate('coding_rules.remediation_function', ruleDetails.debtRemFnType)}\n          {':'}\n          {ruleDetails.debtRemFnOffset !== undefined && ` ${ruleDetails.debtRemFnOffset}`}\n          {ruleDetails.debtRemFnCoeff !== undefined && ` +${ruleDetails.debtRemFnCoeff}`}\n          {ruleDetails.effortToFixDescription !== undefined &&\n            ` ${ruleDetails.effortToFixDescription}`}\n        </li>\n      </Tooltip>\n    );\n  };\n\n  renderScope = () => {\n    const scope = this.props.ruleDetails.scope || 'MAIN';\n    return (\n      <Tooltip overlay={translate('coding_rules.scope.title')}>\n        <li className=\"coding-rules-detail-property\">\n          <RuleScopeIcon className=\"little-spacer-right\" />\n          {translate('coding_rules.scope', scope)}\n        </li>\n      </Tooltip>\n    );\n  };\n\n  renderExternalBadge = () => {\n    const { ruleDetails } = this.props;\n    if (!ruleDetails.repo) {\n      return null;\n    }\n    const engine = ruleDetails.repo.replace(new RegExp(`^${EXTERNAL_RULE_REPO_PREFIX}`), '');\n    if (!engine) {\n      return null;\n    }\n    return (\n      <Tooltip overlay={translateWithParameters('coding_rules.external_rule.engine', engine)}>\n        <li className=\"coding-rules-detail-property\">\n          <div className=\"badge spacer-left text-text-top\">{engine}</div>\n        </li>\n      </Tooltip>\n    );\n  };\n\n  renderKey() {\n    const EXTERNAL_PREFIX = 'external_';\n    const { ruleDetails } = this.props;\n    const displayedKey = ruleDetails.key.startsWith(EXTERNAL_PREFIX)\n      ? ruleDetails.key.substr(EXTERNAL_PREFIX.length)\n      : ruleDetails.key;\n    return <span className=\"note text-middle\">{displayedKey}</span>;\n  }\n\n  render() {\n    const { ruleDetails } = this.props;\n    const hasTypeData = !ruleDetails.isExternal || ruleDetails.type !== 'UNKNOWN';\n    return (\n      <div className=\"js-rule-meta\">\n        <header className=\"page-header\">\n          <div className=\"pull-right\">\n            {this.renderKey()}\n            {!ruleDetails.isExternal && (\n              <Link\n                className=\"coding-rules-detail-permalink link-no-underline spacer-left text-middle\"\n                title={translate('permalink')}\n                to={getRuleUrl(ruleDetails.key, this.props.organization)}>\n                <LinkIcon />\n              </Link>\n            )}\n            {!this.props.hideSimilarRulesFilter && (\n              <SimilarRulesFilter onFilterChange={this.props.onFilterChange} rule={ruleDetails} />\n            )}\n          </div>\n          <h3 className=\"page-title coding-rules-detail-header\">\n            <big>{ruleDetails.name}</big>\n          </h3>\n        </header>\n\n        {hasTypeData && (\n          <ul className=\"coding-rules-detail-properties\">\n            {this.renderType()}\n            {this.renderSeverity()}\n            {!ruleDetails.isExternal && (\n              <>\n                {this.renderStatus()}\n                {this.renderScope()}\n              </>\n            )}\n            {this.renderTags()}\n            {!ruleDetails.isExternal && this.renderCreationDate()}\n            {this.renderRepository()}\n            {!ruleDetails.isExternal && (\n              <>\n                {this.renderTemplate()}\n                {this.renderParentTemplate()}\n                {this.renderRemediation()}\n              </>\n            )}\n            {ruleDetails.isExternal && this.renderExternalBadge()}\n          </ul>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  onCancel: () => void;\n  onSubmit: () => void;\n}\n\nexport default function RemoveExtendedDescriptionModal({ onCancel, onSubmit }: Props) {\n  const header = translate('coding_rules.remove_extended_description');\n  return (\n    <SimpleModal header={header} onClose={onCancel} onSubmit={onSubmit}>\n      {({ onCloseClick, onFormSubmit, submitting }) => (\n        <form onSubmit={onFormSubmit}>\n          <header className=\"modal-head\">\n            <h2>{header}</h2>\n          </header>\n\n          <div className=\"modal-body\">\n            {translate('coding_rules.remove_extended_description.confirm')}\n          </div>\n\n          <footer className=\"modal-foot\">\n            {submitting && <i className=\"spinner spacer-right\" />}\n            <SubmitButton className=\"button-red\" disabled={submitting}>\n              {translate('remove')}\n            </SubmitButton>\n            <ResetButtonLink onClick={onCloseClick}>{translate('cancel')}</ResetButtonLink>\n          </footer>\n        </form>\n      )}\n    </SimpleModal>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button, ResetButtonLink } from 'sonar-ui-common/components/controls/buttons';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { updateRule } from '../../../api/rules';\nimport MarkdownTips from '../../../components/common/MarkdownTips';\nimport RemoveExtendedDescriptionModal from './RemoveExtendedDescriptionModal';\n\ninterface Props {\n  canWrite: boolean | undefined;\n  onChange: (newRuleDetails: T.RuleDetails) => void;\n  organization: string | undefined;\n  ruleDetails: T.RuleDetails;\n}\n\ninterface State {\n  description: string;\n  descriptionForm: boolean;\n  removeDescriptionModal: boolean;\n  submitting: boolean;\n}\n\nexport default class RuleDetailsDescription extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {\n    description: '',\n    descriptionForm: false,\n    submitting: false,\n    removeDescriptionModal: false\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleDescriptionChange = (event: React.SyntheticEvent<HTMLTextAreaElement>) =>\n    this.setState({ description: event.currentTarget.value });\n\n  handleCancelClick = () => {\n    this.setState({ descriptionForm: false });\n  };\n\n  handleSaveClick = () => {\n    this.updateDescription(this.state.description);\n  };\n\n  handleRemoveDescriptionClick = () => {\n    this.setState({ removeDescriptionModal: true });\n  };\n\n  handleCancelRemoving = () => this.setState({ removeDescriptionModal: false });\n\n  handleConfirmRemoving = () => {\n    this.setState({ removeDescriptionModal: false });\n    this.updateDescription('');\n  };\n\n  updateDescription = (text: string) => {\n    this.setState({ submitting: true });\n\n    updateRule({\n      key: this.props.ruleDetails.key,\n      markdown_note: text,\n      organization: this.props.organization\n    }).then(\n      ruleDetails => {\n        this.props.onChange(ruleDetails);\n        if (this.mounted) {\n          this.setState({ submitting: false, descriptionForm: false });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ submitting: false });\n        }\n      }\n    );\n  };\n\n  handleExtendDescriptionClick = () => {\n    this.setState({\n      // set description` to the current `mdNote` each time the form is open\n      description: this.props.ruleDetails.mdNote || '',\n      descriptionForm: true\n    });\n  };\n\n  renderDescription = () => (\n    <div id=\"coding-rules-detail-description-extra\">\n      {this.props.ruleDetails.htmlNote !== undefined && (\n        <div\n          className=\"rule-desc spacer-bottom markdown\"\n          // Safe: defined by rule creator (instance admin?)\n          dangerouslySetInnerHTML={{ __html: this.props.ruleDetails.htmlNote }}\n        />\n      )}\n      {this.props.canWrite && (\n        <Button\n          id=\"coding-rules-detail-extend-description\"\n          onClick={this.handleExtendDescriptionClick}>\n          {translate('coding_rules.extend_description')}\n        </Button>\n      )}\n    </div>\n  );\n\n  renderForm = () => (\n    <div className=\"coding-rules-detail-extend-description-form\">\n      <table className=\"width-100\">\n        <tbody>\n          <tr>\n            <td colSpan={2}>\n              <textarea\n                autoFocus={true}\n                className=\"width-100 little-spacer-bottom\"\n                id=\"coding-rules-detail-extend-description-text\"\n                onChange={this.handleDescriptionChange}\n                rows={4}\n                value={this.state.description}\n              />\n            </td>\n          </tr>\n          <tr>\n            <td>\n              <Button\n                disabled={this.state.submitting}\n                id=\"coding-rules-detail-extend-description-submit\"\n                onClick={this.handleSaveClick}>\n                {translate('save')}\n              </Button>\n              {this.props.ruleDetails.mdNote !== undefined && (\n                <>\n                  <Button\n                    className=\"button-red spacer-left\"\n                    disabled={this.state.submitting}\n                    id=\"coding-rules-detail-extend-description-remove\"\n                    onClick={this.handleRemoveDescriptionClick}>\n                    {translate('remove')}\n                  </Button>\n                  {this.state.removeDescriptionModal && (\n                    <RemoveExtendedDescriptionModal\n                      onCancel={this.handleCancelRemoving}\n                      onSubmit={this.handleConfirmRemoving}\n                    />\n                  )}\n                </>\n              )}\n              <ResetButtonLink\n                className=\"spacer-left\"\n                disabled={this.state.submitting}\n                id=\"coding-rules-detail-extend-description-cancel\"\n                onClick={this.handleCancelClick}>\n                {translate('cancel')}\n              </ResetButtonLink>\n              {this.state.submitting && <i className=\"spinner spacer-left\" />}\n            </td>\n            <td className=\"text-right\">\n              <MarkdownTips />\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  );\n\n  render() {\n    const { ruleDetails } = this.props;\n    const hasDescription = !ruleDetails.isExternal || ruleDetails.type !== 'UNKNOWN';\n\n    return (\n      <div className=\"js-rule-description\">\n        {hasDescription ? (\n          <div\n            className=\"coding-rules-detail-description rule-desc markdown\"\n            // Safe: defined by rule creator (instance admin?)\n            dangerouslySetInnerHTML={{ __html: ruleDetails.htmlDesc || '' }}\n          />\n        ) : (\n          <div className=\"coding-rules-detail-description rule-desc markdown\">\n            {translateWithParameters('issue.external_issue_description', ruleDetails.name)}\n          </div>\n        )}\n\n        {!ruleDetails.templateKey && (\n          <div className=\"coding-rules-detail-description coding-rules-detail-description-extra\">\n            {!this.state.descriptionForm && this.renderDescription()}\n            {this.state.descriptionForm && this.props.canWrite && this.renderForm()}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport Modal from 'sonar-ui-common/components/controls/Modal';\nimport Select from 'sonar-ui-common/components/controls/Select';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { activateRule, Profile } from '../../../api/quality-profiles';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport { SEVERITIES } from '../../../helpers/constants';\nimport { sortProfiles } from '../../quality-profiles/utils';\n\ninterface Props {\n  activation?: T.RuleActivation;\n  modalHeader: string;\n  onClose: () => void;\n  onDone: (severity: string) => Promise<void>;\n  organization: string | undefined;\n  profiles: Profile[];\n  rule: T.Rule | T.RuleDetails;\n}\n\ninterface State {\n  params: T.Dict<string>;\n  profile: string;\n  severity: string;\n  submitting: boolean;\n}\n\nexport default class ActivationFormModal extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    const profilesWithDepth = this.getQualityProfilesWithDepth(props);\n    this.state = {\n      params: this.getParams(props),\n      profile: profilesWithDepth.length > 0 ? profilesWithDepth[0].key : '',\n      severity: props.activation ? props.activation.severity : props.rule.severity,\n      submitting: false\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  getParams = ({ activation, rule } = this.props) => {\n    const params: T.Dict<string> = {};\n    if (rule && rule.params) {\n      for (const param of rule.params) {\n        params[param.key] = param.defaultValue || '';\n      }\n      if (activation && activation.params) {\n        for (const param of activation.params) {\n          params[param.key] = param.value;\n        }\n      }\n    }\n    return params;\n  };\n\n  // Choose QP which a user can administrate, which are the same language and which are not built-in\n  getQualityProfilesWithDepth = ({ profiles } = this.props) => {\n    return sortProfiles(\n      profiles.filter(\n        profile =>\n          !profile.isBuiltIn &&\n          profile.actions &&\n          profile.actions.edit &&\n          profile.language === this.props.rule.lang\n      )\n    ).map(profile => ({\n      ...profile,\n      // Decrease depth by 1, so the top level starts at 0\n      depth: profile.depth - 1\n    }));\n  };\n\n  handleFormSubmit = (event: React.SyntheticEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    this.setState({ submitting: true });\n    const data = {\n      key: this.state.profile,\n      organization: this.props.organization,\n      params: this.state.params,\n      rule: this.props.rule.key,\n      severity: this.state.severity\n    };\n    activateRule(data)\n      .then(() => this.props.onDone(data.severity))\n      .then(\n        () => {\n          if (this.mounted) {\n            this.setState({ submitting: false });\n            this.props.onClose();\n          }\n        },\n        () => {\n          if (this.mounted) {\n            this.setState({ submitting: false });\n          }\n        }\n      );\n  };\n\n  handleParameterChange = (event: React.SyntheticEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = event.currentTarget;\n    this.setState((state: State) => ({ params: { ...state.params, [name]: value } }));\n  };\n\n  handleProfileChange = ({ value }: { value: string }) => {\n    this.setState({ profile: value });\n  };\n\n  handleSeverityChange = ({ value }: { value: string }) => {\n    this.setState({ severity: value });\n  };\n\n  renderSeverityOption = ({ value }: { value: string }) => {\n    return <SeverityHelper severity={value} />;\n  };\n\n  render() {\n    const { activation, rule } = this.props;\n    const { profile, severity, submitting } = this.state;\n    const { params = [] } = rule;\n    const profilesWithDepth = this.getQualityProfilesWithDepth();\n    const isCustomRule = !!(rule as T.RuleDetails).templateKey;\n    const activeInAllProfiles = profilesWithDepth.length <= 0;\n    const isUpdateMode = !!activation;\n\n    return (\n      <Modal contentLabel={this.props.modalHeader} onRequestClose={this.props.onClose} size=\"small\">\n        <form onSubmit={this.handleFormSubmit}>\n          <div className=\"modal-head\">\n            <h2>{this.props.modalHeader}</h2>\n          </div>\n\n          <div className={classNames('modal-body', { 'modal-container': params.length > 0 })}>\n            {!isUpdateMode && activeInAllProfiles && (\n              <Alert variant=\"info\">{translate('coding_rules.active_in_all_profiles')}</Alert>\n            )}\n\n            <div className=\"modal-field\">\n              <label>{translate('coding_rules.quality_profile')}</label>\n              <Select\n                className=\"js-profile\"\n                clearable={false}\n                disabled={submitting || profilesWithDepth.length === 1}\n                onChange={this.handleProfileChange}\n                options={profilesWithDepth.map(profile => ({\n                  label: '   '.repeat(profile.depth) + profile.name,\n                  value: profile.key\n                }))}\n                value={profile}\n              />\n            </div>\n            <div className=\"modal-field\">\n              <label>{translate('severity')}</label>\n              <Select\n                className=\"js-severity\"\n                clearable={false}\n                disabled={submitting}\n                onChange={this.handleSeverityChange}\n                optionRenderer={this.renderSeverityOption}\n                options={SEVERITIES.map(severity => ({\n                  label: translate('severity', severity),\n                  value: severity\n                }))}\n                searchable={false}\n                value={severity}\n                valueRenderer={this.renderSeverityOption}\n              />\n            </div>\n            {isCustomRule ? (\n              <div className=\"modal-field\">\n                <p className=\"note\">{translate('coding_rules.custom_rule.activation_notice')}</p>\n              </div>\n            ) : (\n              params.map(param => (\n                <div className=\"modal-field\" key={param.key}>\n                  <label title={param.key}>{param.key}</label>\n                  {param.type === 'TEXT' ? (\n                    <textarea\n                      disabled={submitting}\n                      name={param.key}\n                      onChange={this.handleParameterChange}\n                      placeholder={param.defaultValue}\n                      rows={3}\n                      value={this.state.params[param.key] || ''}\n                    />\n                  ) : (\n                    <input\n                      disabled={submitting}\n                      name={param.key}\n                      onChange={this.handleParameterChange}\n                      placeholder={param.defaultValue}\n                      type=\"text\"\n                      value={this.state.params[param.key] || ''}\n                    />\n                  )}\n                  <div\n                    className=\"note\"\n                    // Safe: defined by rule creator (instance admin?)\n                    dangerouslySetInnerHTML={{ __html: param.htmlDesc || '' }}\n                  />\n                </div>\n              ))\n            )}\n          </div>\n\n          <footer className=\"modal-foot\">\n            {submitting && <i className=\"spinner spacer-right\" />}\n            <SubmitButton disabled={submitting || activeInAllProfiles}>\n              {isUpdateMode ? translate('save') : translate('coding_rules.activate')}\n            </SubmitButton>\n            <ResetButtonLink disabled={submitting} onClick={this.props.onClose}>\n              {translate('cancel')}\n            </ResetButtonLink>\n          </footer>\n        </form>\n      </Modal>\n    );\n  }\n}\n","export default \"Quality Profiles are collections of Rules to apply during an analysis.\\n\\n---\\n\\nSee also: [Quality Profiles](/instance-administration/quality-profiles/)\\n\"","export default \"Rule Templates allow users to easily define their own rules. They are like cookie cutters from which you can stamp out new, \\\"custom rules\\\". The rules created from a template are listed on its rule detail page.\\n\"","export default \"Only custom rules may be deleted. When a custom rule is deleted, it is not removed from the SonarQube instance. Instead its status is set to \\\"REMOVED\\\", allowing relevant issues to continue to be displayed properly.\\n\"","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport Modal from 'sonar-ui-common/components/controls/Modal';\nimport Select from 'sonar-ui-common/components/controls/Select';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\nimport { bulkActivateRules, bulkDeactivateRules, Profile } from '../../../api/quality-profiles';\nimport { Query, serializeQuery } from '../query';\n\ninterface Props {\n  action: string;\n  languages: T.Languages;\n  onClose: () => void;\n  organization: string | undefined;\n  profile?: Profile;\n  query: Query;\n  referencedProfiles: T.Dict<Profile>;\n  total: number;\n}\n\ninterface ActivationResult {\n  failed: number;\n  profile: string;\n  succeeded: number;\n}\n\ninterface State {\n  finished: boolean;\n  results: ActivationResult[];\n  selectedProfiles: any[];\n  submitting: boolean;\n}\n\nexport default class BulkChangeModal extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n\n    // if there is only one possible option for profile, select it immediately\n    const selectedProfiles = [];\n    const availableProfiles = this.getAvailableQualityProfiles(props);\n    if (availableProfiles.length === 1) {\n      selectedProfiles.push(availableProfiles[0].key);\n    }\n\n    this.state = { finished: false, results: [], selectedProfiles, submitting: false };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleProfileSelect = (options: { value: string }[]) => {\n    const selectedProfiles = options.map(option => option.value);\n    this.setState({ selectedProfiles });\n  };\n\n  getAvailableQualityProfiles = ({ query, referencedProfiles } = this.props) => {\n    let profiles = Object.values(referencedProfiles);\n    if (query.languages.length > 0) {\n      profiles = profiles.filter(profile => query.languages.includes(profile.language));\n    }\n    return profiles\n      .filter(profile => profile.actions && profile.actions.edit)\n      .filter(profile => !profile.isBuiltIn);\n  };\n\n  processResponse = (profile: string, response: any) => {\n    if (this.mounted) {\n      const result: ActivationResult = {\n        failed: response.failed || 0,\n        profile,\n        succeeded: response.succeeded || 0\n      };\n      this.setState(state => ({ results: [...state.results, result] }));\n    }\n  };\n\n  sendRequests = () => {\n    let looper = Promise.resolve();\n\n    // serialize the query, but delete the `profile`\n    const data = serializeQuery(this.props.query);\n    delete data.profile;\n\n    const method = this.props.action === 'activate' ? bulkActivateRules : bulkDeactivateRules;\n\n    // if a profile is selected in the facet, pick it\n    // otherwise take all profiles selected in the dropdown\n    const profiles: string[] = this.props.profile\n      ? [this.props.profile.key]\n      : this.state.selectedProfiles;\n\n    for (const profile of profiles) {\n      looper = looper.then(() =>\n        method({\n          ...data,\n          organization: this.props.organization,\n          targetKey: profile\n        }).then(response => this.processResponse(profile, response))\n      );\n    }\n    return looper;\n  };\n\n  handleFormSubmit = (event: React.SyntheticEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    this.setState({ submitting: true });\n    this.sendRequests().then(\n      () => {\n        if (this.mounted) {\n          this.setState({ finished: true, submitting: false });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ submitting: false });\n        }\n      }\n    );\n  };\n\n  renderResult = (result: ActivationResult) => {\n    const { profile: profileKey } = result;\n    const profile = this.props.referencedProfiles[profileKey];\n    if (!profile) {\n      return null;\n    }\n    const { languages } = this.props;\n    const language = languages[profile.language]\n      ? languages[profile.language].name\n      : profile.language;\n    return (\n      <Alert key={result.profile} variant={result.failed === 0 ? 'success' : 'warning'}>\n        {result.failed\n          ? translateWithParameters(\n              'coding_rules.bulk_change.warning',\n              profile.name,\n              language,\n              result.succeeded,\n              result.failed\n            )\n          : translateWithParameters(\n              'coding_rules.bulk_change.success',\n              profile.name,\n              language,\n              result.succeeded\n            )}\n      </Alert>\n    );\n  };\n\n  renderProfileSelect = () => {\n    const profiles = this.getAvailableQualityProfiles();\n    const options = profiles.map(profile => ({\n      label: `${profile.name} - ${profile.languageName}`,\n      value: profile.key\n    }));\n    return (\n      <Select\n        multi={true}\n        onChange={this.handleProfileSelect}\n        options={options}\n        value={this.state.selectedProfiles}\n      />\n    );\n  };\n\n  render() {\n    const { action, profile, total } = this.props;\n    const header =\n      action === 'activate'\n        ? `${translate('coding_rules.activate_in_quality_profile')} (${formatMeasure(\n            total,\n            'INT'\n          )} ${translate('coding_rules._rules')})`\n        : `${translate('coding_rules.deactivate_in_quality_profile')} (${formatMeasure(\n            total,\n            'INT'\n          )} ${translate('coding_rules._rules')})`;\n\n    return (\n      <Modal contentLabel={header} onRequestClose={this.props.onClose} size=\"small\">\n        <form onSubmit={this.handleFormSubmit}>\n          <header className=\"modal-head\">\n            <h2>{header}</h2>\n          </header>\n\n          <div className=\"modal-body\">\n            {this.state.results.map(this.renderResult)}\n\n            {!this.state.finished && !this.state.submitting && (\n              <div className=\"modal-field\">\n                <h3>\n                  <label htmlFor=\"coding-rules-bulk-change-profile\">\n                    {action === 'activate'\n                      ? translate('coding_rules.activate_in')\n                      : translate('coding_rules.deactivate_in')}\n                  </label>\n                </h3>\n                {profile ? (\n                  <span>\n                    {profile.name}\n                    {' — '}\n                    {translate('are_you_sure')}\n                  </span>\n                ) : (\n                  this.renderProfileSelect()\n                )}\n              </div>\n            )}\n          </div>\n\n          <footer className=\"modal-foot\">\n            {this.state.submitting && <i className=\"spinner spacer-right\" />}\n            {!this.state.finished && (\n              <SubmitButton disabled={this.state.submitting} id=\"coding-rules-submit-bulk-change\">\n                {translate('apply')}\n              </SubmitButton>\n            )}\n            <ResetButtonLink onClick={this.props.onClose}>\n              {this.state.finished ? translate('close') : translate('cancel')}\n            </ResetButtonLink>\n          </footer>\n        </form>\n      </Modal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport Dropdown from 'sonar-ui-common/components/controls/Dropdown';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { Profile } from '../../../api/quality-profiles';\nimport { Query } from '../query';\nimport BulkChangeModal from './BulkChangeModal';\nimport { PopupPlacement } from 'sonar-ui-common/components/ui/popups';\n\ninterface Props {\n  languages: T.Languages;\n  organization: string | undefined;\n  query: Query;\n  referencedProfiles: T.Dict<Profile>;\n  total: number;\n}\n\ninterface State {\n  action?: string;\n  modal: boolean;\n  profile?: Profile;\n}\n\nexport default class BulkChange extends React.PureComponent<Props, State> {\n  state: State = { modal: false };\n\n  getSelectedProfile = () => {\n    const { profile } = this.props.query;\n    return (profile && this.props.referencedProfiles[profile]) || undefined;\n  };\n\n  closeModal = () => this.setState({ action: undefined, modal: false, profile: undefined });\n\n  handleActivateClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.setState({ action: 'activate', modal: true, profile: undefined });\n  };\n\n  handleActivateInProfileClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.setState({ action: 'activate', modal: true, profile: this.getSelectedProfile() });\n  };\n\n  handleDeactivateClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.setState({ action: 'deactivate', modal: true, profile: undefined });\n  };\n\n  handleDeactivateInProfileClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.setState({ action: 'deactivate', modal: true, profile: this.getSelectedProfile() });\n  };\n\n  render() {\n    // show \"Bulk Change\" button only if user has at least one QP which he administrates\n    const canBulkChange = Object.values(this.props.referencedProfiles).some(profile =>\n      Boolean(profile.actions && profile.actions.edit)\n    );\n    if (!canBulkChange) {\n      return (\n        <Tooltip overlay={translate('coding_rules.can_not_bulk_change')}>\n          <Button className=\"js-bulk-change\" disabled={true}>\n            {translate('bulk_change')}\n          </Button>\n        </Tooltip>\n      );\n    }\n\n    const { activation } = this.props.query;\n    const profile = this.getSelectedProfile();\n    const canChangeProfile = Boolean(\n      profile && !profile.isBuiltIn && profile.actions && profile.actions.edit\n    );\n    const allowActivateOnProfile = canChangeProfile && activation === false;\n    const allowDeactivateOnProfile = canChangeProfile && activation === true;\n\n    return (\n      <>\n        <Dropdown\n          className=\"pull-left\"\n          overlayPlacement={PopupPlacement.BottomLeft}\n          overlay={\n            <ul className=\"menu\">\n              <li>\n                <a href=\"#\" onClick={this.handleActivateClick}>\n                  {translate('coding_rules.activate_in')}…\n                </a>\n              </li>\n              {allowActivateOnProfile && profile && (\n                <li>\n                  <a href=\"#\" onClick={this.handleActivateInProfileClick}>\n                    {translate('coding_rules.activate_in')} <strong>{profile.name}</strong>\n                  </a>\n                </li>\n              )}\n              <li>\n                <a href=\"#\" onClick={this.handleDeactivateClick}>\n                  {translate('coding_rules.deactivate_in')}…\n                </a>\n              </li>\n              {allowDeactivateOnProfile && profile && (\n                <li>\n                  <a href=\"#\" onClick={this.handleDeactivateInProfileClick}>\n                    {translate('coding_rules.deactivate_in')} <strong>{profile.name}</strong>\n                  </a>\n                </li>\n              )}\n            </ul>\n          }>\n          <Button className=\"js-bulk-change\">{translate('bulk_change')}</Button>\n        </Dropdown>\n        {this.state.modal && this.state.action && (\n          <BulkChangeModal\n            action={this.state.action}\n            languages={this.props.languages}\n            onClose={this.closeModal}\n            organization={this.props.organization}\n            profile={this.state.profile}\n            query={this.props.query}\n            referencedProfiles={this.props.referencedProfiles}\n            total={this.props.total}\n          />\n        )}\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport { orderBy, sortBy, without } from 'lodash';\nimport * as React from 'react';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport FacetItem from '../../../components/facet/FacetItem';\nimport FacetItemsList from '../../../components/facet/FacetItemsList';\nimport { FacetKey } from '../query';\n\nexport interface BasicProps {\n  onChange: (changes: T.Dict<string | string[] | undefined>) => void;\n  onToggle: (facet: FacetKey) => void;\n  open: boolean;\n  stats?: T.Dict<number>;\n  values: string[];\n}\n\ninterface Props extends BasicProps {\n  children?: React.ReactNode;\n  disabled?: boolean;\n  disabledHelper?: string;\n  halfWidth?: boolean;\n  options?: string[];\n  property: FacetKey;\n  renderFooter?: () => React.ReactNode;\n  renderName?: (value: string) => React.ReactNode;\n  renderTextName?: (value: string) => string;\n  singleSelection?: boolean;\n}\n\nexport default class Facet extends React.PureComponent<Props> {\n  handleItemClick = (itemValue: string, multiple: boolean) => {\n    const { values } = this.props;\n    let newValue;\n    if (this.props.singleSelection) {\n      const value = values.length ? values[0] : undefined;\n      newValue = itemValue === value ? undefined : itemValue;\n    } else if (multiple) {\n      newValue = orderBy(\n        values.includes(itemValue) ? without(values, itemValue) : [...values, itemValue]\n      );\n    } else {\n      newValue = values.includes(itemValue) && values.length < 2 ? [] : [itemValue];\n    }\n    this.props.onChange({ [this.props.property]: newValue });\n  };\n\n  handleHeaderClick = () => this.props.onToggle(this.props.property);\n\n  handleClear = () => this.props.onChange({ [this.props.property]: [] });\n\n  getStat = (value: string) => this.props.stats && this.props.stats[value];\n\n  renderItem = (value: string) => {\n    const active = this.props.values.includes(value);\n    const stat = this.getStat(value);\n    const { renderName = defaultRenderName, renderTextName = defaultRenderName } = this.props;\n\n    return (\n      <FacetItem\n        active={active}\n        disabled={stat === 0 && !active}\n        halfWidth={this.props.halfWidth}\n        key={value}\n        name={renderName(value)}\n        onClick={this.handleItemClick}\n        stat={stat && formatMeasure(stat, 'SHORT_INT')}\n        tooltip={renderTextName(value)}\n        value={value}\n      />\n    );\n  };\n\n  render() {\n    const { disabled, renderTextName = defaultRenderName, stats } = this.props;\n    const values = this.props.values.map(renderTextName);\n    const items =\n      this.props.options ||\n      (stats &&\n        sortBy(\n          Object.keys(stats),\n          key => -stats[key],\n          key => renderTextName(key).toLowerCase()\n        ));\n\n    return (\n      <FacetBox\n        className={classNames({ 'search-navigator-facet-box-forbidden': disabled })}\n        property={this.props.property}>\n        <FacetHeader\n          name={\n            <Tooltip overlay={disabled ? this.props.disabledHelper : undefined}>\n              <span>{translate('coding_rules.facet', this.props.property)}</span>\n            </Tooltip>\n          }\n          onClear={this.handleClear}\n          onClick={disabled ? undefined : this.handleHeaderClick}\n          open={this.props.open && !disabled}\n          values={values}>\n          {this.props.children}\n        </FacetHeader>\n\n        {this.props.open && items !== undefined && (\n          <FacetItemsList>{items.map(this.renderItem)}</FacetItemsList>\n        )}\n\n        {this.props.open && this.props.renderFooter !== undefined && this.props.renderFooter()}\n      </FacetBox>\n    );\n  }\n}\n\nfunction defaultRenderName(value: string) {\n  return value;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport { SEVERITIES } from '../../../helpers/constants';\nimport Facet, { BasicProps } from './Facet';\n\ninterface Props extends BasicProps {\n  disabled: boolean;\n}\n\nexport default class ActivationSeverityFacet extends React.PureComponent<Props> {\n  renderName = (severity: string) => <SeverityHelper severity={severity} />;\n\n  renderTextName = (severity: string) => translate('severity', severity);\n\n  render() {\n    return (\n      <Facet\n        {...this.props}\n        disabled={this.props.disabled}\n        disabledHelper={translate('coding_rules.filters.active_severity.inactive')}\n        halfWidth={true}\n        options={SEVERITIES}\n        property=\"activationSeverities\"\n        renderName={this.renderName}\n        renderTextName={this.renderTextName}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { InjectedIntlProps, injectIntl } from 'react-intl';\nimport { longFormatterOption } from 'sonar-ui-common/components/intl/DateFormatter';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport DateInput from '../../../components/controls/DateInput';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport { Query } from '../query';\n\ninterface Props {\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: keyof Query) => void;\n  open: boolean;\n  value?: Date;\n}\n\nclass AvailableSinceFacet extends React.PureComponent<Props & InjectedIntlProps> {\n  handleHeaderClick = () => {\n    this.props.onToggle('availableSince');\n  };\n\n  handleClear = () => {\n    this.props.onChange({ availableSince: undefined });\n  };\n\n  handlePeriodChange = (date: Date | undefined) => {\n    this.props.onChange({ availableSince: date });\n  };\n\n  getValues = () =>\n    this.props.value\n      ? [this.props.intl.formatDate(this.props.value, longFormatterOption)]\n      : undefined;\n\n  render() {\n    return (\n      <FacetBox property=\"availableSince\">\n        <FacetHeader\n          name={translate('coding_rules.facet.available_since')}\n          onClear={this.handleClear}\n          onClick={this.handleHeaderClick}\n          open={this.props.open}\n          values={this.getValues()}\n        />\n\n        {this.props.open && (\n          <DateInput\n            name=\"available-since\"\n            onChange={this.handlePeriodChange}\n            placeholder={translate('date')}\n            value={this.props.value}\n          />\n        )}\n      </FacetBox>\n    );\n  }\n}\n\nexport default injectIntl(AvailableSinceFacet);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport { SEVERITIES } from '../../../helpers/constants';\nimport Facet, { BasicProps } from './Facet';\n\nexport default class DefaultSeverityFacet extends React.PureComponent<BasicProps> {\n  renderName = (severity: string) => <SeverityHelper severity={severity} />;\n\n  renderTextName = (severity: string) => translate('severity', severity);\n\n  render() {\n    return (\n      <Facet\n        {...this.props}\n        halfWidth={true}\n        options={SEVERITIES}\n        property=\"severities\"\n        renderName={this.renderName}\n        renderTextName={this.renderTextName}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport Facet, { BasicProps } from './Facet';\n\ninterface Props extends T.Omit<BasicProps, 'values'> {\n  disabled: boolean;\n  value: T.RuleInheritance | undefined;\n}\n\nexport default class InheritanceFacet extends React.PureComponent<Props> {\n  renderName = (value: T.RuleInheritance) =>\n    translate('coding_rules.filters.inheritance', value.toLowerCase());\n\n  render() {\n    const { value, ...props } = this.props;\n\n    return (\n      <Facet\n        {...props}\n        disabled={this.props.disabled}\n        disabledHelper={translate('coding_rules.filters.inheritance.inactive')}\n        options={['NONE', 'INHERITED', 'OVERRIDES']}\n        property=\"inheritance\"\n        renderName={this.renderName}\n        renderTextName={this.renderName}\n        singleSelection={true}\n        values={value ? [value] : []}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { uniqBy } from 'lodash';\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport { getLanguages, Store } from '../../../store/rootReducer';\nimport { BasicProps } from './Facet';\n\ninterface InstalledLanguage {\n  key: string;\n  name: string;\n}\n\ninterface Props extends BasicProps {\n  disabled?: boolean;\n  installedLanguages: InstalledLanguage[];\n}\n\nclass LanguageFacet extends React.PureComponent<Props> {\n  getLanguageName = (languageKey: string) => {\n    const language = this.props.installedLanguages.find(l => l.key === languageKey);\n    return language ? language.name : languageKey;\n  };\n\n  handleSearch = (query: string) => {\n    const options = this.getAllPossibleOptions();\n    const results = options.filter(language =>\n      language.name.toLowerCase().includes(query.toLowerCase())\n    );\n    const paging = { pageIndex: 1, pageSize: results.length, total: results.length };\n    return Promise.resolve({ paging, results });\n  };\n\n  getAllPossibleOptions = () => {\n    const { installedLanguages, stats = {} } = this.props;\n\n    // add any language that presents in the facet, but might not be installed\n    // for such language we don't know their display name, so let's just use their key\n    // and make sure we reference each language only once\n    return uniqBy(\n      [...installedLanguages, ...Object.keys(stats).map(key => ({ key, name: key }))],\n      language => language.key\n    );\n  };\n\n  renderSearchResult = ({ name }: InstalledLanguage, term: string) => {\n    return highlightTerm(name, term);\n  };\n\n  render() {\n    return (\n      <ListStyleFacet<InstalledLanguage>\n        disabled={this.props.disabled}\n        disabledHelper={translate('coding_rules.filters.language.inactive')}\n        facetHeader={translate('coding_rules.facet.languages')}\n        fetching={false}\n        getFacetItemText={this.getLanguageName}\n        getSearchResultKey={language => language.key}\n        getSearchResultText={language => language.name}\n        minSearchLength={1}\n        onChange={this.props.onChange}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"languages\"\n        renderFacetItem={this.getLanguageName}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_languages')}\n        stats={this.props.stats}\n        values={this.props.values}\n      />\n    );\n  }\n}\n\nconst mapStateToProps = (state: Store) => ({\n  installedLanguages: Object.values(getLanguages(state))\n});\n\nexport default connect(mapStateToProps)(LanguageFacet);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport { sortBy } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { Profile } from '../../../api/quality-profiles';\nimport DocTooltip from '../../../components/docs/DocTooltip';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport FacetItem from '../../../components/facet/FacetItem';\nimport FacetItemsList from '../../../components/facet/FacetItemsList';\nimport { FacetKey, Query } from '../query';\n\ninterface Props {\n  activation: boolean | undefined;\n  compareToProfile: string | undefined;\n  languages: string[];\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (facet: FacetKey) => void;\n  open: boolean;\n  referencedProfiles: T.Dict<Profile>;\n  value: string | undefined;\n}\n\nexport default class ProfileFacet extends React.PureComponent<Props> {\n  handleItemClick = (selected: string) => {\n    const newValue = this.props.value === selected ? '' : selected;\n    this.props.onChange({\n      activation: this.props.activation === undefined ? true : this.props.activation,\n      compareToProfile: undefined,\n      profile: newValue\n    });\n  };\n\n  handleHeaderClick = () => this.props.onToggle('profile');\n\n  handleClear = () =>\n    this.props.onChange({\n      activation: undefined,\n      activationSeverities: [],\n      compareToProfile: undefined,\n      inheritance: undefined,\n      profile: undefined\n    });\n\n  handleActiveClick = (event: React.SyntheticEvent<HTMLElement>) => {\n    this.stopPropagation(event);\n    this.props.onChange({ activation: true, compareToProfile: undefined });\n  };\n\n  handleInactiveClick = (event: React.SyntheticEvent<HTMLElement>) => {\n    this.stopPropagation(event);\n    this.props.onChange({ activation: false, compareToProfile: undefined });\n  };\n\n  stopPropagation = (event: React.SyntheticEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n  };\n\n  getTextValue = () => {\n    const { referencedProfiles, value } = this.props;\n    if (value) {\n      const profile = referencedProfiles[value];\n      const name = (profile && `${profile.name} ${profile.languageName}`) || value;\n      return [name];\n    } else {\n      return [];\n    }\n  };\n\n  getTooltip = (profile: Profile) => {\n    const base = `${profile.name} ${profile.languageName}`;\n    return profile.isBuiltIn ? `${base} (${translate('quality_profiles.built_in')})` : base;\n  };\n\n  renderName = (profile: Profile) => (\n    <>\n      {profile.name}\n      <span className=\"note little-spacer-left\">\n        {profile.languageName}\n        {profile.isBuiltIn && ` (${translate('quality_profiles.built_in')})`}\n      </span>\n    </>\n  );\n\n  renderActivation = (profile: Profile) => {\n    const isCompare = profile.key === this.props.compareToProfile;\n    const activation = isCompare ? true : this.props.activation;\n    return (\n      <>\n        <span\n          aria-checked={activation}\n          className={classNames('js-active', 'facet-toggle', 'facet-toggle-green', {\n            'facet-toggle-active': activation\n          })}\n          onClick={isCompare ? this.stopPropagation : this.handleActiveClick}\n          role=\"radio\"\n          tabIndex={-1}>\n          active\n        </span>\n        <span\n          aria-checked={!activation}\n          className={classNames('js-inactive', 'facet-toggle', 'facet-toggle-red', {\n            'facet-toggle-active': !activation\n          })}\n          onClick={isCompare ? this.stopPropagation : this.handleInactiveClick}\n          role=\"radio\"\n          tabIndex={-1}>\n          inactive\n        </span>\n      </>\n    );\n  };\n\n  renderItem = (profile: Profile) => {\n    const active = [this.props.value, this.props.compareToProfile].includes(profile.key);\n\n    return (\n      <FacetItem\n        active={active}\n        className={this.props.compareToProfile === profile.key ? 'compare' : undefined}\n        key={profile.key}\n        name={this.renderName(profile)}\n        onClick={this.handleItemClick}\n        stat={this.renderActivation(profile)}\n        tooltip={this.getTooltip(profile)}\n        value={profile.key}\n      />\n    );\n  };\n\n  render() {\n    const { languages, referencedProfiles } = this.props;\n    let profiles = Object.values(referencedProfiles);\n    if (languages.length > 0) {\n      profiles = profiles.filter(profile => languages.includes(profile.language));\n    }\n    profiles = sortBy(\n      profiles,\n      profile => profile.name.toLowerCase(),\n      profile => profile.languageName\n    );\n\n    return (\n      <FacetBox property=\"profile\">\n        <FacetHeader\n          name={translate('coding_rules.facet.qprofile')}\n          onClear={this.handleClear}\n          onClick={this.handleHeaderClick}\n          open={this.props.open}\n          values={this.getTextValue()}>\n          <DocTooltip\n            className=\"spacer-left\"\n            doc={import(/* webpackMode: \"eager\" */ 'Docs/tooltips/rules/rules-quality-profiles.md')}\n          />\n        </FacetHeader>\n\n        {this.props.open && <FacetItemsList>{profiles.map(this.renderItem)}</FacetItemsList>}\n      </FacetBox>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { getLanguages, Store } from '../../../store/rootReducer';\nimport Facet, { BasicProps } from './Facet';\n\ninterface StateProps {\n  referencedLanguages: T.Dict<{ key: string; name: string }>;\n}\n\ninterface Props extends BasicProps, StateProps {\n  referencedRepositories: T.Dict<{ key: string; language: string; name: string }>;\n}\n\nclass RepositoryFacet extends React.PureComponent<Props> {\n  getLanguageName = (languageKey: string) => {\n    const { referencedLanguages } = this.props;\n    const language = referencedLanguages[languageKey];\n    return (language && language.name) || languageKey;\n  };\n\n  renderName = (repositoryKey: string) => {\n    const { referencedRepositories } = this.props;\n    const repository = referencedRepositories[repositoryKey];\n    return repository ? (\n      <>\n        {repository.name}\n        <span className=\"note little-spacer-left\">{this.getLanguageName(repository.language)}</span>\n      </>\n    ) : (\n      repositoryKey\n    );\n  };\n\n  renderTextName = (repositoryKey: string) => {\n    const { referencedRepositories } = this.props;\n    const repository = referencedRepositories[repositoryKey];\n    return (repository && repository.name) || repositoryKey;\n  };\n\n  render() {\n    const { referencedLanguages, referencedRepositories, ...facetProps } = this.props;\n    return (\n      <Facet\n        {...facetProps}\n        property=\"repositories\"\n        renderName={this.renderName}\n        renderTextName={this.renderTextName}\n      />\n    );\n  }\n}\n\nconst mapStateToProps = (state: Store): StateProps => ({\n  referencedLanguages: getLanguages(state)\n});\n\nexport default connect(mapStateToProps)(RepositoryFacet);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { RULE_STATUSES } from '../../../helpers/constants';\nimport Facet, { BasicProps } from './Facet';\n\nexport default class StatusFacet extends React.PureComponent<BasicProps> {\n  renderName = (status: string) => translate('rules.status', status.toLowerCase());\n\n  render() {\n    return (\n      <Facet\n        {...this.props}\n        options={RULE_STATUSES}\n        property=\"statuses\"\n        renderName={this.renderName}\n        renderTextName={this.renderName}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { uniq } from 'lodash';\nimport * as React from 'react';\nimport TagsIcon from 'sonar-ui-common/components/icons/TagsIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport { getRuleTags } from '../../../api/rules';\nimport { colors } from '../../../app/theme';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport { BasicProps } from './Facet';\n\ninterface Props extends BasicProps {\n  organization: string | undefined;\n}\n\nexport default class TagFacet extends React.PureComponent<Props> {\n  handleSearch = (query: string) => {\n    return getRuleTags({ organization: this.props.organization, ps: 50, q: query }).then(tags => ({\n      paging: { pageIndex: 1, pageSize: tags.length, total: tags.length },\n      results: tags\n    }));\n  };\n\n  handleSelect = (option: { value: string }) => {\n    this.props.onChange({ tags: uniq([...this.props.values, option.value]) });\n  };\n\n  getTagName = (tag: string) => {\n    return tag;\n  };\n\n  renderTag = (tag: string) => (\n    <>\n      <TagsIcon className=\"little-spacer-right\" fill={colors.gray60} />\n      {tag}\n    </>\n  );\n\n  renderSearchResult = (tag: string, term: string) => (\n    <>\n      <TagsIcon className=\"little-spacer-right\" fill={colors.gray60} />\n      {highlightTerm(tag, term)}\n    </>\n  );\n\n  render() {\n    return (\n      <ListStyleFacet<string>\n        facetHeader={translate('coding_rules.facet.tags')}\n        fetching={false}\n        getFacetItemText={this.getTagName}\n        getSearchResultKey={tag => tag}\n        getSearchResultText={tag => tag}\n        onChange={this.props.onChange}\n        onSearch={this.handleSearch}\n        onToggle={this.props.onToggle}\n        open={this.props.open}\n        property=\"tags\"\n        renderFacetItem={this.renderTag}\n        renderSearchResult={this.renderSearchResult}\n        searchPlaceholder={translate('search.search_for_tags')}\n        stats={this.props.stats}\n        values={this.props.values}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport DocTooltip from '../../../components/docs/DocTooltip';\nimport Facet, { BasicProps } from './Facet';\n\ninterface Props extends T.Omit<BasicProps, 'onChange' | 'values'> {\n  onChange: (changes: { template: boolean | undefined }) => void;\n  value: boolean | undefined;\n}\n\nexport default class TemplateFacet extends React.PureComponent<Props> {\n  handleChange = (changes: { template: string | any[] }) => {\n    const template =\n      // empty array is returned when a user cleared the facet\n      // otherwise `\"true\"`, `\"false\"` or `undefined` can be returned\n      Array.isArray(changes.template) || changes.template === undefined\n        ? undefined\n        : changes.template === 'true';\n    this.props.onChange({ ...changes, template });\n  };\n\n  renderName = (template: string) =>\n    template === 'true'\n      ? translate('coding_rules.filters.template.is_template')\n      : translate('coding_rules.filters.template.is_not_template');\n\n  render() {\n    const { onChange, value, ...props } = this.props;\n\n    return (\n      <Facet\n        {...props}\n        onChange={this.handleChange}\n        options={['true', 'false']}\n        property=\"template\"\n        renderName={this.renderName}\n        renderTextName={this.renderName}\n        singleSelection={true}\n        values={value !== undefined ? [String(value)] : []}>\n        <DocTooltip\n          className=\"spacer-left\"\n          doc={import(/* webpackMode: \"eager\" */ 'Docs/tooltips/rules/rule-templates.md')}\n        />\n      </Facet>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport IssueTypeIcon from 'sonar-ui-common/components/icons/IssueTypeIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport Facet, { BasicProps } from './Facet';\n\nexport default class TypeFacet extends React.PureComponent<BasicProps> {\n  renderName = (type: string) => (\n    <>\n      <IssueTypeIcon className=\"little-spacer-right\" query={type} />\n      {translate('issue.type', type)}\n    </>\n  );\n\n  renderTextName = (type: string) => translate('issue.type', type);\n\n  render() {\n    const options = ['BUG', 'VULNERABILITY', 'CODE_SMELL', 'SECURITY_HOTSPOT'];\n\n    return (\n      <Facet\n        {...this.props}\n        options={options}\n        property=\"types\"\n        renderName={this.renderName}\n        renderTextName={this.renderTextName}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Profile } from '../../../api/quality-profiles';\nimport StandardFacet from '../../issues/sidebar/StandardFacet';\nimport { Facets, OpenFacets, Query } from '../query';\nimport ActivationSeverityFacet from './ActivationSeverityFacet';\nimport AvailableSinceFacet from './AvailableSinceFacet';\nimport DefaultSeverityFacet from './DefaultSeverityFacet';\nimport InheritanceFacet from './InheritanceFacet';\nimport LanguageFacet from './LanguageFacet';\nimport ProfileFacet from './ProfileFacet';\nimport RepositoryFacet from './RepositoryFacet';\nimport StatusFacet from './StatusFacet';\nimport TagFacet from './TagFacet';\nimport TemplateFacet from './TemplateFacet';\nimport TypeFacet from './TypeFacet';\n\ninterface Props {\n  facets?: Facets;\n  hideProfileFacet?: boolean;\n  onFacetToggle: (facet: string) => void;\n  onFilterChange: (changes: Partial<Query>) => void;\n  openFacets: OpenFacets;\n  organization: string | undefined;\n  organizationsEnabled?: boolean;\n  query: Query;\n  referencedProfiles: T.Dict<Profile>;\n  referencedRepositories: T.Dict<{ key: string; language: string; name: string }>;\n  selectedProfile?: Profile;\n}\n\nexport default function FacetsList(props: Props) {\n  const languageDisabled = !props.hideProfileFacet && props.query.profile !== undefined;\n\n  const inheritanceDisabled =\n    props.query.compareToProfile !== undefined ||\n    props.selectedProfile === undefined ||\n    !props.selectedProfile.isInherited;\n\n  const activationSeverityDisabled =\n    props.query.compareToProfile !== undefined ||\n    props.selectedProfile === undefined ||\n    !props.query.activation;\n  return (\n    <>\n      <LanguageFacet\n        disabled={languageDisabled}\n        onChange={props.onFilterChange}\n        onToggle={props.onFacetToggle}\n        open={!!props.openFacets.languages}\n        stats={props.facets && props.facets.languages}\n        values={props.query.languages}\n      />\n      <TypeFacet\n        onChange={props.onFilterChange}\n        onToggle={props.onFacetToggle}\n        open={!!props.openFacets.types}\n        stats={props.facets && props.facets.types}\n        values={props.query.types}\n      />\n      <TagFacet\n        onChange={props.onFilterChange}\n        onToggle={props.onFacetToggle}\n        open={!!props.openFacets.tags}\n        organization={props.organization}\n        stats={props.facets && props.facets.tags}\n        values={props.query.tags}\n      />\n      <RepositoryFacet\n        onChange={props.onFilterChange}\n        onToggle={props.onFacetToggle}\n        open={!!props.openFacets.repositories}\n        referencedRepositories={props.referencedRepositories}\n        stats={props.facets && props.facets.repositories}\n        values={props.query.repositories}\n      />\n      <DefaultSeverityFacet\n        onChange={props.onFilterChange}\n        onToggle={props.onFacetToggle}\n        open={!!props.openFacets.severities}\n        stats={props.facets && props.facets.severities}\n        values={props.query.severities}\n      />\n      <StatusFacet\n        onChange={props.onFilterChange}\n        onToggle={props.onFacetToggle}\n        open={!!props.openFacets.statuses}\n        stats={props.facets && props.facets.statuses}\n        values={props.query.statuses}\n      />\n      <StandardFacet\n        cwe={props.query.cwe}\n        cweOpen={!!props.openFacets.cwe}\n        cweStats={props.facets && props.facets.cwe}\n        fetchingCwe={false}\n        fetchingOwaspTop10={false}\n        fetchingSansTop25={false}\n        fetchingSonarSourceSecurity={false}\n        onChange={props.onFilterChange}\n        onToggle={props.onFacetToggle}\n        open={!!props.openFacets.standards}\n        owaspTop10={props.query.owaspTop10}\n        owaspTop10Open={!!props.openFacets.owaspTop10}\n        owaspTop10Stats={props.facets && props.facets.owaspTop10}\n        query={props.query}\n        sansTop25={props.query.sansTop25}\n        sansTop25Open={!!props.openFacets.sansTop25}\n        sansTop25Stats={props.facets && props.facets.sansTop25}\n        sonarsourceSecurity={props.query.sonarsourceSecurity}\n        sonarsourceSecurityOpen={!!props.openFacets.sonarsourceSecurity}\n        sonarsourceSecurityStats={props.facets && props.facets.sonarsourceSecurity}\n      />\n      <AvailableSinceFacet\n        onChange={props.onFilterChange}\n        onToggle={props.onFacetToggle}\n        open={!!props.openFacets.availableSince}\n        value={props.query.availableSince}\n      />\n      {!props.organizationsEnabled && (\n        <TemplateFacet\n          onChange={props.onFilterChange}\n          onToggle={props.onFacetToggle}\n          open={!!props.openFacets.template}\n          value={props.query.template}\n        />\n      )}\n      {!props.hideProfileFacet && (\n        <>\n          <ProfileFacet\n            activation={props.query.activation}\n            compareToProfile={props.query.compareToProfile}\n            languages={props.query.languages}\n            onChange={props.onFilterChange}\n            onToggle={props.onFacetToggle}\n            open={!!props.openFacets.profile}\n            referencedProfiles={props.referencedProfiles}\n            value={props.query.profile}\n          />\n          <InheritanceFacet\n            disabled={inheritanceDisabled}\n            onChange={props.onFilterChange}\n            onToggle={props.onFacetToggle}\n            open={!!props.openFacets.inheritance}\n            value={props.query.inheritance}\n          />\n          <ActivationSeverityFacet\n            disabled={activationSeverityDisabled}\n            onChange={props.onFilterChange}\n            onToggle={props.onFacetToggle}\n            open={!!props.openFacets.activationSeverities}\n            stats={props.facets && props.facets.activationSeverities}\n            values={props.query.activationSeverities}\n          />\n        </>\n      )}\n    </>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ReloadButton from 'sonar-ui-common/components/controls/ReloadButton';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport PageCounter from '../../../components/common/PageCounter';\n\ninterface Props {\n  loading: boolean;\n  onReload: () => void;\n  paging?: T.Paging;\n  selectedIndex?: number;\n}\n\nexport default function PageActions(props: Props) {\n  return (\n    <div className=\"pull-right\">\n      <Shortcuts />\n\n      <DeferredSpinner loading={props.loading}>\n        <ReloadButton onClick={props.onReload} />\n      </DeferredSpinner>\n\n      {props.paging && (\n        <PageCounter\n          className=\"spacer-left\"\n          current={props.selectedIndex}\n          label={translate('coding_rules._rules')}\n          total={props.paging.total}\n        />\n      )}\n    </div>\n  );\n}\n\nfunction Shortcuts() {\n  return (\n    <span className=\"note big-spacer-right\">\n      <span className=\"big-spacer-right\">\n        <span className=\"shortcut-button little-spacer-right\">↑</span>\n        <span className=\"shortcut-button little-spacer-right\">↓</span>\n        {translate('coding_rules.to_select_rules')}\n      </span>\n\n      <span>\n        <span className=\"shortcut-button little-spacer-right\">←</span>\n        <span className=\"shortcut-button little-spacer-right\">→</span>\n        {translate('issues.to_navigate')}\n      </span>\n    </span>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport Modal from 'sonar-ui-common/components/controls/Modal';\nimport Select from 'sonar-ui-common/components/controls/Select';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { csvEscape } from 'sonar-ui-common/helpers/csv';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { latinize } from 'sonar-ui-common/helpers/strings';\nimport { createRule, updateRule } from '../../../api/rules';\nimport MarkdownTips from '../../../components/common/MarkdownTips';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport TypeHelper from '../../../components/shared/TypeHelper';\nimport { RULE_STATUSES, RULE_TYPES, SEVERITIES } from '../../../helpers/constants';\n\ninterface Props {\n  customRule?: T.RuleDetails;\n  onClose: () => void;\n  onDone: (newRuleDetails: T.RuleDetails) => void;\n  organization: string | undefined;\n  templateRule: T.RuleDetails;\n}\n\ninterface State {\n  description: string;\n  key: string;\n  keyModifiedByUser: boolean;\n  name: string;\n  params: T.Dict<string>;\n  reactivating: boolean;\n  severity: string;\n  status: string;\n  submitting: boolean;\n  type: string;\n}\n\nexport default class CustomRuleFormModal extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    const params: T.Dict<string> = {};\n    if (props.customRule && props.customRule.params) {\n      for (const param of props.customRule.params) {\n        params[param.key] = param.defaultValue || '';\n      }\n    }\n    this.state = {\n      description: (props.customRule && props.customRule.mdDesc) || '',\n      key: '',\n      keyModifiedByUser: false,\n      name: (props.customRule && props.customRule.name) || '',\n      params,\n      reactivating: false,\n      severity: (props.customRule && props.customRule.severity) || props.templateRule.severity,\n      status: (props.customRule && props.customRule.status) || props.templateRule.status,\n      submitting: false,\n      type: (props.customRule && props.customRule.type) || props.templateRule.type\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  prepareRequest = () => {\n    const { customRule, organization, templateRule } = this.props;\n    const params = Object.keys(this.state.params)\n      .map(key => `${key}=${csvEscape(this.state.params[key])}`)\n      .join(';');\n    const ruleData = {\n      markdown_description: this.state.description,\n      name: this.state.name,\n      organization,\n      params,\n      severity: this.state.severity,\n      status: this.state.status\n    };\n    return customRule\n      ? updateRule({ ...ruleData, key: customRule.key })\n      : createRule({\n          ...ruleData,\n          custom_key: this.state.key,\n          prevent_reactivation: !this.state.reactivating,\n          template_key: templateRule.key,\n          type: this.state.type\n        });\n  };\n\n  handleFormSubmit = (event: React.SyntheticEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    this.setState({ submitting: true });\n    this.prepareRequest().then(\n      newRuleDetails => {\n        if (this.mounted) {\n          this.setState({ submitting: false });\n          this.props.onDone(newRuleDetails);\n        }\n      },\n      (response: Response) => {\n        if (this.mounted) {\n          this.setState({ reactivating: response.status === 409, submitting: false });\n        }\n      }\n    );\n  };\n\n  handleNameChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n    const { value: name } = event.currentTarget;\n    this.setState(state => ({\n      name,\n      key: state.keyModifiedByUser ? state.key : latinize(name).replace(/[^A-Za-z0-9]/g, '_')\n    }));\n  };\n\n  handleKeyChange = (event: React.SyntheticEvent<HTMLInputElement>) =>\n    this.setState({ key: event.currentTarget.value, keyModifiedByUser: true });\n\n  handleDescriptionChange = (event: React.SyntheticEvent<HTMLTextAreaElement>) =>\n    this.setState({ description: event.currentTarget.value });\n\n  handleTypeChange = ({ value }: { value: string }) => this.setState({ type: value });\n\n  handleSeverityChange = ({ value }: { value: string }) => this.setState({ severity: value });\n\n  handleStatusChange = ({ value }: { value: string }) => this.setState({ status: value });\n\n  handleParameterChange = (event: React.SyntheticEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = event.currentTarget;\n    this.setState((state: State) => ({ params: { ...state.params, [name]: value } }));\n  };\n\n  renderNameField = () => (\n    <div className=\"modal-field\">\n      <label htmlFor=\"coding-rules-custom-rule-creation-name\">\n        {translate('name')} <em className=\"mandatory\">*</em>\n      </label>\n      <input\n        autoFocus={true}\n        disabled={this.state.submitting}\n        id=\"coding-rules-custom-rule-creation-name\"\n        onChange={this.handleNameChange}\n        required={true}\n        type=\"text\"\n        value={this.state.name}\n      />\n    </div>\n  );\n\n  renderKeyField = () => (\n    <div className=\"modal-field\">\n      <label htmlFor=\"coding-rules-custom-rule-creation-key\">\n        {translate('key')} {!this.props.customRule && <em className=\"mandatory\">*</em>}\n      </label>\n\n      {this.props.customRule ? (\n        <span className=\"coding-rules-detail-custom-rule-key\" title={this.props.customRule.key}>\n          {this.props.customRule.key}\n        </span>\n      ) : (\n        <input\n          disabled={this.state.submitting}\n          id=\"coding-rules-custom-rule-creation-key\"\n          onChange={this.handleKeyChange}\n          required={true}\n          type=\"text\"\n          value={this.state.key}\n        />\n      )}\n    </div>\n  );\n\n  renderDescriptionField = () => (\n    <div className=\"modal-field\">\n      <label htmlFor=\"coding-rules-custom-rule-creation-html-description\">\n        {translate('description')} <em className=\"mandatory\">*</em>\n      </label>\n      <textarea\n        disabled={this.state.submitting}\n        id=\"coding-rules-custom-rule-creation-html-description\"\n        onChange={this.handleDescriptionChange}\n        required={true}\n        rows={5}\n        value={this.state.description}\n      />\n      <MarkdownTips className=\"modal-field-descriptor text-right\" />\n    </div>\n  );\n\n  renderTypeOption = ({ value }: { value: T.RuleType }) => {\n    return <TypeHelper type={value} />;\n  };\n\n  renderTypeField = () => (\n    <div className=\"modal-field flex-1 spacer-right\">\n      <label htmlFor=\"coding-rules-custom-rule-type\">{translate('type')}</label>\n      <Select\n        clearable={false}\n        disabled={this.state.submitting}\n        id=\"coding-rules-custom-rule-type\"\n        onChange={this.handleTypeChange}\n        optionRenderer={this.renderTypeOption}\n        options={RULE_TYPES.map(type => ({\n          label: translate('issue.type', type),\n          value: type\n        }))}\n        searchable={false}\n        value={this.state.type}\n        valueRenderer={this.renderTypeOption}\n      />\n    </div>\n  );\n\n  renderSeverityOption = ({ value }: { value: string }) => <SeverityHelper severity={value} />;\n\n  renderSeverityField = () => (\n    <div className=\"modal-field flex-1 spacer-right\">\n      <label htmlFor=\"coding-rules-custom-rule-severity\">{translate('severity')}</label>\n      <Select\n        clearable={false}\n        disabled={this.state.submitting}\n        id=\"coding-rules-custom-rule-severity\"\n        onChange={this.handleSeverityChange}\n        optionRenderer={this.renderSeverityOption}\n        options={SEVERITIES.map(severity => ({\n          label: translate('severity', severity),\n          value: severity\n        }))}\n        searchable={false}\n        value={this.state.severity}\n        valueRenderer={this.renderSeverityOption}\n      />\n    </div>\n  );\n\n  renderStatusField = () => (\n    <div className=\"modal-field flex-1\">\n      <label htmlFor=\"coding-rules-custom-rule-status\">\n        {translate('coding_rules.filters.status')}\n      </label>\n      <Select\n        clearable={false}\n        disabled={this.state.submitting}\n        id=\"coding-rules-custom-rule-status\"\n        onChange={this.handleStatusChange}\n        options={RULE_STATUSES.map(status => ({\n          label: translate('rules.status', status),\n          value: status\n        }))}\n        searchable={false}\n        value={this.state.status}\n      />\n    </div>\n  );\n\n  renderParameterField = (param: T.RuleParameter) => (\n    <div className=\"modal-field\" key={param.key}>\n      <label className=\"capitalize\" htmlFor={param.key}>\n        {param.key}\n      </label>\n\n      {param.type === 'TEXT' ? (\n        <textarea\n          disabled={this.state.submitting}\n          id={param.key}\n          name={param.key}\n          onChange={this.handleParameterChange}\n          placeholder={param.defaultValue}\n          rows={3}\n          value={this.state.params[param.key] || ''}\n        />\n      ) : (\n        <input\n          disabled={this.state.submitting}\n          id={param.key}\n          name={param.key}\n          onChange={this.handleParameterChange}\n          placeholder={param.defaultValue}\n          type=\"text\"\n          value={this.state.params[param.key] || ''}\n        />\n      )}\n      <div\n        className=\"modal-field-description\"\n        // Safe: defined by rule creator (instance admin?)\n        dangerouslySetInnerHTML={{ __html: param.htmlDesc || '' }}\n      />\n    </div>\n  );\n\n  render() {\n    const { customRule, templateRule } = this.props;\n    const { reactivating, submitting } = this.state;\n    const { params = [] } = templateRule;\n    const header = customRule\n      ? translate('coding_rules.update_custom_rule')\n      : translate('coding_rules.create_custom_rule');\n    let submit = this.props.customRule ? translate('save') : translate('create');\n    if (this.state.reactivating) {\n      submit = translate('coding_rules.reactivate');\n    }\n    return (\n      <Modal contentLabel={header} onRequestClose={this.props.onClose}>\n        <form onSubmit={this.handleFormSubmit}>\n          <div className=\"modal-head\">\n            <h2>{header}</h2>\n          </div>\n\n          <div className=\"modal-body modal-container\">\n            {reactivating && (\n              <Alert variant=\"warning\">{translate('coding_rules.reactivate.help')}</Alert>\n            )}\n\n            {this.renderNameField()}\n            {this.renderKeyField()}\n            <div className=\"display-flex-space-between\">\n              {/* do not allow to change the type of existing rule */}\n              {!customRule && this.renderTypeField()}\n              {this.renderSeverityField()}\n              {this.renderStatusField()}\n            </div>\n            {this.renderDescriptionField()}\n            {params.map(this.renderParameterField)}\n          </div>\n\n          <div className=\"modal-foot\">\n            {submitting && <i className=\"spinner spacer-right\" />}\n            <SubmitButton disabled={this.state.submitting}>{submit}</SubmitButton>\n            <ResetButtonLink\n              disabled={submitting}\n              id=\"coding-rules-custom-rule-creation-cancel\"\n              onClick={this.props.onClose}>\n              {translate('cancel')}\n            </ResetButtonLink>\n          </div>\n        </form>\n      </Modal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport CustomRuleFormModal from './CustomRuleFormModal';\n\ninterface Props {\n  children: (props: { onClick: () => void }) => React.ReactNode;\n  customRule?: T.RuleDetails;\n  onDone: (newRuleDetails: T.RuleDetails) => void;\n  organization: string | undefined;\n  templateRule: T.RuleDetails;\n}\n\ninterface State {\n  modal: boolean;\n}\n\nexport default class CustomRuleButton extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { modal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleClick = () => {\n    this.setState({ modal: true });\n  };\n\n  handleModalClose = () => {\n    if (this.mounted) {\n      this.setState({ modal: false });\n    }\n  };\n\n  handleDone = (newRuleDetails: T.RuleDetails) => {\n    this.handleModalClose();\n    this.props.onDone(newRuleDetails);\n  };\n\n  render() {\n    return (\n      <>\n        {this.props.children({ onClick: this.handleClick })}\n        {this.state.modal && (\n          <CustomRuleFormModal\n            customRule={this.props.customRule}\n            onClose={this.handleModalClose}\n            onDone={this.handleDone}\n            organization={this.props.organization}\n            templateRule={this.props.templateRule}\n          />\n        )}\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { sortBy } from 'lodash';\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport ConfirmButton from 'sonar-ui-common/components/controls/ConfirmButton';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { deleteRule, searchRules } from '../../../api/rules';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport { getRuleUrl } from '../../../helpers/urls';\nimport CustomRuleButton from './CustomRuleButton';\n\ninterface Props {\n  canChange?: boolean;\n  organization: string | undefined;\n  ruleDetails: T.RuleDetails;\n}\n\ninterface State {\n  loading: boolean;\n  rules?: T.Rule[];\n}\n\nexport default class RuleDetailsCustomRules extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: false };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchRules();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.ruleDetails.key !== this.props.ruleDetails.key) {\n      this.fetchRules();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchRules = () => {\n    this.setState({ loading: true });\n    searchRules({\n      f: 'name,severity,params',\n      organization: this.props.organization,\n      template_key: this.props.ruleDetails.key\n    }).then(\n      ({ rules }) => {\n        if (this.mounted) {\n          this.setState({ rules, loading: false });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  handleRuleCreate = (newRuleDetails: T.RuleDetails) => {\n    if (this.mounted) {\n      this.setState(({ rules = [] }: State) => ({\n        rules: [...rules, newRuleDetails]\n      }));\n    }\n  };\n\n  handleRuleDelete = (ruleKey: string) => {\n    return deleteRule({ key: ruleKey, organization: this.props.organization }).then(() => {\n      if (this.mounted) {\n        this.setState(({ rules = [] }) => ({\n          rules: rules.filter(rule => rule.key !== ruleKey)\n        }));\n      }\n    });\n  };\n\n  renderRule = (rule: T.Rule) => (\n    <tr data-rule={rule.key} key={rule.key}>\n      <td className=\"coding-rules-detail-list-name\">\n        <Link to={getRuleUrl(rule.key, this.props.organization)}>{rule.name}</Link>\n      </td>\n\n      <td className=\"coding-rules-detail-list-severity\">\n        <SeverityHelper className=\"display-flex-center\" severity={rule.severity} />\n      </td>\n\n      <td className=\"coding-rules-detail-list-parameters\">\n        {rule.params &&\n          rule.params\n            .filter(param => param.defaultValue)\n            .map(param => (\n              <div className=\"coding-rules-detail-list-parameter\" key={param.key}>\n                <span className=\"key\">{param.key}</span>\n                <span className=\"sep\">:&nbsp;</span>\n                <span className=\"value\" title={param.defaultValue}>\n                  {param.defaultValue}\n                </span>\n              </div>\n            ))}\n      </td>\n\n      {this.props.canChange && (\n        <td className=\"coding-rules-detail-list-actions\">\n          <ConfirmButton\n            confirmButtonText={translate('delete')}\n            confirmData={rule.key}\n            isDestructive={true}\n            modalBody={translateWithParameters('coding_rules.delete.custom.confirm', rule.name)}\n            modalHeader={translate('coding_rules.delete_rule')}\n            onConfirm={this.handleRuleDelete}>\n            {({ onClick }) => (\n              <Button className=\"button-red js-delete-custom-rule\" onClick={onClick}>\n                {translate('delete')}\n              </Button>\n            )}\n          </ConfirmButton>\n        </td>\n      )}\n    </tr>\n  );\n\n  render() {\n    const { loading, rules = [] } = this.state;\n\n    return (\n      <div className=\"js-rule-custom-rules coding-rule-section\">\n        <div className=\"coding-rules-detail-custom-rules-section\">\n          <div className=\"coding-rule-section-separator\" />\n\n          <h3 className=\"coding-rules-detail-title\">{translate('coding_rules.custom_rules')}</h3>\n\n          {this.props.canChange && (\n            <CustomRuleButton\n              onDone={this.handleRuleCreate}\n              organization={this.props.organization}\n              templateRule={this.props.ruleDetails}>\n              {({ onClick }) => (\n                <Button className=\"js-create-custom-rule spacer-left\" onClick={onClick}>\n                  {translate('coding_rules.create')}\n                </Button>\n              )}\n            </CustomRuleButton>\n          )}\n\n          <DeferredSpinner className=\"spacer-left\" loading={loading}>\n            {rules.length > 0 && (\n              <table className=\"coding-rules-detail-list\" id=\"coding-rules-detail-custom-rules\">\n                <tbody>{sortBy(rules, rule => rule.name).map(this.renderRule)}</tbody>\n              </table>\n            )}\n          </DeferredSpinner>\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\nimport { getFacet } from '../../../api/issues';\nimport { withAppState } from '../../../components/hoc/withAppState';\nimport { getIssuesUrl } from '../../../helpers/urls';\n\ninterface Props {\n  appState: Pick<T.AppState, 'branchesEnabled'>;\n  organization: string | undefined;\n  ruleDetails: Pick<T.RuleDetails, 'key' | 'type'>;\n}\n\ninterface Project {\n  count: number;\n  key: string;\n  name: string;\n}\n\ninterface State {\n  loading: boolean;\n  projects?: Project[];\n  total?: number;\n}\n\nexport class RuleDetailsIssues extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: false };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchIssues();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.ruleDetails !== this.props.ruleDetails) {\n      this.fetchIssues();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchIssues = () => {\n    const {\n      ruleDetails: { key },\n      organization\n    } = this.props;\n\n    this.setState({ loading: true });\n    getFacet(\n      {\n        resolved: 'false',\n        rules: key,\n        organization\n      },\n      'projects'\n    ).then(\n      ({ facet, response }) => {\n        if (this.mounted) {\n          const { components = [], paging } = response;\n          const projects = [];\n          for (const item of facet) {\n            const project = components.find(component => component.key === item.val);\n            if (project) {\n              projects.push({ count: item.count, key: project.key, name: project.name });\n            }\n          }\n          this.setState({ projects, loading: false, total: paging.total });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  renderTotal = () => {\n    const {\n      ruleDetails: { key },\n      organization\n    } = this.props;\n\n    const { total } = this.state;\n    if (total === undefined) {\n      return null;\n    }\n    const path = getIssuesUrl({ resolved: 'false', rules: key }, organization);\n\n    const totalItem = (\n      <span className=\"little-spacer-left\">\n        {'('}\n        <Link to={path}>{total}</Link>\n        {')'}\n      </span>\n    );\n\n    if (!this.props.appState.branchesEnabled) {\n      return totalItem;\n    }\n\n    return (\n      <Tooltip overlay={translate('coding_rules.issues.only_main_branches')}>{totalItem}</Tooltip>\n    );\n  };\n\n  renderProject = (project: Project) => {\n    const {\n      ruleDetails: { key },\n      organization\n    } = this.props;\n\n    const path = getIssuesUrl(\n      { resolved: 'false', rules: key, projects: project.key },\n      organization\n    );\n    return (\n      <tr key={project.key}>\n        <td className=\"coding-rules-detail-list-name\">{project.name}</td>\n        <td className=\"coding-rules-detail-list-parameters\">\n          <Link to={path}>{formatMeasure(project.count, 'INT')}</Link>\n        </td>\n      </tr>\n    );\n  };\n\n  render() {\n    const { loading, projects = [] } = this.state;\n\n    return (\n      <div className=\"js-rule-issues coding-rule-section\">\n        <div className=\"coding-rule-section-separator\" />\n\n        <DeferredSpinner loading={loading}>\n          <h3 className=\"coding-rules-detail-title\">\n            {translate('coding_rules.issues')}\n            {this.renderTotal()}\n          </h3>\n\n          {projects.length > 0 && (\n            <table className=\"coding-rules-detail-list coding-rules-most-violated-projects\">\n              <tbody>\n                <tr>\n                  <td className=\"coding-rules-detail-list-name\" colSpan={2}>\n                    {translate('coding_rules.most_violating_projects')}\n                  </td>\n                </tr>\n                {projects.map(this.renderProject)}\n              </tbody>\n            </table>\n          )}\n        </DeferredSpinner>\n      </div>\n    );\n  }\n}\n\nexport default withAppState(RuleDetailsIssues);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  params: T.RuleParameter[];\n}\n\nexport default class RuleDetailsParameters extends React.PureComponent<Props> {\n  renderParameter = (param: T.RuleParameter) => (\n    <tr className=\"coding-rules-detail-parameter\" key={param.key}>\n      <td className=\"coding-rules-detail-parameter-name\">{param.key}</td>\n      <td className=\"coding-rules-detail-parameter-description\">\n        <p // Safe: defined by rule creator (instance admin?)\n          dangerouslySetInnerHTML={{ __html: param.htmlDesc || '' }}\n        />\n        {param.defaultValue !== undefined && (\n          <div className=\"note spacer-top\">\n            {translate('coding_rules.parameters.default_value')}\n            <br />\n            <span className=\"coding-rules-detail-parameter-value\">{param.defaultValue}</span>\n          </div>\n        )}\n      </td>\n    </tr>\n  );\n\n  render() {\n    return (\n      <div className=\"js-rule-parameters\">\n        <h3 className=\"coding-rules-detail-title\">{translate('coding_rules.parameters')}</h3>\n        <table className=\"coding-rules-detail-parameters\">\n          <tbody>{this.props.params.map(this.renderParameter)}</tbody>\n        </table>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport { Profile as BaseProfile } from '../../../api/quality-profiles';\nimport ActivationFormModal from './ActivationFormModal';\n\ninterface Props {\n  activation?: T.RuleActivation;\n  buttonText: string;\n  className?: string;\n  modalHeader: string;\n  onDone: (severity: string) => Promise<void>;\n  organization: string | undefined;\n  profiles: BaseProfile[];\n  rule: T.Rule | T.RuleDetails;\n}\n\ninterface State {\n  modal: boolean;\n}\n\nexport default class ActivationButton extends React.PureComponent<Props, State> {\n  state: State = { modal: false };\n\n  handleButtonClick = () => {\n    this.setState({ modal: true });\n  };\n\n  handleCloseModal = () => {\n    this.setState({ modal: false });\n  };\n\n  render() {\n    return (\n      <>\n        <Button\n          className={this.props.className}\n          id=\"coding-rules-quality-profile-activate\"\n          onClick={this.handleButtonClick}>\n          {this.props.buttonText}\n        </Button>\n\n        {this.state.modal && (\n          <ActivationFormModal\n            activation={this.props.activation}\n            modalHeader={this.props.modalHeader}\n            onClose={this.handleCloseModal}\n            onDone={this.props.onDone}\n            organization={this.props.organization}\n            profiles={this.props.profiles}\n            rule={this.props.rule}\n          />\n        )}\n      </>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { colors } from '../../../app/theme';\n\ninterface Props {\n  className?: string;\n  inheritance: T.RuleInheritance;\n}\n\nexport default function RuleInheritanceIcon({ className, inheritance, ...other }: Props) {\n  const fill = inheritance === 'OVERRIDES' ? colors.red : colors.baseFontColor;\n\n  return (\n    <svg\n      className={className}\n      height={16}\n      version=\"1.1\"\n      viewBox=\"0 0 16 16\"\n      width={16}\n      xmlSpace=\"preserve\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      {...other}>\n      <path\n        d=\"M6.25 12.5a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0zm0-9a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0zm5 1a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0zm.75 0a1.5 1.5 0 0 1-.75 1.297c-.023 2.82-2.023 3.445-3.352 3.867-1.242.39-1.648.578-1.648 1.336v.203A1.5 1.5 0 1 1 4 12.5a1.5 1.5 0 0 1 .75-1.297V4.797A1.5 1.5 0 1 1 7 3.5a1.5 1.5 0 0 1-.75 1.297V8.68c.398-.196.82-.328 1.203-.446 1.453-.46 2.281-.804 2.297-2.437A1.5 1.5 0 1 1 12 4.5z\"\n        style={{ fill, fillRule: 'nonzero' }}\n      />\n    </svg>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { filter } from 'lodash';\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport ConfirmButton from 'sonar-ui-common/components/controls/ConfirmButton';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { activateRule, deactivateRule, Profile } from '../../../api/quality-profiles';\nimport InstanceMessage from '../../../components/common/InstanceMessage';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport { getQualityProfileUrl } from '../../../helpers/urls';\nimport BuiltInQualityProfileBadge from '../../quality-profiles/components/BuiltInQualityProfileBadge';\nimport ActivationButton from './ActivationButton';\nimport RuleInheritanceIcon from './RuleInheritanceIcon';\n\ninterface Props {\n  activations: T.RuleActivation[] | undefined;\n  canWrite: boolean | undefined;\n  onActivate: () => Promise<void>;\n  onDeactivate: () => Promise<void>;\n  organization: string | undefined;\n  referencedProfiles: T.Dict<Profile>;\n  ruleDetails: T.RuleDetails;\n}\n\nexport default class RuleDetailsProfiles extends React.PureComponent<Props> {\n  handleActivate = () => this.props.onActivate();\n\n  handleDeactivate = (key?: string) => {\n    if (key) {\n      deactivateRule({\n        key,\n        organization: this.props.organization,\n        rule: this.props.ruleDetails.key\n      }).then(this.props.onDeactivate, () => {});\n    }\n  };\n\n  handleRevert = (key?: string) => {\n    if (key) {\n      activateRule({\n        key,\n        organization: this.props.organization,\n        rule: this.props.ruleDetails.key,\n        reset: true\n      }).then(this.props.onActivate, () => {});\n    }\n  };\n\n  renderInheritedProfile = (activation: T.RuleActivation, profile: Profile) => {\n    if (!profile.parentName) {\n      return null;\n    }\n    const profilePath = getQualityProfileUrl(\n      profile.parentName,\n      profile.language,\n      this.props.organization\n    );\n    return (\n      <div className=\"coding-rules-detail-quality-profile-inheritance\">\n        {(activation.inherit === 'OVERRIDES' || activation.inherit === 'INHERITED') && (\n          <>\n            <RuleInheritanceIcon className=\"text-middle\" inheritance={activation.inherit} />\n            <Link className=\"link-base-color little-spacer-left text-middle\" to={profilePath}>\n              {profile.parentName}\n            </Link>\n          </>\n        )}\n      </div>\n    );\n  };\n\n  renderSeverity = (activation: T.RuleActivation, parentActivation?: T.RuleActivation) => (\n    <td className=\"coding-rules-detail-quality-profile-severity\">\n      <Tooltip overlay={translate('coding_rules.activation_severity')}>\n        <span>\n          <SeverityHelper className=\"display-inline-flex-center\" severity={activation.severity} />\n        </span>\n      </Tooltip>\n      {parentActivation !== undefined && activation.severity !== parentActivation.severity && (\n        <div className=\"coding-rules-detail-quality-profile-inheritance\">\n          {translate('coding_rules.original')} {translate('severity', parentActivation.severity)}\n        </div>\n      )}\n    </td>\n  );\n\n  renderParameter = (\n    param: { key: string; value: string },\n    parentActivation?: T.RuleActivation\n  ) => {\n    const originalParam =\n      parentActivation && parentActivation.params.find(p => p.key === param.key);\n    const originalValue = originalParam && originalParam.value;\n\n    return (\n      <div className=\"coding-rules-detail-quality-profile-parameter\" key={param.key}>\n        <span className=\"key\">{param.key}</span>\n        <span className=\"sep\">: </span>\n        <span className=\"value\" title={param.value}>\n          {param.value}\n        </span>\n        {parentActivation && param.value !== originalValue && (\n          <div className=\"coding-rules-detail-quality-profile-inheritance\">\n            {translate('coding_rules.original')} <span className=\"value\">{originalValue}</span>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  renderParameters = (activation: T.RuleActivation, parentActivation?: T.RuleActivation) => (\n    <td className=\"coding-rules-detail-quality-profile-parameters\">\n      {activation.params.map(param => this.renderParameter(param, parentActivation))}\n    </td>\n  );\n\n  renderActions = (activation: T.RuleActivation, profile: Profile) => {\n    const canEdit = profile.actions && profile.actions.edit && !profile.isBuiltIn;\n    const { ruleDetails } = this.props;\n    const hasParent = activation.inherit !== 'NONE' && profile.parentKey;\n    return (\n      <td className=\"coding-rules-detail-quality-profile-actions\">\n        {canEdit && (\n          <>\n            {!ruleDetails.isTemplate && (\n              <ActivationButton\n                activation={activation}\n                buttonText={translate('change_verb')}\n                className=\"coding-rules-detail-quality-profile-change\"\n                modalHeader={translate('coding_rules.change_details')}\n                onDone={this.handleActivate}\n                organization={this.props.organization}\n                profiles={[profile]}\n                rule={ruleDetails}\n              />\n            )}\n            {hasParent ? (\n              activation.inherit === 'OVERRIDES' &&\n              profile.parentName && (\n                <ConfirmButton\n                  confirmButtonText={translate('yes')}\n                  confirmData={profile.key}\n                  modalBody={translateWithParameters(\n                    'coding_rules.revert_to_parent_definition.confirm',\n                    profile.parentName\n                  )}\n                  modalHeader={translate('coding_rules.revert_to_parent_definition')}\n                  onConfirm={this.handleRevert}>\n                  {({ onClick }) => (\n                    <Button\n                      className=\"coding-rules-detail-quality-profile-revert button-red spacer-left\"\n                      onClick={onClick}>\n                      {translate('coding_rules.revert_to_parent_definition')}\n                    </Button>\n                  )}\n                </ConfirmButton>\n              )\n            ) : (\n              <ConfirmButton\n                confirmButtonText={translate('yes')}\n                confirmData={profile.key}\n                modalBody={translate('coding_rules.deactivate.confirm')}\n                modalHeader={translate('coding_rules.deactivate')}\n                onConfirm={this.handleDeactivate}>\n                {({ onClick }) => (\n                  <Button\n                    className=\"coding-rules-detail-quality-profile-deactivate button-red spacer-left\"\n                    onClick={onClick}>\n                    {translate('coding_rules.deactivate')}\n                  </Button>\n                )}\n              </ConfirmButton>\n            )}\n          </>\n        )}\n      </td>\n    );\n  };\n\n  renderActivation = (activation: T.RuleActivation) => {\n    const { activations = [], ruleDetails } = this.props;\n    const profile = this.props.referencedProfiles[activation.qProfile];\n    if (!profile) {\n      return null;\n    }\n\n    const parentActivation = activations.find(x => x.qProfile === profile.parentKey);\n\n    return (\n      <tr data-profile={profile.key} key={profile.key}>\n        <td className=\"coding-rules-detail-quality-profile-name\">\n          <Link to={getQualityProfileUrl(profile.name, profile.language, this.props.organization)}>\n            {profile.name}\n          </Link>\n          {profile.isBuiltIn && <BuiltInQualityProfileBadge className=\"spacer-left\" />}\n          {this.renderInheritedProfile(activation, profile)}\n        </td>\n\n        {this.renderSeverity(activation, parentActivation)}\n        {!ruleDetails.templateKey && this.renderParameters(activation, parentActivation)}\n        {this.renderActions(activation, profile)}\n      </tr>\n    );\n  };\n\n  render() {\n    const { activations = [], referencedProfiles, ruleDetails } = this.props;\n    const canActivate = Object.values(referencedProfiles).some(profile =>\n      Boolean(profile.actions && profile.actions.edit && profile.language === ruleDetails.lang)\n    );\n\n    return (\n      <div className=\"js-rule-profiles coding-rule-section\">\n        <div className=\"coding-rules-detail-quality-profiles-section\">\n          <div className=\"coding-rule-section-separator\" />\n\n          <h3 className=\"coding-rules-detail-title\">\n            <InstanceMessage message={translate('coding_rules.quality_profiles')} />\n          </h3>\n\n          {canActivate && (\n            <ActivationButton\n              buttonText={translate('coding_rules.activate')}\n              className=\"coding-rules-quality-profile-activate spacer-left\"\n              modalHeader={translate('coding_rules.activate_in_quality_profile')}\n              onDone={this.handleActivate}\n              organization={this.props.organization}\n              profiles={filter(\n                this.props.referencedProfiles,\n                profile => !activations.find(activation => activation.qProfile === profile.key)\n              )}\n              rule={ruleDetails}\n            />\n          )}\n\n          {activations.length > 0 && (\n            <table\n              className=\"coding-rules-detail-quality-profiles width-100\"\n              id=\"coding-rules-detail-quality-profiles\">\n              <tbody>{activations.map(this.renderActivation)}</tbody>\n            </table>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport ConfirmButton from 'sonar-ui-common/components/controls/ConfirmButton';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { Profile } from '../../../api/quality-profiles';\nimport { deleteRule, getRuleDetails, updateRule } from '../../../api/rules';\nimport DocTooltip from '../../../components/docs/DocTooltip';\nimport { Activation, Query } from '../query';\nimport CustomRuleButton from './CustomRuleButton';\nimport RuleDetailsCustomRules from './RuleDetailsCustomRules';\nimport RuleDetailsDescription from './RuleDetailsDescription';\nimport RuleDetailsIssues from './RuleDetailsIssues';\nimport RuleDetailsMeta from './RuleDetailsMeta';\nimport RuleDetailsParameters from './RuleDetailsParameters';\nimport RuleDetailsProfiles from './RuleDetailsProfiles';\n\ninterface Props {\n  allowCustomRules?: boolean;\n  canWrite?: boolean;\n  hideQualityProfiles?: boolean;\n  onActivate: (profile: string, rule: string, activation: Activation) => void;\n  onDeactivate: (profile: string, rule: string) => void;\n  onDelete: (rule: string) => void;\n  onFilterChange: (changes: Partial<Query>) => void;\n  organization: string | undefined;\n  referencedProfiles: T.Dict<Profile>;\n  referencedRepositories: T.Dict<{ key: string; language: string; name: string }>;\n  ruleKey: string;\n  selectedProfile?: Profile;\n}\n\ninterface State {\n  actives?: T.RuleActivation[];\n  loading: boolean;\n  ruleDetails?: T.RuleDetails;\n}\n\nexport default class RuleDetails extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: true };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.setState({ loading: true });\n    this.fetchRuleDetails();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.ruleKey !== this.props.ruleKey) {\n      this.setState({ loading: true });\n      this.fetchRuleDetails();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchRuleDetails = () => {\n    return getRuleDetails({\n      actives: true,\n      key: this.props.ruleKey,\n      organization: this.props.organization\n    }).then(\n      ({ actives, rule }) => {\n        if (this.mounted) {\n          this.setState({ actives, loading: false, ruleDetails: rule });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  handleRuleChange = (ruleDetails: T.RuleDetails) => {\n    if (this.mounted) {\n      this.setState({ ruleDetails });\n    }\n  };\n\n  handleTagsChange = (tags: string[]) => {\n    // optimistic update\n    const oldTags = this.state.ruleDetails && this.state.ruleDetails.tags;\n    this.setState(state =>\n      state.ruleDetails ? { ruleDetails: { ...state.ruleDetails, tags } } : null\n    );\n    updateRule({\n      key: this.props.ruleKey,\n      organization: this.props.organization,\n      tags: tags.join()\n    }).catch(() => {\n      if (this.mounted) {\n        this.setState(state =>\n          state.ruleDetails ? { ruleDetails: { ...state.ruleDetails, tags: oldTags } } : null\n        );\n      }\n    });\n  };\n\n  handleActivate = () => {\n    return this.fetchRuleDetails().then(() => {\n      const { ruleKey, selectedProfile } = this.props;\n      if (selectedProfile && this.state.actives) {\n        const active = this.state.actives.find(active => active.qProfile === selectedProfile.key);\n        if (active) {\n          this.props.onActivate(selectedProfile.key, ruleKey, active);\n        }\n      }\n    });\n  };\n\n  handleDeactivate = () => {\n    return this.fetchRuleDetails().then(() => {\n      const { ruleKey, selectedProfile } = this.props;\n      if (\n        selectedProfile &&\n        this.state.actives &&\n        !this.state.actives.find(active => active.qProfile === selectedProfile.key)\n      ) {\n        this.props.onDeactivate(selectedProfile.key, ruleKey);\n      }\n    });\n  };\n\n  handleDelete = () => {\n    return deleteRule({ key: this.props.ruleKey, organization: this.props.organization }).then(() =>\n      this.props.onDelete(this.props.ruleKey)\n    );\n  };\n\n  render() {\n    const { ruleDetails } = this.state;\n\n    if (!ruleDetails) {\n      return <div className=\"coding-rule-details\" />;\n    }\n\n    const {\n      allowCustomRules,\n      canWrite,\n      hideQualityProfiles,\n      organization,\n      referencedProfiles\n    } = this.props;\n    const { params = [] } = ruleDetails;\n\n    const isCustom = !!ruleDetails.templateKey;\n    const isEditable = canWrite && !!this.props.allowCustomRules && isCustom;\n\n    return (\n      <div className=\"coding-rule-details\">\n        <DeferredSpinner loading={this.state.loading}>\n          <RuleDetailsMeta\n            canWrite={canWrite}\n            onFilterChange={this.props.onFilterChange}\n            onTagsChange={this.handleTagsChange}\n            organization={organization}\n            referencedRepositories={this.props.referencedRepositories}\n            ruleDetails={ruleDetails}\n          />\n\n          <RuleDetailsDescription\n            canWrite={canWrite}\n            onChange={this.handleRuleChange}\n            organization={organization}\n            ruleDetails={ruleDetails}\n          />\n\n          {params.length > 0 && <RuleDetailsParameters params={params} />}\n\n          {isEditable && (\n            <div className=\"coding-rules-detail-description display-flex-center\">\n              {/* `templateRule` is used to get rule meta data, `customRule` is used to get parameter values */}\n              {/* it's expected to pass the same rule to both parameters */}\n              <CustomRuleButton\n                customRule={ruleDetails}\n                onDone={this.handleRuleChange}\n                organization={organization}\n                templateRule={ruleDetails}>\n                {({ onClick }) => (\n                  <Button\n                    className=\"js-edit-custom\"\n                    id=\"coding-rules-detail-custom-rule-change\"\n                    onClick={onClick}>\n                    {translate('edit')}\n                  </Button>\n                )}\n              </CustomRuleButton>\n              <ConfirmButton\n                confirmButtonText={translate('delete')}\n                isDestructive={true}\n                modalBody={translateWithParameters(\n                  'coding_rules.delete.custom.confirm',\n                  ruleDetails.name\n                )}\n                modalHeader={translate('coding_rules.delete_rule')}\n                onConfirm={this.handleDelete}>\n                {({ onClick }) => (\n                  <>\n                    <Button\n                      className=\"button-red spacer-left js-delete\"\n                      id=\"coding-rules-detail-rule-delete\"\n                      onClick={onClick}>\n                      {translate('delete')}\n                    </Button>\n                    <DocTooltip\n                      className=\"spacer-left\"\n                      doc={import(\n                        /* webpackMode: \"eager\" */ 'Docs/tooltips/rules/custom-rule-removal.md'\n                      )}\n                    />\n                  </>\n                )}\n              </ConfirmButton>\n            </div>\n          )}\n\n          {ruleDetails.isTemplate && (\n            <RuleDetailsCustomRules\n              canChange={allowCustomRules && canWrite}\n              organization={organization}\n              ruleDetails={ruleDetails}\n            />\n          )}\n\n          {!ruleDetails.isTemplate && !hideQualityProfiles && (\n            <RuleDetailsProfiles\n              activations={this.state.actives}\n              canWrite={canWrite}\n              onActivate={this.handleActivate}\n              onDeactivate={this.handleDeactivate}\n              organization={organization}\n              referencedProfiles={referencedProfiles}\n              ruleDetails={ruleDetails}\n            />\n          )}\n\n          {!ruleDetails.isTemplate && ruleDetails.type !== 'SECURITY_HOTSPOT' && (\n            <RuleDetailsIssues organization={organization} ruleDetails={ruleDetails} />\n          )}\n        </DeferredSpinner>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport ConfirmButton from 'sonar-ui-common/components/controls/ConfirmButton';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport IssueTypeIcon from 'sonar-ui-common/components/icons/IssueTypeIcon';\nimport SeverityIcon from 'sonar-ui-common/components/icons/SeverityIcon';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { deactivateRule, Profile } from '../../../api/quality-profiles';\nimport TagsList from '../../../components/tags/TagsList';\nimport { getRuleUrl } from '../../../helpers/urls';\nimport { Activation, Query } from '../query';\nimport ActivationButton from './ActivationButton';\nimport RuleInheritanceIcon from './RuleInheritanceIcon';\nimport SimilarRulesFilter from './SimilarRulesFilter';\n\ninterface Props {\n  activation?: Activation;\n  canWrite?: boolean;\n  isLoggedIn: boolean;\n  onActivate: (profile: string, rule: string, activation: Activation) => void;\n  onDeactivate: (profile: string, rule: string) => void;\n  onFilterChange: (changes: Partial<Query>) => void;\n  onOpen: (ruleKey: string) => void;\n  organization: string | undefined;\n  rule: T.Rule;\n  selected: boolean;\n  selectedProfile?: Profile;\n}\n\nexport default class RuleListItem extends React.PureComponent<Props> {\n  handleDeactivate = () => {\n    if (this.props.selectedProfile) {\n      const data = {\n        key: this.props.selectedProfile.key,\n        organization: this.props.organization,\n        rule: this.props.rule.key\n      };\n      deactivateRule(data).then(\n        () => this.props.onDeactivate(data.key, data.rule),\n        () => {}\n      );\n    }\n  };\n\n  handleActivate = (severity: string) => {\n    if (this.props.selectedProfile) {\n      this.props.onActivate(this.props.selectedProfile.key, this.props.rule.key, {\n        severity,\n        inherit: 'NONE'\n      });\n    }\n    return Promise.resolve();\n  };\n\n  handleNameClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    // cmd(ctrl) + click should open a rule permalink in a new tab\n    const isLeftClickEvent = event.button === 0;\n    const isModifiedEvent = !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n    if (isModifiedEvent || !isLeftClickEvent) {\n      return;\n    }\n\n    event.preventDefault();\n    this.props.onOpen(this.props.rule.key);\n  };\n\n  renderActivation = () => {\n    const { activation, selectedProfile } = this.props;\n    if (!activation) {\n      return null;\n    }\n\n    return (\n      <td className=\"coding-rule-table-meta-cell coding-rule-activation\">\n        <SeverityIcon severity={activation.severity} />\n        {selectedProfile && selectedProfile.parentName && (\n          <>\n            {activation.inherit === 'OVERRIDES' && (\n              <Tooltip\n                overlay={translateWithParameters(\n                  'coding_rules.overrides',\n                  selectedProfile.name,\n                  selectedProfile.parentName\n                )}>\n                <RuleInheritanceIcon\n                  className=\"little-spacer-left\"\n                  inheritance={activation.inherit}\n                />\n              </Tooltip>\n            )}\n            {activation.inherit === 'INHERITED' && (\n              <Tooltip\n                overlay={translateWithParameters(\n                  'coding_rules.inherits',\n                  selectedProfile.name,\n                  selectedProfile.parentName\n                )}>\n                <RuleInheritanceIcon\n                  className=\"little-spacer-left\"\n                  inheritance={activation.inherit}\n                />\n              </Tooltip>\n            )}\n          </>\n        )}\n      </td>\n    );\n  };\n\n  renderActions = () => {\n    const { activation, isLoggedIn, rule, selectedProfile } = this.props;\n    if (!selectedProfile || !isLoggedIn) {\n      return null;\n    }\n\n    const canCopy = selectedProfile.actions && selectedProfile.actions.copy;\n    if (selectedProfile.isBuiltIn && canCopy) {\n      return (\n        <td className=\"coding-rule-table-meta-cell coding-rule-activation-actions\">\n          {this.renderDeactivateButton('', 'coding_rules.need_extend_or_copy')}\n        </td>\n      );\n    }\n\n    const canEdit = selectedProfile.actions && selectedProfile.actions.edit;\n    if (!canEdit) {\n      return null;\n    }\n\n    return (\n      <td className=\"coding-rule-table-meta-cell coding-rule-activation-actions\">\n        {activation\n          ? this.renderDeactivateButton(activation.inherit)\n          : !rule.isTemplate && (\n              <ActivationButton\n                buttonText={translate('coding_rules.activate')}\n                className=\"coding-rules-detail-quality-profile-activate\"\n                modalHeader={translate('coding_rules.activate_in_quality_profile')}\n                onDone={this.handleActivate}\n                organization={this.props.organization}\n                profiles={[selectedProfile]}\n                rule={rule}\n              />\n            )}\n      </td>\n    );\n  };\n\n  renderDeactivateButton = (\n    inherit: string,\n    overlayTranslationKey = 'coding_rules.can_not_deactivate'\n  ) => {\n    return inherit === 'NONE' ? (\n      <ConfirmButton\n        confirmButtonText={translate('yes')}\n        modalBody={translate('coding_rules.deactivate.confirm')}\n        modalHeader={translate('coding_rules.deactivate')}\n        onConfirm={this.handleDeactivate}>\n        {({ onClick }) => (\n          <Button\n            className=\"coding-rules-detail-quality-profile-deactivate button-red\"\n            onClick={onClick}>\n            {translate('coding_rules.deactivate')}\n          </Button>\n        )}\n      </ConfirmButton>\n    ) : (\n      <Tooltip overlay={translate(overlayTranslationKey)}>\n        <Button className=\"coding-rules-detail-quality-profile-deactivate button-red disabled\">\n          {translate('coding_rules.deactivate')}\n        </Button>\n      </Tooltip>\n    );\n  };\n\n  render() {\n    const { rule, selected } = this.props;\n    const allTags = [...(rule.tags || []), ...(rule.sysTags || [])];\n    return (\n      <div className={classNames('coding-rule', { selected })} data-rule={rule.key}>\n        <table className=\"coding-rule-table\">\n          <tbody>\n            <tr>\n              {this.renderActivation()}\n\n              <td>\n                <div className=\"coding-rule-title\">\n                  <Link\n                    className=\"link-no-underline\"\n                    onClick={this.handleNameClick}\n                    to={getRuleUrl(rule.key, this.props.organization)}>\n                    {rule.name}\n                  </Link>\n                  {rule.isTemplate && (\n                    <Tooltip overlay={translate('coding_rules.rule_template.title')}>\n                      <span className=\"badge spacer-left\">\n                        {translate('coding_rules.rule_template')}\n                      </span>\n                    </Tooltip>\n                  )}\n                </div>\n              </td>\n\n              <td className=\"coding-rule-table-meta-cell\">\n                <div className=\"display-flex-center coding-rule-meta\">\n                  {rule.status !== 'READY' && (\n                    <span className=\"spacer-left badge badge-error\">\n                      {translate('rules.status', rule.status)}\n                    </span>\n                  )}\n                  <span className=\"display-inline-flex-center spacer-left note\">\n                    {rule.langName}\n                  </span>\n                  <Tooltip overlay={translate('coding_rules.type.tooltip', rule.type)}>\n                    <span className=\"display-inline-flex-center spacer-left note\">\n                      <IssueTypeIcon query={rule.type} />\n                      <span className=\"little-spacer-left text-middle\">\n                        {translate('issue.type', rule.type)}\n                      </span>\n                    </span>\n                  </Tooltip>\n                  {allTags.length > 0 && (\n                    <TagsList\n                      allowUpdate={false}\n                      className=\"display-inline-flex-center note spacer-left\"\n                      tags={allTags}\n                    />\n                  )}\n                  <SimilarRulesFilter onFilterChange={this.props.onFilterChange} rule={rule} />\n                </div>\n              </td>\n\n              {this.renderActions()}\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as key from 'keymaster';\nimport { keyBy } from 'lodash';\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { connect } from 'react-redux';\nimport { withRouter, WithRouterProps } from 'react-router';\nimport ListFooter from 'sonar-ui-common/components/controls/ListFooter';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport BackIcon from 'sonar-ui-common/components/icons/BackIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport {\n  addSideBarClass,\n  addWhitePageClass,\n  removeSideBarClass,\n  removeWhitePageClass\n} from 'sonar-ui-common/helpers/pages';\nimport { scrollToElement } from 'sonar-ui-common/helpers/scrolling';\nimport { Profile, searchQualityProfiles } from '../../../api/quality-profiles';\nimport { getRulesApp, searchRules } from '../../../api/rules';\nimport A11ySkipTarget from '../../../app/components/a11y/A11ySkipTarget';\nimport Suggestions from '../../../app/components/embed-docs-modal/Suggestions';\nimport FiltersHeader from '../../../components/common/FiltersHeader';\nimport ScreenPositionHelper from '../../../components/common/ScreenPositionHelper';\nimport '../../../components/search-navigator.css';\nimport { hasPrivateAccess } from '../../../helpers/organizations';\nimport { isSonarCloud } from '../../../helpers/system';\nimport { isLoggedIn } from '../../../helpers/users';\nimport {\n  getAppState,\n  getCurrentUser,\n  getLanguages,\n  getMyOrganizations,\n  Store\n} from '../../../store/rootReducer';\nimport {\n  shouldOpenSonarSourceSecurityFacet,\n  shouldOpenStandardsChildFacet,\n  shouldOpenStandardsFacet,\n  STANDARDS\n} from '../../issues/utils';\nimport {\n  Activation,\n  Actives,\n  areQueriesEqual,\n  FacetKey,\n  Facets,\n  getAppFacet,\n  getOpen,\n  getServerFacet,\n  hasRuleKey,\n  OpenFacets,\n  parseQuery,\n  Query,\n  serializeQuery,\n  shouldRequestFacet\n} from '../query';\nimport '../styles.css';\nimport BulkChange from './BulkChange';\nimport FacetsList from './FacetsList';\nimport PageActions from './PageActions';\nimport RuleDetails from './RuleDetails';\nimport RuleListItem from './RuleListItem';\n\nconst PAGE_SIZE = 100;\nconst LIMIT_BEFORE_LOAD_MORE = 5;\n\ninterface StateToProps {\n  appState: T.AppState;\n  currentUser: T.CurrentUser;\n  languages: T.Languages;\n  userOrganizations: T.Organization[];\n}\n\ninterface OwnProps extends WithRouterProps {\n  organization: T.Organization | undefined;\n}\n\ntype Props = OwnProps & StateToProps;\n\ninterface State {\n  actives?: Actives;\n  canWrite?: boolean;\n  facets?: Facets;\n  loading: boolean;\n  openFacets: OpenFacets;\n  openRule?: T.Rule;\n  paging?: T.Paging;\n  query: Query;\n  referencedProfiles: T.Dict<Profile>;\n  referencedRepositories: T.Dict<{ key: string; language: string; name: string }>;\n  rules: T.Rule[];\n  selected?: string;\n  usingPermalink?: boolean;\n}\n\nexport class App extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    const query = parseQuery(props.location.query);\n    this.state = {\n      loading: true,\n      openFacets: {\n        languages: true,\n        owaspTop10: shouldOpenStandardsChildFacet({}, query, 'owaspTop10'),\n        sansTop25: shouldOpenStandardsChildFacet({}, query, 'sansTop25'),\n        sonarsourceSecurity: shouldOpenSonarSourceSecurityFacet({}, query),\n        standards: shouldOpenStandardsFacet({}, query),\n        types: true\n      },\n      query,\n      referencedProfiles: {},\n      referencedRepositories: {},\n      rules: []\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    addWhitePageClass();\n    addSideBarClass();\n    this.attachShortcuts();\n    this.fetchInitialData();\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    this.setState(({ rules, selected }) => {\n      const openRule = this.getOpenRule(nextProps, rules);\n      return {\n        openRule,\n        usingPermalink: hasRuleKey(nextProps.location.query),\n        query: parseQuery(nextProps.location.query),\n        selected: openRule ? openRule.key : selected\n      };\n    });\n  }\n\n  componentDidUpdate(prevProps: Props, prevState: State) {\n    if (!areQueriesEqual(prevProps.location.query, this.props.location.query)) {\n      this.fetchFirstRules();\n    }\n    if (\n      !this.state.openRule &&\n      (prevState.selected !== this.state.selected || prevState.openRule)\n    ) {\n      // if user simply selected another issue\n      // or if he went from the source code back to the list of issues\n      this.scrollToSelectedRule();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n    removeWhitePageClass();\n    removeSideBarClass();\n    this.detachShortcuts();\n  }\n\n  attachShortcuts = () => {\n    key.setScope('coding-rules');\n    key('up', 'coding-rules', () => {\n      this.selectPreviousRule();\n      return false;\n    });\n    key('down', 'coding-rules', () => {\n      this.selectNextRule();\n      return false;\n    });\n    key('right', 'coding-rules', () => {\n      this.openSelectedRule();\n      return false;\n    });\n    key('left', 'coding-rules', () => {\n      this.handleBack();\n      return false;\n    });\n  };\n\n  detachShortcuts = () => key.deleteScope('coding-rules');\n\n  getOpenRule = (props: Props, rules: T.Rule[]) => {\n    const open = getOpen(props.location.query);\n    return open && rules.find(rule => rule.key === open);\n  };\n\n  getFacetsToFetch = () => {\n    const { openFacets } = this.state;\n    return Object.keys(openFacets)\n      .filter((facet: FacetKey) => openFacets[facet])\n      .filter((facet: FacetKey) => shouldRequestFacet(facet))\n      .map((facet: FacetKey) => getServerFacet(facet));\n  };\n\n  getFieldsToFetch = () => {\n    const fields = [\n      'isTemplate',\n      'name',\n      'lang',\n      'langName',\n      'severity',\n      'status',\n      'sysTags',\n      'tags',\n      'templateKey'\n    ];\n    if (this.state.query.profile) {\n      fields.push('actives', 'params');\n    }\n    return fields;\n  };\n\n  getSearchParameters = () => ({\n    f: this.getFieldsToFetch().join(),\n    facets: this.getFacetsToFetch().join(),\n    organization: this.props.organization && this.props.organization.key,\n    ps: PAGE_SIZE,\n    s: 'name',\n    ...serializeQuery(this.state.query)\n  });\n\n  stopLoading = () => {\n    if (this.mounted) {\n      this.setState({ loading: false });\n    }\n  };\n\n  fetchInitialData = () => {\n    this.setState({ loading: true });\n    const organization = this.props.organization && this.props.organization.key;\n    Promise.all([getRulesApp({ organization }), this.fetchQualityProfiles()]).then(\n      ([{ canWrite, repositories }, { profiles }]) => {\n        this.setState({\n          canWrite,\n          referencedProfiles: keyBy(profiles, 'key'),\n          referencedRepositories: keyBy(repositories, 'key')\n        });\n        this.fetchFirstRules();\n      },\n      this.stopLoading\n    );\n  };\n\n  makeFetchRequest = (query?: T.RawQuery) =>\n    searchRules({ ...this.getSearchParameters(), ...query }).then(\n      ({ actives: rawActives, facets: rawFacets, p, ps, rules, total }) => {\n        const actives = rawActives && parseActives(rawActives);\n        const facets = rawFacets && parseFacets(rawFacets);\n        const paging = { pageIndex: p, pageSize: ps, total };\n        return { actives, facets, paging, rules };\n      }\n    );\n\n  fetchFirstRules = (query?: T.RawQuery) => {\n    this.setState({ loading: true });\n    this.makeFetchRequest(query).then(({ actives, facets, paging, rules }) => {\n      if (this.mounted) {\n        const openRule = this.getOpenRule(this.props, rules);\n        const usingPermalink = hasRuleKey(this.props.location.query);\n        const selected = rules.length > 0 ? (openRule && openRule.key) || rules[0].key : undefined;\n        this.setState({\n          actives,\n          facets,\n          loading: false,\n          openRule,\n          paging,\n          rules,\n          selected,\n          usingPermalink\n        });\n      }\n    }, this.stopLoading);\n  };\n\n  fetchMoreRules = () => {\n    const { paging } = this.state;\n    if (paging) {\n      this.setState({ loading: true });\n      const nextPage = paging.pageIndex + 1;\n      this.makeFetchRequest({ p: nextPage, facets: undefined }).then(\n        ({ actives, paging, rules }) => {\n          if (this.mounted) {\n            this.setState((state: State) => ({\n              actives: { ...state.actives, ...actives },\n              loading: false,\n              paging,\n              rules: [...state.rules, ...rules]\n            }));\n          }\n        },\n        this.stopLoading\n      );\n    }\n  };\n\n  fetchFacet = (facet: FacetKey) => {\n    this.makeFetchRequest({ ps: 1, facets: getServerFacet(facet) }).then(({ facets }) => {\n      if (this.mounted) {\n        this.setState(state => ({ facets: { ...state.facets, ...facets }, loading: false }));\n      }\n    }, this.stopLoading);\n  };\n\n  fetchQualityProfiles = () => {\n    const { currentUser, organization, userOrganizations } = this.props;\n    if (hasPrivateAccess(currentUser, organization, userOrganizations)) {\n      return searchQualityProfiles({ organization: organization && organization.key });\n    }\n    return { profiles: [] };\n  };\n\n  getSelectedIndex = ({ selected, rules } = this.state) => {\n    const index = rules.findIndex(rule => rule.key === selected);\n    return index !== -1 ? index : undefined;\n  };\n\n  selectNextRule = () => {\n    const { rules, loading, paging } = this.state;\n    const selectedIndex = this.getSelectedIndex();\n    if (selectedIndex !== undefined) {\n      if (\n        selectedIndex > rules.length - LIMIT_BEFORE_LOAD_MORE &&\n        !loading &&\n        paging &&\n        rules.length < paging.total\n      ) {\n        this.fetchMoreRules();\n      }\n      if (rules && selectedIndex < rules.length - 1) {\n        if (this.state.openRule) {\n          this.openRule(rules[selectedIndex + 1].key);\n        } else {\n          this.setState({ selected: rules[selectedIndex + 1].key });\n        }\n      }\n    }\n  };\n\n  selectPreviousRule = () => {\n    const { rules } = this.state;\n    const selectedIndex = this.getSelectedIndex();\n    if (rules && selectedIndex !== undefined && selectedIndex > 0) {\n      if (this.state.openRule) {\n        this.openRule(rules[selectedIndex - 1].key);\n      } else {\n        this.setState({ selected: rules[selectedIndex - 1].key });\n      }\n    }\n  };\n\n  getRulePath = (rule: string) => ({\n    pathname: this.props.location.pathname,\n    query: { ...serializeQuery(this.state.query), open: rule }\n  });\n\n  openRule = (rule: string) => {\n    const path = this.getRulePath(rule);\n    if (this.state.openRule) {\n      this.props.router.replace(path);\n    } else {\n      this.props.router.push(path);\n    }\n  };\n\n  openSelectedRule = () => {\n    const { selected } = this.state;\n    if (selected) {\n      this.openRule(selected);\n    }\n  };\n\n  closeRule = () => {\n    this.props.router.push({\n      pathname: this.props.location.pathname,\n      query: {\n        ...serializeQuery(this.state.query),\n        open: undefined\n      }\n    });\n    this.scrollToSelectedRule(false);\n  };\n\n  scrollToSelectedRule = (smooth = true) => {\n    const { selected } = this.state;\n    if (selected) {\n      const element = document.querySelector(`[data-rule=\"${selected}\"]`);\n      if (element) {\n        scrollToElement(element, { topOffset: 150, bottomOffset: 100, smooth });\n      }\n    }\n  };\n\n  getRuleActivation = (rule: string) => {\n    const { actives, query } = this.state;\n    if (actives && actives[rule] && query.profile) {\n      return actives[rule][query.profile];\n    } else {\n      return undefined;\n    }\n  };\n\n  getSelectedProfile = () => {\n    const { query, referencedProfiles } = this.state;\n    if (query.profile) {\n      return referencedProfiles[query.profile];\n    } else {\n      return undefined;\n    }\n  };\n\n  closeFacet = (facet: string) =>\n    this.setState(state => ({\n      openFacets: { ...state.openFacets, [facet]: false }\n    }));\n\n  handleRuleOpen = (ruleKey: string) => {\n    this.props.router.push(this.getRulePath(ruleKey));\n  };\n\n  handleBack = (event?: React.SyntheticEvent<HTMLAnchorElement>) => {\n    const { usingPermalink } = this.state;\n\n    if (event) {\n      event.preventDefault();\n      event.currentTarget.blur();\n    }\n\n    if (usingPermalink) {\n      this.handleReset();\n    } else {\n      this.closeRule();\n    }\n  };\n\n  handleFilterChange = (changes: Partial<Query>) => {\n    this.props.router.push({\n      pathname: this.props.location.pathname,\n      query: serializeQuery({ ...this.state.query, ...changes })\n    });\n\n    this.setState(({ openFacets }) => ({\n      openFacets: {\n        ...openFacets,\n        sonarsourceSecurity: shouldOpenSonarSourceSecurityFacet(openFacets, changes),\n        standards: shouldOpenStandardsFacet(openFacets, changes)\n      }\n    }));\n  };\n\n  handleFacetToggle = (property: string) => {\n    this.setState(state => {\n      const willOpenProperty = !state.openFacets[property];\n      const newState = {\n        loading: state.loading,\n        openFacets: { ...state.openFacets, [property]: willOpenProperty }\n      };\n\n      // Try to open sonarsource security \"subfacet\" by default if the standard facet is open\n      if (willOpenProperty && property === STANDARDS) {\n        newState.openFacets.sonarsourceSecurity = shouldOpenSonarSourceSecurityFacet(\n          newState.openFacets,\n          state.query\n        );\n        // Force loading of sonarsource security facet data\n        property = newState.openFacets.sonarsourceSecurity ? 'sonarsourceSecurity' : property;\n      }\n\n      if (shouldRequestFacet(property) && (!state.facets || !state.facets[property])) {\n        newState.loading = true;\n        this.fetchFacet(property);\n      }\n\n      return newState;\n    });\n  };\n\n  handleReload = () => this.fetchFirstRules();\n\n  handleReset = () => this.props.router.push({ pathname: this.props.location.pathname });\n\n  /** Tries to take rule by index, or takes the last one  */\n  pickRuleAround = (rules: T.Rule[], selectedIndex: number | undefined) => {\n    if (selectedIndex === undefined || rules.length === 0) {\n      return undefined;\n    }\n    if (selectedIndex >= 0 && selectedIndex < rules.length) {\n      return rules[selectedIndex].key;\n    }\n    return rules[rules.length - 1].key;\n  };\n\n  handleRuleDelete = (ruleKey: string) => {\n    if (this.state.query.ruleKey === ruleKey) {\n      this.handleReset();\n    } else {\n      this.setState(state => {\n        const rules = state.rules.filter(rule => rule.key !== ruleKey);\n        const selectedIndex = this.getSelectedIndex(state);\n        const selected = this.pickRuleAround(rules, selectedIndex);\n        return { rules, selected };\n      });\n      this.closeRule();\n    }\n  };\n\n  handleRuleActivate = (profile: string, rule: string, activation: Activation) =>\n    this.setState((state: State) => {\n      const { actives = {} } = state;\n      if (!actives[rule]) {\n        return { actives: { ...actives, [rule]: { [profile]: activation } } };\n      }\n\n      return { actives: { ...actives, [rule]: { ...actives[rule], [profile]: activation } } };\n    });\n\n  handleRuleDeactivate = (profile: string, rule: string) =>\n    this.setState(state => {\n      const { actives } = state;\n      if (actives && actives[rule]) {\n        const newRule = { ...actives[rule] };\n        delete newRule[profile];\n        return { actives: { ...actives, [rule]: newRule } };\n      }\n      return null;\n    });\n\n  handleSearch = (searchQuery: string) => this.handleFilterChange({ searchQuery });\n\n  isFiltered = () => Object.keys(serializeQuery(this.state.query)).length > 0;\n\n  renderBulkButton = () => {\n    const { currentUser, languages } = this.props;\n    const { canWrite, paging, query, referencedProfiles } = this.state;\n    const organization = this.props.organization && this.props.organization.key;\n\n    if (!isLoggedIn(currentUser) || (isSonarCloud() && !organization) || !canWrite) {\n      return null;\n    }\n\n    return (\n      paging && (\n        <BulkChange\n          languages={languages}\n          organization={organization}\n          query={query}\n          referencedProfiles={referencedProfiles}\n          total={paging.total}\n        />\n      )\n    );\n  };\n\n  render() {\n    const { paging, rules } = this.state;\n    const selectedIndex = this.getSelectedIndex();\n    const organization = this.props.organization && this.props.organization.key;\n    const hideQualityProfiles = !hasPrivateAccess(\n      this.props.currentUser,\n      this.props.organization,\n      this.props.userOrganizations\n    );\n\n    return (\n      <>\n        <Suggestions suggestions=\"coding_rules\" />\n        <Helmet defer={false} title={translate('coding_rules.page')}>\n          <meta content=\"noindex\" name=\"robots\" />\n        </Helmet>\n        <div className=\"layout-page\" id=\"coding-rules-page\">\n          <ScreenPositionHelper className=\"layout-page-side-outer\">\n            {({ top }) => (\n              <div className=\"layout-page-side\" style={{ top }}>\n                <div className=\"layout-page-side-inner\">\n                  <div className=\"layout-page-filters\">\n                    <A11ySkipTarget\n                      anchor=\"rules_filters\"\n                      label={translate('coding_rules.skip_to_filters')}\n                      weight={10}\n                    />\n                    <FiltersHeader displayReset={this.isFiltered()} onReset={this.handleReset} />\n                    <SearchBox\n                      className=\"spacer-bottom\"\n                      id=\"coding-rules-search\"\n                      minLength={2}\n                      onChange={this.handleSearch}\n                      placeholder={translate('search.search_for_rules')}\n                      value={this.state.query.searchQuery || ''}\n                    />\n                    <FacetsList\n                      facets={this.state.facets}\n                      hideProfileFacet={hideQualityProfiles}\n                      onFacetToggle={this.handleFacetToggle}\n                      onFilterChange={this.handleFilterChange}\n                      openFacets={this.state.openFacets}\n                      organization={organization}\n                      organizationsEnabled={this.props.appState.organizationsEnabled}\n                      query={this.state.query}\n                      referencedProfiles={this.state.referencedProfiles}\n                      referencedRepositories={this.state.referencedRepositories}\n                      selectedProfile={this.getSelectedProfile()}\n                    />\n                  </div>\n                </div>\n              </div>\n            )}\n          </ScreenPositionHelper>\n\n          <div className=\"layout-page-main\">\n            <div className=\"layout-page-header-panel layout-page-main-header\">\n              <div className=\"layout-page-header-panel-inner layout-page-main-header-inner\">\n                <div className=\"layout-page-main-inner\">\n                  <A11ySkipTarget anchor=\"rules_main\" />\n                  {this.state.openRule ? (\n                    <a\n                      className=\"js-back display-inline-flex-center link-no-underline\"\n                      href=\"#\"\n                      onClick={this.handleBack}>\n                      <BackIcon className=\"spacer-right\" />\n                      {this.state.usingPermalink\n                        ? translate('coding_rules.see_all')\n                        : translate('coding_rules.return_to_list')}\n                    </a>\n                  ) : (\n                    this.renderBulkButton()\n                  )}\n                  {!this.state.usingPermalink && (\n                    <PageActions\n                      loading={this.state.loading}\n                      onReload={this.handleReload}\n                      paging={paging}\n                      selectedIndex={selectedIndex}\n                    />\n                  )}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"layout-page-main-inner\">\n              {this.state.openRule ? (\n                <RuleDetails\n                  allowCustomRules={!this.props.appState.organizationsEnabled}\n                  canWrite={this.state.canWrite}\n                  hideQualityProfiles={hideQualityProfiles}\n                  onActivate={this.handleRuleActivate}\n                  onDeactivate={this.handleRuleDeactivate}\n                  onDelete={this.handleRuleDelete}\n                  onFilterChange={this.handleFilterChange}\n                  organization={organization}\n                  referencedProfiles={this.state.referencedProfiles}\n                  referencedRepositories={this.state.referencedRepositories}\n                  ruleKey={this.state.openRule.key}\n                  selectedProfile={this.getSelectedProfile()}\n                />\n              ) : (\n                <>\n                  {rules.map(rule => (\n                    <RuleListItem\n                      activation={this.getRuleActivation(rule.key)}\n                      canWrite={this.state.canWrite}\n                      isLoggedIn={isLoggedIn(this.props.currentUser)}\n                      key={rule.key}\n                      onActivate={this.handleRuleActivate}\n                      onDeactivate={this.handleRuleDeactivate}\n                      onFilterChange={this.handleFilterChange}\n                      onOpen={this.handleRuleOpen}\n                      organization={organization}\n                      rule={rule}\n                      selected={rule.key === this.state.selected}\n                      selectedProfile={this.getSelectedProfile()}\n                    />\n                  ))}\n                  {paging !== undefined && (\n                    <ListFooter\n                      count={rules.length}\n                      loadMore={this.fetchMoreRules}\n                      ready={!this.state.loading}\n                      total={paging.total}\n                    />\n                  )}\n                </>\n              )}\n            </div>\n          </div>\n        </div>\n      </>\n    );\n  }\n}\n\nfunction parseActives(rawActives: T.Dict<T.RuleActivation[]>) {\n  const actives: Actives = {};\n  for (const [rule, activations] of Object.entries(rawActives)) {\n    actives[rule] = {};\n    for (const { inherit, qProfile, severity } of activations) {\n      actives[rule][qProfile] = { inherit, severity };\n    }\n  }\n  return actives;\n}\n\nfunction parseFacets(rawFacets: { property: string; values: { count: number; val: string }[] }[]) {\n  const facets: Facets = {};\n  for (const rawFacet of rawFacets) {\n    const values: T.Dict<number> = {};\n    for (const rawValue of rawFacet.values) {\n      values[rawValue.val] = rawValue.count;\n    }\n    facets[getAppFacet(rawFacet.property)] = values;\n  }\n  return facets;\n}\n\nconst mapStateToProps = (state: Store) => ({\n  appState: getAppState(state),\n  currentUser: getCurrentUser(state),\n  languages: getLanguages(state),\n  userOrganizations: getMyOrganizations(state)\n});\n\nexport default withRouter(connect(mapStateToProps)(App));\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { SuggestionsContext } from './SuggestionsContext';\n\ninterface Props {\n  suggestions: string;\n}\n\nexport default function Suggestions({ suggestions }: Props) {\n  return (\n    <SuggestionsContext.Consumer>\n      {({ addSuggestions, removeSuggestions }) => (\n        <SuggestionsInner\n          addSuggestions={addSuggestions}\n          removeSuggestions={removeSuggestions}\n          suggestions={suggestions}\n        />\n      )}\n    </SuggestionsContext.Consumer>\n  );\n}\n\ninterface SuggestionsInnerProps {\n  addSuggestions: (key: string) => void;\n  removeSuggestions: (key: string) => void;\n  suggestions: string;\n}\n\nclass SuggestionsInner extends React.PureComponent<SuggestionsInnerProps> {\n  componentDidMount() {\n    this.props.addSuggestions(this.props.suggestions);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.suggestions !== this.props.suggestions) {\n      this.props.removeSuggestions(this.props.suggestions);\n      this.props.addSuggestions(prevProps.suggestions);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.removeSuggestions(this.props.suggestions);\n  }\n\n  render() {\n    return null;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nexport function getWrappedDisplayName<P>(\n  WrappedComponent: React.ComponentType<P>,\n  hocName: string\n) {\n  const wrappedDisplayName = WrappedComponent.displayName || WrappedComponent.name || 'Component';\n  return `${hocName}(${wrappedDisplayName})`;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport { lazyLoadComponent } from 'sonar-ui-common/components/lazyLoadComponent';\nimport { filterContent } from '../../helpers/markdown';\n\nconst DocMarkdownBlock = lazyLoadComponent(() => import('./DocMarkdownBlock'), 'DocMarkdownBlock');\n\ninterface Props {\n  className?: string;\n  children?: React.ReactNode;\n  // Use as `import(/* webpackMode: \"eager\" */ 'Docs/tooltips/foo/bar.md')`\n  doc: Promise<{ default: string }>;\n  overlayProps?: T.Dict<string>;\n}\n\ninterface State {\n  content?: string;\n}\n\nexport default class DocTooltip extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {};\n\n  componentDidMount() {\n    this.mounted = true;\n    this.props.doc.then(\n      ({ default: content }) => {\n        if (this.mounted) {\n          this.setState({ content });\n        }\n      },\n      () => {}\n    );\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  render() {\n    return this.state.content ? (\n      <HelpTooltip\n        className={this.props.className}\n        overlay={\n          <div className=\"abs-width-300\">\n            <DocMarkdownBlock\n              childProps={this.props.overlayProps}\n              className=\"cut-margins\"\n              content={filterContent(this.state.content)}\n              isTooltip={true}\n            />\n          </div>\n        }>\n        {this.props.children}\n      </HelpTooltip>\n    ) : (\n      this.props.children || null\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { A11yContext } from './A11yContext';\n\ninterface Props {\n  anchor: string;\n  label?: string;\n  weight?: number;\n}\n\nexport default function A11ySkipTarget(props: Props) {\n  return (\n    <A11yContext.Consumer>\n      {({ addA11ySkipLink, removeA11ySkipLink }) => (\n        <A11ySkipTargetInner\n          addA11ySkipLink={addA11ySkipLink}\n          removeA11ySkipLink={removeA11ySkipLink}\n          {...props}\n        />\n      )}\n    </A11yContext.Consumer>\n  );\n}\n\ninterface InnerProps {\n  addA11ySkipLink: (link: T.A11ySkipLink) => void;\n  removeA11ySkipLink: (link: T.A11ySkipLink) => void;\n}\n\nexport class A11ySkipTargetInner extends React.PureComponent<Props & InnerProps> {\n  componentDidMount() {\n    this.props.addA11ySkipLink(this.getLink());\n  }\n\n  componentWillUnmount() {\n    this.props.removeA11ySkipLink(this.getLink());\n  }\n\n  getLink = (): T.A11ySkipLink => {\n    const { anchor: key, label = translate('skip_to_content'), weight } = this.props;\n    return { key, label, weight };\n  };\n\n  render() {\n    const { anchor } = this.props;\n    return <span id={`a11y_target__${anchor}`} />;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { map } from 'lodash';\nimport { csvEscape } from 'sonar-ui-common/helpers/csv';\nimport { getJSON, post, postJSON, RequestData } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\nimport { Exporter, ProfileChangelogEvent } from '../apps/quality-profiles/types';\n\nexport interface ProfileActions {\n  associateProjects?: boolean;\n  copy?: boolean;\n  delete?: boolean;\n  edit?: boolean;\n  setAsDefault?: boolean;\n}\n\nexport interface Actions {\n  create?: boolean;\n}\n\nexport interface Profile {\n  actions?: ProfileActions;\n  key: string;\n  name: string;\n  language: string;\n  languageName: string;\n  isInherited?: boolean;\n  parentKey?: string;\n  parentName?: string;\n  isDefault?: boolean;\n  activeRuleCount: number;\n  activeDeprecatedRuleCount: number;\n  rulesUpdatedAt?: string;\n  lastUsed?: string;\n  userUpdatedAt?: string;\n  organization: string;\n  isBuiltIn?: boolean;\n  projectCount?: number;\n}\n\nexport interface SearchQualityProfilesParameters {\n  defaults?: boolean;\n  language?: string;\n  organization?: string;\n  project?: string;\n  qualityProfile?: string;\n}\n\nexport interface SearchQualityProfilesResponse {\n  actions?: Actions;\n  profiles: Profile[];\n}\n\nexport function searchQualityProfiles(\n  parameters: SearchQualityProfilesParameters\n): Promise<SearchQualityProfilesResponse> {\n  return getJSON('/api/qualityprofiles/search', parameters).catch(throwGlobalError);\n}\n\nexport function getQualityProfile({\n  compareToSonarWay,\n  profile: { key }\n}: {\n  compareToSonarWay?: boolean;\n  profile: Profile;\n}): Promise<any> {\n  return getJSON('/api/qualityprofiles/show', { compareToSonarWay, key });\n}\n\nexport function createQualityProfile(data: RequestData): Promise<any> {\n  return postJSON('/api/qualityprofiles/create', data).catch(throwGlobalError);\n}\n\nexport function restoreQualityProfile(data: RequestData): Promise<any> {\n  return postJSON('/api/qualityprofiles/restore', data).catch(throwGlobalError);\n}\n\nexport interface ProfileProject {\n  id: number;\n  key: string;\n  name: string;\n  selected: boolean;\n}\n\nexport function getProfileProjects(\n  data: RequestData\n): Promise<{ more: boolean; paging: T.Paging; results: ProfileProject[] }> {\n  return getJSON('/api/qualityprofiles/projects', data).catch(throwGlobalError);\n}\n\nexport function getProfileInheritance({\n  language,\n  name: qualityProfile,\n  organization\n}: Profile): Promise<{\n  ancestors: T.ProfileInheritanceDetails[];\n  children: T.ProfileInheritanceDetails[];\n  profile: T.ProfileInheritanceDetails;\n}> {\n  return getJSON('/api/qualityprofiles/inheritance', {\n    language,\n    qualityProfile,\n    organization\n  }).catch(throwGlobalError);\n}\n\nexport function setDefaultProfile({ language, name: qualityProfile, organization }: Profile) {\n  return post('/api/qualityprofiles/set_default', {\n    language,\n    qualityProfile,\n    organization\n  });\n}\n\nexport function renameProfile(key: string, name: string) {\n  return post('/api/qualityprofiles/rename', { key, name }).catch(throwGlobalError);\n}\n\nexport function copyProfile(fromKey: string, toName: string): Promise<any> {\n  return postJSON('/api/qualityprofiles/copy', { fromKey, toName }).catch(throwGlobalError);\n}\n\nexport function deleteProfile({ language, name: qualityProfile, organization }: Profile) {\n  return post('/api/qualityprofiles/delete', { language, qualityProfile, organization }).catch(\n    throwGlobalError\n  );\n}\n\nexport function changeProfileParent(\n  { language, name: qualityProfile, organization }: Profile,\n  parentProfile?: Profile\n) {\n  return post('/api/qualityprofiles/change_parent', {\n    language,\n    qualityProfile,\n    organization,\n    parentQualityProfile: parentProfile ? parentProfile.name : undefined\n  }).catch(throwGlobalError);\n}\n\nexport function getQualityProfileBackupUrl({\n  language,\n  name: qualityProfile,\n  organization\n}: Profile) {\n  const queryParams = Object.entries({ language, qualityProfile, organization })\n    .map(([key, value]) => `${key}=${encodeURIComponent(value)}`)\n    .join('&');\n  return `/api/qualityprofiles/backup?${queryParams}`;\n}\n\nexport function getQualityProfileExporterUrl(\n  { key: exporterKey }: Exporter,\n  { language, name: qualityProfile, organization }: Profile\n) {\n  const queryParams = Object.entries({ exporterKey, language, qualityProfile, organization })\n    .map(([key, value]) => `${key}=${encodeURIComponent(value)}`)\n    .join('&');\n  return `/api/qualityprofiles/export?${queryParams}`;\n}\n\nexport function getImporters(): Promise<\n  Array<{ key: string; languages: Array<string>; name: string }>\n> {\n  return getJSON('/api/qualityprofiles/importers').then(r => r.importers, throwGlobalError);\n}\n\nexport function getExporters(): Promise<any> {\n  return getJSON('/api/qualityprofiles/exporters').then(r => r.exporters);\n}\n\nexport function getProfileChangelog(\n  since: any,\n  to: any,\n  { language, name: qualityProfile, organization }: Profile,\n  page?: number\n): Promise<{\n  events: ProfileChangelogEvent[];\n  p: number;\n  ps: number;\n  total: number;\n}> {\n  return getJSON('/api/qualityprofiles/changelog', {\n    since,\n    to,\n    language,\n    qualityProfile,\n    organization,\n    p: page\n  });\n}\n\nexport interface CompareResponse {\n  left: { name: string };\n  right: { name: string };\n  inLeft: Array<{ key: string; name: string; severity: string }>;\n  inRight: Array<{ key: string; name: string; severity: string }>;\n  modified: Array<{\n    key: string;\n    name: string;\n    left: { params: T.Dict<string>; severity: string };\n    right: { params: T.Dict<string>; severity: string };\n  }>;\n}\n\nexport function compareProfiles(leftKey: string, rightKey: string): Promise<CompareResponse> {\n  return getJSON('/api/qualityprofiles/compare', { leftKey, rightKey });\n}\n\nexport function associateProject(\n  { language, name: qualityProfile, organization }: Profile,\n  project: string\n) {\n  return post('/api/qualityprofiles/add_project', {\n    language,\n    qualityProfile,\n    organization,\n    project\n  }).catch(throwGlobalError);\n}\n\nexport function dissociateProject(\n  { language, name: qualityProfile, organization }: Profile,\n  project: string\n) {\n  return post('/api/qualityprofiles/remove_project', {\n    language,\n    qualityProfile,\n    organization,\n    project\n  }).catch(throwGlobalError);\n}\n\nexport interface SearchUsersGroupsParameters {\n  language: string;\n  organization?: string;\n  qualityProfile: string;\n  q?: string;\n  selected?: 'all' | 'selected' | 'deselected';\n}\n\ninterface SearchUsersResponse {\n  users: T.UserSelected[];\n  paging: T.Paging;\n}\n\nexport function searchUsers(parameters: SearchUsersGroupsParameters): Promise<SearchUsersResponse> {\n  return getJSON('/api/qualityprofiles/search_users', parameters).catch(throwGlobalError);\n}\n\nexport interface SearchGroupsResponse {\n  groups: Array<{ name: string }>;\n  paging: T.Paging;\n}\n\nexport function searchGroups(\n  parameters: SearchUsersGroupsParameters\n): Promise<SearchGroupsResponse> {\n  return getJSON('/api/qualityprofiles/search_groups', parameters).catch(throwGlobalError);\n}\n\nexport interface AddRemoveUserParameters {\n  language: string;\n  login: string;\n  organization?: string;\n  qualityProfile: string;\n}\n\nexport function addUser(parameters: AddRemoveUserParameters): Promise<void | Response> {\n  return post('/api/qualityprofiles/add_user', parameters).catch(throwGlobalError);\n}\n\nexport function removeUser(parameters: AddRemoveUserParameters): Promise<void | Response> {\n  return post('/api/qualityprofiles/remove_user', parameters).catch(throwGlobalError);\n}\n\nexport interface AddRemoveGroupParameters {\n  group: string;\n  language: string;\n  organization?: string;\n  qualityProfile: string;\n}\n\nexport function addGroup(parameters: AddRemoveGroupParameters): Promise<void | Response> {\n  return post('/api/qualityprofiles/add_group', parameters).catch(throwGlobalError);\n}\n\nexport function removeGroup(parameters: AddRemoveGroupParameters): Promise<void | Response> {\n  return post('/api/qualityprofiles/remove_group', parameters).catch(throwGlobalError);\n}\n\nexport interface BulkActivateParameters {\n  activation?: boolean;\n  active_severities?: string;\n  asc?: boolean;\n  available_since?: string;\n  compareToProfile?: string;\n  inheritance?: string;\n  is_template?: string;\n  languages?: string;\n  organization: string | undefined;\n  q?: string;\n  qprofile?: string;\n  repositories?: string;\n  rule_key?: string;\n  s?: string;\n  severities?: string;\n  statuses?: string;\n  tags?: string;\n  targetKey: string;\n  targetSeverity?: string;\n  template_key?: string;\n  types?: string;\n}\n\nexport function bulkActivateRules(data: BulkActivateParameters) {\n  return postJSON('/api/qualityprofiles/activate_rules', data);\n}\n\nexport function bulkDeactivateRules(data: BulkActivateParameters) {\n  return postJSON('/api/qualityprofiles/deactivate_rules', data);\n}\n\nexport function activateRule(data: {\n  key: string;\n  organization: string | undefined;\n  params?: T.Dict<string>;\n  reset?: boolean;\n  rule: string;\n  severity?: string;\n}) {\n  const params =\n    data.params && map(data.params, (value, key) => `${key}=${csvEscape(value)}`).join(';');\n  return post('/api/qualityprofiles/activate_rule', { ...data, params }).catch(throwGlobalError);\n}\n\nexport function deactivateRule(data: {\n  key: string;\n  organization: string | undefined;\n  rule: string;\n}) {\n  return post('/api/qualityprofiles/deactivate_rule', data).catch(throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// keep this file in JavaScript, because it is used by a webpack loader\nmodule.exports = { getFrontMatter, separateFrontMatter, filterContent };\n\nfunction getFrontMatter(content) {\n  const lines = content.split('\\n');\n  const position = getFrontMatterPosition(lines);\n  return position ? parseFrontMatter(lines.slice(position.firstLine + 1, position.lastLine)) : {};\n}\n\nfunction separateFrontMatter(content) {\n  const lines = content.split('\\n');\n  const position = getFrontMatterPosition(lines);\n  if (position) {\n    const frontmatter = parseFrontMatter(lines.slice(position.firstLine + 1, position.lastLine));\n    const content = lines.slice(position.lastLine + 1).join('\\n');\n    return { frontmatter, content };\n  } else {\n    return { frontmatter: {}, content };\n  }\n}\n\nfunction getFrontMatterPosition(lines) {\n  let firstLine;\n  let lastLine;\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    if (line.trim() === '---') {\n      if (firstLine === undefined) {\n        firstLine = i;\n      } else {\n        lastLine = i;\n        break;\n      }\n    }\n  }\n  return lastLine !== undefined ? { firstLine, lastLine } : undefined;\n}\n\nfunction parseFrontMatter(lines) {\n  const data = {};\n  for (let i = 0; i < lines.length; i++) {\n    const tokens = lines[i].split(':').map(x => x.trim());\n    if (tokens.length === 2) {\n      data[tokens[0]] = tokens[1];\n    }\n  }\n  return data;\n}\n\n/**\n * @param {string} content\n * @returns {string}\n */\nfunction filterContent(content) {\n  const regexBase = '<!-- \\\\/?(sonarqube|sonarcloud|static) -->';\n  const { isSonarCloud, getInstance } = require('./system');\n  const contentWithInstance = content.replace(/{instance}/gi, getInstance());\n  const contentWithoutStatic = cutConditionalContent(contentWithInstance, 'static');\n  const filteredContent = isSonarCloud()\n    ? cutConditionalContent(contentWithoutStatic, 'sonarqube')\n    : cutConditionalContent(contentWithoutStatic, 'sonarcloud');\n  return filteredContent\n    .replace(new RegExp(`^${regexBase}(\\n|\\r|\\r\\n|$)`, 'gm'), '') // First, remove single-line ones, including ending carriage-returns.\n    .replace(new RegExp(`${regexBase}`, 'g'), ''); // Now remove all remaining ones.\n}\n\n/**\n * @param {string} content\n * @param {string} tag\n * @returns {string}\n */\nfunction cutConditionalContent(content, tag) {\n  const beginning = `<!-- ${tag} -->`;\n  const ending = `<!-- /${tag} -->`;\n\n  let newContent = content;\n  let start = newContent.indexOf(beginning);\n  let end = newContent.indexOf(ending);\n  while (start !== -1 && end !== -1) {\n    if (start < end) {\n      newContent = newContent.substring(0, start) + newContent.substring(end + ending.length);\n    } else {\n      // When conditional tags are incorrectly used we log an error, strip them out and pass to the next pair of tags\n      // eslint-disable-next-line no-console\n      console.error(\n        new Error(\n          `Documentation - incorrect usage of conditional formatting tags here: \"${newContent.substring(\n            end,\n            start + beginning.length\n          )}\"`\n        )\n      );\n      newContent =\n        newContent.substring(0, end) +\n        newContent.substring(end + ending.length, start) +\n        newContent.substring(start + beginning.length);\n    }\n    start = newContent.indexOf(beginning);\n    end = newContent.indexOf(ending);\n  }\n\n  return newContent;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport SeverityIcon from 'sonar-ui-common/components/icons/SeverityIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  className?: string;\n  severity: string;\n}\n\nexport default function SeverityHelper({ className, severity }: Props) {\n  if (!severity) {\n    return null;\n  }\n  return (\n    <span className={className}>\n      <SeverityIcon className=\"little-spacer-right\" severity={severity} />\n      {translate('severity', severity)}\n    </span>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, post, postJSON } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\n\nexport interface GetRulesAppResponse {\n  canWrite?: boolean;\n  repositories: { key: string; language: string; name: string }[];\n}\n\nexport function getRulesApp(data: {\n  organization: string | undefined;\n}): Promise<GetRulesAppResponse> {\n  return getJSON('/api/rules/app', data).catch(throwGlobalError);\n}\n\nexport interface SearchRulesResponse {\n  actives?: T.Dict<T.RuleActivation[]>;\n  facets?: { property: string; values: { count: number; val: string }[] }[];\n  p: number;\n  ps: number;\n  rules: T.Rule[];\n  total: number;\n}\n\nexport function searchRules(data: {\n  organization: string | undefined;\n  [x: string]: any;\n}): Promise<SearchRulesResponse> {\n  return getJSON('/api/rules/search', data).catch(throwGlobalError);\n}\n\nexport function takeFacet(response: any, property: string) {\n  const facet = response.facets.find((facet: any) => facet.property === property);\n  return facet ? facet.values : [];\n}\n\nexport function getRuleDetails(parameters: {\n  actives?: boolean;\n  key: string;\n  organization: string | undefined;\n}): Promise<{ actives?: T.RuleActivation[]; rule: T.RuleDetails }> {\n  return getJSON('/api/rules/show', parameters).catch(throwGlobalError);\n}\n\nexport function getRuleTags(parameters: {\n  organization: string | undefined;\n  ps?: number;\n  q: string;\n}): Promise<string[]> {\n  return getJSON('/api/rules/tags', parameters).then(r => r.tags, throwGlobalError);\n}\n\nexport function createRule(data: {\n  custom_key: string;\n  markdown_description: string;\n  name: string;\n  organization: string | undefined;\n  params?: string;\n  prevent_reactivation?: boolean;\n  severity?: string;\n  status?: string;\n  template_key: string;\n  type?: string;\n}): Promise<T.RuleDetails> {\n  return postJSON('/api/rules/create', data).then(\n    r => r.rule,\n    response => {\n      // do not show global error if the status code is 409\n      // this case should be handled inside a component\n      if (response && response.status === 409) {\n        return Promise.reject(response);\n      } else {\n        return throwGlobalError(response);\n      }\n    }\n  );\n}\n\nexport function deleteRule(parameters: { key: string; organization: string | undefined }) {\n  return post('/api/rules/delete', parameters).catch(throwGlobalError);\n}\n\nexport function updateRule(data: {\n  key: string;\n  markdown_description?: string;\n  markdown_note?: string;\n  name?: string;\n  organization: string | undefined;\n  params?: string;\n  remediation_fn_base_effort?: string;\n  remediation_fn_type?: string;\n  remediation_fy_gap_multiplier?: string;\n  severity?: string;\n  status?: string;\n  tags?: string;\n}): Promise<T.RuleDetails> {\n  return postJSON('/api/rules/update', data).then(r => r.rule, throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { getAppState, Store } from '../../store/rootReducer';\nimport { getWrappedDisplayName } from './utils';\n\nexport function withAppState<P>(\n  WrappedComponent: React.ComponentType<P & { appState: Partial<T.AppState> }>\n) {\n  class Wrapper extends React.Component<P & { appState: T.AppState }> {\n    static displayName = getWrappedDisplayName(WrappedComponent, 'withAppState');\n\n    render() {\n      return <WrappedComponent {...this.props} />;\n    }\n  }\n\n  function mapStateToProps(state: Store) {\n    return { appState: getAppState(state) };\n  }\n\n  return connect(mapStateToProps)(Wrapper);\n}\n","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./TagsList.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\n\ninterface Props {\n  className?: string;\n  children: React.ReactNode;\n  property: string;\n}\n\nexport default function FacetBox(props: Props) {\n  return (\n    <div\n      className={classNames('search-navigator-facet-box', props.className)}\n      data-property={props.property}>\n      {props.children}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { debounce } from 'lodash';\nimport * as React from 'react';\n\ninterface Props {\n  className?: string;\n  children: (position: { top: number; left: number }) => React.ReactElement<any>;\n}\n\nexport default class ScreenPositionHelper extends React.PureComponent<Props> {\n  container?: HTMLDivElement;\n  debouncedOnResize: () => void;\n\n  constructor(props: Props) {\n    super(props);\n    this.debouncedOnResize = debounce(() => this.forceUpdate(), 250);\n  }\n\n  componentDidMount() {\n    this.forceUpdate();\n    window.addEventListener('resize', this.debouncedOnResize);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.debouncedOnResize);\n  }\n\n  getPosition = () => {\n    const containerPos = this.container && this.container.getBoundingClientRect();\n    if (!containerPos) {\n      return { top: 0, left: 0 };\n    }\n    return {\n      top: window.pageYOffset + containerPos.top,\n      left: window.pageXOffset + containerPos.left\n    };\n  };\n\n  render() {\n    return (\n      <div\n        className={this.props.className}\n        ref={container => (this.container = container as HTMLDivElement)}>\n        {this.props.children(this.getPosition())}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport OpenCloseIcon from 'sonar-ui-common/components/icons/OpenCloseIcon';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  children?: React.ReactNode;\n  fetching?: boolean;\n  helper?: string;\n  name: React.ReactNode;\n  onClear?: () => void;\n  onClick?: () => void;\n  open: boolean;\n  values?: string[];\n}\n\nexport default class FacetHeader extends React.PureComponent<Props> {\n  handleClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    if (this.props.onClick) {\n      this.props.onClick();\n    }\n  };\n\n  renderHelper() {\n    if (!this.props.helper) {\n      return null;\n    }\n    return <HelpTooltip className=\"spacer-left\" overlay={this.props.helper} />;\n  }\n\n  renderValueIndicator() {\n    const { values } = this.props;\n    if (!values || !values.length) {\n      return null;\n    }\n    const value =\n      values.length === 1 ? values[0] : translateWithParameters('x_selected', values.length);\n    return (\n      <span className=\"badge text-ellipsis\" title={value}>\n        {value}\n      </span>\n    );\n  }\n\n  render() {\n    const showClearButton =\n      this.props.values != null && this.props.values.length > 0 && this.props.onClear != null;\n\n    return (\n      <div className=\"search-navigator-facet-header-wrapper display-flex-center\">\n        {this.props.onClick ? (\n          <span className=\"search-navigator-facet-header display-flex-center\">\n            <a href=\"#\" onClick={this.handleClick}>\n              <OpenCloseIcon className=\"little-spacer-right\" open={this.props.open} />\n              {this.props.name}\n            </a>\n            {this.renderHelper()}\n          </span>\n        ) : (\n          <span className=\"search-navigator-facet-header display-flex-center\">\n            {this.props.name}\n            {this.renderHelper()}\n          </span>\n        )}\n\n        {this.props.children}\n\n        <span className=\"search-navigator-facet-header-value spacer-left spacer-right \">\n          {this.renderValueIndicator()}\n        </span>\n\n        {this.props.fetching && (\n          <span className=\"little-spacer-right\">\n            <DeferredSpinner />\n          </span>\n        )}\n\n        {showClearButton && (\n          <Button\n            className=\"search-navigator-facet-header-button button-small button-red\"\n            onClick={this.props.onClear}>\n            {translate('clear')}\n          </Button>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\n\nexport interface Props {\n  active?: boolean;\n  className?: string;\n  disabled?: boolean;\n  halfWidth?: boolean;\n  name: React.ReactNode;\n  onClick: (x: string, multiple?: boolean) => void;\n  stat?: React.ReactNode;\n  /** Textual version of `name` */\n  tooltip?: string;\n  value: string;\n}\n\nexport default class FacetItem extends React.PureComponent<Props> {\n  static defaultProps = {\n    disabled: false,\n    halfWidth: false,\n    loading: false\n  };\n\n  handleClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.props.onClick(this.props.value, event.ctrlKey || event.metaKey);\n  };\n\n  renderValue() {\n    if (this.props.stat == null) {\n      return null;\n    }\n\n    return <span className=\"facet-stat\">{this.props.stat}</span>;\n  }\n\n  render() {\n    const { name } = this.props;\n    const className = classNames('search-navigator-facet', this.props.className, {\n      active: this.props.active,\n      'search-navigator-facet-half': this.props.halfWidth\n    });\n\n    return this.props.disabled ? (\n      <span className={className} data-facet={this.props.value} title={this.props.tooltip}>\n        <span className=\"facet-name\">{name}</span>\n        {this.renderValue()}\n      </span>\n    ) : (\n      <a\n        className={className}\n        data-facet={this.props.value}\n        href=\"#\"\n        onClick={this.handleClick}\n        title={this.props.tooltip}>\n        <span className=\"facet-name\">{name}</span>\n        {this.renderValue()}\n      </a>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport Checkbox from 'sonar-ui-common/components/controls/Checkbox';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\nexport interface MultiSelectOptionProps {\n  active?: boolean;\n  custom?: boolean;\n  disabled?: boolean;\n  element: string;\n  onHover: (element: string) => void;\n  onSelectChange: (selected: boolean, element: string) => void;\n  renderLabel: (element: string) => React.ReactNode;\n  selected?: boolean;\n}\n\nexport default function MultiSelectOption(props: MultiSelectOptionProps) {\n  const { active, custom, disabled, element, selected } = props;\n  const onHover = () => props.onHover(element);\n  const className = classNames({ active, disabled });\n  const label = props.renderLabel(element);\n\n  return (\n    <li onFocus={onHover} onMouseOver={onHover}>\n      <Checkbox\n        checked={Boolean(selected)}\n        className={className}\n        disabled={disabled}\n        id={element}\n        onCheck={props.onSelectChange}>\n        {custom ? (\n          <span\n            aria-label={`${translate('create_new_element')}: ${label}`}\n            className=\"little-spacer-left\">\n            <span aria-hidden={true} className=\"little-spacer-right\">\n              +\n            </span>\n            {label}\n          </span>\n        ) : (\n          <span className=\"little-spacer-left\">{label}</span>\n        )}\n      </Checkbox>\n    </li>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport { difference } from 'lodash';\nimport * as React from 'react';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport { translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport MultiSelectOption from './MultiSelectOption';\n\ninterface Props {\n  allowNewElements?: boolean;\n  allowSelection?: boolean;\n  elements: string[];\n  filterSelected?: (query: string, selectedElements: string[]) => string[];\n  footerNode?: React.ReactNode;\n  listSize?: number;\n  onSearch: (query: string) => Promise<void>;\n  onSelect: (item: string) => void;\n  onUnselect: (item: string) => void;\n  placeholder: string;\n  renderLabel?: (element: string) => React.ReactNode;\n  selectedElements: string[];\n  validateSearchInput?: (value: string) => string;\n}\n\ninterface State {\n  activeIdx: number;\n  loading: boolean;\n  query: string;\n  selectedElements: string[];\n  unselectedElements: string[];\n}\n\ninterface DefaultProps {\n  filterSelected: (query: string, selectedElements: string[]) => string[];\n  listSize: number;\n  renderLabel: (element: string) => React.ReactNode;\n  validateSearchInput: (value: string) => string;\n}\n\ntype PropsWithDefault = Props & DefaultProps;\n\nexport default class MultiSelect extends React.PureComponent<Props, State> {\n  container?: HTMLDivElement | null;\n  searchInput?: HTMLInputElement | null;\n  mounted = false;\n\n  static defaultProps: DefaultProps = {\n    filterSelected: (query: string, selectedElements: string[]) =>\n      selectedElements.filter(elem => elem.includes(query)),\n    listSize: 0,\n    renderLabel: (element: string) => element,\n    validateSearchInput: (value: string) => value\n  };\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      activeIdx: 0,\n      loading: true,\n      query: '',\n      selectedElements: [],\n      unselectedElements: []\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.onSearchQuery('');\n    this.updateSelectedElements(this.props as PropsWithDefault);\n    this.updateUnselectedElements(this.props as PropsWithDefault);\n    if (this.container) {\n      this.container.addEventListener('keydown', this.handleKeyboard, true);\n    }\n  }\n\n  componentWillReceiveProps(nextProps: PropsWithDefault) {\n    if (\n      this.props.elements !== nextProps.elements ||\n      this.props.selectedElements !== nextProps.selectedElements\n    ) {\n      this.updateSelectedElements(nextProps);\n      this.updateUnselectedElements(nextProps);\n\n      const totalElements = this.getAllElements(nextProps, this.state).length;\n      if (this.state.activeIdx >= totalElements) {\n        this.setState({ activeIdx: totalElements - 1 });\n      }\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.searchInput) {\n      this.searchInput.focus();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n    if (this.container) {\n      this.container.removeEventListener('keydown', this.handleKeyboard);\n    }\n  }\n\n  handleSelectChange = (selected: boolean, item: string) => {\n    if (selected) {\n      this.onSelectItem(item);\n    } else {\n      this.onUnselectItem(item);\n    }\n  };\n\n  handleSearchChange = (value: string) => {\n    this.onSearchQuery((this.props as PropsWithDefault).validateSearchInput(value));\n  };\n\n  handleElementHover = (element: string) => {\n    this.setState((prevState, props) => {\n      return { activeIdx: this.getAllElements(props, prevState).indexOf(element) };\n    });\n  };\n\n  handleKeyboard = (evt: KeyboardEvent) => {\n    switch (evt.keyCode) {\n      case 40: // down\n        evt.stopPropagation();\n        evt.preventDefault();\n        this.setState(this.selectNextElement);\n        break;\n      case 38: // up\n        evt.stopPropagation();\n        evt.preventDefault();\n        this.setState(this.selectPreviousElement);\n        break;\n      case 37: // left\n      case 39: // right\n        evt.stopPropagation();\n        break;\n      case 13: // enter\n        if (this.state.activeIdx >= 0) {\n          this.toggleSelect(this.getAllElements(this.props, this.state)[this.state.activeIdx]);\n        }\n        break;\n    }\n  };\n\n  onSearchQuery = (query: string) => {\n    this.setState({ activeIdx: 0, loading: true, query });\n    this.props.onSearch(query).then(this.stopLoading, this.stopLoading);\n  };\n\n  onSelectItem = (item: string) => {\n    if (this.isNewElement(item, this.props)) {\n      this.onSearchQuery('');\n    }\n    this.props.onSelect(item);\n  };\n\n  onUnselectItem = (item: string) => this.props.onUnselect(item);\n\n  isNewElement = (elem: string, { selectedElements, elements }: Props) =>\n    elem.length > 0 && selectedElements.indexOf(elem) === -1 && elements.indexOf(elem) === -1;\n\n  updateSelectedElements = (props: PropsWithDefault) => {\n    this.setState((state: State) => {\n      if (state.query) {\n        return {\n          selectedElements: props.filterSelected(state.query, props.selectedElements)\n        };\n      } else {\n        return { selectedElements: [...props.selectedElements] };\n      }\n    });\n  };\n\n  updateUnselectedElements = (props: PropsWithDefault) => {\n    this.setState((state: State) => {\n      if (props.listSize === 0) {\n        return { unselectedElements: difference(props.elements, props.selectedElements) };\n      } else if (props.listSize < state.selectedElements.length) {\n        return { unselectedElements: [] };\n      } else {\n        return {\n          unselectedElements: difference(props.elements, props.selectedElements).slice(\n            0,\n            props.listSize - state.selectedElements.length\n          )\n        };\n      }\n    });\n  };\n\n  getAllElements = (props: Props, state: State) => {\n    if (this.isNewElement(state.query, props)) {\n      return [...state.selectedElements, ...state.unselectedElements, state.query];\n    } else {\n      return [...state.selectedElements, ...state.unselectedElements];\n    }\n  };\n\n  setElementActive = (idx: number) => this.setState({ activeIdx: idx });\n\n  selectNextElement = (state: State, props: Props) => {\n    const { activeIdx } = state;\n    const allElements = this.getAllElements(props, state);\n    if (activeIdx < 0 || activeIdx >= allElements.length - 1) {\n      return { activeIdx: 0 };\n    } else {\n      return { activeIdx: activeIdx + 1 };\n    }\n  };\n\n  selectPreviousElement = (state: State, props: Props) => {\n    const { activeIdx } = state;\n    const allElements = this.getAllElements(props, state);\n    if (activeIdx <= 0) {\n      const lastIdx = allElements.length - 1;\n      return { activeIdx: lastIdx };\n    } else {\n      return { activeIdx: activeIdx - 1 };\n    }\n  };\n\n  stopLoading = () => {\n    if (this.mounted) {\n      this.setState({ loading: false });\n    }\n  };\n\n  toggleSelect = (item: string) => {\n    if (this.props.selectedElements.indexOf(item) === -1) {\n      this.onSelectItem(item);\n    } else {\n      this.onUnselectItem(item);\n    }\n  };\n\n  render() {\n    const { allowSelection = true, allowNewElements = true, footerNode = '' } = this.props;\n    const { renderLabel } = this.props as PropsWithDefault;\n    const { query, activeIdx, selectedElements, unselectedElements } = this.state;\n    const activeElement = this.getAllElements(this.props, this.state)[activeIdx];\n    const showNewElement = allowNewElements && this.isNewElement(query, this.props);\n    const infiniteList = this.props.listSize === 0;\n    const listClasses = classNames('menu', {\n      'menu-vertically-limited': infiniteList,\n      'spacer-top': infiniteList,\n      'with-top-separator': infiniteList,\n      'with-bottom-separator': Boolean(footerNode)\n    });\n\n    return (\n      <div className=\"multi-select\" ref={div => (this.container = div)}>\n        <div className=\"menu-search\">\n          <SearchBox\n            autoFocus={true}\n            className=\"little-spacer-top\"\n            loading={this.state.loading}\n            onChange={this.handleSearchChange}\n            placeholder={this.props.placeholder}\n            value={query}\n          />\n        </div>\n        <ul className={listClasses}>\n          {selectedElements.length > 0 &&\n            selectedElements.map(element => (\n              <MultiSelectOption\n                active={activeElement === element}\n                element={element}\n                key={element}\n                onHover={this.handleElementHover}\n                onSelectChange={this.handleSelectChange}\n                renderLabel={renderLabel}\n                selected={true}\n              />\n            ))}\n          {unselectedElements.length > 0 &&\n            unselectedElements.map(element => (\n              <MultiSelectOption\n                active={activeElement === element}\n                disabled={!allowSelection}\n                element={element}\n                key={element}\n                onHover={this.handleElementHover}\n                onSelectChange={this.handleSelectChange}\n                renderLabel={renderLabel}\n              />\n            ))}\n          {showNewElement && (\n            <MultiSelectOption\n              active={activeElement === query}\n              custom={true}\n              element={query}\n              key={query}\n              onHover={this.handleElementHover}\n              onSelectChange={this.handleSelectChange}\n              renderLabel={renderLabel}\n            />\n          )}\n          {!showNewElement && selectedElements.length < 1 && unselectedElements.length < 1 && (\n            <li className=\"spacer-left\">{translateWithParameters('no_results_for_x', query)}</li>\n          )}\n        </ul>\n        {footerNode}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport DropdownIcon from 'sonar-ui-common/components/icons/DropdownIcon';\nimport TagsIcon from 'sonar-ui-common/components/icons/TagsIcon';\nimport { translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport './TagsList.css';\n\ninterface Props {\n  allowUpdate?: boolean;\n  className?: string;\n  tags: string[];\n}\n\nexport default function TagsList({ allowUpdate = false, className, tags }: Props) {\n  return (\n    <span\n      aria-label={translateWithParameters('tags_list_x', tags.join(', '))}\n      className={classNames('tags-list', className)}>\n      <TagsIcon className=\"text-middle\" />\n      <span aria-hidden={true} className=\"text-ellipsis text-middle\" title={tags.join(', ')}>\n        {tags.join(', ')}\n      </span>\n      {allowUpdate && <DropdownIcon className=\"text-middle\" />}\n    </span>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getMarkdownHelpUrl } from '../../helpers/urls';\n\ninterface Props {\n  className?: string;\n}\n\nexport default class MarkdownTips extends React.PureComponent<Props> {\n  handleClick(evt: React.SyntheticEvent<HTMLAnchorElement>) {\n    evt.preventDefault();\n    window.open(getMarkdownHelpUrl(), 'Markdown', 'height=300,width=600,scrollbars=1,resizable=1');\n  }\n\n  render() {\n    return (\n      <div className={classNames('markdown-tips', this.props.className)}>\n        <a className=\"little-spacer-right\" href=\"#\" onClick={this.handleClick}>\n          {translate('markdown.helplink')}\n        </a>\n        {':'}\n        <span className=\"spacer-left\">*{translate('bold')}*</span>\n        <span className=\"spacer-left\">\n          ``\n          {translate('code')}\n          ``\n        </span>\n        <span className=\"spacer-left\">* {translate('bulleted_point')}</span>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\n\ninterface Props {\n  children?: React.ReactNode;\n  title?: string;\n}\n\nexport default function FacetItemsList({ children, title }: Props) {\n  return (\n    <div className=\"search-navigator-facet-list\">\n      {title && <div className=\"search-navigator-facet-list-title\">{title}</div>}\n      {children}\n    </div>\n  );\n}\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".tags-list{white-space:nowrap;line-height:16px}.tags-list i:before{font-size:12px}.tags-list span{display:inline-block;vertical-align:middle;text-align:left;max-width:220px;padding-left:4px;padding-right:4px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\n\ninterface Props {\n  className?: string;\n  count: number;\n  showMore: () => void;\n  showLess: (() => void) | undefined;\n  total: number;\n}\n\nexport default class ListStyleFacetFooter extends React.PureComponent<Props> {\n  handleShowMoreClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.props.showMore();\n  };\n\n  handleShowLessClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    if (this.props.showLess) {\n      this.props.showLess();\n    }\n  };\n\n  render() {\n    const { count, total } = this.props;\n    const hasMore = total > count;\n    const allShown = Boolean(total && total === count);\n\n    return (\n      <footer className=\"note spacer-top spacer-bottom text-center\">\n        {translateWithParameters('x_show', formatMeasure(count, 'INT', null))}\n\n        {hasMore && (\n          <a className=\"spacer-left text-muted\" href=\"#\" onClick={this.handleShowMoreClick}>\n            {translate('show_more')}\n          </a>\n        )}\n\n        {this.props.showLess && allShown && (\n          <a className=\"spacer-left text-muted\" href=\"#\" onClick={this.handleShowLessClick}>\n            {translate('show_less')}\n          </a>\n        )}\n      </footer>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport { sortBy, without } from 'lodash';\nimport * as React from 'react';\nimport ListFooter from 'sonar-ui-common/components/controls/ListFooter';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\nimport { queriesEqual } from 'sonar-ui-common/helpers/query';\nimport FacetBox from './FacetBox';\nimport FacetHeader from './FacetHeader';\nimport FacetItem from './FacetItem';\nimport FacetItemsList from './FacetItemsList';\nimport ListStyleFacetFooter from './ListStyleFacetFooter';\nimport MultipleSelectionHint from './MultipleSelectionHint';\n\ninterface SearchResponse<S> {\n  maxResults?: boolean;\n  results: S[];\n  paging?: T.Paging;\n}\n\nexport interface Props<S> {\n  className?: string;\n  disabled?: boolean;\n  disabledHelper?: string;\n  facetHeader: string;\n  fetching: boolean;\n  getFacetItemText: (item: string) => string;\n  getSearchResultKey: (result: S) => string;\n  getSearchResultText: (result: S) => string;\n  loadSearchResultCount?: (result: S[]) => Promise<T.Dict<number>>;\n  maxInitialItems: number;\n  maxItems: number;\n  minSearchLength: number;\n  onChange: (changes: T.Dict<string | string[]>) => void;\n  onClear?: () => void;\n  onItemClick?: (itemValue: string, multiple: boolean) => void;\n  onSearch: (query: string, page?: number) => Promise<SearchResponse<S>>;\n  onToggle: (property: string) => void;\n  open: boolean;\n  property: string;\n  query?: T.RawQuery;\n  renderFacetItem: (item: string) => React.ReactNode;\n  renderSearchResult: (result: S, query: string) => React.ReactNode;\n  searchPlaceholder: string;\n  getSortedItems?: () => string[];\n  stats: T.Dict<number> | undefined;\n  values: string[];\n}\n\ninterface State<S> {\n  autoFocus: boolean;\n  query: string;\n  searching: boolean;\n  searchMaxResults?: boolean;\n  searchPaging?: T.Paging;\n  searchResults?: S[];\n  searchResultsCounts: T.Dict<number>;\n  showFullList: boolean;\n}\n\nexport default class ListStyleFacet<S> extends React.Component<Props<S>, State<S>> {\n  mounted = false;\n\n  static defaultProps = {\n    maxInitialItems: 15,\n    maxItems: 100,\n    minSearchLength: 2\n  };\n\n  state: State<S> = {\n    autoFocus: false,\n    query: '',\n    searching: false,\n    searchResultsCounts: {},\n    showFullList: false\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentDidUpdate(prevProps: Props<S>) {\n    if (!prevProps.open && this.props.open) {\n      // focus search field *only* if it was manually open\n      this.setState({ autoFocus: true });\n    } else if (\n      (prevProps.open && !this.props.open) ||\n      !queriesEqual(prevProps.query || {}, this.props.query || {})\n    ) {\n      // reset state when closing the facet, or when query changes\n      this.setState({\n        query: '',\n        searchMaxResults: undefined,\n        searchResults: undefined,\n        searching: false,\n        searchResultsCounts: {},\n        showFullList: false\n      });\n    } else if (\n      prevProps.stats !== this.props.stats &&\n      Object.keys(this.props.stats || {}).length < this.props.maxInitialItems\n    ) {\n      // show limited list if `stats` changed and there are less than 15 items\n      this.setState({ showFullList: false });\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleItemClick = (itemValue: string, multiple: boolean) => {\n    if (this.props.onItemClick) {\n      this.props.onItemClick(itemValue, multiple);\n    } else {\n      const { values } = this.props;\n      if (multiple) {\n        const newValue = sortBy(\n          values.includes(itemValue) ? without(values, itemValue) : [...values, itemValue]\n        );\n        this.props.onChange({ [this.props.property]: newValue });\n      } else {\n        this.props.onChange({\n          [this.props.property]: values.includes(itemValue) && values.length < 2 ? [] : [itemValue]\n        });\n      }\n    }\n  };\n\n  handleHeaderClick = () => {\n    this.props.onToggle(this.props.property);\n  };\n\n  handleClear = () => {\n    if (this.props.onClear) {\n      this.props.onClear();\n    } else {\n      this.props.onChange({ [this.props.property]: [] });\n    }\n  };\n\n  stopSearching = () => {\n    if (this.mounted) {\n      this.setState({ searching: false });\n    }\n  };\n\n  search = (query: string) => {\n    if (query.length >= this.props.minSearchLength) {\n      this.setState({ query, searching: true });\n      this.props\n        .onSearch(query)\n        .then(this.loadCountsForSearchResults)\n        .then(({ maxResults, paging, results, stats }) => {\n          if (this.mounted) {\n            this.setState(state => ({\n              searching: false,\n              searchMaxResults: maxResults,\n              searchResults: results,\n              searchPaging: paging,\n              searchResultsCounts: { ...state.searchResultsCounts, ...stats }\n            }));\n          }\n        })\n        .catch(this.stopSearching);\n    } else {\n      this.setState({ query, searching: false, searchResults: [] });\n    }\n  };\n\n  searchMore = () => {\n    const { query, searchPaging, searchResults } = this.state;\n    if (query && searchResults && searchPaging) {\n      this.setState({ searching: true });\n      this.props\n        .onSearch(query, searchPaging.pageIndex + 1)\n        .then(this.loadCountsForSearchResults)\n        .then(({ paging, results, stats }) => {\n          if (this.mounted) {\n            this.setState(state => ({\n              searching: false,\n              searchResults: [...searchResults, ...results],\n              searchPaging: paging,\n              searchResultsCounts: { ...state.searchResultsCounts, ...stats }\n            }));\n          }\n        })\n        .catch(this.stopSearching);\n    }\n  };\n\n  loadCountsForSearchResults = (response: SearchResponse<S>) => {\n    const { loadSearchResultCount = () => Promise.resolve({}) } = this.props;\n    const resultsToLoad = response.results.filter(result => {\n      const key = this.props.getSearchResultKey(result);\n      return this.getStat(key) === undefined && this.state.searchResultsCounts[key] === undefined;\n    });\n    if (resultsToLoad.length > 0) {\n      return loadSearchResultCount(resultsToLoad).then(stats => ({ ...response, stats }));\n    } else {\n      return { ...response, stats: {} };\n    }\n  };\n\n  getStat(item: string) {\n    const { stats } = this.props;\n    return stats && stats[item] !== undefined ? stats && stats[item] : undefined;\n  }\n\n  showFullList = () => {\n    this.setState({ showFullList: true });\n  };\n\n  hideFullList = () => {\n    this.setState({ showFullList: false });\n  };\n\n  renderList() {\n    const { stats } = this.props;\n\n    if (!stats) {\n      return null;\n    }\n\n    const sortedItems = this.props.getSortedItems\n      ? this.props.getSortedItems()\n      : sortBy(\n          Object.keys(stats),\n          key => -stats[key],\n          key => this.props.getFacetItemText(key)\n        );\n\n    const limitedList = this.state.showFullList\n      ? sortedItems\n      : sortedItems.slice(0, this.props.maxInitialItems);\n\n    // make sure all selected items are displayed\n    const selectedBelowLimit = this.state.showFullList\n      ? []\n      : sortedItems\n          .slice(this.props.maxInitialItems)\n          .filter(item => this.props.values.includes(item));\n\n    const mightHaveMoreResults = sortedItems.length >= this.props.maxItems;\n\n    return (\n      <>\n        <FacetItemsList>\n          {limitedList.map(item => (\n            <FacetItem\n              active={this.props.values.includes(item)}\n              key={item}\n              name={this.props.renderFacetItem(item)}\n              onClick={this.handleItemClick}\n              stat={formatFacetStat(this.getStat(item))}\n              tooltip={this.props.getFacetItemText(item)}\n              value={item}\n            />\n          ))}\n        </FacetItemsList>\n        {selectedBelowLimit.length > 0 && (\n          <>\n            <div className=\"note spacer-bottom text-center\">⋯</div>\n            <FacetItemsList>\n              {selectedBelowLimit.map(item => (\n                <FacetItem\n                  active={true}\n                  key={item}\n                  name={this.props.renderFacetItem(item)}\n                  onClick={this.handleItemClick}\n                  stat={formatFacetStat(this.getStat(item))}\n                  tooltip={this.props.getFacetItemText(item)}\n                  value={item}\n                />\n              ))}\n            </FacetItemsList>\n          </>\n        )}\n        <ListStyleFacetFooter\n          count={limitedList.length + selectedBelowLimit.length}\n          showLess={this.state.showFullList ? this.hideFullList : undefined}\n          showMore={this.showFullList}\n          total={sortedItems.length}\n        />\n        {mightHaveMoreResults && this.state.showFullList && (\n          <Alert className=\"spacer-top\" variant=\"warning\">\n            {translate('facet_might_have_more_results')}\n          </Alert>\n        )}\n      </>\n    );\n  }\n\n  renderSearch() {\n    if (!this.props.stats || !Object.keys(this.props.stats).length) {\n      return null;\n    }\n\n    return (\n      <SearchBox\n        autoFocus={this.state.autoFocus}\n        className=\"little-spacer-top spacer-bottom\"\n        loading={this.state.searching}\n        minLength={this.props.minSearchLength}\n        onChange={this.search}\n        placeholder={this.props.searchPlaceholder}\n        value={this.state.query}\n      />\n    );\n  }\n\n  renderSearchResults() {\n    const { searching, searchMaxResults, searchResults, searchPaging } = this.state;\n\n    if (!searching && (!searchResults || !searchResults.length)) {\n      return <div className=\"note spacer-bottom\">{translate('no_results')}</div>;\n    }\n\n    if (!searchResults) {\n      // initial search\n      return null;\n    }\n\n    return (\n      <>\n        <FacetItemsList>\n          {searchResults.map(result => this.renderSearchResult(result))}\n        </FacetItemsList>\n        {searchMaxResults && (\n          <Alert className=\"spacer-top\" variant=\"warning\">\n            {translate('facet_might_have_more_results')}\n          </Alert>\n        )}\n        {searchPaging && (\n          <ListFooter\n            className=\"spacer-bottom\"\n            count={searchResults.length}\n            loadMore={this.searchMore}\n            ready={!searching}\n            total={searchPaging.total}\n          />\n        )}\n      </>\n    );\n  }\n\n  renderSearchResult(result: S) {\n    const key = this.props.getSearchResultKey(result);\n    const active = this.props.values.includes(key);\n    const stat = this.getStat(key) || this.state.searchResultsCounts[key];\n    const disabled = !active && stat === 0;\n    return (\n      <FacetItem\n        active={active}\n        disabled={disabled}\n        key={key}\n        name={this.props.renderSearchResult(result, this.state.query)}\n        onClick={this.handleItemClick}\n        stat={formatFacetStat(stat)}\n        tooltip={this.props.getSearchResultText(result)}\n        value={key}\n      />\n    );\n  }\n\n  render() {\n    const { disabled, stats = {} } = this.props;\n    const { query, searching, searchResults } = this.state;\n    const values = this.props.values.map(item => this.props.getFacetItemText(item));\n    const loadingResults =\n      query !== '' && searching && (searchResults === undefined || searchResults.length === 0);\n    const showList = !query || loadingResults;\n    return (\n      <FacetBox\n        className={classNames(this.props.className, {\n          'search-navigator-facet-box-forbidden': disabled\n        })}\n        property={this.props.property}>\n        <FacetHeader\n          fetching={this.props.fetching}\n          name={\n            <Tooltip overlay={disabled ? this.props.disabledHelper : undefined}>\n              <span>{this.props.facetHeader}</span>\n            </Tooltip>\n          }\n          onClear={this.handleClear}\n          onClick={disabled ? undefined : this.handleHeaderClick}\n          open={this.props.open && !disabled}\n          values={values}\n        />\n\n        {this.props.open && !disabled && (\n          <>\n            {this.renderSearch()}\n            {showList ? this.renderList() : this.renderSearchResults()}\n            <MultipleSelectionHint options={Object.keys(stats).length} values={values.length} />\n          </>\n        )}\n      </FacetBox>\n    );\n  }\n}\n\nfunction formatFacetStat(stat: number | undefined) {\n  return stat && formatMeasure(stat, 'SHORT_INT');\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { isLoggedIn } from './users';\n\nexport function isPaidOrganization(organization: T.Organization | undefined): boolean {\n  return Boolean(organization && organization.subscription === 'PAID');\n}\n\nexport function hasPrivateAccess(\n  currentUser: T.CurrentUser,\n  organization: T.Organization | undefined,\n  userOrganizations: T.Organization[]\n): boolean {\n  return (\n    !isPaidOrganization(organization) ||\n    isCurrentUserMemberOf(currentUser, organization, userOrganizations)\n  );\n}\n\nexport function isCurrentUserMemberOf(\n  currentUser: T.CurrentUser,\n  organization: T.Organization | undefined,\n  userOrganizations: T.Organization[]\n): boolean {\n  return Boolean(\n    organization &&\n      isLoggedIn(currentUser) &&\n      ((organization.actions && organization.actions.admin) ||\n        userOrganizations.some(org => org.key === organization.key))\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport MultiSelect from '../common/MultiSelect';\nimport './TagsList.css';\n\ninterface Props {\n  listSize: number;\n  onSearch: (query: string) => Promise<void>;\n  onSelect: (item: string) => void;\n  onUnselect: (item: string) => void;\n  selectedTags: string[];\n  tags: string[];\n}\n\nexport default function TagsSelector(props: Props) {\n  return (\n    <MultiSelect\n      elements={props.tags}\n      listSize={props.listSize}\n      onSearch={props.onSearch}\n      onSelect={props.onSelect}\n      onUnselect={props.onUnselect}\n      placeholder={translate('search.search_for_tags')}\n      selectedElements={props.selectedTags}\n      validateSearchInput={validateTag}\n    />\n  );\n}\n\nexport function validateTag(value: string) {\n  // Allow only a-z, 0-9, '+', '-', '#', '.'\n  return value.toLowerCase().replace(/[^-a-z0-9+#.]/gi, '');\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as addMonths from 'date-fns/add_months';\nimport * as setMonth from 'date-fns/set_month';\nimport * as setYear from 'date-fns/set_year';\nimport * as subMonths from 'date-fns/sub_months';\nimport { range } from 'lodash';\nimport * as React from 'react';\nimport { DayModifiers, Modifier, Modifiers } from 'react-day-picker';\nimport { InjectedIntlProps, injectIntl } from 'react-intl';\nimport { ButtonIcon, ClearButton } from 'sonar-ui-common/components/controls/buttons';\nimport OutsideClickHandler from 'sonar-ui-common/components/controls/OutsideClickHandler';\nimport Select from 'sonar-ui-common/components/controls/Select';\nimport CalendarIcon from 'sonar-ui-common/components/icons/CalendarIcon';\nimport ChevronLeftIcon from 'sonar-ui-common/components/icons/ChevronLeftIcon';\nimport ChevronRightIcon from 'sonar-ui-common/components/icons/ChevronRightIcon';\nimport { lazyLoadComponent } from 'sonar-ui-common/components/lazyLoadComponent';\nimport {\n  getShortMonthName,\n  getShortWeekDayName,\n  getWeekDayName\n} from 'sonar-ui-common/helpers/l10n';\nimport './DayPicker.css';\nimport './styles.css';\n\nconst DayPicker = lazyLoadComponent(() => import('react-day-picker'), 'DayPicker');\n\ninterface Props {\n  className?: string;\n  currentMonth?: Date;\n  highlightFrom?: Date;\n  highlightTo?: Date;\n  inputClassName?: string;\n  maxDate?: Date;\n  minDate?: Date;\n  name?: string;\n  onChange: (date: Date | undefined) => void;\n  placeholder: string;\n  value?: Date;\n}\n\ninterface State {\n  currentMonth: Date;\n  open: boolean;\n  lastHovered?: Date;\n}\n\ntype Week = [string, string, string, string, string, string, string];\n\nexport default class DateInput extends React.PureComponent<Props, State> {\n  input?: HTMLInputElement | null;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = { currentMonth: props.value || props.currentMonth || new Date(), open: false };\n  }\n\n  focus = () => {\n    if (this.input) {\n      this.input.focus();\n    }\n    this.openCalendar();\n  };\n\n  handleResetClick = () => {\n    this.closeCalendar();\n    this.props.onChange(undefined);\n  };\n\n  openCalendar = () => {\n    this.setState({\n      currentMonth: this.props.value || this.props.currentMonth || new Date(),\n      lastHovered: undefined,\n      open: true\n    });\n  };\n\n  closeCalendar = () => {\n    this.setState({ open: false });\n  };\n\n  handleDayClick = (day: Date, modifiers: DayModifiers) => {\n    if (!modifiers.disabled) {\n      this.closeCalendar();\n      this.props.onChange(day);\n    }\n  };\n\n  handleDayMouseEnter = (day: Date, modifiers: DayModifiers) => {\n    this.setState({ lastHovered: modifiers.disabled ? undefined : day });\n  };\n\n  handleCurrentMonthChange = ({ value }: { value: number }) => {\n    this.setState((state: State) => ({ currentMonth: setMonth(state.currentMonth, value) }));\n  };\n\n  handleCurrentYearChange = ({ value }: { value: number }) => {\n    this.setState(state => ({ currentMonth: setYear(state.currentMonth, value) }));\n  };\n\n  handlePreviousMonthClick = () => {\n    this.setState(state => ({ currentMonth: subMonths(state.currentMonth, 1) }));\n  };\n\n  handleNextMonthClick = () => {\n    this.setState(state => ({ currentMonth: addMonths(state.currentMonth, 1) }));\n  };\n\n  render() {\n    const { highlightFrom, highlightTo, minDate, value } = this.props;\n    const { lastHovered } = this.state;\n\n    const after = this.props.maxDate || new Date();\n\n    const months = range(12);\n    const years = range(new Date().getFullYear() - 10, new Date().getFullYear() + 1);\n\n    const selectedDays: Modifier[] = value ? [value] : [];\n    let modifiers: Partial<Modifiers> | undefined;\n    const lastHoveredOrValue = lastHovered || value;\n\n    if (highlightFrom && lastHoveredOrValue) {\n      modifiers = { highlighted: { from: highlightFrom, to: lastHoveredOrValue } };\n      selectedDays.push(highlightFrom);\n    }\n    if (highlightTo && lastHoveredOrValue) {\n      modifiers = { highlighted: { from: lastHoveredOrValue, to: highlightTo } };\n      selectedDays.push(highlightTo);\n    }\n\n    const weekdaysLong = range(7).map(getWeekDayName) as Week;\n    const weekdaysShort = range(7).map(getShortWeekDayName) as Week;\n\n    return (\n      <OutsideClickHandler onClickOutside={this.closeCalendar}>\n        <span className={classNames('date-input-control', this.props.className)}>\n          <InputWrapper\n            className={classNames('date-input-control-input', this.props.inputClassName, {\n              'is-filled': this.props.value !== undefined\n            })}\n            innerRef={node => (this.input = node)}\n            name={this.props.name}\n            onFocus={this.openCalendar}\n            placeholder={this.props.placeholder}\n            readOnly={true}\n            type=\"text\"\n            value={value}\n          />\n          <CalendarIcon className=\"date-input-control-icon\" fill=\"\" />\n          {this.props.value !== undefined && (\n            <ClearButton\n              className=\"button-tiny date-input-control-reset\"\n              iconProps={{ size: 12 }}\n              onClick={this.handleResetClick}\n            />\n          )}\n          {this.state.open && (\n            <div className=\"date-input-calendar\">\n              <nav className=\"date-input-calendar-nav\">\n                <ButtonIcon className=\"button-small\" onClick={this.handlePreviousMonthClick}>\n                  <ChevronLeftIcon />\n                </ButtonIcon>\n                <div className=\"date-input-calender-month\">\n                  <Select\n                    className=\"date-input-calender-month-select\"\n                    onChange={this.handleCurrentMonthChange}\n                    options={months.map(month => ({\n                      label: getShortMonthName(month),\n                      value: month\n                    }))}\n                    value={this.state.currentMonth.getMonth()}\n                  />\n                  <Select\n                    className=\"date-input-calender-month-select spacer-left\"\n                    onChange={this.handleCurrentYearChange}\n                    options={years.map(year => ({ label: String(year), value: year }))}\n                    value={this.state.currentMonth.getFullYear()}\n                  />\n                </div>\n                <ButtonIcon className=\"button-small\" onClick={this.handleNextMonthClick}>\n                  <ChevronRightIcon />\n                </ButtonIcon>\n              </nav>\n              <DayPicker\n                captionElement={<NullComponent />}\n                disabledDays={{ after, before: minDate }}\n                firstDayOfWeek={1}\n                modifiers={modifiers}\n                month={this.state.currentMonth}\n                navbarElement={<NullComponent />}\n                onDayClick={this.handleDayClick}\n                onDayMouseEnter={this.handleDayMouseEnter}\n                selectedDays={selectedDays}\n                weekdaysLong={weekdaysLong}\n                weekdaysShort={weekdaysShort}\n              />\n            </div>\n          )}\n        </span>\n      </OutsideClickHandler>\n    );\n  }\n}\n\nfunction NullComponent() {\n  return null;\n}\n\ntype InputWrapperProps = T.Omit<React.InputHTMLAttributes<HTMLInputElement>, 'value'> &\n  InjectedIntlProps & {\n    innerRef: React.Ref<HTMLInputElement>;\n    value: Date | undefined;\n  };\n\nconst InputWrapper = injectIntl(({ innerRef, intl, value, ...other }: InputWrapperProps) => {\n  const formattedValue =\n    value && intl.formatDate(value, { year: 'numeric', month: 'short', day: 'numeric' });\n  return <input {...other} ref={innerRef} value={formattedValue || ''} />;\n});\n","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./DayPicker.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".DayPicker{display:inline-block}.DayPicker-wrapper{position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none;padding-bottom:8px;flex-direction:row}.DayPicker-Months{display:flex;flex-wrap:wrap;justify-content:center}.DayPicker-Month{display:table;border-collapse:collapse;border-spacing:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;margin:8px 8px 0}.DayPicker-Weekdays{display:table-header-group}.DayPicker-WeekdaysRow{display:table-row}.DayPicker-Weekday{display:table-cell;padding:8px;font-size:12px;text-align:center;color:#999}.DayPicker-Weekday abbr[title]{border-bottom:none;text-decoration:none}.DayPicker-Body{display:table-row-group}.DayPicker-Week{display:table-row}.DayPicker-Day{display:table-cell;line-height:15px;padding:8px;text-align:center;cursor:pointer;vertical-align:top;outline:none}.DayPicker--interactionDisabled .DayPicker-Day{cursor:default}.DayPicker-Footer{padding-top:8px}.DayPicker-Day--today{font-weight:700}.DayPicker-Day--outside{cursor:default;color:#8b9898}.DayPicker-Day--disabled{color:#cdcdcd;cursor:not-allowed}.DayPicker-Day--sunday{background-color:#f7f8f8}.DayPicker-Day--sunday:not(.DayPicker-Day--today){color:#dce0e0}.DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside){background-color:#4b9fd5;color:#fff}.DayPicker:not(.DayPicker--interactionDisabled) .DayPicker-Day:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--highlighted):not(.DayPicker-Day--outside):hover{background-color:#f3f3f3}.DayPicker-Day--highlighted:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--outside){background-color:#cae3f2}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".date-input-control{position:relative;display:inline-block;cursor:pointer}.date-input-control-input{width:130px;padding-left:24px!important;cursor:pointer}.date-input-control-input.is-filled{padding-right:16px!important}.date-input-control-icon{position:absolute;top:4px;left:4px}.date-input-control-icon path{fill:#cdcdcd;transition:fill .3s ease}.date-input-control-input:focus+.date-input-control-icon path{fill:#4b9fd5}.date-input-control-reset{position:absolute;top:4px;right:4px;border:none}.date-input-calendar{position:absolute;z-index:7500;top:100%;left:0;border:1px solid #e6e6e6;background-color:#fff;box-shadow:0 6px 12px rgba(0,0,0,.175)}.date-input-calendar-nav{display:flex;justify-content:space-between;align-items:center;padding-top:8px;padding-left:8px;padding-right:8px}.date-input-calender-month-select{width:70px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var api = require(\"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../node_modules/postcss-loader/src/index.js??postcss!./search-navigator.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".search-navigator.sticky .search-navigator-workspace-header{position:fixed;z-index:50;top:0;left:300px;right:0}.search-navigator.sticky .search-navigator-workspace-details,.search-navigator.sticky .search-navigator-workspace-list{padding-top:43px}.search-navigator-facet-box{background-color:#f3f3f3;font-size:13px}.search-navigator-facet-box.leak-facet-box{background-color:#fbf3d5;border:1px solid #f1e8cb}.search-navigator-facet-box.is-inner{margin-left:8px;padding-left:12px;border-left:1px solid #e6e6e6}.search-navigator-facet-box.is-inner .search-navigator-facet-header{padding-top:6px;padding-bottom:6px}.leak-facet-box:not(.hidden)+.leak-facet-box{border-top:none}.search-navigator-facet-box-forbidden{background-color:transparent;opacity:.5}.search-navigator-facet-box-forbidden .search-navigator-facet-container,.search-navigator-facet-box-forbidden .search-navigator-facet-empty,.search-navigator-facet-box-forbidden .search-navigator-facet-list{display:none}.search-navigator-facet-box-forbidden .search-navigator-facet-header{color:#777}.search-navigator-facet-box-forbidden .search-navigator-facet-header:hover{color:#4b9fd5}.search-navigator-facet-box-forbidden .search-navigator-facet-header{cursor:default}.search-navigator-facet-box-forbidden .search-navigator-facet-header:hover{color:#777}.search-navigator-facet{position:relative;display:inline-flex;justify-content:space-between;align-items:center;width:100%;height:24px;margin:0 0 1px;padding:0 6px;border:1px solid transparent;border-radius:2px;box-sizing:border-box;white-space:normal;opacity:.3;cursor:not-allowed;transition:none}a.search-navigator-facet{opacity:1;cursor:pointer}a.search-navigator-facet .facet-name{color:#444}.search-navigator-facet.active,a.search-navigator-facet:focus,a.search-navigator-facet:hover{border-color:#4b9fd5}.search-navigator-facet.facet-category{opacity:1;cursor:default}.search-navigator-facet.facet-category .facet-name{color:#777}.search-navigator-facet .facet-name{flex:1 1 auto;min-width:0;line-height:16px;padding:1px 0;color:#777;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.search-navigator-facet .facet-stat{display:flex;align-items:center;margin-left:8px;color:#777;font-size:12px}.search-navigator-facet .facet-toggle{display:none;float:left;height:16px;line-height:16px;margin-top:-1px;padding:0 5px;border-radius:2px;font-size:11px;text-transform:lowercase}.search-navigator-facet .facet-toggle:hover{color:#444}.search-navigator-facet .facet-toggle-active.facet-toggle-green{background-color:#0a0;color:#fff}.search-navigator-facet .facet-toggle-active.facet-toggle-red{background-color:#d4333f;color:#fff}.leak-facet-box .search-navigator-facet .facet-name,.leak-facet-box .search-navigator-facet .facet-stat{background-color:#fbf3d5}.leak-facet-box .search-navigator-facet .facet-stat:before{background-image:linear-gradient(90deg,rgba(251,243,213,0),#fbf3d5 75%)}.search-navigator-facet.active{background-color:#cae3f2;text-decoration:none}.search-navigator-facet.active .facet-toggle{display:inline}.search-navigator-facet.compare .facet-toggle{cursor:not-allowed;opacity:.5}.search-navigator-facet.compare .facet-toggle.facet-toggle-green{background-color:#0a0;color:#fff}.search-navigator-facet.compare .facet-toggle.facet-toggle-red{background-color:transparent;color:#777}.search-navigator-facet-half{width:45%}.search-navigator-facet-half:nth-child(odd){margin-right:10%}.search-navigator-facet-highlight-under-container{margin-bottom:1px}.search-navigator-facet-highlight-under-container .search-navigator-facet{margin-bottom:0}.search-navigator-facet-highlight-under-container .search-navigator-facet.active,.search-navigator-facet-highlight-under-container .search-navigator-facet:hover{border-bottom:none;padding-bottom:1px;border-radius:2px 2px 0 0}.search-navigator-facet-highlight-under-container .search-navigator-facet.active~.search-navigator-facet,.search-navigator-facet-highlight-under-container .search-navigator-facet:hover~.search-navigator-facet{border-top:none;border-bottom:none;border-left-color:#4b9fd5;border-right-color:#4b9fd5;border-radius:0}.search-navigator-facet-highlight-under-container .search-navigator-facet.active~.search-navigator-facet:last-of-type,.search-navigator-facet-highlight-under-container .search-navigator-facet:hover~.search-navigator-facet:last-of-type{border-bottom:1px solid #4b9fd5;border-radius:0 0 2px 2px}.search-navigator-facet-highlight-under-container .search-navigator-facet.active:last-of-type,.search-navigator-facet-highlight-under-container .search-navigator-facet:hover:last-of-type{border-bottom:1px solid #4b9fd5;border-radius:2px}.search-navigator-facet-highlight-under-container .search-navigator-facet.active~.search-navigator-facet{background-color:#cae3f2;text-decoration:none}.search-navigator-facet-highlight-under-container .search-navigator-facet.active~.search-navigator-facet .facet-toggle{display:inline}.search-navigator-facet-highlight-under-container .search-navigator-facet.active~.search-navigator-facet:hover,.search-navigator-facet-highlight-under-container .search-navigator-facet:hover~.search-navigator-facet.active{border-top:1px solid #4b9fd5}.search-navigator-facet-highlight-under-container .search-navigator-facet.active~.search-navigator-facet:hover,.search-navigator-facet-highlight-under-container .search-navigator-facet.active~.search-navigator-facet:hover~.search-navigator-facet{background-color:#a1cde8;text-decoration:none}.search-navigator-facet-highlight-under-container .search-navigator-facet.active~.search-navigator-facet:hover .facet-toggle,.search-navigator-facet-highlight-under-container .search-navigator-facet.active~.search-navigator-facet:hover~.search-navigator-facet .facet-toggle{display:inline}.search-navigator-facet-header{display:block;flex-shrink:0;padding:8px 0;color:#444;font-weight:600;overflow:hidden;white-space:nowrap}.search-navigator-facet-header>a{border-bottom:none;color:#444}.search-navigator-facet-header>a:focus,.search-navigator-facet-header>a:hover{color:#4b9fd5}.search-navigator-facet-header>.note{font-weight:400}.search-navigator-facet-header-value{display:block;overflow:hidden}.search-navigator-facet-header-value>.badge{display:block}.search-navigator-facet-header-button{flex-shrink:0;margin-left:auto}.search-navigator-facet-header-wrapper{display:flex;align-items:center}.search-navigator-facet-list{padding-bottom:8px;font-size:0}.search-navigator-facet-list-title{margin:0 8px 4px;font-size:12px;font-weight:700}.search-navigator-facet-list+.search-navigator-facet-list>.search-navigator-facet-list-title{border-top:1px solid #e6e6e6;padding-top:8px}.search-navigator-facet-empty{margin:0;padding:0 10px 10px;color:#444;font-size:12px;white-space:nowrap}.search-navigator-facet-footer{display:block;padding-bottom:8px;border-bottom:none}.search-navigator-facet-container{margin-top:6px;padding:0 10px 16px}.search-navigator-date-facet-selection{position:relative;padding-left:8px;font-size:12px}.search-navigator-date-facet-selection:after,.search-navigator-date-facet-selection:before{display:table;content:\\\"\\\";line-height:0}.search-navigator-date-facet-selection:after{clear:both}.search-navigator-date-facet-selection .date-input-control-input{width:115px!important}.search-navigator-date-facet-selection-dropdown-left{float:left;border-bottom:none}.search-navigator-date-facet-selection-dropdown-right{float:right;border-bottom:none}.search-navigator-date-facet-selection-input-left{position:absolute;left:0;width:100px;visibility:hidden}.search-navigator-date-facet-selection-input-right{position:absolute;right:0;width:100px;visibility:hidden}.search-navigator-date-facet-selection .date-input-control:not(:first-of-type) .date-input-calendar{left:auto;right:0}.search-navigator-filters{position:relative;padding:5px 10px;background-color:#f3f3f3}.search-navigator-filters:after,.search-navigator-filters:before{display:table;content:\\\"\\\";line-height:0}.search-navigator-filters:after{clear:both}.search-navigator-filters-header{margin-bottom:12px;padding-bottom:11px;border-bottom:1px solid #e6e6e6}.search-navigator-intro{width:500px;margin:0 auto;padding-top:100px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport './MultipleSelectionHint.css';\n\ninterface Props {\n  options: number;\n  values: number;\n}\n\nexport default function MultipleSelectionHint({ options, values }: Props) {\n  // do not render if nothing is selected or there are less than 2 possible options\n  if (values === 0 || options < 2) {\n    return null;\n  }\n\n  return (\n    <div className=\"multiple-selection-hint\">\n      <div className=\"multiple-selection-hint-inner\">\n        {translate(\n          isOnMac()\n            ? 'shortcuts.section.global.facets.multiselection.mac'\n            : 'shortcuts.section.global.facets.multiselection'\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction isOnMac() {\n  return navigator.userAgent.indexOf('Mac OS X') !== -1;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nexport function getStandards(): Promise<T.Standards> {\n  return import('./standards.json').then(x => x.default);\n}\n\nexport function renderCWECategory(standards: T.Standards, category: string): string {\n  const record = standards.cwe[category];\n  if (!record) {\n    return `CWE-${category}`;\n  } else if (category === 'unknown') {\n    return record.title;\n  } else {\n    return `CWE-${category} - ${record.title}`;\n  }\n}\n\nexport function renderOwaspTop10Category(\n  standards: T.Standards,\n  category: string,\n  withPrefix = false\n): string {\n  const record = standards.owaspTop10[category];\n  if (!record) {\n    return addPrefix(category.toUpperCase(), 'OWASP', withPrefix);\n  } else {\n    return addPrefix(`${category.toUpperCase()} - ${record.title}`, 'OWASP', withPrefix);\n  }\n}\n\nexport function renderSansTop25Category(\n  standards: T.Standards,\n  category: string,\n  withPrefix = false\n): string {\n  const record = standards.sansTop25[category];\n  return addPrefix(record ? record.title : category, 'SANS', withPrefix);\n}\n\nexport function renderSonarSourceSecurityCategory(\n  standards: T.Standards,\n  category: string,\n  withPrefix = false\n): string {\n  const record = standards.sonarsourceSecurity[category];\n  if (!record) {\n    return addPrefix(category.toUpperCase(), 'SONAR', withPrefix);\n  } else if (category === 'others') {\n    return record.title;\n  } else {\n    return addPrefix(record.title, 'SONAR', withPrefix);\n  }\n}\n\nfunction addPrefix(title: string, prefix: string, withPrefix: boolean) {\n  return withPrefix ? `${prefix} ${title}` : title;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport DocTooltip from '../../../components/docs/DocTooltip';\n\ninterface Props {\n  className?: string;\n  tooltip?: boolean;\n}\n\nexport default function BuiltInQualityProfileBadge({ className, tooltip = true }: Props) {\n  const badge = (\n    <div className={classNames('badge badge-info', className)}>\n      {translate('quality_profiles.built_in')}\n    </div>\n  );\n\n  if (tooltip) {\n    return (\n      <DocTooltip\n        doc={import(\n          /* webpackMode: \"eager\" */ 'Docs/tooltips/quality-profiles/built-in-quality-profile.md'\n        )}>\n        {badge}\n      </DocTooltip>\n    );\n  }\n  return badge;\n}\n","export default \"Built-in profiles are provided directly by the language analyzers and may be updated with each new analyzer version. They represent best-practice, minimum rule sets.\\n\"","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Dropdown from 'sonar-ui-common/components/controls/Dropdown';\nimport DropdownIcon from 'sonar-ui-common/components/icons/DropdownIcon';\nimport FilterIcon from 'sonar-ui-common/components/icons/FilterIcon';\nimport IssueTypeIcon from 'sonar-ui-common/components/icons/IssueTypeIcon';\nimport TagsIcon from 'sonar-ui-common/components/icons/TagsIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport { Query } from '../query';\n\ninterface Props {\n  onFilterChange: (changes: Partial<Query>) => void;\n  rule: T.Rule;\n}\n\nexport default class SimilarRulesFilter extends React.PureComponent<Props> {\n  handleLanguageClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    if (this.props.rule.lang) {\n      this.props.onFilterChange({ languages: [this.props.rule.lang] });\n    }\n  };\n\n  handleTypeClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.props.onFilterChange({ types: [this.props.rule.type] });\n  };\n\n  handleSeverityClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    if (this.props.rule.severity) {\n      this.props.onFilterChange({ severities: [this.props.rule.severity] });\n    }\n  };\n\n  handleTagClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { tag } = event.currentTarget.dataset;\n    if (tag) {\n      this.props.onFilterChange({ tags: [tag] });\n    }\n  };\n\n  render() {\n    const { rule } = this.props;\n    const { tags = [], sysTags = [], severity } = rule;\n    const allTags = [...tags, ...sysTags];\n\n    return (\n      <Dropdown\n        className=\"display-inline-block\"\n        overlay={\n          <>\n            <ul className=\"menu\">\n              <li className=\"menu-header\">{translate('coding_rules.filter_similar_rules')}</li>\n              <li>\n                <a\n                  data-test=\"coding-rules__similar-language\"\n                  href=\"#\"\n                  onClick={this.handleLanguageClick}>\n                  {rule.langName}\n                </a>\n              </li>\n\n              <li>\n                <a\n                  className=\"display-flex-center\"\n                  data-test=\"coding-rules__similar-type\"\n                  href=\"#\"\n                  onClick={this.handleTypeClick}>\n                  <IssueTypeIcon query={rule.type} />\n                  <span className=\"little-spacer-left\">{translate('issue.type', rule.type)}</span>\n                </a>\n              </li>\n\n              {severity && (\n                <li>\n                  <a\n                    data-test=\"coding-rules__similar-severity\"\n                    href=\"#\"\n                    onClick={this.handleSeverityClick}>\n                    <SeverityHelper className=\"display-flex-center\" severity={rule.severity} />\n                  </a>\n                </li>\n              )}\n\n              {allTags.length > 0 && <li className=\"divider\" />}\n              {allTags.map(tag => (\n                <li key={tag}>\n                  <a\n                    data-tag={tag}\n                    data-test=\"coding-rules__similar-tag\"\n                    href=\"#\"\n                    onClick={this.handleTagClick}>\n                    <TagsIcon className=\"icon-half-transparent little-spacer-right text-middle\" />\n                    <span className=\"text-middle\">{tag}</span>\n                  </a>\n                </li>\n              ))}\n            </ul>\n          </>\n        }>\n        <a\n          className=\"js-rule-filter link-no-underline spacer-left dropdown-toggle\"\n          href=\"#\"\n          title={translate('coding_rules.filter_similar_rules')}>\n          <FilterIcon className=\"icon-half-transparent\" />\n          <DropdownIcon className=\"icon-half-transparent\" />\n        </a>\n      </Dropdown>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  displayReset: boolean;\n  onReset: () => void;\n}\n\nexport default function FiltersHeader({ displayReset, onReset }: Props) {\n  return (\n    <div className=\"search-navigator-filters-header\">\n      {displayReset && (\n        <div className=\"pull-right\">\n          <Button className=\"button-red\" id=\"coding-rules-clear-all-filters\" onClick={onReset}>\n            {translate('clear_all_filters')}\n          </Button>\n        </div>\n      )}\n\n      <h3>{translate('filters')}</h3>\n    </div>\n  );\n}\n","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".coding-rules-extended-view .coding-rules-list{display:none}.coding-rules-extended-view .coding-rules-details{display:block}.coding-rules-detail-title{position:relative;display:inline-block;margin:16px 0;font-size:16px;font-weight:400}.coding-rules-detail-quality-profile-parameter{display:block;height:100%;padding-top:0;padding-right:10px}.coding-rules-detail-quality-profile-parameter .key,.coding-rules-detail-quality-profile-parameter .sep,.coding-rules-detail-quality-profile-parameter .value{display:inline;vertical-align:top}.coding-rules-detail-quality-profile-parameter .value{display:inline-block;vertical-align:top;line-height:23px;max-width:300px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-family:Consolas,Liberation Mono,Menlo,Courier,monospace}.coding-rules-detail-quality-profile-parameter+.coding-rules-detail-quality-profile-parameter{margin-top:0}.coding-rules-detail-properties{display:flex;flex-wrap:wrap;align-items:center;margin-top:8px}.coding-rules-detail-properties+.coding-rules-detail-properties{margin-top:-10px}.coding-rules-detail-property{display:flex;align-items:center;margin-right:16px;margin-bottom:8px;font-size:12px}.coding-rules-detail-tag+.coding-rules-detail-tag{margin-left:10px}.coding-rules-detail-tags-change{cursor:pointer}.coding-rules-detail-tags-change:hover span{text-decoration:underline}.coding-rules-detail-tag-edit{line-height:1}.coding-rules-details-tag-edit-cancel{vertical-align:middle}.coding-rules-detail-description{margin:20px 0}.coding-rules-detail-description-extra{margin-top:-10px}.coding-rules-detail-extend-description-form{margin:10px 0}.coding-rules-detail-parameters{width:100%;margin:10px 0 20px}.coding-rules-detail-parameter-name{width:1px;vertical-align:top;padding:5px 10px 5px 0;font-weight:700}.coding-rules-detail-parameter-description{vertical-align:top;padding:5px}.coding-rules-detail-parameter-value{font-family:Consolas,Liberation Mono,Menlo,Courier,monospace;word-break:break-all}.coding-rules-detail-list,.coding-rules-detail-quality-profiles{width:100%;line-height:22px}.coding-rules-detail-list td,.coding-rules-detail-quality-profiles td{border-top:1px solid #e6e6e6}.coding-rules-detail-list tr:first-child td,.coding-rules-detail-quality-profiles tr:first-child td{border-top:none}.coding-rules-detail-list-name,.coding-rules-detail-quality-profile-name{vertical-align:top;width:1px;padding:8px 5px 8px 0;font-weight:600;white-space:nowrap}.coding-rules-detail-list-severity,.coding-rules-detail-quality-profile-severity{vertical-align:top;width:1px;padding:8px 5px;white-space:nowrap}.coding-rules-detail-quality-profile-severity i{margin-top:2px}.coding-rules-detail-list-parameters,.coding-rules-detail-quality-profile-parameters{vertical-align:top;padding:8px 5px}.coding-rules-detail-list-actions,.coding-rules-detail-quality-profile-actions{vertical-align:top;width:1px;padding:8px 0 8px 5px;text-align:right;white-space:nowrap}.coding-rules-detail-quality-profile-inheritance{font-size:12px;font-weight:400}.coding-rules-detail-quality-profiles-activation{margin-top:-3px;margin-left:10px}.coding-rules-most-violated-projects td{border-top-color:transparent}.coding-rules-most-violated-projects tr:first-child+tr td{border-top-color:#e6e6e6}.coding-rules-most-violated-projects .coding-rules-detail-list-name{font-weight:400}.coding-rule{padding:8px 10px 8px 8px;border:1px solid transparent;background-color:#fff}.coding-rule.selected{border-color:#4b9fd5!important}.coding-rule+.coding-rule{border-top-color:#e6e6e6}.coding-rule.selected+.coding-rule{border-top-color:transparent}.coding-rule-table{width:100%}.coding-rule-table td{vertical-align:top}.coding-rule-table+.coding-rule-table{margin-top:5px}.coding-rule-table-meta-cell{width:1px;white-space:nowrap}@media (max-width:1320px){.coding-rule-table .tags-list span{max-width:100px}}.coding-rule-title{line-height:20px;font-size:13px}.coding-rule-meta{padding:2px 2px 2px 30px;font-size:12px}.coding-rule-activation{width:40px;line-height:19.5px}.coding-rule-activation-actions{padding-left:20px}.coding-rule-section-separator{height:0;margin:10px 0;border-top:1px solid #e6e6e6}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { omit, sortBy, without } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { highlightTerm } from 'sonar-ui-common/helpers/search';\nimport FacetBox from '../../../components/facet/FacetBox';\nimport FacetHeader from '../../../components/facet/FacetHeader';\nimport FacetItem from '../../../components/facet/FacetItem';\nimport FacetItemsList from '../../../components/facet/FacetItemsList';\nimport ListStyleFacet from '../../../components/facet/ListStyleFacet';\nimport MultipleSelectionHint from '../../../components/facet/MultipleSelectionHint';\nimport {\n  getStandards,\n  renderCWECategory,\n  renderOwaspTop10Category,\n  renderSansTop25Category,\n  renderSonarSourceSecurityCategory\n} from '../../../helpers/security-standard';\nimport { Facet, formatFacetStat, Query, STANDARDS } from '../utils';\n\ninterface Props {\n  cwe: string[];\n  cweOpen: boolean;\n  cweStats: T.Dict<number> | undefined;\n  fetchingCwe: boolean;\n  fetchingOwaspTop10: boolean;\n  fetchingSansTop25: boolean;\n  fetchingSonarSourceSecurity: boolean;\n  loadSearchResultCount?: (property: string, changes: Partial<Query>) => Promise<Facet>;\n  onChange: (changes: Partial<Query>) => void;\n  onToggle: (property: string) => void;\n  open: boolean;\n  owaspTop10: string[];\n  owaspTop10Open: boolean;\n  owaspTop10Stats: T.Dict<number> | undefined;\n  query: Partial<Query>;\n  sansTop25: string[];\n  sansTop25Open: boolean;\n  sansTop25Stats: T.Dict<number> | undefined;\n  sonarsourceSecurity: string[];\n  sonarsourceSecurityOpen: boolean;\n  sonarsourceSecurityStats: T.Dict<number> | undefined;\n}\n\ninterface State {\n  standards: T.Standards;\n}\n\ntype StatsProp = 'owaspTop10Stats' | 'cweStats' | 'sansTop25Stats' | 'sonarsourceSecurityStats';\ntype ValuesProp = T.StandardType;\n\nexport default class StandardFacet extends React.PureComponent<Props, State> {\n  mounted = false;\n  property = STANDARDS;\n  state: State = {\n    standards: { owaspTop10: {}, sansTop25: {}, cwe: {}, sonarsourceSecurity: {} }\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n\n    // load standards.json only if the facet is open, or there is a selected value\n    if (\n      this.props.open ||\n      this.props.owaspTop10.length > 0 ||\n      this.props.cwe.length > 0 ||\n      this.props.sansTop25.length > 0 ||\n      this.props.sonarsourceSecurity.length > 0\n    ) {\n      this.loadStandards();\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (!prevProps.open && this.props.open) {\n      this.loadStandards();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadStandards = () => {\n    getStandards().then(\n      ({ owaspTop10, sansTop25, cwe, sonarsourceSecurity }: T.Standards) => {\n        if (this.mounted) {\n          this.setState({ standards: { owaspTop10, sansTop25, cwe, sonarsourceSecurity } });\n        }\n      },\n      () => {}\n    );\n  };\n\n  getValues = () => {\n    return [\n      ...this.props.sonarsourceSecurity.map(item =>\n        renderSonarSourceSecurityCategory(this.state.standards, item, true)\n      ),\n      ...this.props.owaspTop10.map(item =>\n        renderOwaspTop10Category(this.state.standards, item, true)\n      ),\n      ...this.props.sansTop25.map(item =>\n        renderSansTop25Category(this.state.standards, item, true)\n      ),\n      ...this.props.cwe.map(item => renderCWECategory(this.state.standards, item))\n    ];\n  };\n\n  handleHeaderClick = () => {\n    this.props.onToggle(this.property);\n  };\n\n  handleOwaspTop10HeaderClick = () => {\n    this.props.onToggle('owaspTop10');\n  };\n\n  handleSansTop25HeaderClick = () => {\n    this.props.onToggle('sansTop25');\n  };\n\n  handleSonarSourceSecurityHeaderClick = () => {\n    this.props.onToggle('sonarsourceSecurity');\n  };\n\n  handleClear = () => {\n    this.props.onChange({\n      [this.property]: [],\n      owaspTop10: [],\n      sansTop25: [],\n      cwe: [],\n      sonarsourceSecurity: []\n    });\n  };\n\n  handleItemClick = (prop: ValuesProp, itemValue: string, multiple: boolean) => {\n    const items = this.props[prop];\n    if (multiple) {\n      const newValue = sortBy(\n        items.includes(itemValue) ? without(items, itemValue) : [...items, itemValue]\n      );\n      this.props.onChange({ [prop]: newValue });\n    } else {\n      this.props.onChange({\n        [prop]: items.includes(itemValue) && items.length < 2 ? [] : [itemValue]\n      });\n    }\n  };\n\n  handleOwaspTop10ItemClick = (itemValue: string, multiple: boolean) => {\n    this.handleItemClick('owaspTop10', itemValue, multiple);\n  };\n\n  handleSansTop25ItemClick = (itemValue: string, multiple: boolean) => {\n    this.handleItemClick('sansTop25', itemValue, multiple);\n  };\n\n  handleSonarSourceSecurityItemClick = (itemValue: string, multiple: boolean) => {\n    this.handleItemClick('sonarsourceSecurity', itemValue, multiple);\n  };\n\n  handleCWESearch = (query: string) => {\n    return Promise.resolve({\n      results: Object.keys(this.state.standards.cwe).filter(cwe =>\n        renderCWECategory(this.state.standards, cwe)\n          .toLowerCase()\n          .includes(query.toLowerCase())\n      )\n    });\n  };\n\n  loadCWESearchResultCount = (categories: string[]) => {\n    const { loadSearchResultCount } = this.props;\n    return loadSearchResultCount\n      ? loadSearchResultCount('cwe', { cwe: categories })\n      : Promise.resolve({});\n  };\n\n  renderList = (\n    statsProp: StatsProp,\n    valuesProp: ValuesProp,\n    renderName: (standards: T.Standards, category: string) => string,\n    onClick: (x: string, multiple?: boolean) => void\n  ) => {\n    const stats = this.props[statsProp];\n    const values = this.props[valuesProp];\n    if (!stats) {\n      return null;\n    }\n    const categories = sortBy(Object.keys(stats), key => -stats[key]);\n    return this.renderFacetItemsList(stats, values, categories, renderName, renderName, onClick);\n  };\n\n  // eslint-disable-next-line max-params\n  renderFacetItemsList = (\n    stats: any,\n    values: string[],\n    categories: string[],\n    renderName: (standards: T.Standards, category: string) => React.ReactNode,\n    renderTooltip: (standards: T.Standards, category: string) => string,\n    onClick: (x: string, multiple?: boolean) => void\n  ) => {\n    if (!categories.length) {\n      return (\n        <div className=\"search-navigator-facet-empty little-spacer-top\">\n          {translate('no_results')}\n        </div>\n      );\n    }\n\n    const getStat = (category: string) => {\n      return stats ? stats[category] : undefined;\n    };\n\n    return (\n      <FacetItemsList>\n        {categories.map(category => (\n          <FacetItem\n            active={values.includes(category)}\n            key={category}\n            name={renderName(this.state.standards, category)}\n            onClick={onClick}\n            stat={formatFacetStat(getStat(category))}\n            tooltip={renderTooltip(this.state.standards, category)}\n            value={category}\n          />\n        ))}\n      </FacetItemsList>\n    );\n  };\n\n  renderHint = (statsProp: StatsProp, valuesProp: ValuesProp) => {\n    const stats = this.props[statsProp] || {};\n    const values = this.props[valuesProp];\n    return <MultipleSelectionHint options={Object.keys(stats).length} values={values.length} />;\n  };\n\n  renderOwaspTop10List() {\n    return this.renderList(\n      'owaspTop10Stats',\n      'owaspTop10',\n      renderOwaspTop10Category,\n      this.handleOwaspTop10ItemClick\n    );\n  }\n\n  renderOwaspTop10Hint() {\n    return this.renderHint('owaspTop10Stats', 'owaspTop10');\n  }\n\n  renderSansTop25List() {\n    return this.renderList(\n      'sansTop25Stats',\n      'sansTop25',\n      renderSansTop25Category,\n      this.handleSansTop25ItemClick\n    );\n  }\n\n  renderSansTop25Hint() {\n    return this.renderHint('sansTop25Stats', 'sansTop25');\n  }\n\n  renderSonarSourceSecurityList() {\n    return this.renderList(\n      'sonarsourceSecurityStats',\n      'sonarsourceSecurity',\n      renderSonarSourceSecurityCategory,\n      this.handleSonarSourceSecurityItemClick\n    );\n  }\n\n  renderSonarSourceSecurityHint() {\n    return this.renderHint('sonarsourceSecurityStats', 'sonarsourceSecurity');\n  }\n\n  renderSubFacets() {\n    return (\n      <>\n        <FacetBox className=\"is-inner\" property=\"sonarsourceSecurity\">\n          <FacetHeader\n            fetching={this.props.fetchingSonarSourceSecurity}\n            name={translate('issues.facet.sonarsourceSecurity')}\n            onClick={this.handleSonarSourceSecurityHeaderClick}\n            open={this.props.sonarsourceSecurityOpen}\n            values={this.props.sonarsourceSecurity.map(item =>\n              renderSonarSourceSecurityCategory(this.state.standards, item)\n            )}\n          />\n          {this.props.sonarsourceSecurityOpen && (\n            <>\n              {this.renderSonarSourceSecurityList()}\n              {this.renderSonarSourceSecurityHint()}\n            </>\n          )}\n        </FacetBox>\n        <FacetBox className=\"is-inner\" property=\"owaspTop10\">\n          <FacetHeader\n            fetching={this.props.fetchingOwaspTop10}\n            name={translate('issues.facet.owaspTop10')}\n            onClick={this.handleOwaspTop10HeaderClick}\n            open={this.props.owaspTop10Open}\n            values={this.props.owaspTop10.map(item =>\n              renderOwaspTop10Category(this.state.standards, item)\n            )}\n          />\n          {this.props.owaspTop10Open && (\n            <>\n              {this.renderOwaspTop10List()}\n              {this.renderOwaspTop10Hint()}\n            </>\n          )}\n        </FacetBox>\n        <FacetBox className=\"is-inner\" property=\"sansTop25\">\n          <FacetHeader\n            fetching={this.props.fetchingSansTop25}\n            name={translate('issues.facet.sansTop25')}\n            onClick={this.handleSansTop25HeaderClick}\n            open={this.props.sansTop25Open}\n            values={this.props.sansTop25.map(item =>\n              renderSansTop25Category(this.state.standards, item)\n            )}\n          />\n          {this.props.sansTop25Open && (\n            <>\n              {this.renderSansTop25List()}\n              {this.renderSansTop25Hint()}\n            </>\n          )}\n        </FacetBox>\n        <ListStyleFacet<string>\n          className=\"is-inner\"\n          facetHeader={translate('issues.facet.cwe')}\n          fetching={this.props.fetchingCwe}\n          getFacetItemText={item => renderCWECategory(this.state.standards, item)}\n          getSearchResultKey={item => item}\n          getSearchResultText={item => renderCWECategory(this.state.standards, item)}\n          loadSearchResultCount={this.loadCWESearchResultCount}\n          onChange={this.props.onChange}\n          onSearch={this.handleCWESearch}\n          onToggle={this.props.onToggle}\n          open={this.props.cweOpen}\n          property=\"cwe\"\n          query={omit(this.props.query, 'cwe')}\n          renderFacetItem={item => renderCWECategory(this.state.standards, item)}\n          renderSearchResult={(item, query) =>\n            highlightTerm(renderCWECategory(this.state.standards, item), query)\n          }\n          searchPlaceholder={translate('search.search_for_cwe')}\n          stats={this.props.cweStats}\n          values={this.props.cwe}\n        />\n      </>\n    );\n  }\n\n  render() {\n    return (\n      <FacetBox property={this.property}>\n        <FacetHeader\n          name={translate('issues.facet', this.property)}\n          onClear={this.handleClear}\n          onClick={this.handleHeaderClick}\n          open={this.props.open}\n          values={this.getValues()}\n        />\n\n        {this.props.open && this.renderSubFacets()}\n      </FacetBox>\n    );\n  }\n}\n","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./MultipleSelectionHint.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".multiple-selection-hint{margin-top:8px;margin-bottom:8px;text-align:center}.multiple-selection-hint-inner{display:inline-block;height:24px;line-height:24px;border-radius:24px;background-color:#e6e6e6;text-align:center;padding:0 8px;font-size:12px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport { formatMeasure } from 'sonar-ui-common/helpers/measures';\n\ninterface Props {\n  className?: string;\n  current?: number;\n  label: string;\n  total: number;\n}\n\nexport default function PageCounter({ className, current, label, total }: Props) {\n  return (\n    <div className={classNames('display-inline-block', className)}>\n      <strong className=\"little-spacer-right\">\n        {current !== undefined && formatMeasure(current + 1, 'INT') + ' / '}\n        <span className=\"js-page-counter-total\">{formatMeasure(total, 'INT')}</span>\n      </strong>\n      {label}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport IssueTypeIcon from 'sonar-ui-common/components/icons/IssueTypeIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  className?: string;\n  type: T.IssueType | T.RuleType;\n}\n\nexport default function TypeHelper(props: Props) {\n  return (\n    <span className={props.className}>\n      <IssueTypeIcon className=\"little-spacer-right\" query={props.type} />\n      {translate('issue.type', props.type)}\n    </span>\n  );\n}\n","export default \"Custom rules are created by administrators from templates, and are the only fully-editable rules.\\n\""],"sourceRoot":""}