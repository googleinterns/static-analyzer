(window.webpackJsonp=window.webpackJsonp||[]).push([[320],{1088:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),r=n(317),o=n(807),i=n(319),s=n(337);function c(e){class t extends a.Component{componentDidMount(){this.props.fetchMyOrganizations()}render(){return a.createElement(e,Object.assign({},this.props))}}t.displayName=Object(s.a)(e,"withUserOrganizations");const n={fetchMyOrganizations:o.b};return Object(r.connect)((function(e){return{userOrganizations:Object(i.getMyOrganizations)(e)}}),n)(t)}},1253:function(e,t,n){var a=n(311),r=n(1799);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=(a(r,o),r.locals?r.locals:{});e.exports=i},1797:function(e,t,n){var a=n(311),r=n(1798);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=(a(r,o),r.locals?r.locals:{});e.exports=i},1798:function(e,t,n){(t=n(312)(!1)).push([e.i,".manual-project-create{max-width:700px}.manual-project-create .button{margin-top:8px}",""]),e.exports=t},1799:function(e,t,n){(t=n(312)(!1)).push([e.i,"#create-project{padding-top:0!important}#create-project header{padding-top:20px}.white-page #create-project header{background-color:#fff;position:-webkit-sticky;position:sticky;top:48px;z-index:50}.create-project{display:flex!important;justify-content:space-between}.create-project-repository{display:flex;align-items:center;min-width:500px;height:40px;border:1px solid #e6e6e6;padding:8px 16px;margin-bottom:8px;box-sizing:border-box;cursor:pointer;transition:all .3s ease}.create-project-repository.disabled{background-color:#ebebeb;border-color:#ddd;cursor:default}.create-project-repository.imported{cursor:default}.create-project-repository.selected{background-color:#cae3f2;border-color:#236a97}.create-project-repository:not(.imported):not(.disabled):active,.create-project-repository:not(.imported):not(.disabled):focus,.create-project-repository:not(.imported):not(.disabled):hover{border-color:#4b9fd5;box-shadow:none}.create-project-side-with-search{margin-top:32px}.create-project-side-sticky{position:-webkit-sticky;position:sticky;top:68px}.create-project-setup{display:flex;overflow:hidden;opacity:0;flex-direction:column;height:0;width:450px;margin-bottom:0;color:#fff;background-color:#0b3c62;border:none;border-radius:3px;transition:height .5s ease,opacity .4s ease-out,margin-bottom .5s ease-in}.create-project-setup.open{opacity:1;height:160px;margin-bottom:20px}.create-project-setup h2{color:#fff;font-weight:700;font-size:16px}.create-project-setup .boxed-group-inner{display:flex;flex-direction:column;flex-grow:1}.create-project-setup .button{border-color:#4c9bd6;background-color:#4c9bd6;color:#fff;transition:border-color .2s ease,box-shadow .2s ease,background-color .2s ease}.create-project-setup .button:focus,.create-project-setup .button:hover{border-color:#327bb3;background-color:#327bb3}.create-project-actions{min-width:500px;display:flex;justify-content:space-between;align-items:center;padding:8px 0 8px 16px;border-left:1px solid transparent}.create-project-actions .icon-checkbox{margin-right:8px}.create-project-modes{margin:0 auto;max-width:500px}.create-project-import-bbs .open .boxed-group-header{border-bottom:1px solid #e6e6e6}.create-project-import-bbs .boxed-group-inner{padding-top:24px}.create-project-import-bbs-repo{width:250px;min-height:40px}",""]),e.exports=t},1876:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return et}));var a=n(2),r=n(350),o=n(22),i=n(328),s=n(317),c=n(1794),l=n.n(c),p=n(316),d=n.n(p),u=n(5),m=n(415),h=n(782),g=n(588),b=n(1088),j=n(416),f=n(320),O=n(518),y=n(779),_=n.n(y),v=n(30),k=n(577),E=n(314),S=n(326),P=n.n(S),N=n(340),x=n.n(N),z=n(336);function C({hideIcons:e,onChange:t,organization:n,organizations:r}){const o=function(e){return function(t){const n=t.alm?"sonarcloud/".concat(Object(j.g)(t.alm.key)):"sonarcloud-square-logo",r="PAID"===t.subscription;return a.createElement("div",{className:"display-flex-space-between"},a.createElement("span",{className:"text-ellipsis flex-1"},!e&&a.createElement("img",{alt:t.alm?t.alm.key:"SonarCloud",className:"little-spacer-right",height:14,src:"".concat(Object(z.getBaseUrl)(),"/images/").concat(n,".svg")}),t.name,a.createElement("span",{className:"note little-spacer-left"},t.key)),r&&a.createElement("div",{className:"badge"},Object(u.translate)("organization.paid_plan.badge")))}}(e);return a.createElement(x.a,{autoFocus:!n,className:"input-super-large",clearable:!1,id:"select-organization",labelKey:"name",onChange:t,optionRenderer:o,options:P()(r,e=>e.name.toLowerCase()),placeholder:Object(u.translate)("onboarding.import_organization.choose_organization"),required:!0,value:n,valueKey:"key",valueRenderer:o})}class w extends a.PureComponent{constructor(){super(...arguments),this.handleLinkClick=e=>{e.preventDefault(),e.stopPropagation(),Object(v.save)(k.d,Date.now().toString(10)),this.props.router.push({pathname:"/create-organization",state:{tab:this.props.autoImport?"auto":"manual"}})}}render(){const{autoImport:e,onChange:t,organization:n,organizations:r}=this.props;return a.createElement("div",{className:"form-field spacer-bottom"},a.createElement("label",{htmlFor:"select-organization"},a.createElement("span",{className:"text-middle"},a.createElement("strong",null,Object(u.translate)("onboarding.create_project.organization")),a.createElement("em",{className:"mandatory"},"*"))),a.createElement(C,{hideIcons:!e,onChange:t,organization:n,organizations:r}),a.createElement("a",{className:"big-spacer-left js-new-org",href:"#",onClick:this.handleLinkClick},e?Object(u.translate)("onboarding.create_project.import_new_org"):Object(u.translate)("onboarding.create_project.create_new_org")))}}var R=Object(E.withRouter)(w),A=n(466),M=n.n(A),U=n(309),B=n(342),K=n.n(B),F=n(353),D=n.n(F),L=n(325),I=n(410),T=n(506),W=n(688),q=n(583),V=n.n(q),J=n(304),$=n(315),G=n.n($),H=n(462),X=n.n(H),Z=n(793),Q=n.n(Z),Y=n(332);class ee extends a.PureComponent{constructor(){super(...arguments),this.handleMouseEnter=()=>{this.props.highlightUpgradeBox(!0)},this.handleMouseLeave=()=>{this.props.highlightUpgradeBox(!1)},this.handleToggle=()=>{this.props.disabled||this.props.repository.linkedProjectKey||this.props.toggleRepository(this.props.repository)}}render(){const{disabled:e,identityProvider:t,repository:n,selected:r}=this.props,o=Boolean(n.linkedProjectKey);return a.createElement(G.a,{overlay:e?Object(u.translate)("onboarding.create_project.subscribe_to_import_private_repositories"):void 0},a.createElement("li",null,a.createElement("div",{className:U("create-project-repository",{disabled:e,imported:o,selected:r}),onClick:this.handleToggle,onMouseEnter:e?this.handleMouseEnter:void 0,onMouseLeave:e?this.handleMouseLeave:void 0,role:"listitem"},a.createElement("div",{className:"flex-1 display-flex-center"},e?a.createElement(Q.a,{fill:Y.colors.disableGrayText}):a.createElement(K.a,{checked:r||o,disabled:e||o,onCheck:V.a}),a.createElement("img",{alt:t.name,className:U("spacer-left",{"icon-half-transparent":e}),height:14,src:"".concat(Object(z.getBaseUrl)(),"/images/sonarcloud/").concat(t.key,".svg"),width:14}),a.createElement("span",{className:"spacer-left"},this.props.repository.label),n.private&&a.createElement("div",{className:"badge spacer-left"},Object(u.translate)("visibility.private"))),n.linkedProjectKey&&a.createElement("span",null,a.createElement(X.a,{className:"little-spacer-right",fill:Y.colors.green}),a.createElement(J.FormattedMessage,{defaultMessage:Object(u.translate)("onboarding.create_project.repository_imported"),id:"onboarding.create_project.repository_imported",values:{link:a.createElement(E.Link,{to:Object(f.t)(n.linkedProjectKey)},Object(u.translate)("onboarding.create_project.see_project"))}})))))}}var te=n(446),ne=n.n(te),ae=n(310);class re extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={submitting:!1},this.canSubmit=()=>!this.state.submitting&&this.props.selectedRepositories.length>0,this.handleFormSubmit=e=>{if(e.preventDefault(),this.canSubmit()){const{selectedRepositories:e}=this.props;this.setState({submitting:!0}),Object(h.c)({installationKeys:e.map(e=>e.installationKey),organization:this.props.organization.key}).then(({projects:e})=>this.props.onProjectCreate(e.map(e=>e.projectKey),this.props.organization.key),this.handleProvisionFail)}},this.handleProvisionFail=()=>this.props.onProvisionFail().then(()=>{this.mounted&&this.setState({submitting:!1})})}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{selectedRepositories:e}=this.props,t=e.length>0,[n=[],r=[]]=ne()(e,e=>e.private);return a.createElement("form",{className:U("create-project-setup boxed-group",{open:t}),onSubmit:this.handleFormSubmit},a.createElement("div",{className:"boxed-group-header"},a.createElement("h2",{className:"spacer-top"},e.length>1?Object(u.translateWithParameters)("onboarding.create_project.x_repositories_selected",e.length):Object(u.translate)("onboarding.create_project.1_repository_selected"))),a.createElement("div",{className:"boxed-group-inner"},a.createElement("div",{className:"flex-1"},1===r.length&&a.createElement("p",null,Object(u.translate)("onboarding.create_project.1_repository_created_as_public")),r.length>1&&a.createElement("p",null,Object(u.translateWithParameters)("onboarding.create_project.x_repository_created_as_public",r.length)),1===n.length&&a.createElement("p",null,Object(u.translate)("onboarding.create_project.1_repository_created_as_private")),n.length>1&&a.createElement("p",null,Object(u.translateWithParameters)("onboarding.create_project.x_repository_created_as_private",n.length))),a.createElement("div",null,a.createElement(ae.SubmitButton,{className:"button-large",disabled:this.state.submitting},Object(u.translate)("set_up")),a.createElement(d.a,{className:"spacer-left",loading:this.state.submitting}))))}}function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ce extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={checkAllRepositories:!1,highlight:!1,loading:!0,repositories:[],search:"",selectedRepositories:{},successfullyUpgraded:!1},this.fetchRepositories=()=>{const{organization:e}=this.props;return Object(h.b)({organization:e.key}).then(({repositories:e})=>{this.mounted&&this.setState({loading:!1,repositories:e})},()=>{this.mounted&&this.setState({loading:!1})})},this.filterBySearch=e=>t=>t.label.toLowerCase().includes(e.toLowerCase()),this.handleHighlightUpgradeBox=e=>{this.setState({highlight:e})},this.handleOrganizationUpgrade=()=>{this.props.onOrganizationUpgrade(),this.mounted&&this.setState({successfullyUpgraded:!0})},this.handleProvisionFail=()=>this.fetchRepositories().then(()=>{this.mounted&&this.setState(({repositories:e,selectedRepositories:t})=>{const n={};return Object.keys(t).forEach(t=>{const a=e.find(e=>e.installationKey===t);a&&!a.linkedProjectKey&&(n[a.installationKey]=a)}),{selectedRepositories:n}})}),this.handleSearch=e=>{this.setState({search:e,checkAllRepositories:!1,selectedRepositories:{}})},this.onCheckAllRepositories=()=>{this.setState(({checkAllRepositories:e,repositories:t,search:n})=>{const{organization:a}=this.props,r=Object(T.c)(a),o={selectedRepositories:{},checkAllRepositories:!e};if(o.checkAllRepositories){const e=t.filter(e=>this.filterBySearch(n)(e)&&(e=>!!r||!e.private)(e)&&(e=>!e.linkedProjectKey)(e));o.selectedRepositories=M()(e,"installationKey")}return o})},this.toggleRepository=e=>{this.setState(({selectedRepositories:t})=>({selectedRepositories:ie({},t,{[e.installationKey]:t[e.installationKey]?void 0:e})}))}}componentDidMount(){this.mounted=!0,this.fetchRepositories()}componentDidUpdate(e){e.organization.key!==this.props.organization.key&&(this.setState({loading:!0,selectedRepositories:{}}),this.fetchRepositories())}componentWillUnmount(){this.mounted=!1}render(){const{highlight:e,loading:t,repositories:n,search:r,selectedRepositories:o}=this.state,{almApplication:i,organization:s}=this.props,c=Object(T.c)(s),l=n.some(e=>Boolean(e.private)),p=n.length>5,m=n.length>1,h=!c&&l&&s.actions&&s.actions.admin,g=n.filter(this.filterBySearch(r));return a.createElement("div",{className:"create-project"},a.createElement("div",{className:"flex-1 huge-spacer-right"},a.createElement("div",{className:"spacer-bottom create-project-actions"},a.createElement("div",null,m&&a.createElement(K.a,{checked:this.state.checkAllRepositories,disabled:0===g.length,onCheck:this.onCheckAllRepositories},Object(u.translate)("onboarding.create_project.select_all_repositories"))),p&&a.createElement(D.a,{minLength:1,onChange:this.handleSearch,placeholder:Object(u.translate)("search.search_for_repositories"),value:this.state.search})),this.state.successfullyUpgraded&&a.createElement(L.Alert,{variant:"success"},Object(u.translateWithParameters)("onboarding.create_project.subscribtion_success_x",s.name)),a.createElement(d.a,{loading:t},a.createElement("ul",null,0===g.length&&a.createElement("li",{className:"big-spacer-top note"},h?Object(u.translateWithParameters)("no_results_for_x",r):Object(u.translate)("onboarding.create_project.no_repositories")),g.map(e=>a.createElement(ee,{disabled:Boolean(e.private&&!c),highlightUpgradeBox:this.handleHighlightUpgradeBox,identityProvider:i,key:e.installationKey,repository:e,selected:Boolean(o[e.installationKey]),toggleRepository:this.toggleRepository}))))),s&&a.createElement("div",{className:U({"create-project-side-with-search":p})},a.createElement("div",{className:"create-project-side-sticky"},a.createElement(re,{onProjectCreate:this.props.onProjectCreate,onProvisionFail:this.handleProvisionFail,organization:s,selectedRepositories:Object.keys(o).map(e=>o[e]).filter(I.isDefined)}),h&&a.createElement(W.a,{className:U({highlight:e}),onOrganizationUpgrade:this.handleOrganizationUpgrade,organization:s}))))}}class le extends a.PureComponent{constructor(e){super(e),this.mounted=!1,this.handleInstallAppClick=()=>{Object(v.save)(k.c,Date.now().toString(10)),Object(v.save)(k.d,Date.now().toString(10))},this.handleOrganizationSelect=({key:e})=>{this.setState({selectedOrganization:e})},this.state={selectedOrganization:this.getInitialSelectedOrganization(e)}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}getInitialSelectedOrganization(e){return e.organization?e.organization:1===e.boundOrganizations.length?e.boundOrganizations[0].key:""}render(){const{almApplication:e,boundOrganizations:t,onProjectCreate:n}=this.props;if(0===t.length)return a.createElement(a.Fragment,null,a.createElement("p",{className:"spacer-bottom"},Object(u.translate)("onboarding.create_project.install_app_description",e.key)),a.createElement(_.a,{backgroundColor:e.backgroundColor,className:"display-inline-block",iconPath:e.iconPath,name:e.name,onClick:this.handleInstallAppClick,small:!0,url:e.installationUrl},Object(u.translate)("onboarding.import_organization.choose_organization_button",e.key)));const{selectedOrganization:r}=this.state,o=t.find(e=>e.key===r);return a.createElement(a.Fragment,null,a.createElement(R,{autoImport:!0,onChange:this.handleOrganizationSelect,organization:r,organizations:this.props.boundOrganizations}),o&&a.createElement(ce,{almApplication:e,onOrganizationUpgrade:this.props.onOrganizationUpgrade,onProjectCreate:n,organization:o}))}}var pe=n(364),de=n.n(pe),ue=n(685),me=n.n(ue),he=n(360);function ge(e){const{additionalActions:t,showBreadcrumb:n,title:r}=e;return a.createElement("header",{className:"huge-spacer-bottom bordered-bottom overflow-hidden"},a.createElement("h1",{className:"pull-left huge big-spacer-bottom"},n&&a.createElement(a.Fragment,null,a.createElement(E.Link,{to:"/projects/create"},Object(u.translate)("my_account.create_new.TRK")),a.createElement("span",{className:"big-spacer-left big-spacer-right slash-separator"})),r),t)}n(1797);class be extends a.PureComponent{constructor(e){super(e),this.mounted=!1,this.checkFreeKey=e=>Object(he.f)({component:e}).then(t=>{this.mounted&&e===this.state.projectKey&&(t?this.setState({projectKeyError:Object(u.translate)("onboarding.create_project.project_key.taken"),touched:!0,validating:!1}):this.setState({projectKeyError:void 0,validating:!1}))}).catch(()=>{this.mounted&&e===this.state.projectKey&&this.setState({projectKeyError:void 0,validating:!1})}),this.canChoosePrivate=e=>Boolean(e&&"PAID"===e.subscription),this.getInitialSelectedOrganization=e=>e.organization?this.getOrganization(e.organization):e.userOrganizations&&1===e.userOrganizations.length?e.userOrganizations[0]:void 0,this.getOrganization=e=>this.props.userOrganizations&&this.props.userOrganizations.find(({key:t})=>t===e),this.handleFormSubmit=e=>{e.preventDefault();const{state:t}=this;this.canSubmit(t)&&(this.setState({submitting:!0}),Object(he.c)({project:t.projectKey,name:(t.projectName||t.projectKey).trim(),organization:t.selectedOrganization&&t.selectedOrganization.key,visibility:this.state.selectedVisibility}).then(({project:e})=>this.props.onProjectCreate([e.key]),()=>{this.mounted&&this.setState({submitting:!1})}))},this.handleOrganizationSelect=({key:e})=>{const t=this.getOrganization(e);let{selectedVisibility:n}=this.state;void 0===n&&(n=this.canChoosePrivate(t)?"private":"public"),this.setState({selectedOrganization:t,selectedVisibility:n})},this.handleOrganizationUpgrade=()=>{this.props.fetchMyOrganizations().then(()=>{this.setState(e=>{if(e.selectedOrganization){return{selectedOrganization:this.getOrganization(e.selectedOrganization.key)}}return null})},()=>{})},this.handleProjectKeyChange=e=>{const t=e.currentTarget.value||"",n=this.validateKey(t);this.setState(e=>{const a=e.projectNameChanged?e.projectName:t;return{projectKey:t,projectKeyError:n,projectName:a,projectNameError:this.validateName(a),touched:!0,validating:void 0===n}}),void 0===n&&this.checkFreeKey(t)},this.handleProjectNameChange=e=>{const t=e.currentTarget.value;this.setState({projectName:t,projectNameChanged:!0,projectNameError:this.validateName(t)})},this.handleVisibilityChange=e=>{this.setState({selectedVisibility:e})},this.validateKey=e=>e.length>400||!/^[\w-.:]*[a-zA-Z]+[\w-.:]*$/.test(e)?Object(u.translate)("onboarding.create_project.project_key.error"):void 0,this.validateName=e=>0===e.length||e.length>255?Object(u.translate)("onboarding.create_project.display_name.error"):void 0,this.state={projectKey:"",projectName:"",projectNameChanged:!1,selectedOrganization:this.getInitialSelectedOrganization(e),submitting:!1,touched:!1,validating:!1},this.checkFreeKey=de()(this.checkFreeKey,250)}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}canSubmit(e){const{projectKey:t,projectKeyError:n,projectName:a,projectNameError:r,selectedOrganization:i}=e;return Boolean(void 0===n&&void 0===r&&t.length>0&&a.length>0&&(!Object(o.isSonarCloud)()||i))}render(){const{projectKey:e,projectKeyError:t,projectName:n,projectNameError:r,selectedOrganization:i,submitting:s,touched:c,validating:l}=this.state,{branchesEnabled:p}=this.props,m=c&&void 0!==t,h=c&&!l&&void 0===t,g=c&&void 0!==r,b=c&&void 0===r,j=this.canChoosePrivate(i);return a.createElement(a.Fragment,null,a.createElement(ge,{showBreadcrumb:p,title:Object(u.translate)("onboarding.create_project.setup_manually")}),a.createElement("div",{className:"create-project"},a.createElement("div",{className:"flex-1 huge-spacer-right"},a.createElement("form",{className:"manual-project-create",onSubmit:this.handleFormSubmit},Object(o.isSonarCloud)()&&this.props.userOrganizations&&a.createElement(R,{onChange:this.handleOrganizationSelect,organization:i?i.key:"",organizations:this.props.userOrganizations}),a.createElement(me.a,{className:"form-field",description:Object(u.translate)("onboarding.create_project.project_key.description"),error:t,help:Object(u.translate)("onboarding.create_project.project_key.help"),id:"project-key",isInvalid:m,isValid:h,label:Object(u.translate)("onboarding.create_project.project_key"),required:!0},a.createElement("input",{autoFocus:!0,className:U("input-super-large",{"is-invalid":m,"is-valid":h}),id:"project-key",maxLength:400,minLength:1,onChange:this.handleProjectKeyChange,type:"text",value:e})),a.createElement(me.a,{className:"form-field",description:Object(u.translate)("onboarding.create_project.display_name.description"),error:r,help:Object(u.translate)("onboarding.create_project.display_name.help"),id:"project-name",isInvalid:g,isValid:b,label:Object(u.translate)("onboarding.create_project.display_name"),required:!0},a.createElement("input",{className:U("input-super-large",{"is-invalid":g,"is-valid":b}),id:"project-name",maxLength:255,minLength:1,onChange:this.handleProjectNameChange,type:"text",value:n})),a.createElement(ae.SubmitButton,{disabled:!this.canSubmit(this.state)||s},Object(u.translate)("set_up")),a.createElement(d.a,{className:"spacer-left",loading:s}))),Object(o.isSonarCloud)()&&i&&a.createElement("div",{className:"create-project-side-sticky"},a.createElement(W.a,{className:U("animated",{open:!j}),onOrganizationUpgrade:this.handleOrganizationUpgrade,organization:i}))))}}n(1253);function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ye extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!0},this.handleProjectCreate=(e,t)=>{this.props.skipOnboarding(),e.length>1?this.props.router.push({pathname:(t?Object(f.q)(t):"")+"/projects"}):1===e.length&&this.props.router.push(Object(f.t)(e[0]))},this.fetchAlmApplication=()=>Object(h.a)().then(({application:e})=>{this.mounted&&this.setState({almApplication:e,loading:!1})},()=>{this.mounted&&this.setState({loading:!1})}),this.onTabChange=e=>{this.updateUrl({tab:e})},this.updateUrl=(e={})=>{this.props.router.replace({pathname:this.props.location.pathname,query:this.props.location.query,state:fe({},this.props.location.state||{},{},e)})}}componentDidMount(){this.mounted=!0,Object(j.c)(this.props.currentUser)?this.fetchAlmApplication():this.setState({loading:!1}),Object(m.addWhitePageClass)()}componentWillUnmount(){this.mounted=!1,Object(m.removeWhitePageClass)()}render(){const{currentUser:e,location:t,userOrganizations:n}=this.props,{almApplication:r,loading:o}=this.state,s=t.state||{},c=Object(u.translate)("onboarding.create_project.header"),p="manual"===s.tab;return a.createElement(a.Fragment,null,a.createElement(i.a,{title:c,titleTemplate:"%s"}),a.createElement("div",{className:"page page-limited huge-spacer-top huge-spacer-bottom"},a.createElement("header",{className:"page-header huge-spacer-bottom"},a.createElement("h1",{className:"page-title huge"},a.createElement("strong",null,c))),o?a.createElement(d.a,null):a.createElement(a.Fragment,null,r&&a.createElement(l.a,{onChange:this.onTabChange,selected:s.tab||"auto",tabs:[{key:"auto",node:Object(u.translate)("onboarding.create_project.select_repositories")},{key:"manual",node:Object(u.translate)("onboarding.create_project.setup_manually")}]}),p||!r?a.createElement(be,{currentUser:e,fetchMyOrganizations:this.props.fetchMyOrganizations,onProjectCreate:this.handleProjectCreate,organization:s.organization,userOrganizations:n.filter(({actions:e={}})=>e.provision)}):a.createElement(le,{almApplication:r,boundOrganizations:n.filter(({alm:e,actions:t={}})=>e&&t.provision),onOrganizationUpgrade:this.props.fetchMyOrganizations,onProjectCreate:this.handleProjectCreate,organization:s.organization}))))}}const _e={skipOnboarding:O.g};var ve=Object(g.a)(Object(b.a)(Object(s.connect)(null,_e)(ye))),ke=n(600),Ee=n(413),Se=n(546),Pe=n(8),Ne=n(321);var xe,ze=n(319),Ce=n(651),we=n(356),Re=n.n(we),Ae=n(424),Me=n.n(Ae),Ue=n(628),Be=n.n(Ue),Ke=n(438),Fe=n.n(Ke);function De(e){const{disableRepositories:t,open:n,project:r,repositories:o,selectedRepository:i,showingAllRepositories:s}=e,c=o.length;return a.createElement(Be.a,{className:U("big-spacer-bottom",{open:n,"not-clickable":!e.onClick,"no-hover":!e.onClick}),key:r.key,onClick:e.onClick?e.onClick:()=>{},open:n,title:a.createElement("h3",null,r.name)},n&&a.createElement("div",{className:"display-flex-wrap"},0===c&&a.createElement(L.Alert,{variant:"warning"},a.createElement(J.FormattedMessage,{defaultMessage:Object(u.translate)("onboarding.create_project.no_bbs_repos"),id:"onboarding.create_project.no_bbs_repos",values:{link:a.createElement(E.Link,{to:{pathname:"/projects/create",query:{mode:xe.BitbucketServer,resetPat:1}}},Object(u.translate)("onboarding.create_project.update_your_token"))}})),o.map(n=>n.sqProjectKey?a.createElement("div",{className:"display-flex-start spacer-right spacer-bottom create-project-import-bbs-repo",key:n.id},a.createElement(X.a,{className:"spacer-right",fill:Y.colors.green,size:14}),a.createElement("div",{className:"overflow-hidden"},a.createElement("div",{className:"little-spacer-bottom text-ellipsis"},a.createElement("strong",{title:n.name},a.createElement(E.Link,{to:Object(f.t)(n.sqProjectKey)},n.name))),a.createElement("em",null,Object(u.translate)("onboarding.create_project.repository_imported")))):a.createElement(Fe.a,{checked:(null==i?void 0:i.id)===n.id,className:U("display-flex-start spacer-right spacer-bottom create-project-import-bbs-repo overflow-hidden",{disabled:t,"text-muted":t,"link-no-underline":t}),key:n.id,onCheck:()=>e.onSelectRepository(n),value:String(n.id)},a.createElement("strong",{className:"text-ellipsis",title:n.name},n.name))),!s&&c>0&&a.createElement(L.Alert,{variant:"warning"},Object(u.translateWithParameters)("onboarding.create_project.only_showing_X_first_repos",c))))}function Le(e){const{disableRepositories:t,projects:n,projectRepositories:r,selectedRepository:o}=e,[i,s]=a.useState(n.length>0?[n[0].key]:[]),c=n.length<=i.length;return a.createElement(a.Fragment,null,a.createElement("div",{className:"overflow-hidden spacer-bottom"},a.createElement(ae.ButtonLink,{className:"pull-right",onClick:()=>s(c?[]:n.map(e=>e.key))},c?Object(u.translate)("collapse_all"):Object(u.translate)("expand_all"))),n.map(n=>{const c=i.includes(n.key),{allShown:l,repositories:p=[]}=r[n.key]||{};return a.createElement(De,{disableRepositories:t,key:n.key,onClick:()=>((e,t)=>{s(e?Re()(i,t):Me()([...i,t]))})(c,n.key),onSelectRepository:e.onSelectRepository,open:c,project:n,repositories:p,selectedRepository:o,showingAllRepositories:l})}))}function Ie(e){const{disableRepositories:t,projects:n,searching:r,searchResults:o=[],selectedRepository:i}=e,s=Me()(o.map(e=>n.find(t=>t.key===e.projectKey)).filter(I.isDefined));return 0!==s.length||r?a.createElement("div",{className:"big-spacer-top"},a.createElement(d.a,{loading:r},s.map(n=>{const r=o.filter(e=>e.projectKey===n.key);return a.createElement(De,{disableRepositories:t,key:n.key,onSelectRepository:e.onSelectRepository,open:!0,project:n,repositories:r,selectedRepository:i,showingAllRepositories:!0})}))):a.createElement(L.Alert,{className:"big-spacer-top",variant:"warning"},Object(u.translate)("onboarding.create_project.no_bbs_repos.filter"))}function Te(e){const{disableRepositories:t,projects:n=[],projectRepositories:r={},searchResults:o,searching:i,selectedRepository:s}=e;return 0===n.length?a.createElement(L.Alert,{className:"spacer-top",variant:"warning"},a.createElement(J.FormattedMessage,{defaultMessage:Object(u.translate)("onboarding.create_project.no_bbs_projects"),id:"onboarding.create_project.no_bbs_projects",values:{link:a.createElement(E.Link,{to:{pathname:"/projects/create",query:{mode:xe.BitbucketServer,resetPat:1}}},Object(u.translate)("onboarding.create_project.update_your_token"))}})):a.createElement("div",{className:"create-project-import-bbs"},a.createElement(D.a,{onChange:e.onSearch,placeholder:Object(u.translate)("onboarding.create_project.search_repositories_by_name")}),i||o?a.createElement(Ie,{disableRepositories:t,onSelectRepository:e.onSelectRepository,projects:n,searchResults:o,searching:i,selectedRepository:s}):a.createElement(Le,{disableRepositories:t,onSelectRepository:e.onSelectRepository,projectRepositories:r,projects:n,selectedRepository:s}))}function We(e){const{bitbucketSetting:{url:t},submitting:n=!1,validationFailed:r}=e,[o,i]=a.useState(!1);a.useEffect(()=>{i(!1)},[n]);const s=r&&!o;return a.createElement("div",{className:"display-flex-start"},a.createElement("form",{onSubmit:t=>{t.preventDefault();const n=new FormData(t.currentTarget).get("personal_access_token");e.onPersonalAccessTokenCreate(n)}},a.createElement("h2",{className:"big"},Object(u.translate)("onboarding.create_project.grant_access_to_bbs.title")),a.createElement("p",{className:"big-spacer-top big-spacer-bottom"},Object(u.translate)("onboarding.create_project.grant_access_to_bbs.help")),a.createElement(me.a,{error:s?Object(u.translate)("onboarding.create_project.pat_incorrect"):void 0,id:"personal_access_token",isInvalid:s,isValid:!1,label:Object(u.translate)("onboarding.create_project.enter_pat"),required:!0},a.createElement("input",{autoFocus:!0,className:U("input-super-large",{"is-invalid":s}),id:"personal_access_token",minLength:1,name:"personal_access_token",onChange:()=>{i(!0)},type:"text"})),a.createElement(ae.SubmitButton,{disabled:s||n||!o},Object(u.translate)("save")),a.createElement(d.a,{className:"spacer-left",loading:n})),a.createElement(L.Alert,{className:"big-spacer-left big-spacer-top",display:"block",variant:"info"},a.createElement("h3",null,Object(u.translate)("onboarding.create_project.pat_help.title")),a.createElement("p",{className:"big-spacer-top big-spacer-bottom"},Object(u.translate)("onboarding.create_project.pat_help.bbs_help_1")),t&&a.createElement("div",{className:"text-middle"},a.createElement("img",{alt:"",className:"spacer-right",height:"16",src:"".concat(Object(z.getBaseUrl)(),"/images/alm/bitbucket.svg")}),a.createElement("a",{href:"".concat(t.replace(/\/$/,""),"/plugins/servlet/access-tokens/add"),rel:"noopener noreferrer",target:"_blank"},Object(u.translate)("onboarding.create_project.pat_help.link"))),a.createElement("p",{className:"big-spacer-top big-spacer-bottom"},Object(u.translate)("onboarding.create_project.pat_help.bbs_help_2")),a.createElement("ul",null,a.createElement("li",null,a.createElement(J.FormattedMessage,{defaultMessage:Object(u.translate)("onboarding.create_project.pat_help.bbs_permission_projects"),id:"onboarding.create_project.pat_help.bbs_permission_projects",values:{perm:a.createElement("strong",null,Object(u.translate)("onboarding.create_project.pat_help.read_permission"))}})),a.createElement("li",null,a.createElement(J.FormattedMessage,{defaultMessage:Object(u.translate)("onboarding.create_project.pat_help.bbs_permission_repos"),id:"onboarding.create_project.pat_help.bbs_permission_repos",values:{perm:a.createElement("strong",null,Object(u.translate)("onboarding.create_project.pat_help.read_permission"))}})))))}function qe(e){const{bitbucketSetting:t,canAdmin:n,importing:r,loading:o,projects:i,projectRepositories:s,selectedRepository:c,searching:l,searchResults:p,showPersonalAccessTokenForm:m,submittingToken:h,tokenValidationFailed:g}=e;return a.createElement(a.Fragment,null,a.createElement(ge,{additionalActions:!m&&a.createElement("div",{className:"display-flex-center pull-right"},a.createElement(d.a,{className:"spacer-right",loading:r}),a.createElement(ae.Button,{className:"button-large button-primary",disabled:!c||r,onClick:e.onImportRepository},Object(u.translate)("onboarding.create_project.import_selected_repo"))),showBreadcrumb:!0,title:a.createElement("span",{className:"text-middle"},a.createElement("img",{alt:"",className:"spacer-right",height:"24",src:"".concat(Object(z.getBaseUrl)(),"/images/alm/bitbucket.svg")}),Object(u.translate)("onboarding.create_project.from_bbs"))}),o&&a.createElement("i",{className:"spinner"}),!o&&!t&&a.createElement(L.Alert,{variant:"error"},n?a.createElement(J.FormattedMessage,{defaultMessage:Object(u.translate)("onboarding.create_project.no_bbs_binding.admin"),id:"onboarding.create_project.no_bbs_binding.admin",values:{url:a.createElement(E.Link,{to:{pathname:"/admin/settings",query:{category:Ce.a}}},Object(u.translate)("settings.page"))}}):Object(u.translate)("onboarding.create_project.no_bbs_binding")),!o&&t&&(m?a.createElement(We,{bitbucketSetting:t,onPersonalAccessTokenCreate:e.onPersonalAccessTokenCreate,submitting:h,validationFailed:g}):a.createElement(Te,{disableRepositories:r,onSearch:e.onSearch,onSelectRepository:e.onSelectRepository,projectRepositories:s,projects:i,searchResults:p,searching:l,selectedRepository:c})))}function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.Manual="manual",e.BitbucketServer="bbs"}(xe||(xe={}));class $e extends a.PureComponent{constructor(e){super(e),this.mounted=!1,this.fetchInitialData=async()=>{this.setState({loading:!0});const e=await this.checkPersonalAccessToken().catch(()=>!1);let t,n;e&&(t=await this.fetchBitbucketProjects().catch(()=>{})),t&&t.length>0&&(n=await this.fetchBitbucketRepositories(t).catch(()=>{})),this.mounted&&this.setState({patIsValid:e,projects:t,projectRepositories:n,loading:!1})},this.checkPersonalAccessToken=()=>{const{bitbucketSetting:e}=this.state;return e?(t=e.key,Object(Pe.get)("/api/alm_integrations/check_pat",{almSetting:t}).then(()=>!0).catch(e=>400!==e.status&&Object(Ne.a)(e))):Promise.resolve(!1);var t},this.fetchBitbucketProjects=()=>{const{bitbucketSetting:e}=this.state;return e?(t=e.key,Object(Pe.getJSON)("/api/alm_integrations/list_bitbucketserver_projects",{almSetting:t})).then(({projects:e})=>e):Promise.resolve(void 0);var t},this.fetchBitbucketRepositories=e=>{const{bitbucketSetting:t}=this.state;return t?Promise.all(e.map(e=>{return(n=t.key,a=e.name,Object(Pe.getJSON)("/api/alm_integrations/search_bitbucketserver_repos",{almSetting:n,projectName:a})).then(({isLastPage:t,repositories:n})=>({isLastPage:t,repositories:n,projectKey:e.key}));var n,a})).then(e=>e.reduce((e,{isLastPage:t,projectKey:n,repositories:a})=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){Je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{[n]:{allShown:t,repositories:a}}),{})):Promise.resolve(void 0)},this.handlePersonalAccessTokenCreate=e=>{const{bitbucketSetting:t}=this.state;var n,a;!t||e.length<1||(this.setState({submittingToken:!0,tokenValidationFailed:!1}),(n=t.key,a=e,Object(Pe.post)("/api/alm_integrations/set_pat",{almSetting:n,pat:a}).catch(Ne.a)).then(this.checkPersonalAccessToken).then(e=>{this.mounted&&(this.setState({submittingToken:!1,patIsValid:e,tokenValidationFailed:!e}),e&&this.fetchInitialData())}).catch(()=>{this.mounted&&this.setState({submittingToken:!1})}))},this.handleImportRepository=()=>{const{bitbucketSetting:e,selectedRepository:t}=this.state;var n,a,r;e&&t&&(this.setState({importing:!0}),(n=e.key,a=t.projectKey,r=t.slug,Object(Pe.postJSON)("/api/alm_integrations/import_bitbucketserver_project",{almSetting:n,projectKey:a,repositorySlug:r}).catch(Ne.a)).then(({project:{key:e}})=>{this.mounted&&(this.setState({importing:!1}),this.props.onProjectCreate([e]))}).catch(()=>{this.mounted&&this.setState({importing:!1})}))},this.handleSearch=e=>{const{bitbucketSetting:t}=this.state;var n,a;t&&(e?(this.setState({searching:!0,selectedRepository:void 0}),(n=t.key,a=e,Object(Pe.getJSON)("/api/alm_integrations/search_bitbucketserver_repos",{almSetting:n,repositoryName:a})).then(({repositories:e})=>{this.mounted&&this.setState({searching:!1,searchResults:e})}).catch(()=>{this.mounted&&this.setState({searching:!1})})):this.setState({searching:!1,searchResults:void 0,selectedRepository:void 0}))},this.handleSelectRepository=e=>{this.setState({selectedRepository:e})},this.state={bitbucketSetting:e.bitbucketSettings[0],importing:!1,loading:!1,searching:!1,tokenValidationFailed:!1}}componentDidMount(){this.mounted=!0,this.fetchInitialData()}componentDidUpdate(e){0===e.bitbucketSettings.length&&this.props.bitbucketSettings.length>0&&this.setState({bitbucketSetting:this.props.bitbucketSettings[0]},()=>this.fetchInitialData())}componentWillUnmount(){this.mounted=!1}render(){const{canAdmin:e,loadingBindings:t,location:n}=this.props,{bitbucketSetting:r,importing:o,loading:i,patIsValid:s,projectRepositories:c,projects:l,searching:p,searchResults:d,selectedRepository:u,submittingToken:m,tokenValidationFailed:h}=this.state;return a.createElement(qe,{bitbucketSetting:r,canAdmin:e,importing:o,loading:i||t,onImportRepository:this.handleImportRepository,onPersonalAccessTokenCreate:this.handlePersonalAccessTokenCreate,onProjectCreate:this.props.onProjectCreate,onSearch:this.handleSearch,onSelectRepository:this.handleSelectRepository,projectRepositories:c,projects:l,searchResults:d,searching:p,selectedRepository:u,showPersonalAccessTokenForm:!s||Boolean(n.query.resetPat),submittingToken:m,tokenValidationFailed:h})}}var Ge=Object(s.connect)(e=>{const{canAdmin:t}=Object(ze.getAppState)(e);return{canAdmin:t}})($e),He=n(322),Xe=n.n(He);function Ze(e){const{bbsBindingCount:t,loadingBindings:n}=e;return a.createElement(a.Fragment,null,a.createElement("header",{className:"huge-spacer-top big-spacer-bottom padded"},a.createElement("h1",{className:"text-center huge big-spacer-bottom"},Object(u.translate)("my_account.create_new.TRK")),a.createElement("p",{className:"text-center big"},Object(u.translate)("onboarding.create_project.select_method"))),a.createElement("div",{className:"create-project-modes huge-spacer-top display-flex-space-around"},a.createElement("button",{className:"button button-huge display-flex-column create-project-mode-type-manual",onClick:()=>e.onSelectMode(xe.Manual),type:"button"},a.createElement("img",{alt:"",height:80,src:"".concat(Object(z.getBaseUrl)(),"/images/sonarcloud/analysis/manual.svg")}),a.createElement("div",{className:"medium big-spacer-top"},Object(u.translate)("onboarding.create_project.select_method.manual"))),a.createElement("button",{className:"button button-huge big-spacer-left display-flex-column create-project-mode-type-bbs",disabled:1!==t,onClick:()=>e.onSelectMode(xe.BitbucketServer),type:"button"},a.createElement("img",{alt:"",height:80,src:"".concat(Object(z.getBaseUrl)(),"/images/alm/bitbucket.svg"),width:80}),a.createElement("div",{className:"medium big-spacer-top"},Object(u.translate)("onboarding.create_project.select_method.from_bbs")),n&&a.createElement("span",null,Object(u.translate)("onboarding.create_project.check_bbs_supported"),a.createElement("i",{className:"little-spacer-left spinner"})),!n&&1!==t&&a.createElement("div",{className:"text-muted small spacer-top",style:{lineHeight:1.5}},Object(u.translate)("onboarding.create_project.bbs_not_configured"),a.createElement(Xe.a,{className:"little-spacer-left",overlay:0===t?Object(u.translate)("onboarding.create_project.zero_bbs_instances"):Object(u.translateWithParameters)("onboarding.create_project.too_many_bbs_instances_X",t)})))))}class Qe extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={bitbucketSettings:[],loading:!1},this.fetchAlmBindings=()=>{this.setState({loading:!0}),Object(ke.i)().then(e=>{this.mounted&&this.setState({bitbucketSettings:e.filter(e=>e.alm===Se.a.Bitbucket),loading:!1})}).catch(()=>{this.mounted&&this.setState({loading:!1})})},this.handleProjectCreate=e=>{1===e.length&&this.props.router.push(Object(f.t)(e[0]))},this.handleModeSelect=e=>{const{router:t,location:n}=this.props;t.push({pathname:n.pathname,query:{mode:e}})}}componentDidMount(){var e;const{appState:{branchesEnabled:t},location:n}=this.props;this.mounted=!0,t&&this.fetchAlmBindings(),((null===(e=n.query)||void 0===e?void 0:e.mode)||!t)&&Object(m.addWhitePageClass)()}componentDidUpdate(e){var t,n,a,r;(null===(t=this.props.location.query)||void 0===t?void 0:t.mode)&&!(null===(n=e.location.query)||void 0===n?void 0:n.mode)?Object(m.addWhitePageClass)():!(null===(a=this.props.location.query)||void 0===a?void 0:a.mode)&&(null===(r=e.location.query)||void 0===r?void 0:r.mode)&&Object(m.removeWhitePageClass)()}componentWillUnmount(){this.mounted=!1,Object(m.removeWhitePageClass)()}render(){var e;const{appState:{branchesEnabled:t},currentUser:n,location:r}=this.props,{bitbucketSettings:o,loading:s}=this.state,c=null===(e=r.query)||void 0===e?void 0:e.mode,l=!t||c===xe.Manual,p=t&&c===xe.BitbucketServer;return a.createElement(a.Fragment,null,a.createElement(i.a,{title:Object(u.translate)("my_account.create_new.TRK"),titleTemplate:"%s"}),a.createElement("div",{className:"page page-limited huge-spacer-bottom position-relative",id:"create-project"},!p&&!l&&a.createElement(Ze,{bbsBindingCount:o.length,loadingBindings:s,onSelectMode:this.handleModeSelect}),l&&a.createElement(be,{branchesEnabled:t,currentUser:n,onProjectCreate:this.handleProjectCreate}),p&&a.createElement(Ge,{bitbucketSettings:o,loadingBindings:s,location:r,onProjectCreate:this.handleProjectCreate})))}}var Ye=Object(g.a)(Object(Ee.a)(Qe));function et(e){return a.createElement(a.Fragment,null,a.createElement(r.a,{anchor:"create_project_main"}),Object(o.isSonarCloud)()?a.createElement(ve,Object.assign({},e)):a.createElement(Ye,Object.assign({},e)))}},337:function(e,t,n){"use strict";function a(e,t){const n=e.displayName||e.name||"Component";return"".concat(t,"(").concat(n,")")}n.d(t,"a",(function(){return a}))},350:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2),r=n(5),o=n(400);function i(e){return a.createElement(o.a.Consumer,null,({addA11ySkipLink:t,removeA11ySkipLink:n})=>a.createElement(s,Object.assign({addA11ySkipLink:t,removeA11ySkipLink:n},e)))}class s extends a.PureComponent{constructor(){super(...arguments),this.getLink=()=>{const{anchor:e,label:t=Object(r.translate)("skip_to_content"),weight:n}=this.props;return{key:e,label:t,weight:n}}}componentDidMount(){this.props.addA11ySkipLink(this.getLink())}componentWillUnmount(){this.props.removeA11ySkipLink(this.getLink())}render(){const{anchor:e}=this.props;return a.createElement("span",{id:"a11y_target__".concat(e)})}}},378:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(317),o=n(319),i=n(337);function s(e){class t extends a.Component{render(){return a.createElement(e,Object.assign({},this.props))}}return t.displayName=Object(i.a)(e,"withCurrentUser"),Object(r.connect)((function(e){return{currentUser:Object(o.getCurrentUser)(e)}}))(t)}},398:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var a=n(336),r=n(14);let o=!1;function i(e,t="body"){return new Promise(n=>{const r=document.createElement("script");r.src="".concat(Object(a.getBaseUrl)()).concat(e),r.onload=n,document.getElementsByTagName(t)[0].appendChild(r)})}async function s(e){const t=Object(r.a)(e);if(t)return Promise.resolve(t);if(!o){(0,(await Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(298)]).then(n.bind(null,537))).default)(),o=!0}await i("/static/".concat(e,".js"));const a=Object(r.a)(e);return a||Promise.reject()}},413:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),r=n(317),o=n(319),i=n(337);function s(e){class t extends a.Component{render(){return a.createElement(e,Object.assign({},this.props))}}return t.displayName=Object(i.a)(e,"withAppState"),Object(r.connect)((function(e){return{appState:Object(o.getAppState)(e)}}))(t)}},416:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return p}));var a=n(333);function r(e,t){return t.endsWith("/")||(t+="/"),c(e)?t.replace("github.com/","github.com/orgs/")+"people":t+"profile/members"}function o(e){return Object(a.b)(e)&&e.externalProvider?p(e.externalProvider):void 0}function i(e){return Object(a.b)(e)&&(s(e.externalProvider)||c(e.externalProvider))}function s(e){return!!e&&e.startsWith("bitbucket")}function c(e){return"github"===e}function l(e){return"microsoft"===e}function p(e){return s(e)?"bitbucket":e}},506:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var a=n(333);function r(e){return Boolean(e&&"PAID"===e.subscription)}function o(e,t,n){return!r(t)||i(e,t,n)}function i(e,t,n){return Boolean(t&&Object(a.b)(e)&&(t.actions&&t.actions.admin||n.some(e=>e.key===t.key)))}},546:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e.Azure="azure",e.Bitbucket="bitbucket",e.GitHub="github",e.GitLab="gitlab"}(a||(a={}))},577:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return h}));var a=n(503),r=n.n(a),o=n(5),i=n(318),s=n(432),c=n(590);n(416);const l="sonarcloud.import_org.binding_in_progress",p="sonarcloud.import_org.redirect_to_projects",d="sonarcloud.bind_org.key",u="sonarcloud.bind_org.redirect_to_org";var m;function h(e,t){const n=Object(i.formatMeasure)(e,"FLOAT").replace(/[.|,]0$/,"").replace(/([.|,]\d)$/,"$10");return t?n:Object(o.translateWithParameters)("billing.price_format",n)}!function(e){e[e.OrganizationDetails=0]="OrganizationDetails",e[e.Plan=1]="Plan"}(m||(m={}));r()((e={})=>{let t=void 0,n=void 0;if(e.installation_id)n="github",t=Object(s.parseAsOptionalString)(e.installation_id);else if(e.clientKey)n="bitbucket",t=Object(s.parseAsOptionalString)(e.clientKey);else if(e.jwt){const a=Object(c.decodeJwt)(e.jwt);a&&a.iss&&(n="bitbucket",t=a.iss)}return{almInstallId:t,almKey:n}})},588:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n(32),o=n.n(r),i=n(333),s=n(337),c=n(378);function l(e){class t extends a.Component{componentDidMount(){Object(i.b)(this.props.currentUser)||o()()}render(){return Object(i.b)(this.props.currentUser)?a.createElement(e,Object.assign({},this.props)):null}}return t.displayName=Object(s.a)(e,"whenLoggedIn"),Object(c.a)(t)}},600:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"o",(function(){return p})),n.d(t,"c",(function(){return d})),n.d(t,"p",(function(){return u})),n.d(t,"e",(function(){return m})),n.d(t,"r",(function(){return h})),n.d(t,"f",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"j",(function(){return j})),n.d(t,"g",(function(){return f})),n.d(t,"k",(function(){return O})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return _})),n.d(t,"n",(function(){return v}));var a=n(8),r=n(321);function o(){return Object(a.getJSON)("/api/alm_settings/list_definitions").catch(r.a)}function i(e){return Object(a.getJSON)("/api/alm_settings/list",{project:e}).then(({almSettings:e})=>e).catch(r.a)}function s(e){return Object(a.post)("/api/alm_settings/create_github",e).catch(r.a)}function c(e){return Object(a.post)("/api/alm_settings/update_github",e).catch(r.a)}function l(e){return Object(a.post)("/api/alm_settings/create_azure",e).catch(r.a)}function p(e){return Object(a.post)("/api/alm_settings/update_azure",e).catch(r.a)}function d(e){return Object(a.post)("/api/alm_settings/create_bitbucket",e).catch(r.a)}function u(e){return Object(a.post)("/api/alm_settings/update_bitbucket",e).catch(r.a)}function m(e){return Object(a.post)("/api/alm_settings/create_gitlab",e).catch(r.a)}function h(e){return Object(a.post)("/api/alm_settings/update_gitlab",e).catch(r.a)}function g(e){return Object(a.post)("/api/alm_settings/delete",{key:e}).catch(r.a)}function b(e){return Object(a.getJSON)("/api/alm_settings/count_binding",{almSetting:e}).then(({projects:e})=>e).catch(r.a)}function j(e){return Object(a.getJSON)("/api/alm_settings/get_binding",{project:e})}function f(e){return Object(a.post)("/api/alm_settings/delete_binding",{project:e}).catch(r.a)}function O(e){return Object(a.post)("/api/alm_settings/set_azure_binding",e).catch(r.a)}function y(e){return Object(a.post)("/api/alm_settings/set_bitbucket_binding",e).catch(r.a)}function _(e){return Object(a.post)("/api/alm_settings/set_github_binding",e).catch(r.a)}function v(e){return Object(a.post)("/api/alm_settings/set_gitlab_binding",e).catch(r.a)}},651:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s}));const a="almintegration",r="exclusions",o="languages",i="new_code_period",s="pull_request_decoration_binding"},688:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var a=n(2),r=n(304),o=n(314),i=n(310),s=n(500),c=n.n(s),l=n(5),p=n(8),d=n(321);var u=n(577),m=n(462),h=n.n(m),g=n(332);function b(){return a.createElement("ul",{className:"note"},a.createElement(j,null,Object(l.translate)("billing.upgrade_box.unlimited_private_projects")),a.createElement(j,null,Object(l.translate)("billing.upgrade_box.strict_control_private_data")),a.createElement(j,null,Object(l.translate)("billing.upgrade_box.cancel_anytime")),a.createElement(j,null,a.createElement("strong",null,Object(l.translateWithParameters)("billing.upgrade_box.free_trial_x",14))))}function j({children:e}){return a.createElement("li",{className:"display-flex-center little-spacer-bottom"},a.createElement(h.a,{className:"spacer-right",fill:g.colors.lightGreen}),e)}var f=n(327),O=n.n(f),y=n(316),_=n.n(y),v=n(378),k=n(398);class E extends a.Component{render(){const{BillingForm:e}=window.SonarBilling;return a.createElement(e,Object.assign({},this.props))}}const S=Object(v.a)(E);class P extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={ready:!1}}componentDidMount(){this.mounted=!0,Object(k.a)("billing/billing").then(()=>{this.mounted&&this.setState({ready:!0})},()=>{})}componentWillUnmount(){this.mounted=!1}render(){const e=Object(l.translate)("billing.upgrade_box.upgrade_to_paid_plan");return this.state.ready?a.createElement(O.a,{contentLabel:e,noBackdrop:this.props.insideModal,onRequestClose:this.props.onClose,shouldCloseOnOverlayClick:!1,size:"medium"},a.createElement("div",{className:"modal-head"},a.createElement("h2",null,e)),a.createElement(S,{onCommit:this.props.onUpgradeDone,organizationKey:this.props.organization.key,subscriptionPlans:this.props.subscriptionPlans},({onSubmit:e,processingUpgrade:t,renderFormFields:n,renderNextCharge:o,renderRecap:s,renderSubmitButton:c})=>a.createElement("form",{id:"organization-paid-plan-form",onSubmit:e},a.createElement("div",{className:"modal-body modal-container"},a.createElement("div",{className:"huge-spacer-bottom"},a.createElement("p",{className:"spacer-bottom"},a.createElement(r.FormattedMessage,{defaultMessage:Object(l.translate)("billing.upgrade.org_x_advantages"),id:"billing.coupon.description",values:{org:a.createElement("strong",null,this.props.organization.name)}})),a.createElement(b,null)),n(),a.createElement("div",{className:"big-spacer-top"},s())),a.createElement("footer",{className:"modal-foot display-flex-center display-flex-space-between"},o()||a.createElement("span",null),a.createElement("div",null,a.createElement(_.a,{loading:t}),c(),a.createElement(i.ResetButtonLink,{onClick:this.props.onClose},Object(l.translate)("cancel"))))))):null}}class N extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={subscriptionPlans:[],upgradeOrganizationModal:!1},this.fetchSubscriptionPlans=()=>Object(p.getJSON)("/api/billing/show_subscription_plans").then(({subscriptionPlans:e})=>e,d.a).then(e=>{this.mounted&&this.setState({subscriptionPlans:e})}),this.handleUpgradeClick=()=>{this.setState({upgradeOrganizationModal:!0})},this.handleUpgradeOrganizationModalClose=()=>{this.mounted&&this.setState({upgradeOrganizationModal:!1})},this.handleOrganizationUpgrade=()=>{this.props.onOrganizationUpgrade(),this.handleUpgradeOrganizationModalClose()}}componentDidMount(){this.mounted=!0,this.fetchSubscriptionPlans()}componentWillUnmount(){this.mounted=!1}render(){if(!Object(l.hasMessage)("billing.upgrade_box.header"))return null;const{subscriptionPlans:e,upgradeOrganizationModal:t}=this.state,n=e[0]&&e[0].price;return a.createElement(a.Fragment,null,a.createElement(c.a,{className:this.props.className,title:Object(l.translate)("billing.upgrade_box.header"),titleInfo:void 0!==n&&a.createElement(r.FormattedMessage,{defaultMessage:Object(l.translate)("billing.price_from_x"),id:"billing.price_from_x",values:{price:a.createElement("span",{className:"big"},Object(u.e)(n))}})},a.createElement(a.Fragment,null,a.createElement(b,null),a.createElement("div",{className:"big-spacer-left"},a.createElement(i.Button,{className:"js-upgrade-organization",onClick:this.handleUpgradeClick},Object(l.translate)("billing.paid_plan.upgrade")),a.createElement(o.Link,{className:"spacer-left",target:"_blank",to:"/about/pricing"},Object(l.translate)("billing.pricing.learn_more"))))),t&&a.createElement(P,{insideModal:this.props.insideModal,onClose:this.handleUpgradeOrganizationModalClose,onUpgradeDone:this.handleOrganizationUpgrade,organization:this.props.organization,subscriptionPlans:e}))}}},782:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return p}));var a=n(8),r=n(321);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(){return Object(a.getJSON)("/api/alm_integration/show_app_info").catch(r.a)}function l(e){return Object(a.getJSON)("/api/alm_integration/list_repositories",e).catch(r.a)}function p(e){return Object(a.postJSON)("/api/alm_integration/provision_projects",i({},e,{installationKeys:e.installationKeys.join(",")})).catch(r.a)}}}]);
//# sourceMappingURL=320.m.45cea597.chunk.js.map