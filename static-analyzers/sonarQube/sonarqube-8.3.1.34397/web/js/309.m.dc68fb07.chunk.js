(window.webpackJsonp=window.webpackJsonp||[]).push([[309],{1075:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return l}));var s=a(8),r=a(321);function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function c(e){return Object(s.getJSON)("/api/measures/search_history",e).catch(r.a)}function l(e,t){return c(i({},e,{ps:1e3})).then(a=>{const s=t?{measures:t.measures.map((e,t)=>i({},e,{history:e.history.concat(a.measures[t].history)})),paging:a.paging}:a;return s.paging.pageIndex*s.paging.pageSize>=s.paging.total?s:l(i({},e,{p:s.paging.pageIndex+1}),s)})}},1076:function(e,t,a){(t=a(312)(!1)).push([e.i,".activity-graph-container{padding:10px 0}.activity-graph-tooltip{padding:8px}.activity-graph-tooltip-line{height:20px}.activity-graph-tooltip-line+.activity-graph-tooltip-line{padding-top:4px}.activity-graph-tooltip-issues-line{height:26px;padding-bottom:4px}.activity-graph-tooltip-separator{padding-left:16px;padding-right:16px}.activity-graph-tooltip-separator hr{margin-top:8px;margin-bottom:8px}.activity-graph-tooltip-title,.activity-graph-tooltip-value{font-weight:700}.activity-graph-legends{flex-grow:0;padding-bottom:16px;text-align:center}.activity-graph-legend-actionable{display:inline-block;padding:4px 8px 4px 12px;border-width:1px;border-style:solid;border-radius:12px}",""]),e.exports=t},1100:function(e,t,a){"use strict";a.d(t,"a",(function(){return V}));var s=a(578),r=a.n(s),n=a(2),i=a(316),o=a.n(i),c=a(5),l=a(336),p=a(513),d=a(671),u=a(1077),h=a.n(u),m=a(318),y=a(345),g=a(315),v=a.n(g),f=a(309),b=a.n(f),E=a(310),j=a(690),O=a.n(j),x=a(650),D=a.n(x);class k extends n.PureComponent{constructor(){super(...arguments),this.handleClick=()=>{this.props.removeMetric&&this.props.removeMetric(this.props.metric)}}render(){const e=null!=this.props.removeMetric,t=f({"activity-graph-legend-actionable":e},this.props.className);return n.createElement("span",{className:t},this.props.showWarning?n.createElement(O.a,{className:"spacer-right"}):n.createElement(D.a,{className:"text-middle spacer-right",index:this.props.index}),n.createElement("span",{className:"text-middle"},this.props.name),e&&n.createElement(E.ClearButton,{className:"button-tiny spacer-left text-middle",iconProps:{size:12},onClick:this.handleClick}))}}var S=a(409);function N({removeMetric:e,series:t}){return n.createElement("div",{className:"activity-graph-legends"},t.map((t,a)=>{const s=Object(S.h)(t),r=n.createElement(k,{index:a,metric:t.name,name:t.translatedName,removeMetric:e,showWarning:!s});return s?n.createElement("span",{className:"spacer-left spacer-right",key:t.name},r):n.createElement(v.a,{key:t.name,overlay:Object(c.translate)("project_activity.graphs.custom.metric_no_history")},n.createElement("span",{className:"spacer-left spacer-right"},r))}))}function C({series:e}){return n.createElement("div",{className:"activity-graph-legends"},e.map((e,t)=>n.createElement(k,{className:"big-spacer-left big-spacer-right",index:t,key:e.name,metric:e.name,name:e.translatedName})))}var P=a(349),_=a.n(P),w=a(365),M=a(410);function A({name:e,index:t,translatedName:a,value:s}){return n.createElement("tr",{className:"activity-graph-tooltip-line",key:e},n.createElement("td",{className:"thin"},n.createElement(D.a,{className:"spacer-right",index:t})),n.createElement("td",{className:"activity-graph-tooltip-value text-right spacer-right thin"},s),n.createElement("td",null,a))}function L({addSeparator:e,measuresHistory:t,tooltipIdx:a}){const s=t.find(e=>"uncovered_lines"===e.metric),r=t.find(e=>"coverage"===e.metric);if(!(s&&s.history[a]&&r&&r.history[a]))return null;const i=s.history[a].value,o=r.history[a].value;return n.createElement("tbody",null,e&&n.createElement("tr",null,n.createElement("td",{className:"activity-graph-tooltip-separator",colSpan:3},n.createElement("hr",null))),i&&n.createElement("tr",{className:"activity-graph-tooltip-line"},n.createElement("td",{className:"activity-graph-tooltip-value text-right spacer-right thin",colSpan:2},Object(m.formatMeasure)(i,"SHORT_INT")),n.createElement("td",null,Object(c.translate)("metric.uncovered_lines.name"))),o&&n.createElement("tr",{className:"activity-graph-tooltip-line"},n.createElement("td",{className:"activity-graph-tooltip-value text-right spacer-right thin",colSpan:2},Object(m.formatMeasure)(o,"PERCENT")),n.createElement("td",null,Object(c.translate)("metric.coverage.name"))))}function T({addSeparator:e,measuresHistory:t,tooltipIdx:a}){const s=t.find(e=>"duplicated_lines_density"===e.metric);if(!s||!s.history[a])return null;const r=s.history[a].value;return r?n.createElement("tbody",null,e&&n.createElement("tr",null,n.createElement("td",{className:"activity-graph-tooltip-separator",colSpan:3},n.createElement("hr",null))),n.createElement("tr",{className:"activity-graph-tooltip-line"},n.createElement("td",{className:"activity-graph-tooltip-value text-right spacer-right thin",colSpan:2},Object(m.formatMeasure)(r,"PERCENT")),n.createElement("td",null,Object(c.translate)("metric.duplicated_lines_density.name")))):null}var I=a(599),q=a.n(I);function H({addSeparator:e,events:t}){return n.createElement("tbody",null,e&&n.createElement("tr",null,n.createElement("td",{className:"activity-graph-tooltip-separator",colSpan:3},n.createElement("hr",null))),n.createElement("tr",{className:"activity-graph-tooltip-line"},n.createElement("td",{colSpan:3},n.createElement("span",null,Object(c.translate)("events"),":"),t.map(e=>n.createElement("span",{className:"spacer-left",key:e.key},n.createElement(q.a,{className:b()("project-activity-event-icon",e.category)}))))))}var B=a(388),F=a.n(B);const R={bugs:"reliability_rating",vulnerabilities:"security_rating",code_smells:"sqale_rating"};function z(e){const t=e.measuresHistory.find(t=>t.metric===R[e.name]);if(!t||!t.history[e.tooltipIdx])return null;const a=t.history[e.tooltipIdx].value;return n.createElement("tr",{className:"activity-graph-tooltip-issues-line",key:e.name},n.createElement("td",{className:"thin"},n.createElement(D.a,{className:"spacer-right",index:e.index})),n.createElement("td",{className:"text-right spacer-right"},n.createElement("span",{className:"activity-graph-tooltip-value"},e.value),a&&n.createElement(F.a,{className:"spacer-left",small:!0,value:a})),n.createElement("td",null,e.translatedName))}class G extends n.PureComponent{renderContent(){const{tooltipIdx:e}=this.props;return this.props.series.map((t,a)=>{const s=t.data[e];return!s||!s.y&&0!==s.y?null:this.props.graph===S.a?n.createElement(z,{index:a,key:t.name,measuresHistory:this.props.measuresHistory,name:t.name,tooltipIdx:e,translatedName:t.translatedName,value:this.props.formatValue(s.y)}):n.createElement(A,{index:a,key:t.name,name:t.name,translatedName:t.translatedName,value:this.props.formatValue(s.y)})})}render(){const{events:e,measuresHistory:t,tooltipIdx:a}=this.props;let s=this.props.tooltipPos+60,r=w.PopupPlacement.RightTop;s>this.props.graphWidth-250-50&&(s-=250,r=w.PopupPlacement.LeftTop);const i=this.renderContent().filter(M.isDefined),o=i.length>0;return n.createElement(w.Popup,{className:"disabled-pointer-events",placement:r,style:{top:30,left:s,width:250}},n.createElement("div",{className:"activity-graph-tooltip"},n.createElement("div",{className:"activity-graph-tooltip-title spacer-bottom"},n.createElement(_.a,{date:this.props.selectedDate})),n.createElement("table",{className:"width-100"},n.createElement("tbody",null,i),"coverage"===this.props.graph&&n.createElement(L,{addSeparator:o,measuresHistory:t,tooltipIdx:a}),"duplications"===this.props.graph&&n.createElement(T,{addSeparator:o,measuresHistory:t,tooltipIdx:a}),e&&e.length>0&&n.createElement(H,{addSeparator:o,events:e}))))}}class Q extends n.PureComponent{constructor(){super(...arguments),this.state={},this.formatValue=e=>Object(m.formatMeasure)(e,Object(y.getShortType)(this.props.metricsType)),this.formatTooltipValue=e=>Object(m.formatMeasure)(e,this.props.metricsType),this.updateTooltip=(e,t,a)=>{this.props.updateTooltip(e),this.setState({tooltipXPos:t,tooltipIdx:a})}}render(){const{events:e,graph:t,graphEndDate:a,graphStartDate:s,isCustom:r,leakPeriodDate:i,measuresHistory:o,metricsType:c,selectedDate:l,series:p,showAreas:u}=this.props,{tooltipIdx:m,tooltipXPos:y}=this.state;return n.createElement("div",{className:"activity-graph-container flex-grow display-flex-column display-flex-stretch display-flex-justify-center"},r&&this.props.removeCustomMetric?n.createElement(N,{removeMetric:this.props.removeCustomMetric,series:p}):n.createElement(C,{series:p}),n.createElement("div",{className:"flex-1"},n.createElement(d.AutoSizer,null,({height:r,width:d})=>n.createElement("div",null,n.createElement(h.a,{endDate:a,formatYTick:this.formatValue,height:r,leakPeriodDate:i,metricType:c,selectedDate:l,series:p,showAreas:u,startDate:s,updateSelectedDate:this.props.updateSelectedDate,updateTooltip:this.updateTooltip,updateZoom:this.props.updateGraphZoom,width:d}),void 0!==l&&void 0!==m&&void 0!==y&&n.createElement(G,{events:e,formatValue:this.formatTooltipValue,graph:t,graphWidth:d,measuresHistory:o,selectedDate:l,series:p,tooltipIdx:m,tooltipPos:y})))))}}a(787);class V extends n.PureComponent{constructor(e){super(e),this.getSelectedDateEvents=()=>{const{selectedDate:e}=this.state,{analyses:t}=this.props;if(t&&e){const a=t.find(t=>t.date.valueOf()===e.valueOf());if(a)return a.events}return[]},this.updateTooltip=e=>{this.setState({selectedDate:e})},this.state={selectedDate:e.selectedDate}}componentWillReceiveProps(e){r()(e.selectedDate,this.props.selectedDate)||this.setState({selectedDate:e.selectedDate})}render(){const{graph:e,loading:t,series:a}=this.props,s=Object(S.j)(e);if(t)return n.createElement("div",{className:"activity-graph-container flex-grow display-flex-column display-flex-stretch display-flex-justify-center"},n.createElement("div",{className:"text-center"},n.createElement(o.a,{loading:t})));if(!Object(S.i)(a))return n.createElement("div",{className:"activity-graph-container flex-grow display-flex-column display-flex-stretch display-flex-justify-center"},n.createElement("div",{className:"display-flex-center display-flex-justify-center"},n.createElement("img",{alt:"",className:"spacer-right",height:52,src:"".concat(Object(l.getBaseUrl)(),"/images/activity-chart.svg")}),n.createElement("div",{className:"big-spacer-left big text-muted",style:{maxWidth:300}},Object(c.translate)(s?"project_activity.graphs.custom.no_history":"component_measures.no_history"))));const r=this.getSelectedDateEvents(),i=[p.a.coverage,p.a.duplications].includes(e);return n.createElement("div",{className:"display-flex-justify-center display-flex-column display-flex-stretch flex-grow"},this.props.graphs.map((t,a)=>n.createElement(Q,{events:r,graph:e,graphEndDate:this.props.graphEndDate,graphStartDate:this.props.graphStartDate,isCustom:s,key:a,leakPeriodDate:this.props.leakPeriodDate,measuresHistory:this.props.measuresHistory,metricsType:Object(S.g)(t),removeCustomMetric:this.props.removeCustomMetric,selectedDate:this.state.selectedDate,series:t,showAreas:i,updateGraphZoom:this.props.updateGraphZoom,updateSelectedDate:this.props.updateSelectedDate,updateTooltip:this.updateTooltip})))}}},1101:function(e,t,a){"use strict";var s=a(326),r=a.n(s),n=a(2),i=a(309),o=a(310),c=a(599),l=a.n(c),p=a(5),d=a(315),u=a.n(d),h=a(699),m=a(788),y=a(789);function g({event:e}){if(Object(y.b)(e))return n.createElement(y.a,{event:e});if(Object(m.b)(e))return n.createElement(h.a.Consumer,null,({branchLike:t})=>n.createElement(m.a,{branchLike:t,event:e}));{const t=n.createElement("span",{className:"text-middle"},n.createElement("span",{className:"note little-spacer-right"},Object(p.translate)("event.category",e.category),":"),n.createElement("strong",{className:"spacer-right"},e.name));return e.description?n.createElement(u.a,{overlay:e.description},t):t}}var v=a(344),f=a.n(v);class b extends n.PureComponent{constructor(e){super(e),this.changeInput=e=>{this.setState({name:e.target.value})},this.handleSubmit=()=>this.props.changeEvent(this.props.event.key,this.state.name),this.state={name:e.event.name}}render(){const{name:e}=this.state;return n.createElement(f.a,{confirmButtonText:Object(p.translate)("change_verb"),confirmDisable:!e||e===this.props.event.name,header:this.props.header,onClose:this.props.onClose,onConfirm:this.handleSubmit,size:"small"},n.createElement("div",{className:"modal-field"},n.createElement("label",null,Object(p.translate)("name")),n.createElement("input",{autoFocus:!0,onChange:this.changeInput,type:"text",value:e})))}}function E(e){const{analysisKey:t,event:a,header:s,removeEventQuestion:r}=e;return n.createElement(f.a,{confirmButtonText:Object(p.translate)("delete"),header:s,isDestructive:!0,onClose:e.onClose,onConfirm:()=>e.onConfirm(t,a.key)},r)}var j=n.memo((function(e){const{analysisKey:t,event:a,canAdmin:s,isFirst:r}=e,[c,d]=n.useState(!1),[u,h]=n.useState(!1),m="OTHER"===a.category,y="VERSION"===a.category,v=(m||y)&&e.onChange,f=(m||y&&!r)&&e.onDelete,j=s&&(v||f);return n.createElement("div",{className:"project-activity-event"},n.createElement(l.a,{className:i("project-activity-event-icon little-spacer-right text-middle",a.category)}),n.createElement(g,{event:a}),j&&n.createElement("span",{className:"nowrap"},v&&n.createElement(o.EditButton,{"aria-label":Object(p.translate)("project_activity.events.tooltip.edit"),className:"button-small","data-test":"project-activity__edit-event",onClick:()=>d(!0),stopPropagation:!0}),f&&n.createElement(o.DeleteButton,{"aria-label":Object(p.translate)("project_activity.events.tooltip.delete"),className:"button-small","data-test":"project-activity__delete-event",onClick:()=>h(!0),stopPropagation:!0})),c&&e.onChange&&n.createElement(b,{changeEvent:e.onChange,event:a,header:y?Object(p.translate)("project_activity.change_version"):Object(p.translate)("project_activity.change_custom_event"),onClose:()=>d(!1)}),u&&e.onDelete&&n.createElement(E,{analysisKey:t,event:a,header:y?Object(p.translate)("project_activity.remove_version"):Object(p.translate)("project_activity.remove_custom_event"),onClose:()=>h(!1),onConfirm:e.onDelete,removeEventQuestion:Object(p.translate)("project_activity.".concat(y?"remove_version":"remove_custom_event",".question"))}))}));t.a=n.memo((function(e){const{analysisKey:t,canAdmin:a,events:s,isFirst:i}=e,o=r()(s,e=>"VERSION"===e.category?1:0,"category");return n.createElement("div",{className:"big-spacer-top"},o.map(s=>n.createElement(j,{analysisKey:t,canAdmin:a,event:s,isFirst:i,key:s.key,onChange:e.onChange,onDelete:e.onDelete})))}))},1104:function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var s=a(309),r=a.n(s),n=a(2),i=a(340),o=a.n(i),c=a(5),l=a(326),p=a.n(l),d=a(498),u=a.n(d),h=a(310),m=a(324),y=a.n(m),g=a(330),v=a.n(g),f=a(345),b=a(325),E=a(464);function j(e,t){if(null==e)return{};var a,s,r=function(e,t){if(null==e)return{};var a,s,r={},n=Object.keys(e);for(s=0;s<n.length;s++)a=n[s],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)a=n[s],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function O(e){let{elements:t,metricsTypeFilter:a}=e,s=j(e,["elements","metricsTypeFilter"]),r="";return s.selectedElements.length>=6?r=n.createElement(b.Alert,{className:"spacer-left spacer-right spacer-top",variant:"info"},Object(c.translate)("project_activity.graphs.custom.add_metric_info")):a&&a.length>0&&(r=n.createElement(b.Alert,{className:"spacer-left spacer-right spacer-top",variant:"info"},Object(c.translateWithParameters)("project_activity.graphs.custom.type_x_message",a.map(e=>Object(c.translate)("metric.type",e)).sort().join(", ")))),n.createElement("div",{className:"menu abs-width-300"},n.createElement(E.a,{allowNewElements:!1,allowSelection:s.selectedElements.length<6,elements:t,filterSelected:s.filterSelected,footerNode:r,onSearch:s.onSearch,onSelect:e=>t.includes(e)&&s.onSelect(e),onUnselect:s.onUnselect,placeholder:Object(c.translate)("search.search_for_tags"),renderLabel:s.renderLabel,selectedElements:s.selectedElements}))}class x extends n.PureComponent{constructor(){super(...arguments),this.state={metrics:[],query:"",selectedMetrics:[]},this.filterSelected=(e,t)=>t.filter(t=>this.getLocalizedMetricNameFromKey(t).toLowerCase().includes(e.toLowerCase())),this.filterMetricsElements=({metricsTypeFilter:e,metrics:t,selectedMetrics:a},s)=>t.filter(t=>!(t.hidden||Object(f.isDiffMetric)(t.key)||["DATA","DISTRIB"].includes(t.type)||a.includes(t.key)||!Object(c.getLocalizedMetricName)(t).toLowerCase().includes(s.toLowerCase()))&&(!(e&&e.length>0)||e.includes(t.type))).map(e=>e.key),this.getSelectedMetricsElements=(e,t)=>{const a=t||this.props.selectedMetrics;return e.filter(e=>a.includes(e.key)).map(e=>e.key)},this.getLocalizedMetricNameFromKey=e=>{const t=u()(this.props.metrics,{key:e});return void 0===t?e:Object(c.getLocalizedMetricName)(t)},this.onSearch=e=>(this.setState({query:e}),Promise.resolve()),this.onSelect=e=>{this.props.addMetric(e),this.setState(t=>({selectedMetrics:p()([...t.selectedMetrics,e]),metrics:this.filterMetricsElements(this.props,t.query)}))},this.onUnselect=e=>{this.props.removeMetric(e),this.setState(t=>({metrics:p()([...t.metrics,e]),selectedMetrics:t.selectedMetrics.filter(t=>t!==e)}))}}render(){const{query:e}=this.state,t=this.filterMetricsElements(this.props,e),a=this.getSelectedMetricsElements(this.props.metrics,this.props.selectedMetrics);return n.createElement(y.a,{className:"display-inline-block",overlay:n.createElement(O,{elements:t,filterSelected:this.filterSelected,metricsTypeFilter:this.props.metricsTypeFilter,onSearch:this.onSearch,onSelect:this.onSelect,onUnselect:this.onUnselect,renderLabel:e=>this.getLocalizedMetricNameFromKey(e),selectedElements:a})},n.createElement(h.Button,{className:"spacer-left"},n.createElement("span",{className:"text-ellipsis text-middle"},Object(c.translate)("project_activity.graphs.custom.add")),n.createElement(v.a,{className:"text-top little-spacer-left"})))}}a(787);var D=a(409);class k extends n.PureComponent{constructor(){super(...arguments),this.handleGraphChange=e=>{e.value!==this.props.graph&&this.props.updateGraph(e.value)}}render(){const{addCustomMetric:e,className:t,graph:a,metrics:s,metricsTypeFilter:i,removeCustomMetric:l,selectedMetrics:p=[]}=this.props,d=Object(D.e)(void 0===e||void 0===l).map(e=>({label:Object(c.translate)("project_activity.graphs",e),value:e}));return n.createElement("div",{className:r()(t,"position-relative")},n.createElement(o.a,{className:"pull-left input-medium",clearable:!1,onChange:this.handleGraphChange,options:d,searchable:!1,value:a}),Object(D.j)(a)&&void 0!==e&&void 0!==l&&n.createElement(x,{addMetric:e,className:"pull-left spacer-left",metrics:s,metricsTypeFilter:i,removeMetric:l,selectedMetrics:p}))}}},1784:function(e,t,a){var s=a(311),r=a(1785);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1},i=(s(r,n),r.locals?r.locals:{});e.exports=i},1785:function(e,t,a){(t=a(312)(!1)).push([e.i,".project-activity-page{min-height:600px;height:calc(100vh - 250px)}.project-activity-page-side-outer{position:relative;width:400px;margin-bottom:0;display:flex;flex-direction:row;align-items:stretch}.project-activity-layout-page-main{flex-grow:1;min-width:640px;padding-left:20px;display:flex}.project-activity-layout-page-main-inner{min-width:640px;max-width:880px;margin-bottom:0;flex:1;display:flex;flex-direction:column;align-items:stretch}.project-activity-versions-list{max-width:400px;box-sizing:border-box;overflow:auto;flex-grow:1;flex-shrink:0;padding:16px 16px 16px 12px}.project-activity-day{margin-top:8px;margin-bottom:24px}.project-activity-day:last-child{margin-bottom:10px}.project-activity-date{margin-bottom:16px;font-size:16px;font-weight:700}.project-activity-analysis{position:relative;min-height:20px;padding:16px;cursor:pointer}.project-activity-analysis.selected{cursor:default;background-color:#ecf6fe}.project-activity-analysis:focus{outline:none}.project-activity-analysis:hover{background-color:#ecf6fe}.project-activity-analysis+.project-activity-analysis{border-top:none}.project-activity-analysis-actions{height:20px}.project-activity-time{height:20px;line-height:20px}.project-activity-event{line-height:20px;text-indent:-20px;padding-left:20px}.project-activity-event *{text-indent:0}.project-activity-event+.project-activity-event{margin-top:8px}.project-activity-event-inner-more-link{line-height:16px}.project-activity-event-icon.VERSION{color:#4b9fd5}.project-activity-event-icon.QUALITY_GATE{color:#9139d4}.project-activity-event-icon.QUALITY_PROFILE{color:#ccc}.project-activity-event-icon.DEFINITION_CHANGE{color:#33a759}.project-activity-event-icon.OTHER{color:#442d1b}.project-activity-version-badge{margin-left:-12px;padding-top:8px;padding-bottom:8px;background-color:#fff}.project-activity-version-badge.first,.project-activity-version-badge.sticky{position:absolute;top:0;left:12px;right:16px;padding-top:24px;z-index:1}.project-activity-version-badge.sticky+.project-activity-days-list{padding-top:36px}.project-activity-version-badge .analysis-version{max-width:385px;border-radius:0 2px 2px 0;overflow:hidden;text-overflow:ellipsis}.activity-graph-tooltip-line .project-activity-event-icon,.Select .project-activity-event-icon{margin-top:1px}.baseline-marker{position:absolute;top:-10px;left:0;right:0;display:flex;flex-direction:row;align-items:center}.baseline-marker>.wedge{border:10px solid transparent;border-left-color:#f1e8cb}.baseline-marker>hr{border:none;margin:0 0 0 -11px;background-color:#f1e8cb;height:2px;flex:1 0 auto}.baseline-marker>.label{background-color:#fbf3d5;border:1px solid #f1e8cb;padding:2px 8px;font-size:10px}",""]),e.exports=t},1886:function(e,t,a){"use strict";a.r(t),a.d(t,"PROJECT_ACTIVITY_GRAPH",(function(){return Se})),a.d(t,"default",(function(){return Ne}));var s=a(2),r=a(28),n=a(662),i=a(786),o=a(1075),c=a(409),l=a(329);function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){u(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var h=a(684),m=a(328),y=a(5),g=a(350),v=a(331),f=(a(1784),a(760)),b=a.n(f),E=a(309),j=a(728),O=a(315),x=a.n(O),D=a(351),k=a.n(D),S=a(348),N=a(380),C=a.n(N),P=a(425),_=a.n(P),w=a(322),M=a.n(w),A=a(561),L=a.n(A),T=a(365),I=a(426),q=a(1101),H=a(344),B=a.n(H);class F extends s.PureComponent{constructor(){super(...arguments),this.state={name:""},this.handleNameChange=e=>{this.setState({name:e.target.value})},this.handleSubmit=()=>this.props.addEvent(this.props.analysis.key,this.state.name)}render(){return s.createElement(B.a,{confirmButtonText:Object(y.translate)("save"),confirmDisable:!this.state.name,header:Object(y.translate)(this.props.addEventButtonText),onClose:this.props.onClose,onConfirm:this.handleSubmit,size:"small"},s.createElement("div",{className:"modal-field"},s.createElement("label",null,Object(y.translate)("name")),s.createElement("input",{autoFocus:!0,onChange:this.handleNameChange,type:"text",value:this.state.name})))}}function R({analysis:e,deleteAnalysis:t,onClose:a}){return s.createElement(B.a,{confirmButtonText:Object(y.translate)("delete"),confirmData:e.key,header:Object(y.translate)("project_activity.delete_analysis"),isDestructive:!0,onClose:a,onConfirm:t},Object(y.translate)("project_activity.delete_analysis.question"))}var z=s.memo((function(e){let t=null;const{analysis:a,isBaseline:n,isFirst:i,canAdmin:o,canCreateVersion:c,parentScrollContainer:l,selected:p}=e;s.useEffect(()=>{if(t&&l&&p){const{height:e}=t.getBoundingClientRect();Object(I.scrollToElement)(t,{bottomOffset:e+20,topOffset:60,parent:l,smooth:!1})}});const[d,u]=s.useState(!1),[h,m]=s.useState(!1),[g,v]=s.useState(!1),f=Object(r.parseDate)(a.date),b=null!=a.events.find(e=>"VERSION"===e.category),j=o&&!b&&c,O=o,x=e.canDeleteAnalyses&&!i&&!a.manualNewCodePeriodBaseline;return s.createElement("li",{className:E("project-activity-analysis bordered-top bordered-bottom",{selected:p}),onClick:()=>e.updateSelectedDate(a.date),ref:e=>t=e},s.createElement("div",{className:"display-flex-center display-flex-space-between"},s.createElement("div",{className:"project-activity-time"},s.createElement(L.a,{date:f,long:!1},e=>s.createElement("time",{className:"text-middle",dateTime:f.toISOString()},e))),a.buildString&&s.createElement("div",{className:"flex-shrink small text-muted text-ellipsis"},Object(y.translateWithParameters)("project_activity.analysis_build_string_X",a.buildString)),(j||O||x)&&s.createElement(_.a,null,s.createElement("div",{className:"project-activity-analysis-actions big-spacer-left"},s.createElement(C.a,{overlayPlacement:T.PopupPlacement.BottomRight,small:!0,toggleClassName:"js-analysis-actions"},j&&s.createElement(N.ActionsDropdownItem,{className:"js-add-version",onClick:()=>m(!0)},Object(y.translate)("project_activity.add_version")),O&&s.createElement(N.ActionsDropdownItem,{className:"js-add-event",onClick:()=>u(!0)},Object(y.translate)("project_activity.add_custom_event")),(j||O)&&x&&s.createElement(N.ActionsDropdownDivider,null),x&&s.createElement(N.ActionsDropdownItem,{className:"js-delete-analysis",destructive:!0,onClick:()=>v(!0)},Object(y.translate)("project_activity.delete_analysis"))),h&&s.createElement(F,{addEvent:e.addVersion,addEventButtonText:"project_activity.add_version",analysis:a,onClose:()=>m(!1)}),d&&s.createElement(F,{addEvent:e.addCustomEvent,addEventButtonText:"project_activity.add_custom_event",analysis:a,onClose:()=>u(!1)}),g&&s.createElement(R,{analysis:a,deleteAnalysis:e.deleteAnalysis,onClose:()=>v(!1)})))),a.events.length>0&&s.createElement(q.a,{analysisKey:a.key,canAdmin:o,events:a.events,isFirst:i,onChange:e.changeEvent,onDelete:e.deleteEvent}),n&&s.createElement("div",{className:"baseline-marker"},s.createElement("div",{className:"wedge"}),s.createElement("hr",null),s.createElement("div",{className:"label display-flex-center"},Object(y.translate)("project_activity.new_code_period_start"),s.createElement(M.a,{className:"little-spacer-left",overlay:Object(y.translate)("project_activity.new_code_period_start.help"),placement:"top"}))))}));class G extends s.PureComponent{constructor(e){super(e),this.handleScroll=()=>this.updateStickyBadges(!0),this.resetScrollTop=(e,t)=>{if(this.scrollContainer&&(this.scrollContainer.scrollTop=e),this.badges)for(let e=1;e<this.badges.length;e++)this.badges[e].removeAttribute("originOffsetTop"),this.badges[e].classList.remove("sticky");this.updateStickyBadges(t)},this.updateStickyBadges=e=>{if(!this.scrollContainer||!this.badges)return;const{scrollTop:t}=this.scrollContainer;if(null==t)return;let a;for(let s=1;s<this.badges.length;s++){const r=this.badges[s];let n=r.getAttribute("originOffsetTop");null==n&&(n=String(r.offsetTop),r.setAttribute("originOffsetTop",n)),Number(n)<t+18+2*s?(e&&!r.classList.contains("sticky")&&(a=n),r.classList.add("sticky")):r.classList.remove("sticky")}e&&null!=a&&(this.scrollContainer.scrollTop=Number(a)-6)},this.updateSelectedDate=e=>{this.props.updateQuery({selectedDate:e})},this.handleScroll=b()(this.handleScroll,20)}componentDidMount(){this.badges=document.getElementsByClassName("project-activity-version-badge"),this.analyses=document.getElementsByClassName("project-activity-analysis")}componentDidUpdate(e){this.scrollContainer&&Object(h.c)(e.query,this.props.query)&&this.resetScrollTop(0,!0)}shouldRenderBaselineMarker(e){return Boolean(this.props.leakPeriodDate&&Object(j.isEqual)(this.props.leakPeriodDate,e.date))}renderAnalysis(e){const t=this.props.analyses[0].key,a=this.props.query.selectedDate?this.props.query.selectedDate.valueOf():null;return s.createElement(z,{addCustomEvent:this.props.addCustomEvent,addVersion:this.props.addVersion,analysis:e,canAdmin:this.props.canAdmin,canCreateVersion:this.props.project.qualifier===S.a.Project,canDeleteAnalyses:this.props.canDeleteAnalyses,changeEvent:this.props.changeEvent,deleteAnalysis:this.props.deleteAnalysis,deleteEvent:this.props.deleteEvent,isBaseline:this.shouldRenderBaselineMarker(e),isFirst:e.key===t,key:e.key,parentScrollContainer:this.scrollContainer,selected:e.date.valueOf()===a,updateSelectedDate:this.updateSelectedDate})}render(){const e=Object(h.f)(this.props.analyses,this.props.query),t=e.length>1||1===e.length&&Object.keys(e[0].byDay).length>0;return 0!==this.props.analyses.length&&t?s.createElement("ul",{className:"project-activity-versions-list",onScroll:this.handleScroll,ref:e=>this.scrollContainer=e,style:{paddingTop:this.props.project.qualifier===S.a.Project?52:void 0}},e.map((e,t)=>{const a=Object.keys(e.byDay);return a.length<=0?null:s.createElement("li",{key:e.key||"noversion"},e.version&&s.createElement("div",{className:E("project-activity-version-badge",{first:0===t})},s.createElement(x.a,{mouseEnterDelay:.5,overlay:"".concat(Object(y.translate)("version")," ").concat(e.version)},s.createElement("span",{className:"analysis-version"},e.version))),s.createElement("ul",{className:"project-activity-days-list"},a.map(t=>s.createElement("li",{className:"project-activity-day","data-day":Object(r.toShortNotSoISOString)(Number(t)),key:t},s.createElement("div",{className:"project-activity-date"},s.createElement(k.a,{date:Number(t),long:!0})),s.createElement("ul",{className:"project-activity-analyses-list"},null!=e.byDay[t]&&e.byDay[t].map(e=>this.renderAnalysis(e)))))))}),this.props.analysesLoading&&s.createElement("li",{className:"text-center"},s.createElement("i",{className:"spinner"}))):s.createElement("div",{className:"boxed-group-inner"},this.props.initializing?s.createElement("div",{className:"text-center"},s.createElement("i",{className:"spinner"})):s.createElement("span",{className:"note"},Object(y.translate)("no_results")))}}var Q=a(326),V=a.n(Q),W=a(1786),U=a.n(W),K=a(1084),Z=a.n(K),Y=a(1788),J=a.n(Y),X=a(364),$=a.n(X),ee=a(1104),te=a(1100),ae=a(671),se=a(1789),re=a.n(se);function ne(e){return e.loading||!Object(c.i)(e.series)?null:s.createElement("div",{className:"activity-graph-zoom"},s.createElement(ae.AutoSizer,{disableHeight:!0},({width:t})=>s.createElement(re.a,{endDate:e.graphEndDate,height:64,leakPeriodDate:e.leakPeriodDate,metricType:e.metricsType,padding:[0,10,18,60],series:e.series,showAreas:e.showAreas,startDate:e.graphStartDate,updateZoom:e.updateGraphZoom,width:t})))}var ie=a(513);function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function ce(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(a),!0).forEach((function(t){le(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function le(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class pe extends s.PureComponent{constructor(e){super(e),this.getStateZoomDates=(e,t,a)=>{const s={from:t.query.from||void 0,to:t.query.to||void 0};if(!e||Object(h.e)(e.query,t.query))return{graphEndDate:s.to,graphStartDate:s.from};if(void 0===s.to&&void 0===s.from&&void 0!==a){const e=U()(a.map(e=>e.data.find(e=>Boolean(e.y||0===e.y))),"x"),t=Z()(a.map(e=>J()(e.data,e=>Boolean(e.y||0===e.y))),"x");return{graphEndDate:t&&t.x,graphStartDate:e&&e.x}}return null},this.getMetricsTypeFilter=()=>{if(!(this.state.graphs.length<2))return this.state.graphs.filter(e=>e.length<3).map(e=>e[0].type)},this.addCustomMetric=e=>{const t=[...this.props.query.customMetrics,e];Object(c.k)(Se,this.props.project,ie.a.custom,t),this.props.updateQuery({customMetrics:t})},this.removeCustomMetric=e=>{const t=this.props.query.customMetrics.filter(t=>t!==e);Object(c.k)(Se,this.props.project,ie.a.custom,t),this.props.updateQuery({customMetrics:t})},this.updateGraph=e=>{if(Object(c.k)(Se,this.props.project,e),Object(c.j)(e)&&this.props.query.customMetrics.length<=0){const{customGraphs:t}=Object(c.c)(Se,this.props.project);this.props.updateQuery({graph:e,customMetrics:t})}else this.props.updateQuery({graph:e,customMetrics:[]})},this.updateGraphZoom=(e,t)=>{if(void 0!==t&&void 0!==e){if(Math.abs(t.valueOf()-e.valueOf())<432e5)return}this.setState({graphStartDate:e,graphEndDate:t}),this.updateQueryDateRange([e,t])},this.updateSelectedDate=e=>this.props.updateQuery({selectedDate:e}),this.updateQueryDateRange=e=>{if(void 0===e[0]||void 0===e[1])this.props.updateQuery({from:e[0],to:e[1]});else{const t=V()(e);this.props.updateQuery({from:t[0],to:t[1]})}};const t=Object(c.b)(e.measuresHistory,e.query.graph,e.metrics,Object(c.d)(e.query.graph,e.query.customMetrics));this.state=ce({series:t,graphs:Object(c.l)(t,2,3)},this.getStateZoomDates(void 0,e,t)),this.updateQueryDateRange=$()(this.updateQueryDateRange,500)}componentDidUpdate(e){let t,a;(e.measuresHistory!==this.props.measuresHistory||Object(h.g)(e.query,this.props.query))&&(t=Object(c.b)(this.props.measuresHistory,this.props.query.graph,this.props.metrics,Object(c.d)(this.props.query.graph,this.props.query.customMetrics)),a=Object(c.l)(t,2,3));const s=this.getStateZoomDates(e,this.props,t);if(t||s){let e={};t&&(e.series=t),a&&(e.graphs=a),s&&(e=ce({},e,{},s)),this.setState(e)}}render(){const{leakPeriodDate:e,loading:t,metrics:a,query:r}=this.props,{graphEndDate:n,graphStartDate:i,series:o}=this.state;return s.createElement("div",{className:"project-activity-layout-page-main-inner boxed-group boxed-group-inner"},s.createElement(ee.a,{addCustomMetric:this.addCustomMetric,className:"big-spacer-bottom",graph:r.graph,metrics:a,metricsTypeFilter:this.getMetricsTypeFilter(),removeCustomMetric:this.removeCustomMetric,selectedMetrics:this.props.query.customMetrics,updateGraph:this.updateGraph}),s.createElement(te.a,{analyses:this.props.analyses,graph:r.graph,graphEndDate:n,graphStartDate:i,graphs:this.state.graphs,leakPeriodDate:e,loading:t,measuresHistory:this.props.measuresHistory,removeCustomMetric:this.removeCustomMetric,selectedDate:this.props.query.selectedDate,series:o,updateGraphZoom:this.updateGraphZoom,updateSelectedDate:this.updateSelectedDate}),s.createElement(ne,{graphEndDate:n,graphStartDate:i,leakPeriodDate:e,loading:t,metricsType:Object(c.g)(o),series:o,showAreas:[ie.a.coverage,ie.a.duplications].includes(r.graph),updateGraphZoom:this.updateGraphZoom}))}}var de=a(340),ue=a.n(de),he=a(310),me=a(629);class ye extends s.PureComponent{constructor(){super(...arguments),this.handleChange=({from:e,to:t})=>{this.props.onChange({from:e,to:t})},this.handleResetClick=()=>{this.props.onChange({from:void 0,to:void 0})}}render(){return s.createElement("div",null,s.createElement(me.a,{onChange:this.handleChange,value:{from:this.props.from,to:this.props.to}}),s.createElement(he.Button,{className:"spacer-left",disabled:void 0===this.props.from&&void 0===this.props.to,onClick:this.handleResetClick},Object(y.translate)("project_activity.reset_dates")))}}var ge=a(599),ve=a.n(ge);class fe extends s.PureComponent{constructor(){super(...arguments),this.handleMouseDown=e=>{e.preventDefault(),e.stopPropagation(),this.props.onSelect(this.props.option,e)},this.handleMouseEnter=e=>{this.props.onFocus(this.props.option,e)},this.handleMouseMove=e=>{this.props.isFocused||this.props.onFocus(this.props.option,e)}}render(){const{option:e}=this.props;return s.createElement("div",{className:this.props.className,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,role:"link",tabIndex:0,title:e.label},s.createElement(ve.a,{className:"project-activity-event-icon "+e.value}),s.createElement("span",{className:"little-spacer-left"},this.props.children))}}function be({children:e,value:t}){return s.createElement("div",{className:"Select-value",title:t.label},s.createElement("div",{className:"Select-value-label"},s.createElement(ve.a,{className:"project-activity-event-icon "+t.value}),s.createElement("span",{className:"little-spacer-left"},e)))}class Ee extends s.PureComponent{constructor(){super(...arguments),this.handleCategoryChange=e=>this.props.updateQuery({category:e?e.value:""})}render(){const e="APP"===this.props.project.qualifier,t=(e?h.a:h.b).map(e=>({label:Object(y.translate)("event.category",e),value:e}));return s.createElement("header",{className:"page-header"},!["VW","SVW"].includes(this.props.project.qualifier)&&s.createElement(ue.a,{className:E("pull-left big-spacer-right",{"input-medium":!e,"input-large":e}),clearable:!0,onChange:this.handleCategoryChange,optionComponent:fe,options:t,placeholder:Object(y.translate)("project_activity.filter_events")+"...",searchable:!1,value:this.props.category,valueComponent:be}),s.createElement(ye,{from:this.props.from,onChange:this.props.updateQuery,to:this.props.to}))}}function je(e){const{analyses:t,measuresHistory:a,query:n}=e,{configuration:i}=e.project,o=("TRK"===e.project.qualifier||"APP"===e.project.qualifier)&&!!i&&i.showHistory,c=!!i&&i.showHistory;return s.createElement("div",{className:"page page-limited",id:"project-activity"},s.createElement(v.a,{suggestions:"project_activity"}),s.createElement(m.a,{defer:!1,title:Object(y.translate)("project_activity.page")}),s.createElement(g.a,{anchor:"activity_main"}),s.createElement(Ee,{category:n.category,from:n.from,project:e.project,to:n.to,updateQuery:e.updateQuery}),s.createElement("div",{className:"layout-page project-activity-page"},s.createElement("div",{className:"layout-page-side-outer project-activity-page-side-outer boxed-group"},s.createElement(G,{addCustomEvent:e.addCustomEvent,addVersion:e.addVersion,analyses:t,analysesLoading:e.analysesLoading,canAdmin:o,canDeleteAnalyses:c,changeEvent:e.changeEvent,deleteAnalysis:e.deleteAnalysis,deleteEvent:e.deleteEvent,initializing:e.initializing,leakPeriodDate:e.project.leakPeriodDate?Object(r.parseDate)(e.project.leakPeriodDate):void 0,project:e.project,query:e.query,updateQuery:e.updateQuery})),s.createElement("div",{className:"project-activity-layout-page-main"},s.createElement(pe,{analyses:t,leakPeriodDate:e.project.leakPeriodDate?Object(r.parseDate)(e.project.leakPeriodDate):void 0,loading:e.graphLoading,measuresHistory:a,metrics:e.metrics,project:e.project.key,query:n,updateQuery:e.updateQuery}))))}function Oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function xe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(a),!0).forEach((function(t){De(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function De(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ke(e,t){if(null==e)return{};var a,s,r=function(e,t){if(null==e)return{};var a,s,r={},n=Object.keys(e);for(s=0;s<n.length;s++)a=n[s],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)a=n[s],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}const Se="sonar_project_activity.graph";class Ne extends s.PureComponent{constructor(e){super(e),this.mounted=!1,this.addCustomEvent=(e,t,a)=>i.b(e,t,a).then(e=>{let{analysis:t}=e,a=ke(e,["analysis"]);this.mounted&&this.setState(function(e,t){return a=>({analyses:a.analyses.map(a=>a.key!==e?a:d({},a,{events:[...a.events,t]}))})}(t,a))}),this.addVersion=(e,t)=>this.addCustomEvent(e,t,"VERSION"),this.changeEvent=(e,t)=>i.a(e,t).then(e=>{let{analysis:t}=e,a=ke(e,["analysis"]);this.mounted&&this.setState(function(e,t){return a=>({analyses:a.analyses.map(a=>a.key!==e?a:d({},a,{events:a.events.map(e=>e.key===t.key?d({},e,{},t):e)}))})}(t,a))}),this.deleteAnalysis=e=>i.c(e).then(()=>{this.mounted&&(this.updateGraphData(this.state.query.graph||c.a,this.state.query.customMetrics),this.setState(function(e){return t=>({analyses:t.analyses.filter(t=>t.key!==e)})}(e)))}),this.deleteEvent=(e,t)=>i.d(t).then(()=>{this.mounted&&this.setState(function(e,t){return a=>({analyses:a.analyses.map(a=>a.key!==e?a:d({},a,{events:a.events.filter(e=>e.key!==t)}))})}(e,t))}),this.fetchActivity=(e,t,a,s)=>{const n=xe({project:e,p:t,ps:a},Object(l.d)(this.props.branchLike));return i.e(xe({},s,{},n)).then(({analyses:e,paging:t})=>({analyses:e.map(e=>xe({},e,{date:Object(r.parseDate)(e.date)})),paging:t}))},this.fetchMeasuresHistory=e=>e.length<=0?Promise.resolve([]):Object(o.a)(xe({component:this.props.component.key,metrics:e.join()},Object(l.d)(this.props.branchLike))).then(({measures:e})=>e.map(e=>({metric:e.metric,history:e.history.map(e=>({date:Object(r.parseDate)(e.date),value:e.value}))}))),this.fetchAllActivities=e=>{this.setState({analysesLoading:!0}),this.loadAllActivities(e).then(({analyses:e})=>{this.mounted&&this.setState({analyses:e,analysesLoading:!1})},()=>{this.mounted&&this.setState({analysesLoading:!1})})},this.loadAllActivities=(e,t)=>{if(t&&t.paging.pageIndex*t.paging.pageSize>=t.paging.total)return Promise.resolve(t);const a=t?t.paging.pageIndex+1:1;return this.fetchActivity(e,a,500).then(a=>t?this.loadAllActivities(e,{analyses:t.analyses.concat(a.analyses),paging:a.paging}):this.loadAllActivities(e,a))},this.getTopLevelComponent=e=>{let t=e.breadcrumbs.length-1;for(;t>0&&!["TRK","VW","APP"].includes(e.breadcrumbs[t].qualifier);)t--;return e.breadcrumbs[t].key},this.updateGraphData=(e,t)=>{const a=Object(c.f)(e,t);this.setState({graphLoading:!0}),this.fetchMeasuresHistory(a).then(e=>{this.mounted&&this.setState({graphLoading:!1,measuresHistory:e})},()=>{this.mounted&&this.setState({graphLoading:!1,measuresHistory:[]})})},this.updateQuery=e=>{const t=Object(h.j)(xe({},this.state.query,{},e));this.props.router.push({pathname:this.props.location.pathname,query:xe({},t,{},Object(l.d)(this.props.branchLike),{id:this.props.component.key})})},this.shouldRedirect=()=>{const e=this.props.location.query;if(!e)return!1;const t=Object.keys(e).some(t=>"id"!==t&&""!==e[t]),{graph:a,customGraphs:s}=Object(c.c)(Se,this.props.component.key),r=Object(c.j)(a)&&s.length<=0;return!t&&null!=a&&a!==c.a&&!r},this.state={analyses:[],analysesLoading:!1,graphLoading:!0,initialized:!1,measuresHistory:[],metrics:[],query:Object(h.h)(e.location.query)}}componentDidMount(){if(this.mounted=!0,this.shouldRedirect()){const{graph:e,customGraphs:t}=Object(c.c)(Se,this.props.component.key),a=xe({},this.state.query,{graph:e});Object(c.j)(a.graph)&&(a.customMetrics=t),this.props.router.replace({pathname:this.props.location.pathname,query:xe({},Object(h.j)(a),{},Object(l.d)(this.props.branchLike))})}else this.firstLoadData(this.state.query,this.props.component)}componentDidUpdate(e){if(e.location.query!==this.props.location.query){const e=Object(h.h)(this.props.location.query);(e.graph!==this.state.query.graph||Object(h.d)(this.state.query,e))&&(this.state.initialized?this.updateGraphData(e.graph||c.a,e.customMetrics):this.firstLoadData(e,this.props.component)),this.setState({query:e})}}componentWillUnmount(){this.mounted=!1}filterMetrics({qualifier:e},t){return["VW","SVW"].includes(e)?t:t.filter(e=>"security_review_rating"!==e.key)}firstLoadData(e,t){const a=Object(c.f)(e.graph||c.a,e.customMetrics),s=this.getTopLevelComponent(t);Promise.all([this.fetchActivity(s,1,100,Object(h.i)(e)),Object(n.c)(),this.fetchMeasuresHistory(a)]).then(([{analyses:e},a,r])=>{this.mounted&&(this.setState({analyses:e,graphLoading:!1,initialized:!0,measuresHistory:r,metrics:this.filterMetrics(t,a)}),this.fetchAllActivities(s))},()=>{this.mounted&&this.setState({initialized:!0,graphLoading:!1})})}render(){return this.shouldRedirect()?null:s.createElement(je,{addCustomEvent:this.addCustomEvent,addVersion:this.addVersion,analyses:this.state.analyses,analysesLoading:this.state.analysesLoading,changeEvent:this.changeEvent,deleteAnalysis:this.deleteAnalysis,deleteEvent:this.deleteEvent,graphLoading:!this.state.initialized||this.state.graphLoading,initializing:!this.state.initialized,measuresHistory:this.state.measuresHistory,metrics:this.state.metrics,project:this.props.component,query:this.state.query,updateQuery:this.updateQuery})}}},331:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a(2),r=a(357);function n({suggestions:e}){return s.createElement(r.a.Consumer,null,({addSuggestions:t,removeSuggestions:a})=>s.createElement(i,{addSuggestions:t,removeSuggestions:a,suggestions:e}))}class i extends s.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},348:function(e,t,a){"use strict";var s,r;function n(e){return!!e&&[s.Portfolio.toString(),s.SubPortfolio.toString()].includes(e)}a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return n})),function(e){e.Application="APP",e.Directory="DIR",e.Developper="DEV",e.File="FIL",e.Portfolio="VW",e.Project="TRK",e.SubPortfolio="SVW",e.SubProject="BRC",e.TestFile="UTS"}(s||(s={})),function(e){e.Public="public",e.Private="private"}(r||(r={}))},350:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a(2),r=a(5),n=a(400);function i(e){return s.createElement(n.a.Consumer,null,({addA11ySkipLink:t,removeA11ySkipLink:a})=>s.createElement(o,Object.assign({addA11ySkipLink:t,removeA11ySkipLink:a},e)))}class o extends s.PureComponent{constructor(){super(...arguments),this.getLink=()=>{const{anchor:e,label:t=Object(r.translate)("skip_to_content"),weight:a}=this.props;return{key:e,label:t,weight:a}}}componentDidMount(){this.props.addA11ySkipLink(this.getLink())}componentWillUnmount(){this.props.removeA11ySkipLink(this.getLink())}render(){const{anchor:e}=this.props;return s.createElement("span",{id:"a11y_target__".concat(e)})}}},409:function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"j",(function(){return b})),a.d(t,"e",(function(){return E})),a.d(t,"h",(function(){return j})),a.d(t,"i",(function(){return O})),a.d(t,"g",(function(){return x})),a.d(t,"d",(function(){return D})),a.d(t,"f",(function(){return k})),a.d(t,"l",(function(){return S})),a.d(t,"b",(function(){return N})),a.d(t,"k",(function(){return C})),a.d(t,"c",(function(){return P}));var s=a(326),r=a.n(s),n=a(383),i=a.n(n),o=a(523),c=a.n(o),l=a(648),p=a.n(l),d=a(5),u=a(30),h=a(345),m=a(394),y=a(513);const g=y.a.issues,v={[y.a.issues]:[m.a.bugs,m.a.code_smells,m.a.vulnerabilities],[y.a.coverage]:[m.a.lines_to_cover,m.a.uncovered_lines],[y.a.duplications]:[m.a.ncloc,m.a.duplicated_lines]},f={[y.a.issues]:v[y.a.issues].concat([m.a.reliability_rating,m.a.security_rating,m.a.sqale_rating]),[y.a.coverage]:[...v[y.a.coverage],m.a.coverage],[y.a.duplications]:[...v[y.a.duplications],m.a.duplicated_lines_density]};function b(e){return e===y.a.custom}function E(e=!1){const t=[y.a.issues,y.a.coverage,y.a.duplications];return e?t:[...t,y.a.custom]}function j(e){return e.data.some(e=>Boolean(e.y||0===e.y))}function O(e){return e.some(e=>e.data&&e.data.length>1)}function x(e){return e.length>0?e[0].type:"INT"}function D(e,t){return b(e)?t:v[e]}function k(e,t){return b(e)?t:f[e]}function S(e,t,a){return c()(i()(e,e=>e.type),e=>p()(e,a)).slice(0,t)}function N(e,t,a,s){return s.length<=0||void 0===e?[]:r()(e.filter(e=>s.indexOf(e.metric)>=0).map(s=>{if(s.metric===m.a.uncovered_lines&&!b(t))return function(e,t){const a=t.find(e=>e.metric===m.a.lines_to_cover);return{data:a?e.history.map((e,t)=>({x:e.date,y:Number(a.history[t].value)-Number(e.value)})):[],name:"covered_lines",translatedName:Object(d.translate)("project_activity.custom_metric.covered_lines"),type:"INT"}}(s,e);const r=function(e,t){if(Array.isArray(t))return t.find(t=>t.key===e);return t[e]}(s.metric,a);return{data:s.history.map(e=>({x:e.date,y:r&&"LEVEL"===r.type?e.value:Number(e.value)})),name:s.metric,translatedName:r?Object(d.getLocalizedMetricName)(r):Object(h.localizeMetric)(s.metric),type:r?r.type:"INT"}}),e=>s.indexOf("covered_lines"===e.name?"uncovered_lines":e.name))}function C(e,t,a,s=[]){Object(u.save)(e,a,t),b(a)&&Object(u.save)("".concat(e,".custom"),s.join(","),t)}function P(e,t){const a=Object(u.get)("".concat(e,".custom"),t);return{graph:Object(u.get)(e,t)||g,customGraphs:a?a.split(","):[]}}},464:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var s=a(387),r=a.n(s),n=a(309),i=a(2),o=a(353),c=a.n(o),l=a(5),p=a(342),d=a.n(p);function u(e){const{active:t,custom:a,disabled:s,element:r,selected:o}=e,c=()=>e.onHover(r),p=n({active:t,disabled:s}),u=e.renderLabel(r);return i.createElement("li",{onFocus:c,onMouseOver:c},i.createElement(d.a,{checked:Boolean(o),className:p,disabled:s,id:r,onCheck:e.onSelectChange},a?i.createElement("span",{"aria-label":"".concat(Object(l.translate)("create_new_element"),": ").concat(u),className:"little-spacer-left"},i.createElement("span",{"aria-hidden":!0,className:"little-spacer-right"},"+"),u):i.createElement("span",{className:"little-spacer-left"},u)))}class h extends i.PureComponent{constructor(e){super(e),this.mounted=!1,this.handleSelectChange=(e,t)=>{e?this.onSelectItem(t):this.onUnselectItem(t)},this.handleSearchChange=e=>{this.onSearchQuery(this.props.validateSearchInput(e))},this.handleElementHover=e=>{this.setState((t,a)=>({activeIdx:this.getAllElements(a,t).indexOf(e)}))},this.handleKeyboard=e=>{switch(e.keyCode){case 40:e.stopPropagation(),e.preventDefault(),this.setState(this.selectNextElement);break;case 38:e.stopPropagation(),e.preventDefault(),this.setState(this.selectPreviousElement);break;case 37:case 39:e.stopPropagation();break;case 13:this.state.activeIdx>=0&&this.toggleSelect(this.getAllElements(this.props,this.state)[this.state.activeIdx])}},this.onSearchQuery=e=>{this.setState({activeIdx:0,loading:!0,query:e}),this.props.onSearch(e).then(this.stopLoading,this.stopLoading)},this.onSelectItem=e=>{this.isNewElement(e,this.props)&&this.onSearchQuery(""),this.props.onSelect(e)},this.onUnselectItem=e=>this.props.onUnselect(e),this.isNewElement=(e,{selectedElements:t,elements:a})=>e.length>0&&-1===t.indexOf(e)&&-1===a.indexOf(e),this.updateSelectedElements=e=>{this.setState(t=>t.query?{selectedElements:e.filterSelected(t.query,e.selectedElements)}:{selectedElements:[...e.selectedElements]})},this.updateUnselectedElements=e=>{this.setState(t=>0===e.listSize?{unselectedElements:r()(e.elements,e.selectedElements)}:e.listSize<t.selectedElements.length?{unselectedElements:[]}:{unselectedElements:r()(e.elements,e.selectedElements).slice(0,e.listSize-t.selectedElements.length)})},this.getAllElements=(e,t)=>this.isNewElement(t.query,e)?[...t.selectedElements,...t.unselectedElements,t.query]:[...t.selectedElements,...t.unselectedElements],this.setElementActive=e=>this.setState({activeIdx:e}),this.selectNextElement=(e,t)=>{const{activeIdx:a}=e,s=this.getAllElements(t,e);return a<0||a>=s.length-1?{activeIdx:0}:{activeIdx:a+1}},this.selectPreviousElement=(e,t)=>{const{activeIdx:a}=e,s=this.getAllElements(t,e);if(a<=0){return{activeIdx:s.length-1}}return{activeIdx:a-1}},this.stopLoading=()=>{this.mounted&&this.setState({loading:!1})},this.toggleSelect=e=>{-1===this.props.selectedElements.indexOf(e)?this.onSelectItem(e):this.onUnselectItem(e)},this.state={activeIdx:0,loading:!0,query:"",selectedElements:[],unselectedElements:[]}}componentDidMount(){this.mounted=!0,this.onSearchQuery(""),this.updateSelectedElements(this.props),this.updateUnselectedElements(this.props),this.container&&this.container.addEventListener("keydown",this.handleKeyboard,!0)}componentWillReceiveProps(e){if(this.props.elements!==e.elements||this.props.selectedElements!==e.selectedElements){this.updateSelectedElements(e),this.updateUnselectedElements(e);const t=this.getAllElements(e,this.state).length;this.state.activeIdx>=t&&this.setState({activeIdx:t-1})}}componentDidUpdate(){this.searchInput&&this.searchInput.focus()}componentWillUnmount(){this.mounted=!1,this.container&&this.container.removeEventListener("keydown",this.handleKeyboard)}render(){const{allowSelection:e=!0,allowNewElements:t=!0,footerNode:a=""}=this.props,{renderLabel:s}=this.props,{query:r,activeIdx:o,selectedElements:p,unselectedElements:d}=this.state,h=this.getAllElements(this.props,this.state)[o],m=t&&this.isNewElement(r,this.props),y=0===this.props.listSize,g=n("menu",{"menu-vertically-limited":y,"spacer-top":y,"with-top-separator":y,"with-bottom-separator":Boolean(a)});return i.createElement("div",{className:"multi-select",ref:e=>this.container=e},i.createElement("div",{className:"menu-search"},i.createElement(c.a,{autoFocus:!0,className:"little-spacer-top",loading:this.state.loading,onChange:this.handleSearchChange,placeholder:this.props.placeholder,value:r})),i.createElement("ul",{className:g},p.length>0&&p.map(e=>i.createElement(u,{active:h===e,element:e,key:e,onHover:this.handleElementHover,onSelectChange:this.handleSelectChange,renderLabel:s,selected:!0})),d.length>0&&d.map(t=>i.createElement(u,{active:h===t,disabled:!e,element:t,key:t,onHover:this.handleElementHover,onSelectChange:this.handleSelectChange,renderLabel:s})),m&&i.createElement(u,{active:h===r,custom:!0,element:r,key:r,onHover:this.handleElementHover,onSelectChange:this.handleSelectChange,renderLabel:s}),!m&&p.length<1&&d.length<1&&i.createElement("li",{className:"spacer-left"},Object(l.translateWithParameters)("no_results_for_x",r))),a)}}h.defaultProps={filterSelected:(e,t)=>t.filter(t=>t.includes(e)),listSize:0,renderLabel:e=>e,validateSearchInput:e=>e}},513:function(e,t,a){"use strict";var s;a.d(t,"a",(function(){return s})),function(e){e.issues="issues",e.coverage="coverage",e.duplications="duplications",e.custom="custom"}(s||(s={}))},531:function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var s=a(489),r=a.n(s),n=a(309),i=a(384),o=a(439),c=a(473),l=a(474),p=a(2),d=a(304),u=a(310),h=a(541),m=a.n(h),y=a(340),g=a.n(y),v=a(532),f=a.n(v),b=a(496),E=a.n(b),j=a(418),O=a.n(j),x=a(323),D=a(5);a(533),a(535);function k(e,t){if(null==e)return{};var a,s,r=function(e,t){if(null==e)return{};var a,s,r={},n=Object.keys(e);for(s=0;s<n.length;s++)a=n[s],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)a=n[s],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}const S=Object(x.lazyLoadComponent)(()=>a.e(329).then(a.t.bind(null,686,7)),"DayPicker");class N extends p.PureComponent{constructor(e){super(e),this.focus=()=>{this.input&&this.input.focus(),this.openCalendar()},this.handleResetClick=()=>{this.closeCalendar(),this.props.onChange(void 0)},this.openCalendar=()=>{this.setState({currentMonth:this.props.value||this.props.currentMonth||new Date,lastHovered:void 0,open:!0})},this.closeCalendar=()=>{this.setState({open:!1})},this.handleDayClick=(e,t)=>{t.disabled||(this.closeCalendar(),this.props.onChange(e))},this.handleDayMouseEnter=(e,t)=>{this.setState({lastHovered:t.disabled?void 0:e})},this.handleCurrentMonthChange=({value:e})=>{this.setState(t=>({currentMonth:o(t.currentMonth,e)}))},this.handleCurrentYearChange=({value:e})=>{this.setState(t=>({currentMonth:c(t.currentMonth,e)}))},this.handlePreviousMonthClick=()=>{this.setState(e=>({currentMonth:l(e.currentMonth,1)}))},this.handleNextMonthClick=()=>{this.setState(e=>({currentMonth:i(e.currentMonth,1)}))},this.state={currentMonth:e.value||e.currentMonth||new Date,open:!1}}render(){const{highlightFrom:e,highlightTo:t,minDate:a,value:s}=this.props,{lastHovered:i}=this.state,o=this.props.maxDate||new Date,c=r()(12),l=r()((new Date).getFullYear()-10,(new Date).getFullYear()+1),d=s?[s]:[];let h;const y=i||s;e&&y&&(h={highlighted:{from:e,to:y}},d.push(e)),t&&y&&(h={highlighted:{from:y,to:t}},d.push(t));const v=r()(7).map(D.getWeekDayName),b=r()(7).map(D.getShortWeekDayName);return p.createElement(m.a,{onClickOutside:this.closeCalendar},p.createElement("span",{className:n("date-input-control",this.props.className)},p.createElement(P,{className:n("date-input-control-input",this.props.inputClassName,{"is-filled":void 0!==this.props.value}),innerRef:e=>this.input=e,name:this.props.name,onFocus:this.openCalendar,placeholder:this.props.placeholder,readOnly:!0,type:"text",value:s}),p.createElement(f.a,{className:"date-input-control-icon",fill:""}),void 0!==this.props.value&&p.createElement(u.ClearButton,{className:"button-tiny date-input-control-reset",iconProps:{size:12},onClick:this.handleResetClick}),this.state.open&&p.createElement("div",{className:"date-input-calendar"},p.createElement("nav",{className:"date-input-calendar-nav"},p.createElement(u.ButtonIcon,{className:"button-small",onClick:this.handlePreviousMonthClick},p.createElement(E.a,null)),p.createElement("div",{className:"date-input-calender-month"},p.createElement(g.a,{className:"date-input-calender-month-select",onChange:this.handleCurrentMonthChange,options:c.map(e=>({label:Object(D.getShortMonthName)(e),value:e})),value:this.state.currentMonth.getMonth()}),p.createElement(g.a,{className:"date-input-calender-month-select spacer-left",onChange:this.handleCurrentYearChange,options:l.map(e=>({label:String(e),value:e})),value:this.state.currentMonth.getFullYear()})),p.createElement(u.ButtonIcon,{className:"button-small",onClick:this.handleNextMonthClick},p.createElement(O.a,null))),p.createElement(S,{captionElement:p.createElement(C,null),disabledDays:{after:o,before:a},firstDayOfWeek:1,modifiers:h,month:this.state.currentMonth,navbarElement:p.createElement(C,null),onDayClick:this.handleDayClick,onDayMouseEnter:this.handleDayMouseEnter,selectedDays:d,weekdaysLong:v,weekdaysShort:b}))))}}function C(){return null}const P=Object(d.injectIntl)(e=>{let{innerRef:t,intl:a,value:s}=e,r=k(e,["innerRef","intl","value"]);const n=s&&a.formatDate(s,{year:"numeric",month:"short",day:"numeric"});return p.createElement("input",Object.assign({},r,{ref:t,value:n||""}))})},533:function(e,t,a){var s=a(311),r=a(534);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1},i=(s(r,n),r.locals?r.locals:{});e.exports=i},534:function(e,t,a){(t=a(312)(!1)).push([e.i,".DayPicker{display:inline-block}.DayPicker-wrapper{position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none;padding-bottom:8px;flex-direction:row}.DayPicker-Months{display:flex;flex-wrap:wrap;justify-content:center}.DayPicker-Month{display:table;border-collapse:collapse;border-spacing:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;margin:8px 8px 0}.DayPicker-Weekdays{display:table-header-group}.DayPicker-WeekdaysRow{display:table-row}.DayPicker-Weekday{display:table-cell;padding:8px;font-size:12px;text-align:center;color:#999}.DayPicker-Weekday abbr[title]{border-bottom:none;text-decoration:none}.DayPicker-Body{display:table-row-group}.DayPicker-Week{display:table-row}.DayPicker-Day{display:table-cell;line-height:15px;padding:8px;text-align:center;cursor:pointer;vertical-align:top;outline:none}.DayPicker--interactionDisabled .DayPicker-Day{cursor:default}.DayPicker-Footer{padding-top:8px}.DayPicker-Day--today{font-weight:700}.DayPicker-Day--outside{cursor:default;color:#8b9898}.DayPicker-Day--disabled{color:#cdcdcd;cursor:not-allowed}.DayPicker-Day--sunday{background-color:#f7f8f8}.DayPicker-Day--sunday:not(.DayPicker-Day--today){color:#dce0e0}.DayPicker-Day--selected:not(.DayPicker-Day--disabled):not(.DayPicker-Day--outside){background-color:#4b9fd5;color:#fff}.DayPicker:not(.DayPicker--interactionDisabled) .DayPicker-Day:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--highlighted):not(.DayPicker-Day--outside):hover{background-color:#f3f3f3}.DayPicker-Day--highlighted:not(.DayPicker-Day--disabled):not(.DayPicker-Day--selected):not(.DayPicker-Day--outside){background-color:#cae3f2}",""]),e.exports=t},535:function(e,t,a){var s=a(311),r=a(536);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1},i=(s(r,n),r.locals?r.locals:{});e.exports=i},536:function(e,t,a){(t=a(312)(!1)).push([e.i,".date-input-control{position:relative;display:inline-block;cursor:pointer}.date-input-control-input{width:130px;padding-left:24px!important;cursor:pointer}.date-input-control-input.is-filled{padding-right:16px!important}.date-input-control-icon{position:absolute;top:4px;left:4px}.date-input-control-icon path{fill:#cdcdcd;transition:fill .3s ease}.date-input-control-input:focus+.date-input-control-icon path{fill:#4b9fd5}.date-input-control-reset{position:absolute;top:4px;right:4px;border:none}.date-input-calendar{position:absolute;z-index:7500;top:100%;left:0;border:1px solid #e6e6e6;background-color:#fff;box-shadow:0 6px 12px rgba(0,0,0,.175)}.date-input-calendar-nav{display:flex;justify-content:space-between;align-items:center;padding-top:8px;padding-left:8px;padding-right:8px}.date-input-calender-month-select{width:70px}",""]),e.exports=t},629:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var s=a(309),r=a(2),n=a(5),i=a(531);class o extends r.PureComponent{constructor(){super(...arguments),this.handleFromChange=e=>{this.props.onChange({from:e,to:this.to}),setTimeout(()=>{e&&!this.to&&this.toDateInput&&this.toDateInput.focus()},0)},this.handleToChange=e=>{this.props.onChange({from:this.from,to:e})}}get from(){return this.props.value&&this.props.value.from}get to(){return this.props.value&&this.props.value.to}render(){return r.createElement("div",{className:s("display-inline-flex-center",this.props.className)},r.createElement(i.a,{currentMonth:this.to,"data-test":"from",highlightTo:this.to,maxDate:this.to,onChange:this.handleFromChange,placeholder:Object(n.translate)("start_date"),value:this.from}),r.createElement("span",{className:"note little-spacer-left little-spacer-right"},Object(n.translate)("to_")),r.createElement(i.a,{currentMonth:this.from,"data-test":"to",highlightFrom:this.from,minDate:this.from,onChange:this.handleToChange,placeholder:Object(n.translate)("end_date"),ref:e=>this.toDateInput=e,value:this.to}))}}},684:function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return h})),a.d(t,"e",(function(){return m})),a.d(t,"g",(function(){return y})),a.d(t,"f",(function(){return g})),a.d(t,"h",(function(){return v})),a.d(t,"i",(function(){return f})),a.d(t,"j",(function(){return b}));var s=a(578),r=a.n(s),n=a(427),i=a(28),o=a(432),c=a(409),l=a(513);const p=["VERSION","QUALITY_GATE","QUALITY_PROFILE","OTHER"],d=["QUALITY_GATE","DEFINITION_CHANGE","OTHER"];function u(e,t){return e.category!==t.category||m(e,t)}function h(e,t){return!r()(e.customMetrics,t.customMetrics)}function m(e,t){return!r()(e.from,t.from)||!r()(e.to,t.to)}function y(e,t){return e.graph!==t.graph}function g(e,t){return e.reduce((e,a)=>{let s=e[e.length-1];const r=a.events.find(e=>"VERSION"===e.category);if(r){const t={version:r.name,key:r.key,byDay:{}};!s||Object.keys(s.byDay).length>0?e.push(t):e[e.length-1]=t,s=t}else s||(s={version:null,key:null,byDay:{}},e.push(s));const o=n(Object(i.parseDate)(a.date)).getTime().toString();let c=!0;if(t.category||t.from||t.to){const e=!t.from||a.date>=t.from,s=!t.to||a.date<=t.to,r=!t.category||null!=a.events.find(e=>e.category===t.category);c=e&&s&&r}return c&&(s.byDay[o]||(s.byDay[o]=[]),s.byDay[o].push(a)),e},[])}function v(e){return{category:Object(o.parseAsString)(e.category),customMetrics:Object(o.parseAsArray)(e.custom_metrics,o.parseAsString),from:Object(o.parseAsDate)(e.from),graph:E(e.graph),project:Object(o.parseAsString)(e.id),to:Object(o.parseAsDate)(e.to),selectedDate:Object(o.parseAsDate)(e.selected_date)}}function f(e){return Object(o.cleanQuery)({category:Object(o.serializeString)(e.category),from:Object(o.serializeDate)(e.from),project:Object(o.serializeString)(e.project),to:Object(o.serializeDate)(e.to)})}function b(e){return Object(o.cleanQuery)({category:Object(o.serializeString)(e.category),custom_metrics:Object(o.serializeStringArray)(e.customMetrics),from:Object(o.serializeDate)(e.from),graph:(t=e.graph,t===c.a?void 0:t),id:Object(o.serializeString)(e.project),to:Object(o.serializeDate)(e.to),selected_date:Object(o.serializeDate)(e.selectedDate)});var t}function E(e){const t=Object(o.parseAsString)(e);return Object.keys(l.a).includes(t)?t:c.a}},699:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var s=a(2);const r=s.createContext({branchLike:void 0,component:void 0})},786:function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return l}));var s=a(8),r=a(321);function n(e){return Object(s.getJSON)("/api/project_analyses/search",e).catch(r.a)}function i(e,t,a,n){const i={analysis:e,name:t};return a&&(i.category=a),n&&(i.description=n),Object(s.postJSON)("/api/project_analyses/create_event",i).then(e=>e.event,r.a)}function o(e){return Object(s.post)("/api/project_analyses/delete_event",{event:e}).catch(r.a)}function c(e,t,a){const n={event:e};return t&&(n.name=t),a&&(n.description=a),Object(s.postJSON)("/api/project_analyses/update_event",n).then(e=>e.event,r.a)}function l(e){return Object(s.post)("/api/project_analyses/delete",{analysis:e}).catch(r.a)}},787:function(e,t,a){var s=a(311),r=a(1076);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1},i=(s(r,n),r.locals?r.locals:{});e.exports=i},788:function(e,t,a){"use strict";a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return g}));var s=a(2),r=a(304),n=a(314),i=a(310),o=a(401),c=a.n(o),l=a(330),p=a.n(l),d=a(5),u=a(390),h=a(329),m=a(320);function y(e){return"DEFINITION_CHANGE"===e.category&&void 0!==e.definitionChange}class g extends s.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.stopPropagation=e=>{e.stopPropagation()},this.toggleProjectsList=()=>{this.setState(e=>({expanded:!e.expanded}))},this.renderProjectLink=(e,t)=>s.createElement(n.Link,{onClick:this.stopPropagation,title:e.name,to:Object(m.t)(e.key,t)},Object(u.limitComponentName)(e.name,28)),this.renderBranch=(e=Object(d.translate)("branches.main_branch"))=>s.createElement("span",{className:"nowrap",title:e},s.createElement(c.a,{className:"little-spacer-left text-text-top"}),e)}renderProjectChange(e){const t=!this.props.branchLike||Object(h.g)(this.props.branchLike);if("ADDED"===e.changeType){const a=t?"event.definition_change.added":"event.definition_change.branch_added";return s.createElement("div",{className:"text-ellipsis"},s.createElement(r.FormattedMessage,{defaultMessage:Object(d.translate)(a),id:a,values:{project:this.renderProjectLink(e,e.branch),branch:this.renderBranch(e.branch)}}))}if("REMOVED"===e.changeType){const a=t?"event.definition_change.removed":"event.definition_change.branch_removed";return s.createElement("div",{className:"text-ellipsis"},s.createElement(r.FormattedMessage,{defaultMessage:Object(d.translate)(a),id:a,values:{project:this.renderProjectLink(e,e.branch),branch:this.renderBranch(e.branch)}}))}return"BRANCH_CHANGED"===e.changeType?s.createElement(r.FormattedMessage,{defaultMessage:Object(d.translate)("event.definition_change.branch_replaced"),id:"event.definition_change.branch_replaced",values:{project:this.renderProjectLink(e,e.newBranch),oldBranch:this.renderBranch(e.oldBranch),newBranch:this.renderBranch(e.newBranch)}}):null}render(){const{event:e}=this.props,{expanded:t}=this.state;return s.createElement(s.Fragment,null,s.createElement("span",{className:"note"},Object(d.translate)("event.category",e.category),":"),s.createElement("div",null,s.createElement(i.ResetButtonLink,{className:"project-activity-event-inner-more-link",onClick:this.toggleProjectsList,stopPropagation:!0},t?Object(d.translate)("hide"):Object(d.translate)("more"),s.createElement(p.a,{className:"little-spacer-left",turned:t}))),t&&s.createElement("ul",{className:"spacer-left spacer-top"},e.definitionChange.projects.map(e=>s.createElement("li",{className:"display-flex-center spacer-top",key:e.key},this.renderProjectChange(e)))))}}},789:function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return m}));var s=a(2),r=a(304),n=a(314),i=a(310),o=a(330),c=a.n(o),l=a(372),p=a.n(l),d=a(5),u=a(320);function h(e){return"QUALITY_GATE"===e.category&&void 0!==e.qualityGate}class m extends s.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.stopPropagation=e=>{e.stopPropagation()},this.toggleProjectsList=()=>{this.setState(e=>({expanded:!e.expanded}))}}render(){const{event:e}=this.props,{expanded:t}=this.state;return s.createElement(s.Fragment,null,s.createElement("span",{className:"note spacer-right"},Object(d.translate)("event.category",e.category),":"),e.qualityGate.stillFailing?s.createElement(r.FormattedMessage,{defaultMessage:Object(d.translate)("event.quality_gate.still_x"),id:"event.quality_gate.still_x",values:{status:s.createElement(p.a,{level:e.qualityGate.status,small:!0})}}):s.createElement(p.a,{level:e.qualityGate.status,small:!0}),s.createElement("div",null,e.qualityGate.failing.length>0&&s.createElement(i.ResetButtonLink,{className:"project-activity-event-inner-more-link",onClick:this.toggleProjectsList,stopPropagation:!0},t?Object(d.translate)("hide"):Object(d.translate)("more"),s.createElement(c.a,{className:"little-spacer-left",turned:t}))),t&&s.createElement("ul",{className:"spacer-left spacer-top"},e.qualityGate.failing.map(t=>s.createElement("li",{className:"display-flex-center spacer-top",key:t.key},s.createElement(p.a,{"aria-label":Object(d.translate)("quality_gates.status"),className:"spacer-right",level:e.qualityGate.status,small:!0}),s.createElement("div",{className:"flex-1 text-ellipsis"},s.createElement(n.Link,{onClick:this.stopPropagation,title:t.name,to:Object(u.t)(t.key,t.branch)},s.createElement("span",{"aria-label":Object(d.translateWithParameters)("project_x",t.name)},t.name)))))))}}}}]);
//# sourceMappingURL=309.m.dc68fb07.chunk.js.map