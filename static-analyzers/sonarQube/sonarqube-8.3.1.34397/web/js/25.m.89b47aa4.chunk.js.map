{"version":3,"sources":["webpack:///./src/main/js/components/common/OrganizationHelmet.tsx","webpack:///./src/main/js/apps/permission-templates/utils.ts","webpack:///./src/main/js/apps/permission-templates/components/Form.tsx","webpack:///./src/main/js/apps/permission-templates/components/Header.tsx","webpack:///./src/main/js/apps/permission-templates/components/ListHeader.tsx","webpack:///./src/main/js/apps/permission-templates/components/DeleteForm.tsx","webpack:///./src/main/js/apps/permission-templates/components/ActionsCell.tsx","webpack:///./src/main/js/apps/permission-templates/components/Defaults.tsx","webpack:///./src/main/js/apps/permission-templates/components/NameCell.tsx","webpack:///./src/main/js/apps/permission-templates/components/PermissionCell.tsx","webpack:///./src/main/js/apps/permission-templates/components/ListItem.tsx","webpack:///./src/main/js/apps/permission-templates/components/List.tsx","webpack:///./src/main/js/apps/permission-templates/components/Home.tsx","webpack:///./src/main/js/apps/permission-templates/components/TemplateDetails.tsx","webpack:///./src/main/js/apps/permission-templates/components/TemplateHeader.tsx","webpack:///./src/main/js/apps/permission-templates/components/Template.tsx","webpack:///./src/main/js/apps/permission-templates/components/App.tsx","webpack:///./src/main/js/app/components/embed-docs-modal/Suggestions.tsx","webpack:///./src/main/js/apps/permissions/utils.ts","webpack:///./src/main/js/api/permissions.ts","webpack:///./src/main/js/apps/permissions/styles.css?a730","webpack:///./src/main/js/apps/permissions/styles.css","webpack:///./src/main/js/apps/permissions/shared/components/SearchForm.tsx","webpack:///./src/main/js/apps/permissions/shared/components/PermissionCell.tsx","webpack:///./src/main/js/apps/permissions/shared/components/GroupHolder.tsx","webpack:///./src/main/js/apps/permissions/shared/components/PermissionHeader.tsx","webpack:///./src/main/js/apps/permissions/shared/components/UserHolder.tsx","webpack:///./src/main/js/apps/permissions/shared/components/HoldersList.tsx"],"names":["OrganizationHelmet","title","organization","defaultTitle","name","defer","titleTemplate","PERMISSIONS_ORDER","props","super","mounted","handleSubmit","this","onSubmit","description","state","projectKeyPattern","then","onClose","handleNameChange","event","setState","currentTarget","value","handleDescriptionChange","handleProjectKeyPatternChange","permissionTemplate","header","size","onCloseClick","onFormSubmit","submitting","id","className","htmlFor","autoFocus","maxLength","onChange","required","type","loading","disabled","confirmButtonText","onClick","createModal","handleCreateClick","handleCreateModalClose","handleCreateModalSubmit","data","key","response","refresh","pathname","router","push","query","ready","withRouter","permission","InstanceMessage","message","Alert","variant","cells","permissions","map","overlay","renderTooltip","DeleteForm","t","deleteForm","updateModal","handleUpdateClick","handleCloseUpdateModal","handleSubmitUpdateModal","handleDeleteClick","handleCloseDeleteForm","handleDeleteSubmit","templateId","replace","setDefault","qualifier","topQualifiers","isDefault","defaultFor","availableQualifiers","getAvailableQualifiers","length","renderIfSingleTopQualifier","renderIfMultipleTopQualifiers","child","ActionsDropdown","renderSetDefaultLink","renderSetDefaultsControl","fromDetails","to","destructive","Defaults","template","qualifiersToDisplay","qualifiers","join","NameCell","PermissionCell","p","withProjectCreator","usersCount","groupsCount","ListItem","List","permissionTemplates","Home","TemplateDetails","TemplateHeader","filter","groups","users","requestHolders","realQuery","selectedPermission","requests","finalQuery","Promise","resolve","all","responses","handleToggleUser","user","login","handleToggleProjectCreator","hasPermission","includes","handleToggleGroup","group","groupName","Object","assign","handleSearch","handleFilter","handleSelectPermission","undefined","shouldDisplayCreator","creatorPermissions","CREATOR_NAME","isFiltered","matchQuery","toLocaleLowerCase","toLowerCase","matchPermission","allUsers","creator","unshift","HoldersList","onSelectPermission","onToggleGroup","onToggleUser","showPublicProjectsWarning","SearchForm","onFilter","onSearch","requestPermissions","r","indexOf","sortPermissions","defaultTemplates","forEach","defaultTemplate","mergeDefaultsToTemplates","basePermissions","basePermission","projectPermission","find","mergePermissionsToTemplates","location","Suggestions","suggestions","renderTemplate","renderHome","Consumer","addSuggestions","removeSuggestions","SuggestionsInner","prevProps","PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE","PERMISSIONS_ORDER_GLOBAL","category","PERMISSIONS_ORDER_GLOBAL_GOV","PERMISSIONS_ORDER_FOR_VIEW","PERMISSIONS_ORDER_BY_QUALIFIER","TRK","VW","SVW","APP","DEV","convertToPermissionDefinition","l10nPrefix","getMessage","messageKey","cloudMessageKey","convertToPermissionDefinitions","isPermissionDefinitionGroup","Boolean","grantPermissionToUser","catch","revokePermissionFromUser","grantPermissionToGroup","revokePermissionFromGroup","getPermissionTemplates","url","createPermissionTemplate","updatePermissionTemplate","deletePermissionTemplate","setDefaultPermissionTemplate","applyTemplateToProject","bulkApplyTemplate","grantTemplatePermissionToUser","revokeTemplatePermissionFromUser","grantTemplatePermissionToGroup","revokeTemplatePermissionFromGroup","addProjectCreatorToTemplate","removeProjectCreatorFromTemplate","getPermissionsUsersForComponent","ps","getPermissionsGroupsForComponent","getGlobalPermissionsUsers","getGlobalPermissionsGroups","getPermissionTemplateUsers","q","getPermissionTemplateGroups","changeProjectVisibility","project","visibility","changeProjectDefaultVisibility","projectVisibility","api","content","__esModule","default","module","i","options","exported","locals","exports","___CSS_LOADER_API_IMPORT___","filterOptions","label","onCheck","minLength","placeholder","permissionItem","checked","selected","stopLoading","handleCheck","_checked","onToggle","style","whiteSpace","handlePermissionClick","preventDefault","blur","getTooltipOverlay","href","permissionCells","Avatar","hash","avatar","email","initialPermissionsCount","handleGroupToggle","handleUserToggle","getItemInitialPermissionsCount","item","isPermissionUser","columns","colSpan","items","itemWithPermissions","itemWithoutPermissions","children","renderEmpty","renderItem"],"mappings":"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","file":"js/25.m.89b47aa4.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\n\ninterface Props {\n  organization?: { name: string };\n  title: string;\n}\n\nexport default function OrganizationHelmet({ title, organization }: Props) {\n  const defaultTitle = title + (organization ? ' - ' + organization.name : '');\n  return (\n    <Helmet defaultTitle={defaultTitle} defer={false} titleTemplate={`%s - ${defaultTitle}`} />\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { sortBy } from 'lodash';\n\nexport const PERMISSIONS_ORDER = [\n  'user',\n  'codeviewer',\n  'issueadmin',\n  'securityhotspotadmin',\n  'admin',\n  'scan'\n];\n\nexport function sortPermissions(permissions: T.Permission[]) {\n  return sortBy(permissions, p => PERMISSIONS_ORDER.indexOf(p.key));\n}\n\nexport function mergePermissionsToTemplates(\n  permissionTemplates: T.PermissionTemplate[],\n  basePermissions: T.Permission[]\n): T.PermissionTemplate[] {\n  return permissionTemplates.map(permissionTemplate => {\n    // it's important to keep the order of the permission template's permissions\n    // the same as the order of base permissions\n    const permissions = basePermissions.map(basePermission => {\n      const projectPermission = permissionTemplate.permissions.find(\n        p => p.key === basePermission.key\n      );\n      return { usersCount: 0, groupsCount: 0, ...basePermission, ...projectPermission };\n    });\n\n    return { ...permissionTemplate, permissions };\n  });\n}\n\nexport function mergeDefaultsToTemplates(\n  permissionTemplates: T.PermissionTemplate[],\n  defaultTemplates: Array<{ templateId: string; qualifier: string }> = []\n): T.PermissionTemplate[] {\n  return permissionTemplates.map(permissionTemplate => {\n    const defaultFor: string[] = [];\n\n    defaultTemplates.forEach(defaultTemplate => {\n      if (defaultTemplate.templateId === permissionTemplate.id) {\n        defaultFor.push(defaultTemplate.qualifier);\n      }\n    });\n\n    return { ...permissionTemplate, defaultFor };\n  });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  confirmButtonText: string;\n  header: string;\n  onClose: () => void;\n  onSubmit: (data: {\n    description: string;\n    name: string;\n    projectKeyPattern: string;\n  }) => Promise<void>;\n  permissionTemplate?: { description?: string; name: string; projectKeyPattern?: string };\n}\n\ninterface State {\n  description: string;\n  name: string;\n  projectKeyPattern: string;\n}\n\nexport default class Form extends React.PureComponent<Props, State> {\n  mounted = false;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      description: (props.permissionTemplate && props.permissionTemplate.description) || '',\n      name: (props.permissionTemplate && props.permissionTemplate.name) || '',\n      projectKeyPattern:\n        (props.permissionTemplate && props.permissionTemplate.projectKeyPattern) || ''\n    };\n  }\n\n  handleSubmit = () => {\n    return this.props\n      .onSubmit({\n        description: this.state.description,\n        name: this.state.name,\n        projectKeyPattern: this.state.projectKeyPattern\n      })\n      .then(this.props.onClose);\n  };\n\n  handleNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ name: event.currentTarget.value });\n  };\n\n  handleDescriptionChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    this.setState({ description: event.currentTarget.value });\n  };\n\n  handleProjectKeyPatternChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ projectKeyPattern: event.currentTarget.value });\n  };\n\n  render() {\n    return (\n      <SimpleModal\n        header={this.props.header}\n        onClose={this.props.onClose}\n        onSubmit={this.handleSubmit}\n        size=\"small\">\n        {({ onCloseClick, onFormSubmit, submitting }) => (\n          <form id=\"permission-template-form\" onSubmit={onFormSubmit}>\n            <header className=\"modal-head\">\n              <h2>{this.props.header}</h2>\n            </header>\n\n            <div className=\"modal-body\">\n              <div className=\"modal-field\">\n                <label htmlFor=\"permission-template-name\">\n                  {translate('name')}\n                  <em className=\"mandatory\">*</em>\n                </label>\n                <input\n                  autoFocus={true}\n                  id=\"permission-template-name\"\n                  maxLength={256}\n                  name=\"name\"\n                  onChange={this.handleNameChange}\n                  required={true}\n                  type=\"text\"\n                  value={this.state.name}\n                />\n                <div className=\"modal-field-description\">{translate('should_be_unique')}</div>\n              </div>\n\n              <div className=\"modal-field\">\n                <label htmlFor=\"permission-template-description\">{translate('description')}</label>\n                <textarea\n                  id=\"permission-template-description\"\n                  name=\"description\"\n                  onChange={this.handleDescriptionChange}\n                  value={this.state.description}\n                />\n              </div>\n\n              <div className=\"modal-field\">\n                <label htmlFor=\"permission-template-project-key-pattern\">\n                  {translate('permission_template.key_pattern')}\n                </label>\n                <input\n                  id=\"permission-template-project-key-pattern\"\n                  maxLength={500}\n                  name=\"projectKeyPattern\"\n                  onChange={this.handleProjectKeyPatternChange}\n                  type=\"text\"\n                  value={this.state.projectKeyPattern}\n                />\n                <div className=\"modal-field-description\">\n                  {translate('permission_template.key_pattern.description')}\n                </div>\n              </div>\n            </div>\n\n            <footer className=\"modal-foot\">\n              <DeferredSpinner className=\"spacer-right\" loading={submitting} />\n              <SubmitButton disabled={submitting} id=\"permission-template-submit\">\n                {this.props.confirmButtonText}\n              </SubmitButton>\n              <ResetButtonLink\n                disabled={submitting}\n                id=\"permission-template-cancel\"\n                onClick={onCloseClick}>\n                {translate('cancel')}\n              </ResetButtonLink>\n            </footer>\n          </form>\n        )}\n      </SimpleModal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Button } from 'sonar-ui-common/components/controls/buttons';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { createPermissionTemplate } from '../../../api/permissions';\nimport { Router, withRouter } from '../../../components/hoc/withRouter';\nimport Form from './Form';\n\ninterface Props {\n  organization?: { key: string };\n  ready?: boolean;\n  refresh: () => Promise<void>;\n  router: Pick<Router, 'push'>;\n}\n\ninterface State {\n  createModal: boolean;\n}\n\nclass Header extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { createModal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleCreateClick = () => {\n    this.setState({ createModal: true });\n  };\n\n  handleCreateModalClose = () => {\n    if (this.mounted) {\n      this.setState({ createModal: false });\n    }\n  };\n\n  handleCreateModalSubmit = (data: {\n    description: string;\n    name: string;\n    projectKeyPattern: string;\n  }) => {\n    const organization = this.props.organization && this.props.organization.key;\n    return createPermissionTemplate({ ...data, organization }).then(response => {\n      this.props.refresh().then(() => {\n        const pathname = organization\n          ? `/organizations/${organization}/permission_templates`\n          : '/permission_templates';\n        this.props.router.push({ pathname, query: { id: response.permissionTemplate.id } });\n      });\n    });\n  };\n\n  render() {\n    return (\n      <header className=\"page-header\" id=\"project-permissions-header\">\n        <h1 className=\"page-title\">{translate('permission_templates.page')}</h1>\n\n        {!this.props.ready && <i className=\"spinner\" />}\n\n        <div className=\"page-actions\">\n          <Button onClick={this.handleCreateClick}>{translate('create')}</Button>\n\n          {this.state.createModal && (\n            <Form\n              confirmButtonText={translate('create')}\n              header={translate('permission_template.new_template')}\n              onClose={this.handleCreateModalClose}\n              onSubmit={this.handleCreateModalSubmit}\n            />\n          )}\n        </div>\n\n        <p className=\"page-description\">{translate('permission_templates.page.description')}</p>\n      </header>\n    );\n  }\n}\n\nexport default withRouter(Header);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport InstanceMessage from '../../../components/common/InstanceMessage';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  permissions: T.Permission[];\n}\n\nexport default class ListHeader extends React.PureComponent<Props> {\n  renderTooltip(permission: T.Permission) {\n    return permission.key === 'user' || permission.key === 'codeviewer' ? (\n      <div>\n        <InstanceMessage message={translate('projects_role', permission.key, 'desc')} />\n        <Alert className=\"spacer-top\" variant=\"warning\">\n          {translate('projects_role.public_projects_warning')}\n        </Alert>\n      </div>\n    ) : (\n      <InstanceMessage message={translate('projects_role', permission.key, 'desc')} />\n    );\n  }\n\n  render() {\n    const cells = this.props.permissions.map(permission => (\n      <th className=\"permission-column little-padded-left little-padded-right\" key={permission.key}>\n        <div className=\"permission-column-inner\">\n          <span className=\"text-middle\">{translate('projects_role', permission.key)}</span>\n          <HelpTooltip className=\"spacer-left\" overlay={this.renderTooltip(permission)} />\n        </div>\n      </th>\n    ));\n\n    return (\n      <thead>\n        <tr>\n          <th className=\"little-padded-left little-padded-right\">&nbsp;</th>\n          {cells}\n          <th className=\"thin nowrap text-right little-padded-left little-padded-right\">&nbsp;</th>\n        </tr>\n      </thead>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { ResetButtonLink, SubmitButton } from 'sonar-ui-common/components/controls/buttons';\nimport SimpleModal from 'sonar-ui-common/components/controls/SimpleModal';\nimport DeferredSpinner from 'sonar-ui-common/components/ui/DeferredSpinner';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  onClose: () => void;\n  onSubmit: () => Promise<void>;\n  permissionTemplate: T.PermissionTemplate;\n}\n\nexport default function DeleteForm({ onClose, onSubmit, permissionTemplate: t }: Props) {\n  const header = translate('permission_template.delete_confirm_title');\n\n  return (\n    <SimpleModal header={header} onClose={onClose} onSubmit={onSubmit}>\n      {({ onCloseClick, onFormSubmit, submitting }) => (\n        <form onSubmit={onFormSubmit}>\n          <header className=\"modal-head\">\n            <h2>{header}</h2>\n          </header>\n\n          <div className=\"modal-body\">\n            {translateWithParameters(\n              'permission_template.do_you_want_to_delete_template_xxx',\n              t.name\n            )}\n          </div>\n\n          <footer className=\"modal-foot\">\n            <DeferredSpinner className=\"spacer-right\" loading={submitting} />\n            <SubmitButton className=\"button-red\" disabled={submitting}>\n              {translate('delete')}\n            </SubmitButton>\n            <ResetButtonLink disabled={submitting} onClick={onCloseClick}>\n              {translate('cancel')}\n            </ResetButtonLink>\n          </footer>\n        </form>\n      )}\n    </SimpleModal>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { difference } from 'lodash';\nimport * as React from 'react';\nimport ActionsDropdown, {\n  ActionsDropdownItem\n} from 'sonar-ui-common/components/controls/ActionsDropdown';\nimport QualifierIcon from 'sonar-ui-common/components/icons/QualifierIcon';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport {\n  deletePermissionTemplate,\n  setDefaultPermissionTemplate,\n  updatePermissionTemplate\n} from '../../../api/permissions';\nimport { Router, withRouter } from '../../../components/hoc/withRouter';\nimport DeleteForm from './DeleteForm';\nimport Form from './Form';\n\ninterface Props {\n  fromDetails?: boolean;\n  organization?: { isDefault?: boolean; key: string };\n  permissionTemplate: T.PermissionTemplate;\n  refresh: () => void;\n  router: Pick<Router, 'replace'>;\n  topQualifiers: string[];\n}\n\ninterface State {\n  deleteForm: boolean;\n  updateModal: boolean;\n}\n\nexport class ActionsCell extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { deleteForm: false, updateModal: false };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleUpdateClick = () => {\n    this.setState({ updateModal: true });\n  };\n\n  handleCloseUpdateModal = () => {\n    if (this.mounted) {\n      this.setState({ updateModal: false });\n    }\n  };\n\n  handleSubmitUpdateModal = (data: {\n    description: string;\n    name: string;\n    projectKeyPattern: string;\n  }) => {\n    return updatePermissionTemplate({ id: this.props.permissionTemplate.id, ...data }).then(\n      this.props.refresh\n    );\n  };\n\n  handleDeleteClick = () => {\n    this.setState({ deleteForm: true });\n  };\n\n  handleCloseDeleteForm = () => {\n    if (this.mounted) {\n      this.setState({ deleteForm: false });\n    }\n  };\n\n  handleDeleteSubmit = () => {\n    return deletePermissionTemplate({ templateId: this.props.permissionTemplate.id }).then(() => {\n      const pathname = this.props.organization\n        ? `/organizations/${this.props.organization.key}/permission_templates`\n        : '/permission_templates';\n      this.props.router.replace(pathname);\n      this.props.refresh();\n    });\n  };\n\n  setDefault = (qualifier: string) => () => {\n    setDefaultPermissionTemplate(this.props.permissionTemplate.id, qualifier).then(\n      this.props.refresh,\n      () => {}\n    );\n  };\n\n  getAvailableQualifiers() {\n    const topQualifiers =\n      this.props.organization && !this.props.organization.isDefault\n        ? ['TRK']\n        : this.props.topQualifiers;\n    return difference(topQualifiers, this.props.permissionTemplate.defaultFor);\n  }\n\n  renderSetDefaultsControl() {\n    const availableQualifiers = this.getAvailableQualifiers();\n\n    if (availableQualifiers.length === 0) {\n      return null;\n    }\n\n    return this.props.topQualifiers.length === 1\n      ? this.renderIfSingleTopQualifier(availableQualifiers)\n      : this.renderIfMultipleTopQualifiers(availableQualifiers);\n  }\n\n  renderSetDefaultLink(qualifier: string, child: React.ReactNode) {\n    return (\n      <ActionsDropdownItem\n        className=\"js-set-default\"\n        data-qualifier={qualifier}\n        key={qualifier}\n        onClick={this.setDefault(qualifier)}>\n        {child}\n      </ActionsDropdownItem>\n    );\n  }\n\n  renderIfSingleTopQualifier(availableQualifiers: string[]) {\n    return availableQualifiers.map(qualifier =>\n      this.renderSetDefaultLink(\n        qualifier,\n        <span>{translate('permission_templates.set_default')}</span>\n      )\n    );\n  }\n\n  renderIfMultipleTopQualifiers(availableQualifiers: string[]) {\n    return availableQualifiers.map(qualifier =>\n      this.renderSetDefaultLink(\n        qualifier,\n        <span>\n          {translate('permission_templates.set_default_for')}{' '}\n          <QualifierIcon qualifier={qualifier} /> {translate('qualifiers', qualifier)}\n        </span>\n      )\n    );\n  }\n\n  render() {\n    const { permissionTemplate: t, organization } = this.props;\n\n    const pathname = organization\n      ? `/organizations/${organization.key}/permission_templates`\n      : '/permission_templates';\n\n    return (\n      <>\n        <ActionsDropdown>\n          {this.renderSetDefaultsControl()}\n\n          {!this.props.fromDetails && (\n            <ActionsDropdownItem to={{ pathname, query: { id: t.id } }}>\n              {translate('edit_permissions')}\n            </ActionsDropdownItem>\n          )}\n\n          <ActionsDropdownItem className=\"js-update\" onClick={this.handleUpdateClick}>\n            {translate('update_details')}\n          </ActionsDropdownItem>\n\n          {t.defaultFor.length === 0 && (\n            <ActionsDropdownItem\n              className=\"js-delete\"\n              destructive={true}\n              onClick={this.handleDeleteClick}>\n              {translate('delete')}\n            </ActionsDropdownItem>\n          )}\n        </ActionsDropdown>\n\n        {this.state.updateModal && (\n          <Form\n            confirmButtonText={translate('update_verb')}\n            header={translate('permission_template.edit_template')}\n            onClose={this.handleCloseUpdateModal}\n            onSubmit={this.handleSubmitUpdateModal}\n            permissionTemplate={t}\n          />\n        )}\n\n        {this.state.deleteForm && (\n          <DeleteForm\n            onClose={this.handleCloseDeleteForm}\n            onSubmit={this.handleDeleteSubmit}\n            permissionTemplate={t}\n          />\n        )}\n      </>\n    );\n  }\n}\n\nexport default withRouter(ActionsCell);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { sortBy } from 'lodash';\nimport * as React from 'react';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  template: T.PermissionTemplate;\n}\n\nexport default function Defaults({ organization, template }: Props) {\n  const qualifiersToDisplay =\n    organization && !organization.isDefault ? ['TRK'] : template.defaultFor;\n\n  const qualifiers = sortBy(qualifiersToDisplay)\n    .map(qualifier => translate('qualifiers', qualifier))\n    .join(', ');\n\n  return (\n    <div>\n      <span className=\"badge spacer-right\">\n        {translateWithParameters('permission_template.default_for', qualifiers)}\n      </span>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport Defaults from './Defaults';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  template: T.PermissionTemplate;\n}\n\nexport default function NameCell({ template, organization }: Props) {\n  const pathname = organization\n    ? `/organizations/${organization.key}/permission_templates`\n    : '/permission_templates';\n\n  return (\n    <td className=\"little-padded-left little-padded-right\">\n      <Link to={{ pathname, query: { id: template.id } }}>\n        <strong className=\"js-name\">{template.name}</strong>\n      </Link>\n\n      {template.defaultFor.length > 0 && (\n        <div className=\"spacer-top js-defaults\">\n          <Defaults organization={organization} template={template} />\n        </div>\n      )}\n\n      {!!template.description && (\n        <div className=\"spacer-top js-description\">{template.description}</div>\n      )}\n\n      {!!template.projectKeyPattern && (\n        <div className=\"spacer-top js-project-key-pattern\">\n          Project Key Pattern: <code>{template.projectKeyPattern}</code>\n        </div>\n      )}\n    </td>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { isSonarCloud } from '../../../helpers/system';\n\ninterface Props {\n  permission: {\n    key: string;\n    usersCount: number;\n    groupsCount: number;\n    withProjectCreator?: boolean;\n  };\n}\n\nexport default function PermissionCell({ permission: p }: Props) {\n  return (\n    <td className=\"permission-column little-padded-left little-padded-right\">\n      <div className=\"permission-column-inner\">\n        <ul>\n          {p.withProjectCreator && (\n            <li className=\"little-spacer-bottom display-flex-center\">\n              {translate('permission_templates.project_creators')}\n              <HelpTooltip\n                className=\"little-spacer-left\"\n                overlay={translate(\n                  isSonarCloud()\n                    ? 'permission_templates.project_creators.explanation.sonarcloud'\n                    : 'permission_templates.project_creators.explanation'\n                )}\n              />\n            </li>\n          )}\n          <li className=\"little-spacer-bottom\">\n            <strong>{p.usersCount}</strong>\n            {'  user(s)'}\n          </li>\n          <li>\n            <strong>{p.groupsCount}</strong>\n            {' group(s)'}\n          </li>\n        </ul>\n      </div>\n    </td>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ActionsCell from './ActionsCell';\nimport NameCell from './NameCell';\nimport PermissionCell from './PermissionCell';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  refresh: () => Promise<void>;\n  template: T.PermissionTemplate;\n  topQualifiers: string[];\n}\n\nexport default function ListItem(props: Props) {\n  const permissions = props.template.permissions.map(p => (\n    <PermissionCell key={p.key} permission={p} />\n  ));\n\n  return (\n    <tr data-id={props.template.id} data-name={props.template.name}>\n      <NameCell organization={props.organization} template={props.template} />\n\n      {permissions}\n\n      <td className=\"nowrap thin text-right text-top little-padded-left little-padded-right\">\n        <ActionsCell\n          organization={props.organization}\n          permissionTemplate={props.template}\n          refresh={props.refresh}\n          topQualifiers={props.topQualifiers}\n        />\n      </td>\n    </tr>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport ListHeader from './ListHeader';\nimport ListItem from './ListItem';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  permissionTemplates: T.PermissionTemplate[];\n  permissions: T.Permission[];\n  refresh: () => Promise<void>;\n  topQualifiers: string[];\n}\n\nexport default function List(props: Props) {\n  const permissionTemplates = props.permissionTemplates.map(p => (\n    <ListItem\n      key={p.id}\n      organization={props.organization}\n      refresh={props.refresh}\n      template={p}\n      topQualifiers={props.topQualifiers}\n    />\n  ));\n\n  return (\n    <div className=\"boxed-group boxed-group-inner\">\n      <table className=\"data zebra permissions-table\" id=\"permission-templates\">\n        <ListHeader organization={props.organization} permissions={props.permissions} />\n        <tbody>{permissionTemplates}</tbody>\n      </table>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport Header from './Header';\nimport List from './List';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  permissionTemplates: T.PermissionTemplate[];\n  permissions: T.Permission[];\n  ready: boolean;\n  refresh: () => Promise<void>;\n  topQualifiers: string[];\n}\n\nexport default function Home(props: Props) {\n  return (\n    <div className=\"page page-limited\">\n      <Helmet defer={false} title={translate('permission_templates.page')} />\n\n      <Header organization={props.organization} ready={props.ready} refresh={props.refresh} />\n\n      <List\n        organization={props.organization}\n        permissionTemplates={props.permissionTemplates}\n        permissions={props.permissions}\n        refresh={props.refresh}\n        topQualifiers={props.topQualifiers}\n      />\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Defaults from './Defaults';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  template: T.PermissionTemplate;\n}\n\nexport default function TemplateDetails({ organization, template }: Props) {\n  return (\n    <div className=\"big-spacer-bottom\">\n      {template.defaultFor.length > 0 && (\n        <div className=\"spacer-top js-defaults\">\n          <Defaults organization={organization} template={template} />\n        </div>\n      )}\n\n      {!!template.description && (\n        <div className=\"spacer-top js-description\">{template.description}</div>\n      )}\n\n      {!!template.projectKeyPattern && (\n        <div className=\"spacer-top js-project-key-pattern\">\n          Project Key Pattern: <code>{template.projectKeyPattern}</code>\n        </div>\n      )}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport ActionsCell from './ActionsCell';\n\ninterface Props {\n  loading: boolean;\n  organization: T.Organization | undefined;\n  refresh: () => void;\n  template: T.PermissionTemplate;\n  topQualifiers: string[];\n}\n\nexport default function TemplateHeader(props: Props) {\n  const { template, organization } = props;\n\n  const pathname = organization\n    ? `/organizations/${organization.key}/permission_templates`\n    : '/permission_templates';\n\n  return (\n    <header className=\"page-header\" id=\"project-permissions-header\">\n      <div className=\"note spacer-bottom\">\n        <Link className=\"text-muted\" to={pathname}>\n          {translate('permission_templates.page')}\n        </Link>\n      </div>\n\n      <h1 className=\"page-title\">{template.name}</h1>\n\n      {props.loading && <i className=\"spinner\" />}\n\n      <div className=\"pull-right\">\n        <ActionsCell\n          fromDetails={true}\n          organization={organization}\n          permissionTemplate={template}\n          refresh={props.refresh}\n          topQualifiers={props.topQualifiers}\n        />\n      </div>\n    </header>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport * as api from '../../../api/permissions';\nimport HoldersList from '../../permissions/shared/components/HoldersList';\nimport SearchForm from '../../permissions/shared/components/SearchForm';\nimport {\n  convertToPermissionDefinitions,\n  PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE\n} from '../../permissions/utils';\nimport TemplateDetails from './TemplateDetails';\nimport TemplateHeader from './TemplateHeader';\n\ninterface Props {\n  organization: T.Organization | undefined;\n  refresh: () => void;\n  template: T.PermissionTemplate;\n  topQualifiers: string[];\n}\n\ninterface State {\n  filter: string;\n  groups: T.PermissionGroup[];\n  loading: boolean;\n  query: string;\n  selectedPermission?: string;\n  users: T.PermissionUser[];\n}\n\nexport default class Template extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {\n    filter: 'all',\n    groups: [],\n    loading: false,\n    query: '',\n    users: []\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.requestHolders();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  requestHolders = (realQuery?: string) => {\n    this.setState({ loading: true });\n\n    const { template } = this.props;\n    const { query, filter, selectedPermission } = this.state;\n    const requests = [];\n\n    const finalQuery = realQuery != null ? realQuery : query;\n\n    if (filter !== 'groups') {\n      requests.push(api.getPermissionTemplateUsers(template.id, finalQuery, selectedPermission));\n    } else {\n      requests.push(Promise.resolve([]));\n    }\n\n    if (filter !== 'users') {\n      requests.push(api.getPermissionTemplateGroups(template.id, finalQuery, selectedPermission));\n    } else {\n      requests.push(Promise.resolve([]));\n    }\n\n    return Promise.all(requests).then(responses => {\n      if (this.mounted) {\n        this.setState({\n          users: responses[0],\n          groups: responses[1],\n          loading: false\n        });\n      }\n    });\n  };\n\n  handleToggleUser = (user: T.PermissionUser, permission: string) => {\n    if (user.login === '<creator>') {\n      return this.handleToggleProjectCreator(user, permission);\n    }\n    const { template, organization } = this.props;\n    const hasPermission = user.permissions.includes(permission);\n    const data: { templateId: string; login: string; permission: string; organization?: string } = {\n      templateId: template.id,\n      login: user.login,\n      permission\n    };\n    if (organization) {\n      data.organization = organization.key;\n    }\n    const request = hasPermission\n      ? api.revokeTemplatePermissionFromUser(data)\n      : api.grantTemplatePermissionToUser(data);\n    return request.then(() => this.requestHolders()).then(this.props.refresh);\n  };\n\n  handleToggleProjectCreator = (user: T.PermissionUser, permission: string) => {\n    const { template } = this.props;\n    const hasPermission = user.permissions.includes(permission);\n    const request = hasPermission\n      ? api.removeProjectCreatorFromTemplate(template.id, permission)\n      : api.addProjectCreatorToTemplate(template.id, permission);\n    return request.then(() => this.requestHolders()).then(this.props.refresh);\n  };\n\n  handleToggleGroup = (group: T.PermissionGroup, permission: string) => {\n    const { template, organization } = this.props;\n    const hasPermission = group.permissions.includes(permission);\n    const data = {\n      templateId: template.id,\n      groupName: group.name,\n      permission\n    };\n    if (organization) {\n      Object.assign(data, { organization: organization.key });\n    }\n    const request = hasPermission\n      ? api.revokeTemplatePermissionFromGroup(data)\n      : api.grantTemplatePermissionToGroup(data);\n    return request.then(() => this.requestHolders()).then(this.props.refresh);\n  };\n\n  handleSearch = (query: string) => {\n    this.setState({ query });\n    this.requestHolders(query);\n  };\n\n  handleFilter = (filter: string) => {\n    this.setState({ filter }, this.requestHolders);\n  };\n\n  handleSelectPermission = (selectedPermission: string) => {\n    if (selectedPermission === this.state.selectedPermission) {\n      this.setState({ selectedPermission: undefined }, this.requestHolders);\n    } else {\n      this.setState({ selectedPermission }, this.requestHolders);\n    }\n  };\n\n  shouldDisplayCreator = (creatorPermissions: string[]) => {\n    const { filter, query, selectedPermission } = this.state;\n    const CREATOR_NAME = translate('permission_templates.project_creators');\n\n    const isFiltered = filter !== 'all';\n\n    const matchQuery = !query || CREATOR_NAME.toLocaleLowerCase().includes(query.toLowerCase());\n\n    const matchPermission =\n      selectedPermission === undefined || creatorPermissions.includes(selectedPermission);\n\n    return !isFiltered && matchQuery && matchPermission;\n  };\n\n  render() {\n    const permissions = convertToPermissionDefinitions(\n      PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE,\n      'projects_role'\n    );\n\n    const allUsers = [...this.state.users];\n\n    const creatorPermissions = this.props.template.permissions\n      .filter(p => p.withProjectCreator)\n      .map(p => p.key);\n\n    if (this.shouldDisplayCreator(creatorPermissions)) {\n      const creator = {\n        login: '<creator>',\n        name: translate('permission_templates.project_creators'),\n        permissions: creatorPermissions\n      };\n\n      allUsers.unshift(creator);\n    }\n\n    return (\n      <div className=\"page page-limited\">\n        <Helmet defer={false} title={this.props.template.name} />\n\n        <TemplateHeader\n          loading={this.state.loading}\n          organization={this.props.organization}\n          refresh={this.props.refresh}\n          template={this.props.template}\n          topQualifiers={this.props.topQualifiers}\n        />\n\n        <TemplateDetails organization={this.props.organization} template={this.props.template} />\n\n        <HoldersList\n          groups={this.state.groups}\n          onSelectPermission={this.handleSelectPermission}\n          onToggleGroup={this.handleToggleGroup}\n          onToggleUser={this.handleToggleUser}\n          permissions={permissions}\n          selectedPermission={this.state.selectedPermission}\n          showPublicProjectsWarning={true}\n          users={allUsers}>\n          <SearchForm\n            filter={this.state.filter}\n            onFilter={this.handleFilter}\n            onSearch={this.handleSearch}\n            query={this.state.query}\n          />\n        </HoldersList>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { Location } from 'history';\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { getPermissionTemplates } from '../../../api/permissions';\nimport Suggestions from '../../../app/components/embed-docs-modal/Suggestions';\nimport OrganizationHelmet from '../../../components/common/OrganizationHelmet';\nimport { getAppState, Store } from '../../../store/rootReducer';\nimport '../../permissions/styles.css';\nimport { mergeDefaultsToTemplates, mergePermissionsToTemplates, sortPermissions } from '../utils';\nimport Home from './Home';\nimport Template from './Template';\n\ninterface Props {\n  location: Location;\n  organization: T.Organization | undefined;\n  topQualifiers: string[];\n}\n\ninterface State {\n  ready: boolean;\n  permissions: T.Permission[];\n  permissionTemplates: T.PermissionTemplate[];\n}\n\nexport class App extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = {\n    ready: false,\n    permissions: [],\n    permissionTemplates: []\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.requestPermissions();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  requestPermissions = () => {\n    const { organization } = this.props;\n    const request = organization\n      ? getPermissionTemplates(organization.key)\n      : getPermissionTemplates();\n    return request.then(r => {\n      if (this.mounted) {\n        const permissions = sortPermissions(r.permissions);\n        const permissionTemplates = mergeDefaultsToTemplates(\n          mergePermissionsToTemplates(r.permissionTemplates, permissions),\n          r.defaultTemplates\n        );\n        this.setState({ ready: true, permissionTemplates, permissions });\n      }\n    });\n  };\n\n  renderTemplate(id: string) {\n    if (!this.state.ready) {\n      return null;\n    }\n\n    const template = this.state.permissionTemplates.find(t => t.id === id);\n    if (!template) {\n      return null;\n    }\n\n    return (\n      <Template\n        organization={this.props.organization}\n        refresh={this.requestPermissions}\n        template={template}\n        topQualifiers={this.props.topQualifiers}\n      />\n    );\n  }\n\n  renderHome() {\n    return (\n      <Home\n        organization={this.props.organization}\n        permissionTemplates={this.state.permissionTemplates}\n        permissions={this.state.permissions}\n        ready={this.state.ready}\n        refresh={this.requestPermissions}\n        topQualifiers={this.props.topQualifiers}\n      />\n    );\n  }\n\n  render() {\n    const { id } = this.props.location.query;\n    return (\n      <div>\n        <Suggestions suggestions=\"permission_templates\" />\n        <OrganizationHelmet\n          organization={this.props.organization}\n          title={translate('permission_templates.page')}\n        />\n\n        {id && this.renderTemplate(id)}\n        {!id && this.renderHome()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state: Store) => ({ topQualifiers: getAppState(state).qualifiers });\n\nexport default connect(mapStateToProps)(App);\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { SuggestionsContext } from './SuggestionsContext';\n\ninterface Props {\n  suggestions: string;\n}\n\nexport default function Suggestions({ suggestions }: Props) {\n  return (\n    <SuggestionsContext.Consumer>\n      {({ addSuggestions, removeSuggestions }) => (\n        <SuggestionsInner\n          addSuggestions={addSuggestions}\n          removeSuggestions={removeSuggestions}\n          suggestions={suggestions}\n        />\n      )}\n    </SuggestionsContext.Consumer>\n  );\n}\n\ninterface SuggestionsInnerProps {\n  addSuggestions: (key: string) => void;\n  removeSuggestions: (key: string) => void;\n  suggestions: string;\n}\n\nclass SuggestionsInner extends React.PureComponent<SuggestionsInnerProps> {\n  componentDidMount() {\n    this.props.addSuggestions(this.props.suggestions);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.suggestions !== this.props.suggestions) {\n      this.props.removeSuggestions(this.props.suggestions);\n      this.props.addSuggestions(prevProps.suggestions);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.removeSuggestions(this.props.suggestions);\n  }\n\n  render() {\n    return null;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { hasMessage, translate } from 'sonar-ui-common/helpers/l10n';\nimport { isSonarCloud } from '../../helpers/system';\n\nexport const PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE = [\n  'user',\n  'codeviewer',\n  'issueadmin',\n  'securityhotspotadmin',\n  'admin',\n  'scan'\n];\n\nexport const PERMISSIONS_ORDER_GLOBAL = [\n  'admin',\n  { category: 'administer', permissions: ['gateadmin', 'profileadmin'] },\n  'scan',\n  { category: 'creator', permissions: ['provisioning'] }\n];\n\nexport const PERMISSIONS_ORDER_GLOBAL_GOV = [\n  'admin',\n  { category: 'administer', permissions: ['gateadmin', 'profileadmin'] },\n  'scan',\n  { category: 'creator', permissions: ['provisioning', 'applicationcreator', 'portfoliocreator'] }\n];\n\nexport const PERMISSIONS_ORDER_FOR_VIEW = ['user', 'admin'];\n\nexport const PERMISSIONS_ORDER_FOR_DEV = ['user', 'admin'];\n\nexport const PERMISSIONS_ORDER_BY_QUALIFIER: T.Dict<string[]> = {\n  TRK: PERMISSIONS_ORDER_FOR_PROJECT_TEMPLATE,\n  VW: PERMISSIONS_ORDER_FOR_VIEW,\n  SVW: PERMISSIONS_ORDER_FOR_VIEW,\n  APP: PERMISSIONS_ORDER_FOR_VIEW,\n  DEV: PERMISSIONS_ORDER_FOR_DEV\n};\n\nfunction convertToPermissionDefinition(permission: string, l10nPrefix: string) {\n  const getMessage = (messageKey: string) => {\n    const cloudMessageKey = `${messageKey}.sonarcloud`;\n    return isSonarCloud() && hasMessage(cloudMessageKey)\n      ? translate(cloudMessageKey)\n      : translate(messageKey);\n  };\n\n  const name = getMessage(`${l10nPrefix}.${permission}`);\n  const description = getMessage(`${l10nPrefix}.${permission}.desc`);\n\n  return {\n    key: permission,\n    name,\n    description\n  };\n}\n\nexport function convertToPermissionDefinitions(\n  permissions: Array<string | { category: string; permissions: string[] }>,\n  l10nPrefix: string\n): Array<T.PermissionDefinition | T.PermissionDefinitionGroup> {\n  return permissions.map(permission => {\n    if (typeof permission === 'object') {\n      return {\n        category: permission.category,\n        permissions: permission.permissions.map(permission =>\n          convertToPermissionDefinition(permission, l10nPrefix)\n        )\n      };\n    }\n    return convertToPermissionDefinition(permission, l10nPrefix);\n  });\n}\n\nexport function isPermissionDefinitionGroup(\n  permission?: T.PermissionDefinition | T.PermissionDefinitionGroup\n): permission is T.PermissionDefinitionGroup {\n  return Boolean(permission && (permission as T.PermissionDefinitionGroup).category);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, post, postJSON, RequestData } from 'sonar-ui-common/helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\nimport { BaseSearchProjectsParameters } from './components';\n\nconst PAGE_SIZE = 100;\n\nexport function grantPermissionToUser(data: {\n  projectKey?: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/add_user', data).catch(throwGlobalError);\n}\n\nexport function revokePermissionFromUser(data: {\n  projectKey?: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/remove_user', data).catch(throwGlobalError);\n}\n\nexport function grantPermissionToGroup(data: {\n  projectKey?: string;\n  groupName: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/add_group', data).catch(throwGlobalError);\n}\n\nexport function revokePermissionFromGroup(data: {\n  projectKey?: string;\n  groupName: string;\n  permission: string;\n  organization?: string;\n}) {\n  return post('/api/permissions/remove_group', data).catch(throwGlobalError);\n}\n\ninterface GetPermissionTemplatesResponse {\n  permissionTemplates: T.PermissionTemplate[];\n  defaultTemplates: Array<{ templateId: string; qualifier: string }>;\n  permissions: Array<{ key: string; name: string; description: string }>;\n}\n\nexport function getPermissionTemplates(\n  organization?: string\n): Promise<GetPermissionTemplatesResponse> {\n  const url = '/api/permissions/search_templates';\n  return organization ? getJSON(url, { organization }) : getJSON(url);\n}\n\nexport function createPermissionTemplate(data: RequestData) {\n  return postJSON('/api/permissions/create_template', data);\n}\n\nexport function updatePermissionTemplate(data: RequestData): Promise<void> {\n  return post('/api/permissions/update_template', data);\n}\n\nexport function deletePermissionTemplate(data: RequestData) {\n  return post('/api/permissions/delete_template', data).catch(throwGlobalError);\n}\n\n/**\n * Set default permission template for a given qualifier\n */\nexport function setDefaultPermissionTemplate(templateId: string, qualifier: string): Promise<void> {\n  return post('/api/permissions/set_default_template', { templateId, qualifier });\n}\n\nexport function applyTemplateToProject(data: RequestData) {\n  return post('/api/permissions/apply_template', data).catch(throwGlobalError);\n}\n\nexport function bulkApplyTemplate(data: BaseSearchProjectsParameters): Promise<void> {\n  return post('/api/permissions/bulk_apply_template', data);\n}\n\nexport function grantTemplatePermissionToUser(data: {\n  templateId: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}): Promise<void> {\n  return post('/api/permissions/add_user_to_template', data);\n}\n\nexport function revokeTemplatePermissionFromUser(data: {\n  templateId: string;\n  login: string;\n  permission: string;\n  organization?: string;\n}): Promise<void> {\n  return post('/api/permissions/remove_user_from_template', data);\n}\n\nexport function grantTemplatePermissionToGroup(data: RequestData): Promise<void> {\n  return post('/api/permissions/add_group_to_template', data);\n}\n\nexport function revokeTemplatePermissionFromGroup(data: RequestData): Promise<void> {\n  return post('/api/permissions/remove_group_from_template', data);\n}\n\nexport function addProjectCreatorToTemplate(templateId: string, permission: string): Promise<void> {\n  return post('/api/permissions/add_project_creator_to_template', { templateId, permission });\n}\n\nexport function removeProjectCreatorFromTemplate(\n  templateId: string,\n  permission: string\n): Promise<void> {\n  return post('/api/permissions/remove_project_creator_from_template', { templateId, permission });\n}\n\nexport function getPermissionsUsersForComponent(data: {\n  projectKey: string;\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; users: T.PermissionUser[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/users', data).catch(throwGlobalError);\n}\n\nexport function getPermissionsGroupsForComponent(data: {\n  projectKey: string;\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; groups: T.PermissionGroup[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/groups', data).catch(throwGlobalError);\n}\n\nexport function getGlobalPermissionsUsers(data: {\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; users: T.PermissionUser[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/users', data);\n}\n\nexport function getGlobalPermissionsGroups(data: {\n  q?: string;\n  permission?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n}): Promise<{ paging: T.Paging; groups: T.PermissionGroup[] }> {\n  if (!data.ps) {\n    data.ps = PAGE_SIZE;\n  }\n  return getJSON('/api/permissions/groups', data);\n}\n\nexport function getPermissionTemplateUsers(\n  templateId: string,\n  query?: string,\n  permission?: string,\n  organization?: string\n): Promise<any> {\n  const data: RequestData = { templateId, ps: PAGE_SIZE };\n  if (query) {\n    data.q = query;\n  }\n  if (permission) {\n    data.permission = permission;\n  }\n  if (organization) {\n    Object.assign(data, { organization });\n  }\n  return getJSON('/api/permissions/template_users', data).then(r => r.users);\n}\n\nexport function getPermissionTemplateGroups(\n  templateId: string,\n  query?: string,\n  permission?: string,\n  organization?: string\n): Promise<any> {\n  const data: RequestData = { templateId, ps: PAGE_SIZE };\n  if (query) {\n    data.q = query;\n  }\n  if (permission) {\n    data.permission = permission;\n  }\n  if (organization) {\n    Object.assign(data, { organization });\n  }\n  return getJSON('/api/permissions/template_groups', data).then(r => r.groups);\n}\n\nexport function changeProjectVisibility(\n  project: string,\n  visibility: T.Visibility\n): Promise<void | Response> {\n  return post('/api/projects/update_visibility', { project, visibility }).catch(throwGlobalError);\n}\n\nexport function changeProjectDefaultVisibility(\n  organization: string,\n  projectVisibility: T.Visibility\n): Promise<void | Response> {\n  return post('/api/projects/update_default_visibility', { organization, projectVisibility }).catch(\n    throwGlobalError\n  );\n}\n","var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-1!../../../../../node_modules/postcss-loader/src/index.js??postcss!./styles.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\nvar exported = content.locals ? content.locals : {};\n\n\n\nmodule.exports = exported;","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".permissions-table .permission-column.selected{background-color:#d9edf7}.permissions-table .permission-column-inner{width:100px}.permissions-table .divider{background:#fff;padding:16px 0}.permissions-table .divider:after{display:block;content:\\\"\\\";background:#e6e6e6;height:1px;width:100%}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport RadioToggle from 'sonar-ui-common/components/controls/RadioToggle';\nimport SearchBox from 'sonar-ui-common/components/controls/SearchBox';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\n\ninterface Props {\n  filter: string;\n  onFilter: (value: string) => void;\n  onSearch: (value: string) => void;\n  query: string;\n}\n\nexport default function SearchForm(props: Props) {\n  const filterOptions = [\n    { value: 'all', label: translate('all') },\n    { value: 'users', label: translate('users.page') },\n    { value: 'groups', label: translate('user_groups.page') }\n  ];\n\n  return (\n    <div className=\"display-flex-row\">\n      <RadioToggle\n        name=\"users-or-groups\"\n        onCheck={props.onFilter}\n        options={filterOptions}\n        value={props.filter}\n      />\n\n      <div className=\"flex-1 spacer-left\">\n        <SearchBox\n          minLength={3}\n          onChange={props.onSearch}\n          placeholder={translate('search.search_for_users_or_groups')}\n          value={props.query}\n        />\n      </div>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport Checkbox from 'sonar-ui-common/components/controls/Checkbox';\nimport { isPermissionDefinitionGroup } from '../../utils';\n\ninterface Props {\n  loading: string[];\n  onCheck: (checked: boolean, permission?: string) => void;\n  permission: T.PermissionDefinition | T.PermissionDefinitionGroup;\n  permissionItem: T.PermissionGroup | T.PermissionUser;\n  selectedPermission?: string;\n}\n\nexport default class PermissionCell extends React.PureComponent<Props> {\n  render() {\n    const { loading, onCheck, permission, permissionItem, selectedPermission } = this.props;\n    if (isPermissionDefinitionGroup(permission)) {\n      return (\n        <td className=\"text-middle\">\n          {permission.permissions.map(permission => (\n            <div key={permission.key}>\n              <Checkbox\n                checked={permissionItem.permissions.includes(permission.key)}\n                disabled={loading.includes(permission.key)}\n                id={permission.key}\n                onCheck={onCheck}>\n                <span className=\"little-spacer-left\">{permission.name}</span>\n              </Checkbox>\n            </div>\n          ))}\n        </td>\n      );\n    } else {\n      return (\n        <td\n          className={classNames('permission-column text-center text-middle', {\n            selected: permission.key === selectedPermission\n          })}>\n          <Checkbox\n            checked={permissionItem.permissions.includes(permission.key)}\n            disabled={loading.includes(permission.key)}\n            id={permission.key}\n            onCheck={onCheck}\n          />\n        </td>\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { without } from 'lodash';\nimport * as React from 'react';\nimport GroupIcon from 'sonar-ui-common/components/icons/GroupIcon';\nimport { isPermissionDefinitionGroup } from '../../utils';\nimport PermissionCell from './PermissionCell';\n\ninterface Props {\n  group: T.PermissionGroup;\n  onToggle: (group: T.PermissionGroup, permission: string) => Promise<void>;\n  permissions: T.PermissionDefinitions;\n  selectedPermission?: string;\n}\n\ninterface State {\n  loading: string[];\n}\n\nexport default class GroupHolder extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  stopLoading = (permission: string) => {\n    if (this.mounted) {\n      this.setState(state => ({ loading: without(state.loading, permission) }));\n    }\n  };\n\n  handleCheck = (_checked: boolean, permission?: string) => {\n    if (permission !== undefined) {\n      this.setState(state => ({ loading: [...state.loading, permission] }));\n      this.props.onToggle(this.props.group, permission).then(\n        () => this.stopLoading(permission),\n        () => this.stopLoading(permission)\n      );\n    }\n  };\n\n  render() {\n    const { group } = this.props;\n\n    return (\n      <tr>\n        <td className=\"nowrap text-middle\">\n          <div className=\"display-inline-block text-middle big-spacer-right\">\n            <GroupIcon />\n          </div>\n          <div className=\"display-inline-block text-middle\">\n            <div>\n              <strong>{group.name}</strong>\n            </div>\n            <div className=\"little-spacer-top\" style={{ whiteSpace: 'normal' }}>\n              {group.description}\n            </div>\n          </div>\n        </td>\n        {this.props.permissions.map(permission => (\n          <PermissionCell\n            key={isPermissionDefinitionGroup(permission) ? permission.category : permission.key}\n            loading={this.state.loading}\n            onCheck={this.handleCheck}\n            permission={permission}\n            permissionItem={group}\n            selectedPermission={this.props.selectedPermission}\n          />\n        ))}\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as classNames from 'classnames';\nimport * as React from 'react';\nimport HelpTooltip from 'sonar-ui-common/components/controls/HelpTooltip';\nimport Tooltip from 'sonar-ui-common/components/controls/Tooltip';\nimport { Alert } from 'sonar-ui-common/components/ui/Alert';\nimport { translate, translateWithParameters } from 'sonar-ui-common/helpers/l10n';\nimport InstanceMessage from '../../../../components/common/InstanceMessage';\nimport { isPermissionDefinitionGroup } from '../../utils';\n\ninterface Props {\n  onSelectPermission?: (permission: string) => void;\n  permission: T.PermissionDefinition | T.PermissionDefinitionGroup;\n  selectedPermission?: string;\n  showPublicProjectsWarning?: boolean;\n}\n\nexport default class PermissionHeader extends React.PureComponent<Props> {\n  handlePermissionClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { permission } = this.props;\n    if (this.props.onSelectPermission && !isPermissionDefinitionGroup(permission)) {\n      this.props.onSelectPermission(permission.key);\n    }\n  };\n\n  getTooltipOverlay = () => {\n    const { permission } = this.props;\n\n    if (isPermissionDefinitionGroup(permission)) {\n      return permission.permissions.map(permission => (\n        <React.Fragment key={permission.key}>\n          <b className=\"little-spacer-right\">{permission.name}:</b>\n          <InstanceMessage key={permission.key} message={permission.description} />\n          <br />\n        </React.Fragment>\n      ));\n    } else {\n      if (this.props.showPublicProjectsWarning && ['user', 'codeviewer'].includes(permission.key)) {\n        return (\n          <div>\n            <InstanceMessage message={permission.description} />\n            <Alert className=\"spacer-top\" variant=\"warning\">\n              {translate('projects_role.public_projects_warning')}\n            </Alert>\n          </div>\n        );\n      }\n      return <InstanceMessage message={permission.description} />;\n    }\n  };\n\n  render() {\n    const { onSelectPermission, permission } = this.props;\n    let name;\n    if (isPermissionDefinitionGroup(permission)) {\n      name = translate('global_permissions', permission.category);\n    } else {\n      name = onSelectPermission ? (\n        <Tooltip\n          overlay={translateWithParameters(\n            'global_permissions.filter_by_x_permission',\n            permission.name\n          )}>\n          <a href=\"#\" onClick={this.handlePermissionClick}>\n            {permission.name}\n          </a>\n        </Tooltip>\n      ) : (\n        permission.name\n      );\n    }\n    return (\n      <th\n        className={classNames('permission-column text-center text-middle', {\n          selected:\n            !isPermissionDefinitionGroup(permission) &&\n            permission.key === this.props.selectedPermission\n        })}>\n        <div className=\"permission-column-inner\">\n          {name}\n          <HelpTooltip className=\"spacer-left\" overlay={this.getTooltipOverlay()} />\n        </div>\n      </th>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { without } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport Avatar from '../../../../components/ui/Avatar';\nimport { isSonarCloud } from '../../../../helpers/system';\nimport { isPermissionDefinitionGroup } from '../../utils';\nimport PermissionCell from './PermissionCell';\n\ninterface Props {\n  onToggle: (user: T.PermissionUser, permission: string) => Promise<void>;\n  permissions: T.PermissionDefinitions;\n  selectedPermission?: string;\n  user: T.PermissionUser;\n}\n\ninterface State {\n  loading: string[];\n}\n\nexport default class UserHolder extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  stopLoading = (permission: string) => {\n    if (this.mounted) {\n      this.setState(state => ({ loading: without(state.loading, permission) }));\n    }\n  };\n\n  handleCheck = (_checked: boolean, permission?: string) => {\n    if (permission !== undefined) {\n      this.setState(state => ({ loading: [...state.loading, permission] }));\n      this.props.onToggle(this.props.user, permission).then(\n        () => this.stopLoading(permission),\n        () => this.stopLoading(permission)\n      );\n    }\n  };\n\n  render() {\n    const { user } = this.props;\n    const permissionCells = this.props.permissions.map(permission => (\n      <PermissionCell\n        key={isPermissionDefinitionGroup(permission) ? permission.category : permission.key}\n        loading={this.state.loading}\n        onCheck={this.handleCheck}\n        permission={permission}\n        permissionItem={user}\n        selectedPermission={this.props.selectedPermission}\n      />\n    ));\n\n    if (user.login === '<creator>') {\n      return (\n        <tr>\n          <td className=\"nowrap text-middle\">\n            <div className=\"display-inline-block text-middle\">\n              <div>\n                <strong>{user.name}</strong>\n              </div>\n              <div className=\"little-spacer-top\" style={{ whiteSpace: 'normal' }}>\n                {translate(\n                  isSonarCloud()\n                    ? 'permission_templates.project_creators.explanation.sonarcloud'\n                    : 'permission_templates.project_creators.explanation'\n                )}\n              </div>\n            </div>\n          </td>\n          {permissionCells}\n        </tr>\n      );\n    }\n\n    return (\n      <tr>\n        <td className=\"nowrap text-middle\">\n          <Avatar\n            className=\"text-middle big-spacer-right\"\n            hash={user.avatar}\n            name={user.name}\n            size={36}\n          />\n          <div className=\"display-inline-block text-middle\">\n            {isSonarCloud() ? (\n              <>\n                <div>\n                  <strong>{user.name}</strong>\n                </div>\n                <div className=\"note little-spacer-top\">{user.login}</div>\n              </>\n            ) : (\n              <>\n                <div>\n                  <strong>{user.name}</strong>\n                  <span className=\"note spacer-left\">{user.login}</span>\n                </div>\n                <div className=\"little-spacer-top\">{user.email}</div>\n              </>\n            )}\n          </div>\n        </td>\n        {permissionCells}\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2020 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { partition, sortBy } from 'lodash';\nimport * as React from 'react';\nimport { translate } from 'sonar-ui-common/helpers/l10n';\nimport { isPermissionDefinitionGroup } from '../../utils';\nimport GroupHolder from './GroupHolder';\nimport PermissionHeader from './PermissionHeader';\nimport UserHolder from './UserHolder';\n\ninterface Props {\n  filter?: string;\n  groups: T.PermissionGroup[];\n  loading?: boolean;\n  onSelectPermission?: (permission: string) => void;\n  onToggleGroup: (group: T.PermissionGroup, permission: string) => Promise<void>;\n  onToggleUser: (user: T.PermissionUser, permission: string) => Promise<void>;\n  permissions: T.PermissionDefinitions;\n  query?: string;\n  selectedPermission?: string;\n  showPublicProjectsWarning?: boolean;\n  users: T.PermissionUser[];\n}\n\ninterface State {\n  initialPermissionsCount: T.Dict<number>;\n}\nexport default class HoldersList extends React.PureComponent<Props, State> {\n  state: State = { initialPermissionsCount: {} };\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.filter !== prevProps.filter || this.props.query !== prevProps.query) {\n      this.setState({ initialPermissionsCount: {} });\n    }\n  }\n\n  isPermissionUser(item: T.PermissionGroup | T.PermissionUser): item is T.PermissionUser {\n    return (item as T.PermissionUser).login !== undefined;\n  }\n\n  handleGroupToggle = (group: T.PermissionGroup, permission: string) => {\n    const key = group.id || group.name;\n    if (this.state.initialPermissionsCount[key] === undefined) {\n      this.setState(state => ({\n        initialPermissionsCount: {\n          ...state.initialPermissionsCount,\n          [key]: group.permissions.length\n        }\n      }));\n    }\n    return this.props.onToggleGroup(group, permission);\n  };\n\n  handleUserToggle = (user: T.PermissionUser, permission: string) => {\n    if (this.state.initialPermissionsCount[user.login] === undefined) {\n      this.setState(state => ({\n        initialPermissionsCount: {\n          ...state.initialPermissionsCount,\n          [user.login]: user.permissions.length\n        }\n      }));\n    }\n    return this.props.onToggleUser(user, permission);\n  };\n\n  getItemInitialPermissionsCount = (item: T.PermissionGroup | T.PermissionUser) => {\n    const key = this.isPermissionUser(item) ? item.login : item.id || item.name;\n    return this.state.initialPermissionsCount[key] !== undefined\n      ? this.state.initialPermissionsCount[key]\n      : item.permissions.length;\n  };\n\n  renderEmpty() {\n    const columns = this.props.permissions.length + 1;\n    return (\n      <tr>\n        <td colSpan={columns}>{translate('no_results_search')}</td>\n      </tr>\n    );\n  }\n\n  renderItem(item: T.PermissionUser | T.PermissionGroup, permissions: T.PermissionDefinitions) {\n    return this.isPermissionUser(item) ? (\n      <UserHolder\n        key={`user-${item.login}`}\n        onToggle={this.handleUserToggle}\n        permissions={permissions}\n        selectedPermission={this.props.selectedPermission}\n        user={item}\n      />\n    ) : (\n      <GroupHolder\n        group={item}\n        key={`group-${item.id || item.name}`}\n        onToggle={this.handleGroupToggle}\n        permissions={permissions}\n        selectedPermission={this.props.selectedPermission}\n      />\n    );\n  }\n\n  render() {\n    const { permissions } = this.props;\n    const items = sortBy([...this.props.users, ...this.props.groups], item => {\n      if (this.isPermissionUser(item) && item.login === '<creator>') {\n        return 0;\n      }\n      return item.name;\n    });\n    const [itemWithPermissions, itemWithoutPermissions] = partition(items, item =>\n      this.getItemInitialPermissionsCount(item)\n    );\n    return (\n      <div className=\"boxed-group boxed-group-inner\">\n        <table className=\"data zebra permissions-table\">\n          <thead>\n            <tr>\n              <td className=\"nowrap bordered-bottom\">{this.props.children}</td>\n              {permissions.map(permission => (\n                <PermissionHeader\n                  key={\n                    isPermissionDefinitionGroup(permission) ? permission.category : permission.key\n                  }\n                  onSelectPermission={this.props.onSelectPermission}\n                  permission={permission}\n                  selectedPermission={this.props.selectedPermission}\n                  showPublicProjectsWarning={this.props.showPublicProjectsWarning}\n                />\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {items.length === 0 && !this.props.loading && this.renderEmpty()}\n            {itemWithPermissions.map(item => this.renderItem(item, permissions))}\n            {itemWithPermissions.length > 0 && itemWithoutPermissions.length > 0 && (\n              <>\n                <tr>\n                  <td className=\"divider\" colSpan={20} />\n                </tr>\n                <tr />\n                {/* Keep correct zebra colors in the table */}\n              </>\n            )}\n            {itemWithoutPermissions.map(item => this.renderItem(item, permissions))}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}